var app = (function () {
    'use strict';

    function noop() { }
    function add_location(element, file, line, column, char) {
        element.__svelte_meta = {
            loc: { file, line, column, char }
        };
    }
    function run(fn) {
        return fn();
    }
    function blank_object() {
        return Object.create(null);
    }
    function run_all(fns) {
        fns.forEach(run);
    }
    function is_function(thing) {
        return typeof thing === 'function';
    }
    function safe_not_equal(a, b) {
        return a != a ? b == b : a !== b || ((a && typeof a === 'object') || typeof a === 'function');
    }
    function is_empty(obj) {
        return Object.keys(obj).length === 0;
    }
    function insert(target, node, anchor) {
        target.insertBefore(node, anchor || null);
    }
    function detach(node) {
        if (node.parentNode) {
            node.parentNode.removeChild(node);
        }
    }
    function element(name) {
        return document.createElement(name);
    }
    function children(element) {
        return Array.from(element.childNodes);
    }
    function set_style(node, key, value, important) {
        if (value == null) {
            node.style.removeProperty(key);
        }
        else {
            node.style.setProperty(key, value, important ? 'important' : '');
        }
    }
    function custom_event(type, detail, { bubbles = false, cancelable = false } = {}) {
        const e = document.createEvent('CustomEvent');
        e.initCustomEvent(type, bubbles, cancelable, detail);
        return e;
    }

    let current_component;
    function set_current_component(component) {
        current_component = component;
    }
    function get_current_component() {
        if (!current_component)
            throw new Error('Function called outside component initialization');
        return current_component;
    }
    /**
     * The `onMount` function schedules a callback to run as soon as the component has been mounted to the DOM.
     * It must be called during the component's initialisation (but doesn't need to live *inside* the component;
     * it can be called from an external module).
     *
     * `onMount` does not run inside a [server-side component](/docs#run-time-server-side-component-api).
     *
     * https://svelte.dev/docs#run-time-svelte-onmount
     */
    function onMount(fn) {
        get_current_component().$$.on_mount.push(fn);
    }

    const dirty_components = [];
    const binding_callbacks = [];
    let render_callbacks = [];
    const flush_callbacks = [];
    const resolved_promise = /* @__PURE__ */ Promise.resolve();
    let update_scheduled = false;
    function schedule_update() {
        if (!update_scheduled) {
            update_scheduled = true;
            resolved_promise.then(flush);
        }
    }
    function add_render_callback(fn) {
        render_callbacks.push(fn);
    }
    // flush() calls callbacks in this order:
    // 1. All beforeUpdate callbacks, in order: parents before children
    // 2. All bind:this callbacks, in reverse order: children before parents.
    // 3. All afterUpdate callbacks, in order: parents before children. EXCEPT
    //    for afterUpdates called during the initial onMount, which are called in
    //    reverse order: children before parents.
    // Since callbacks might update component values, which could trigger another
    // call to flush(), the following steps guard against this:
    // 1. During beforeUpdate, any updated components will be added to the
    //    dirty_components array and will cause a reentrant call to flush(). Because
    //    the flush index is kept outside the function, the reentrant call will pick
    //    up where the earlier call left off and go through all dirty components. The
    //    current_component value is saved and restored so that the reentrant call will
    //    not interfere with the "parent" flush() call.
    // 2. bind:this callbacks cannot trigger new flush() calls.
    // 3. During afterUpdate, any updated components will NOT have their afterUpdate
    //    callback called a second time; the seen_callbacks set, outside the flush()
    //    function, guarantees this behavior.
    const seen_callbacks = new Set();
    let flushidx = 0; // Do *not* move this inside the flush() function
    function flush() {
        // Do not reenter flush while dirty components are updated, as this can
        // result in an infinite loop. Instead, let the inner flush handle it.
        // Reentrancy is ok afterwards for bindings etc.
        if (flushidx !== 0) {
            return;
        }
        const saved_component = current_component;
        do {
            // first, call beforeUpdate functions
            // and update components
            try {
                while (flushidx < dirty_components.length) {
                    const component = dirty_components[flushidx];
                    flushidx++;
                    set_current_component(component);
                    update(component.$$);
                }
            }
            catch (e) {
                // reset dirty state to not end up in a deadlocked state and then rethrow
                dirty_components.length = 0;
                flushidx = 0;
                throw e;
            }
            set_current_component(null);
            dirty_components.length = 0;
            flushidx = 0;
            while (binding_callbacks.length)
                binding_callbacks.pop()();
            // then, once components are updated, call
            // afterUpdate functions. This may cause
            // subsequent updates...
            for (let i = 0; i < render_callbacks.length; i += 1) {
                const callback = render_callbacks[i];
                if (!seen_callbacks.has(callback)) {
                    // ...so guard against infinite loops
                    seen_callbacks.add(callback);
                    callback();
                }
            }
            render_callbacks.length = 0;
        } while (dirty_components.length);
        while (flush_callbacks.length) {
            flush_callbacks.pop()();
        }
        update_scheduled = false;
        seen_callbacks.clear();
        set_current_component(saved_component);
    }
    function update($$) {
        if ($$.fragment !== null) {
            $$.update();
            run_all($$.before_update);
            const dirty = $$.dirty;
            $$.dirty = [-1];
            $$.fragment && $$.fragment.p($$.ctx, dirty);
            $$.after_update.forEach(add_render_callback);
        }
    }
    /**
     * Useful for example to execute remaining `afterUpdate` callbacks before executing `destroy`.
     */
    function flush_render_callbacks(fns) {
        const filtered = [];
        const targets = [];
        render_callbacks.forEach((c) => fns.indexOf(c) === -1 ? filtered.push(c) : targets.push(c));
        targets.forEach((c) => c());
        render_callbacks = filtered;
    }
    const outroing = new Set();
    let outros;
    function transition_in(block, local) {
        if (block && block.i) {
            outroing.delete(block);
            block.i(local);
        }
    }
    function transition_out(block, local, detach, callback) {
        if (block && block.o) {
            if (outroing.has(block))
                return;
            outroing.add(block);
            outros.c.push(() => {
                outroing.delete(block);
                if (callback) {
                    if (detach)
                        block.d(1);
                    callback();
                }
            });
            block.o(local);
        }
        else if (callback) {
            callback();
        }
    }
    function create_component(block) {
        block && block.c();
    }
    function mount_component(component, target, anchor, customElement) {
        const { fragment, after_update } = component.$$;
        fragment && fragment.m(target, anchor);
        if (!customElement) {
            // onMount happens before the initial afterUpdate
            add_render_callback(() => {
                const new_on_destroy = component.$$.on_mount.map(run).filter(is_function);
                // if the component was destroyed immediately
                // it will update the `$$.on_destroy` reference to `null`.
                // the destructured on_destroy may still reference to the old array
                if (component.$$.on_destroy) {
                    component.$$.on_destroy.push(...new_on_destroy);
                }
                else {
                    // Edge case - component was destroyed immediately,
                    // most likely as a result of a binding initialising
                    run_all(new_on_destroy);
                }
                component.$$.on_mount = [];
            });
        }
        after_update.forEach(add_render_callback);
    }
    function destroy_component(component, detaching) {
        const $$ = component.$$;
        if ($$.fragment !== null) {
            flush_render_callbacks($$.after_update);
            run_all($$.on_destroy);
            $$.fragment && $$.fragment.d(detaching);
            // TODO null out other refs, including component.$$ (but need to
            // preserve final state?)
            $$.on_destroy = $$.fragment = null;
            $$.ctx = [];
        }
    }
    function make_dirty(component, i) {
        if (component.$$.dirty[0] === -1) {
            dirty_components.push(component);
            schedule_update();
            component.$$.dirty.fill(0);
        }
        component.$$.dirty[(i / 31) | 0] |= (1 << (i % 31));
    }
    function init(component, options, instance, create_fragment, not_equal, props, append_styles, dirty = [-1]) {
        const parent_component = current_component;
        set_current_component(component);
        const $$ = component.$$ = {
            fragment: null,
            ctx: [],
            // state
            props,
            update: noop,
            not_equal,
            bound: blank_object(),
            // lifecycle
            on_mount: [],
            on_destroy: [],
            on_disconnect: [],
            before_update: [],
            after_update: [],
            context: new Map(options.context || (parent_component ? parent_component.$$.context : [])),
            // everything else
            callbacks: blank_object(),
            dirty,
            skip_bound: false,
            root: options.target || parent_component.$$.root
        };
        append_styles && append_styles($$.root);
        let ready = false;
        $$.ctx = instance
            ? instance(component, options.props || {}, (i, ret, ...rest) => {
                const value = rest.length ? rest[0] : ret;
                if ($$.ctx && not_equal($$.ctx[i], $$.ctx[i] = value)) {
                    if (!$$.skip_bound && $$.bound[i])
                        $$.bound[i](value);
                    if (ready)
                        make_dirty(component, i);
                }
                return ret;
            })
            : [];
        $$.update();
        ready = true;
        run_all($$.before_update);
        // `false` as a special case of no DOM component
        $$.fragment = create_fragment ? create_fragment($$.ctx) : false;
        if (options.target) {
            if (options.hydrate) {
                const nodes = children(options.target);
                // eslint-disable-next-line @typescript-eslint/no-non-null-assertion
                $$.fragment && $$.fragment.l(nodes);
                nodes.forEach(detach);
            }
            else {
                // eslint-disable-next-line @typescript-eslint/no-non-null-assertion
                $$.fragment && $$.fragment.c();
            }
            if (options.intro)
                transition_in(component.$$.fragment);
            mount_component(component, options.target, options.anchor, options.customElement);
            flush();
        }
        set_current_component(parent_component);
    }
    /**
     * Base class for Svelte components. Used when dev=false.
     */
    class SvelteComponent {
        $destroy() {
            destroy_component(this, 1);
            this.$destroy = noop;
        }
        $on(type, callback) {
            if (!is_function(callback)) {
                return noop;
            }
            const callbacks = (this.$$.callbacks[type] || (this.$$.callbacks[type] = []));
            callbacks.push(callback);
            return () => {
                const index = callbacks.indexOf(callback);
                if (index !== -1)
                    callbacks.splice(index, 1);
            };
        }
        $set($$props) {
            if (this.$$set && !is_empty($$props)) {
                this.$$.skip_bound = true;
                this.$$set($$props);
                this.$$.skip_bound = false;
            }
        }
    }

    function dispatch_dev(type, detail) {
        document.dispatchEvent(custom_event(type, Object.assign({ version: '3.59.2' }, detail), { bubbles: true }));
    }
    function insert_dev(target, node, anchor) {
        dispatch_dev('SvelteDOMInsert', { target, node, anchor });
        insert(target, node, anchor);
    }
    function detach_dev(node) {
        dispatch_dev('SvelteDOMRemove', { node });
        detach(node);
    }
    function validate_slots(name, slot, keys) {
        for (const slot_key of Object.keys(slot)) {
            if (!~keys.indexOf(slot_key)) {
                console.warn(`<${name}> received an unexpected slot "${slot_key}".`);
            }
        }
    }
    /**
     * Base class for Svelte components with some minor dev-enhancements. Used when dev=true.
     */
    class SvelteComponentDev extends SvelteComponent {
        constructor(options) {
            if (!options || (!options.target && !options.$$inline)) {
                throw new Error("'target' is a required option");
            }
            super();
        }
        $destroy() {
            super.$destroy();
            this.$destroy = () => {
                console.warn('Component was already destroyed'); // eslint-disable-line no-console
            };
        }
        $capture_state() { }
        $inject_state() { }
    }

    var spreadsheet_min = {exports: {}};

    /*
    @license

    dhtmlxSpreadsheet v.5.0.8 Evaluation

    This software is covered by DHTMLX Evaluation License and purposed only for evaluation.
    Contact sales@dhtmlx.com to get Commercial or Enterprise license.
    Usage without proper license is prohibited.

    (c) XB Software.

    */

    (function (module, exports) {
    	if(window.dhx&&(window.dhx_legacy=dhx,delete window.dhx),function(e,t){module.exports=t();}(window,(function(){return function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n});},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0});},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/codebase/",i(i.s=108)}([function(e,t,i){(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=i(126);function o(e){var i=window.ResizeObserver,n=function(t){var i=t.el.offsetHeight,n=t.el.offsetWidth;e(n,i);};return i?t.el("div.dhx-resize-observer",{_hooks:{didInsert:function(e){new i((function(){return n(e)})).observe(e.el);}}}):t.el("iframe.dhx-resize-observer",{_hooks:{didInsert:function(e){e.el.contentWindow.onresize=function(){return n(e)},n(e);}}})}t.el=n.defineElement,t.sv=n.defineSvgElement,t.view=n.defineView,t.create=n.createView,t.inject=n.injectView,t.KEYED_LIST=n.KEYED_LIST,t.disableHelp=function(){n.DEVMODE.mutations=!1,n.DEVMODE.warnings=!1,n.DEVMODE.verbose=!1,n.DEVMODE.UNKEYED_INPUT=!1;},t.resizer=o,t.resizeHandler=function(e,i){return t.create({render:function(){return o(i)}}).mount(e)},t.awaitRedraw=function(){return new e((function(e){requestAnimationFrame((function(){e();}));}))};}).call(this,i(14));},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=i(3),r=(new Date).valueOf();t.uid=function(){return "u"+r++},t.extend=function e(t,i,n){if(void 0===n&&(n=!0),i)for(var o in i){var r=i[o],a=t[o];void 0===r?delete t[o]:!n||"object"!=typeof a||a instanceof Date||a instanceof Array?t[o]=r:e(a,r);}return t},t.copy=function(e,t){var i={};for(var n in e)t&&n.startsWith("$")||(i[n]=e[n]);return i},t.naturalSort=function(e){return e.sort((function(e,t){return "string"==typeof e?e.localeCompare(t):e-t}))},t.findIndex=function(e,t){for(var i=e.length,n=0;n<i;n++)if(t(e[n]))return n;return -1},t.isEqualString=function(e,t){if(e=e.toString(),t=t.toString(),e.length>t.length)return !1;for(var i=0;i<e.length;i++)if(e[i].toLowerCase()!==t[i].toLowerCase())return !1;return !0},t.singleOuterClick=function(e){var t=function(i){e(i)&&document.removeEventListener("click",t);};document.addEventListener("click",t);},t.detectWidgetClick=function(e,t){var i=function(i){return t(o.locate(i,"data-dhx-widget-id")===e)};return document.addEventListener("click",i),function(){return document.removeEventListener("click",i)}},t.unwrapBox=function(e){return Array.isArray(e)?e[0]:e},t.wrapBox=function(e){return Array.isArray(e)?e:[e]},t.isDefined=function(e){return null!=e},t.range=function(e,t){if(e>t)return [];for(var i=[];e<=t;)i.push(e++);return i},t.isNumeric=function(e){return !isNaN(e-parseFloat(e))},t.downloadFile=function(e,t,i){void 0===i&&(i="text/plain");var n=new Blob([e],{type:i});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(n,t);else {var o=document.createElement("a"),r=URL.createObjectURL(n);o.href=r,o.download=t,document.body.appendChild(o),o.click(),setTimeout((function(){document.body.removeChild(o),window.URL.revokeObjectURL(r);}),0);}},t.debounce=function(e,t,i){var n;return function(){for(var o=this,r=[],a=0;a<arguments.length;a++)r[a]=arguments[a];var s=i&&!n;clearTimeout(n),n=setTimeout((function(){n=null,i||e.apply(o,r);}),t),s&&e.apply(this,r);}},t.compare=function e(t,i){for(var n in t){if(t.hasOwnProperty(n)!==i.hasOwnProperty(n))return !1;switch(typeof t[n]){case"object":if(!e(t[n],i[n]))return !1;break;case"function":if(void 0===i[n]||"compare"!==n&&t[n].toString()!==i[n].toString())return !1;break;default:if(t[n]!==i[n])return !1}}for(var n in i)if(!t.hasOwnProperty(n))return !1;return !0},t.isType=function(e){return ((Object.prototype.toString.call(e).match(/^\[object (\S+?)\]$/)||[])[1]||"undefined").toLowerCase()},t.isEmptyObj=function(e){for(var t in e)return !1;return !0},t.getMaxArrayNymber=function(e){if(e.length){for(var t=-1/0,i=0,n=e.length;i<n;i++)e[i]>t&&(t=e[i]);return t}},t.getMinArrayNymber=function(e){if(e.length){for(var t=1/0,i=0,n=e.length;i<n;i++)e[i]<t&&(t=e[i]);return t}},t.getStringWidth=function(e,t){t=n({font:"normal 14px Roboto",lineHeight:20},t);var i=document.createElement("canvas"),r=i.getContext("2d");t.font&&(r.font=t.font);var a=r.measureText(e).width;return o.isIE()||i.remove(),a},t.rgbToHex=function(e){if("#"===e.substr(0,1))return e;if("rgb"===e.substr(0,3)){var t=/(.*?)rgb[a]?\((\d+), *(\d+), *(\d+),* *([\d+.]*)\)/.exec(e);return "#"+parseInt(t[2],10).toString(16).padStart(2,"0")+parseInt(t[3],10).toString(16).padStart(2,"0")+parseInt(t[4],10).toString(16).padStart(2,"0")}};},function(e,t,i){(function(e){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)},o=this&&this.__rest||function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(i[n[o]]=e[n[o]]);}return i};Object.defineProperty(t,"__esModule",{value:!0});var r=i(1),a=i(31),s=i(16),l=i(10),c=i(12),u=i(26);function d(e){if(!e)return "";var t=(e=--e)%26,i=String.fromCharCode(65+t),n=Math.floor(e/26);return n>0?d(n)+i:i}function h(e){return e?(e=e.toUpperCase()).split("").reduce((function(e,t,i,n){return e+=(t.charCodeAt(0)-64)*Math.pow(26,n.length-(i+1))}),0):-1}function f(e,t){if(!e)return {};var i=e.match(/([a-zA-Z]*\d*):([a-zA-Z]*\d*)/);if(i){var n=f(i[1],t),o=f(i[2],t),r=+n.row<=o.row?n.row:o.row,s=+n.col<=o.col?n.col:o.col;return {start:{row:r,col:s},end:{row:r===o.row?n.row:o.row,col:s===o.col?n.col:o.col}}}if(!v(e,t))return {};var l=a.str2pos(e),c=l[0];return {col:l[1],row:c}}function p(e,t,i,n){if(i>n)return -1;var o=Math.floor((i+n)/2);if(!e[o])return o;var r=+e[o].id;return r===t?o:r>t?p(e,t,i,o-1):p(e,t,o+1,n)}function v(e,t,i){void 0===i&&(i=!1);var n=e.match(/([a-zA-Z]*)(\d*)/);if(n&&n[1]&&n[2]){var o=parseInt(n[2],10),r=t.data[i?"_initOrder":"_order"];return {col:h(n[1]),row:p(r,o,0,o)}}}function g(e,t,i){var n=i.data.getId(e)||e+1;return ""+d(t)+n}function _(e,t,i){var n;if(!t)return "";var o=(null===(n=e.data.getItem(t))||void 0===n?void 0:n.$index)||t,a=r.findIndex(e.config.columns,(function(e){return i.toString()===e.id}));return a<0&&i>0&&(a=+i),o<0||a<0?void 0:""+d(a)+o}function m(e){return new RegExp(/([A-Z]+\d+:[A-Z]+\d+)|(?:,)([A-Z]+\d+)/).test(e)}function y(e,t,i){var n;return void 0===i&&(i=!1),n=e.includes(":")?e.split(":").map((function(e){return v(e,t,i)})):e.split(",").map((function(e){return v(e,t,i)})),{start:{row:Math.min(n[0].row,n[1].row),col:Math.min(n[0].col,n[1].col)},end:{row:Math.max(n[0].row,n[1].row),col:Math.max(n[0].col,n[1].col)}}}function b(e,t,i){void 0===i&&(i="row");var n=[],o="row"===i?"col":"row";if(e)for(var r=y(e,t,!0),a=r.start,s=r.end,l=a[i];l<=s[i];l++)for(var c=a[o];c<=s[o];c++){var u="row"===i?_(t,l+1,c):_(t,c+1,l);n.push(u);}return n}function w(e){var t={decimal:".",thousands:","};function i(t){return x(e.split(t)[1].split(";")[0])}return e.includes("mso-displayed-decimal-separator")&&(t.decimal=i("mso-displayed-decimal-separator:")),e.includes("mso-displayed-thousand-separator")&&(t.thousands=i("mso-displayed-thousand-separator:")),t}function x(e){return e.replace(/[\"&\\]/g,"")}function E(e,t){var i=e.split(";")[0];t||(t=c.getSeparators());var n=x(i);return n.includes("[$")&&(n.includes("d")||n.includes("m")||n.includes("y")||n.includes("h")||n.includes("s"))&&(n=n.substr(n.indexOf("]")+1)),u.isDateFormat(n)&&n.includes("[")&&(n=n.replace("[","").replace("]","")),!n.includes("0")&&n.includes("#"),n=n.replace(",",t.thousands).replace(".",t.decimal)}function C(e){if(e){for(var t={},i=0,n=e.split(";");i<n.length;i++){var o=n[i];if(o){var r=o.trim().split(":");"height"!==r[0]&&"width"!==r[0]&&(t[r[0]]=r[1]);}}return t}}function S(e){if("string"!=typeof e||e.includes(" "))return !1;try{var t=new URL(e);return t.origin&&"null"!==t.origin}catch(e){return !1}}function I(e,t,i,n){var o=e.split(":"),a=o[0],s=o[1];return r.compare(k(a,t,i,n),k(s,t,i,n))}function k(e,t,i,n){var o=f(e,n),r=o.col;return {isTopFixed:(null!=i?i:-1)>o.row,isLeftFixed:(null!=t?t:-1)>r}}t.getLetterFromNumber=d,t.getNumberFromLetter=h,t.getCellIds=f,t.getCellIndex=v,t.getCellNameByIndex=g,t.getCellNameById=_,t.getCellInfo=function(e,t,i){var n=f(e,i);return n.start&&(n=n.start),n&&e?t.getCell(n.row,n.col)||{}:{locked:!1}},t.isRangeId=m,t.getRangeIndexes=y,t.getRangeArray=b,t.getRangeMatrix=function(e,t,i){void 0===i&&(i="row");var n=[],o="row"===i?"col":"row";if(e)for(var r=y(e,t),a=r.start,s=r.end,l=a[i];l<=s[i];l++){for(var c=[],u=a[o];u<=s[o];u++){var d="row"===i?g(l,u,t):g(u,l,t);c.push(d);}n.push(c);}return n},t.getNextRangeCell=function(e,t,i,n){void 0===n&&(n="row");var o=b(e,i,n);return o[o.indexOf(t)+1]||o[0]},t.getPrevRangeCell=function(e,t,i,n){void 0===n&&(n="row");var o=b(e,i,n);return o[o.indexOf(t)-1]||o[o.length-1]},t.getCellsArray=function(e,t){if(e)return e.split(",").reduce((function(e,i){return m(i=i.toUpperCase())?e=e.concat(b(i,t)):e.push(i),e}),[])},t.extendConfig=function(e,t,i){for(var n in void 0===e&&(e={}),void 0===t&&(t={}),void 0===i&&(i=!0),e){var o=t[n],a=e[n];a&&"validate"in a&&(t[n]=a.validate(o)?o:a.default,e[n]=a.default);}return r.extend(e,t,i)},t.cleanActionConfig=function(e){return e.page,e.dataStore,e.sheets,e.editLine,e.grid,e.activePage,e.spreadsheet,e.mouseEvent,e.events,o(e,["page","dataStore","sheets","editLine","grid","activePage","spreadsheet","mouseEvent","events"])},t.isWasmSupported=function(){try{if("object"==typeof WebAssembly&&"function"==typeof WebAssembly.instantiate){var e=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));if(e instanceof WebAssembly.Module)return new WebAssembly.Instance(e)instanceof WebAssembly.Instance}}catch(e){return !1}return !1},t.fetchFile=function(t,i,n){return new e((function(e,o){var r=new XMLHttpRequest;r.open(i,t,!0),r.responseType=n,r.onload=function(){var t=r.response;t?e(t):o(r);},r.onerror=function(){return o(r)},r.send(null);}))},t.getSeparatorsFromMSO=w,t.analyzeMSOFormat=E,t.parseHtmlTable=function(e){var t,i,o=e.substring(e.indexOf("<style"),e.indexOf("</style>")),r={},a={};if(o.includes(".x")){var s=o.substring(o.indexOf(".x"),o.indexOf("--\x3e")).split("\r\n.");s[0]=s[0].substr(1);for(var l=0,u=s;l<u.length;l++){var d=u[l];if(d){var h=d.substring(0,d.indexOf("\r\n\t"));if(d.includes("mso-number-format")){var f=d.indexOf("mso-number-format"),p=d.indexOf('";',f),v=d.substring(f,p);a[h]=v.split(':"')[1],d=d.substring(0,f)+d.substring(p+1);}r[h]=C(d.substring(d.indexOf("{")+1,d.indexOf("}")).trim());}}}var g=e.substring(e.indexOf("<table"),e.indexOf("</table>")+8),_=document.createElement("div");_.innerHTML=g;var m=_.querySelector("table"),y=_.querySelector("col"),b=m.rows.length,x=+((null==y?void 0:y.getAttribute("span"))||0);if(!x)for(var S=0;S<b;S++){var I=(null===(i=null===(t=m.rows[S])||void 0===t?void 0:t.cells)||void 0===i?void 0:i.length)||0;x=Math.max(x,I);}var k=new Array(b);for(S=0;S<b;S++)k[S]=new Array(x);var M=c.getSeparators();a&&(M=w(e));var P=[];for(S=0;S<m.rows.length;S++)for(var O=m.rows[S],A=0,D=0;D<O.cells.length;D++){for(;void 0!==k[S][A];)A++;var F=O.cells[D],V=F.rowSpan,R=F.colSpan,T=F.innerText,L=F.classList;if(V>1||R>1){var H={from:{row:S,column:A},to:{row:S+V-1,column:A+R-1}};P.push(H);for(var N=1;N<R;N++)k[S][N+1]={val:"",style:{},format:""};for(var j=1;j<V;j++){S+j<b&&(k[S+j][A]={val:"",style:{},format:""});for(N=1;N<R;N++)k[S+j][A+1]={val:"",style:{},format:""};}}else P.push(null);for(var $=T.trim().replace(/\n/,""),z={},B="",W=0;W<L.length;W++){var U=L[W];r[U]&&(z=n(n({},z),r[U])),a[U]&&(B=E(a[U],M));}z=n(n({},z),C(F.getAttribute("style"))),k[S][A]={val:$,style:z,format:B},A++;}var G=[],q=[],Y=[];return k.forEach((function(e){e.forEach((function(e){G.push(e.val),q.push(e.style),Y.push(e.format);}));})),{values:G,styles:q,rowsCount:b,colsCount:x,formats:Y,spans:P}},t.parseFromText=function(e){for(var t=e.split(/\n/),i=[],n=0,o=t;n<o.length;n++){var r=o[n].split(/\t/);i=i.concat(r);}return {values:i,rowsCount:t.length,colsCount:t[0].split("\t").length,formats:[""]}},t.getTextHeight=function(e,t){var i=document.createElement("div");i.style.width=t+"px",i.innerText=e,i.classList.add("dhx-spreadsheet-height-detector"),document.body.appendChild(i);var n=i.scrollHeight;return i.remove(),n},t.convertStyles=function(e){if(!e)return {};var t,i=null,o="nowrap",a="normal",s=n({},e),l=s.textAlign||s["text-align"],c=s.verticalAlign||s["vertical-align"];if(l){switch(l){case"left":i="flex-start";break;case"center":i="center";break;case"right":i="flex-end";}s["justify-content"]=i;}if(c){switch(c){case"top":t="flex-start";break;case"center":t="center";break;case"bottom":t="flex-end";}s["align-items"]=t+" !important";}var u=e.multiline,d=e.color,h=e.background,f=e["background-color"];return u&&(o="wrap"===u?"normal":"nowrap",a="wrap"===u?"break-all":"normal",s["white-space"]=o,s["word-break"]=a),d&&(s.color=d.startsWith("#")?r.rgbToHex(d):d),f&&(s["background-color"]=f.startsWith("#")?r.rgbToHex(f):f),h&&(s.background=h.startsWith("#")?r.rgbToHex(h):h),s},t.isMac=function(){var e;return !!(null===(e=navigator.userAgentData)||void 0===e?void 0:e.platform.match(/(Mac)/i))},t.getCellNode=function(e,t,i){void 0===i&&(i=!1);var n=v(e,t,i),o=n.row,r=n.col,a=t.getRootNode().querySelector(".dhx_grid_data [data-dhx-id='"+(o+1)+"']");if(a)return a.querySelector("[data-dhx-col-id='"+r+"']")},t.isURL=S,t.doesContainUrl=function(e){if("string"==typeof e)return e.split(" ").find((function(e){return S(e)}))},t.getStylesObject=function(e){void 0===e&&(e="");var t=(e||"").split(" ")||[],i={};return t.forEach((function(e){i=n(n({},i),dhx.css.get(e));})),i},t.checkSpan=function(e,t,i,n){var o=e.from,r=e.to,a=o.column,s=o.row,l=r.column,c=r.row;return I(g(s,a+1,n)+":"+g(c,l+1,n),t,i,n)},t.checkSpanByNames=I,t.isCellFixed=k,t.isCellSpaned=function(e,t){if(null==t?void 0:t.length){var i=a.str2pos(e),n=i[0],o=i[1];return t.find((function(e){var t=e.from,i=e.to,r=t.row,a=t.column,s=i.row,l=i.column;return r<=n&&s>=n&&a<=o&&l>=o}))}},t.showAlert=function(e){s.alert({header:l.default.alertTitle,text:e,buttons:[l.default.ok],buttonsAlignment:"right"});};}).call(this,i(14));},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};function o(e,t,i){for(void 0===t&&(t="data-dhx-id"),void 0===i&&(i="target"),e instanceof Event&&(e=e[i]);e;){if(e.getAttribute&&e.getAttribute(t))return e;e=e.parentNode;}}Object.defineProperty(t,"__esModule",{value:!0}),t.toNode=function(e){var t;return "string"==typeof e?document.getElementById(e)||document.querySelector(e)||(null===(t=document.querySelector("[data-dhx-root-id="+e+"]"))||void 0===t?void 0:t.parentElement)||document.body:e||document.body},t.eventHandler=function(e,t,i){var n=Object.keys(t);return function(o){var r=e(o);if(void 0!==r){var a=o.target;e:for(;a;){var s=a.getAttribute&&a.getAttribute("class")||"";if(s.length)for(var l=s.split(" "),c=0;c<n.length;c++)if(l.includes(n[c])){if(!1===t[n[c]](o,r)||o.cancelBubble)return !1;break e}a=a.parentNode;}}return i&&i(o),!0}},t.locateNode=o,t.locate=function(e,t){void 0===t&&(t="data-dhx-id");var i=o(e,t);return i?i.getAttribute(t):""},t.locateNodeByClassName=function(e,t){for(e instanceof Element||(e=e.target);e;){if(t){if(e.classList&&e.classList.contains(t))return e}else if(e.getAttribute&&e.getAttribute("data-dhx-id"))return e;e=e.parentNode;}},t.getBox=function(e){var t=e.getBoundingClientRect(),i=document.body,n=window.pageYOffset||i.scrollTop,o=window.pageXOffset||i.scrollLeft;return {top:t.top+n,left:t.left+o,right:i.offsetWidth-t.right,bottom:i.offsetHeight-t.bottom,width:t.right-t.left,height:t.bottom-t.top}};var r=-1;t.getScrollbarWidth=function(){if(r>-1)return r;var e=document.createElement("div");return document.body.appendChild(e),e.style.cssText="position: absolute;left: -99999px;overflow:scroll;width: 100px;height: 100px;",r=e.offsetWidth-e.clientWidth,document.body.removeChild(e),r};var a=-1;function s(e){var t=e.getBoundingClientRect();return {left:t.left+window.pageXOffset,right:t.right+window.pageXOffset,top:t.top+window.pageYOffset,bottom:t.bottom+window.pageYOffset}}function l(){return {rightBorder:window.pageXOffset+window.innerWidth,bottomBorder:window.pageYOffset+window.innerHeight}}function c(e,t){var i,o,r=l(),a=r.rightBorder,s=r.bottomBorder-e.bottom-t.height,c=e.top-t.height;if("bottom"===t.mode?s>=0?o=e.bottom:c>=0&&(o=c):c>=0?o=c:s>=0&&(o=e.bottom),s<0&&c<0){if(t.auto)return u(e,n(n({},t),{mode:"right",auto:!1}));o=s>c?e.bottom:c;}if(t.centering)i=function(e,t,i){var n=(t-(e.right-e.left))/2,o=e.left-n,r=e.right+n;return o>=0&&r<=i?o:o<0?0:i-t}(e,t.width,a);else {var d=a-e.left-t.width,h=e.right-t.width;i=d>=0?e.left:h>=0?h:h>d?e.left:h;}return {left:i,top:o}}function u(e,t){var i,o,r=l(),a=r.rightBorder,s=r.bottomBorder,u=a-e.right-t.width,d=e.left-t.width;if("right"===t.mode?u>=0?i=e.right:d>=0&&(i=d):d>=0?i=d:u>=0&&(i=e.right),d<0&&u<0){if(t.auto)return c(e,n(n({},t),{mode:"bottom",auto:!1}));i=d>u?d:e.right;}if(t.centering)o=function(e,t,i){var n=(t-(e.bottom-e.top))/2,o=e.top-n,r=e.bottom+n;return o>=0&&r<=i?o:o<0?0:i-t}(e,t.height,a);else {var h=e.bottom-t.height,f=s-e.top-t.height;o=f>=0?e.top:h>0||h>f?h:e.top;}return {left:i,top:o}}function d(e,t){var i="bottom"===t.mode||"top"===t.mode?c(e,t):u(e,t),n=i.left,o=i.top;return {left:Math.round(n)+"px",top:Math.round(o)+"px",minWidth:Math.round(t.width)+"px",position:"absolute"}}t.getScrollbarHeight=function(){if(a>-1)return a;var e=document.createElement("div");return document.body.appendChild(e),e.style.cssText="position: absolute;left: -99999px;overflow:scroll;width: 100px;height: 100px;",a=e.offsetHeight-e.clientHeight,document.body.removeChild(e),a},t.isIE=function(){var e=window.navigator.userAgent;return e.includes("MSIE ")||e.includes("Trident/")},t.isSafari=function(){var e=function(e){return e.test(window.navigator.userAgent)},t=e(/Chrome/),i=e(/Firefox/);return !t&&!i&&e(/Safari/)},t.isFirefox=function(){var e=function(e){return e.test(window.navigator.userAgent)},t=e(/Chrome/),i=e(/Safari/);return !t&&!i&&e(/Firefox/)},t.getRealPosition=s,t.calculatePosition=d,t.fitPosition=function(e,t){return d(s(e),t)};var h=function(e){return e.href&&-1===e.ownerNode.outerHTML.indexOf(window.location.origin)&&(-1!==e.ownerNode.outerHTML.indexOf("http")||-1!==e.ownerNode.outerHTML.indexOf("https")||-1!==e.ownerNode.outerHTML.indexOf('href="//'))};t.getPageInlineCss=function(){for(var e=[],t=0;t<document.styleSheets.length;t++){var i=document.styleSheets[t];if(!h(i))for(var n=("cssRules"in i&&i.cssRules.length?i.cssRules:i.rules),o=0;o<n.length;o++){var r=n[o];"cssText"in r?e.push(r.cssText):e.push(r.selectorText+" {\n"+r.style.cssText+"\n}\n");}}return e.join("\n")},t.getPageLinksCss=function(){for(var e=[],t=0;t<document.styleSheets.length;t++){var i=document.styleSheets[t];h(i)&&e.push('<link href="'+i.href+'" rel="stylesheet"/>');}return e.join("\n")},t.getLabelStyle=function(e){var t=e.helpMessage,i=e.type,n=e.labelWidth,o=e.label,r=n&&n.toString().startsWith("0"),a="text"!==i&&e.required;return !!(t||a||!(!o||o&&r)||n&&!r)&&{style:(o||n)&&!r&&{width:n,"max-width":"100%"},label:o&&r?null:o}};},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.events={},this.context=e||this;}return e.prototype.on=function(e,t,i){var n=e.toLowerCase();this.events[n]=this.events[n]||[],this.events[n].push({callback:t,context:i||this.context});},e.prototype.detach=function(e,t){var i=e.toLowerCase(),n=this.events[i];if(t&&n&&n.length)for(var o=n.length-1;o>=0;o--)n[o].context===t&&n.splice(o,1);else this.events[i]=[];},e.prototype.fire=function(e,t){void 0===t&&(t=[]);var i=e.toLowerCase();return !this.events[i]||!this.events[i].map((function(e){return e.callback.apply(e.context,t)})).includes(!1)},e.prototype.clear=function(){this.events={};},e}();t.EventSystem=n,t.EventsMixin=function(e){var t=new n(e=e||{});e.detachEvent=t.detach.bind(t),e.attachEvent=t.on.bind(t),e.callEvent=t.fire.bind(t);};},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.beforeValueChange="beforeValueChange",e.afterValueChange="afterValueChange",e.beforeStyleChange="beforeStyleChange",e.afterStyleChange="afterStyleChange",e.beforeFormatChange="beforeFormatChange",e.afterFormatChange="afterFormatChange",e.beforeSelectionSet="beforeSelectionSet",e.afterSelectionSet="afterSelectionSet",e.beforeSelectionRemove="beforeSelectionRemove",e.afterSelectionRemove="afterSelectionRemove",e.beforeRowAdd="beforeRowAdd",e.afterRowAdd="afterRowAdd",e.beforeRowDelete="beforeRowDelete",e.afterRowDelete="afterRowDelete",e.beforeColumnAdd="beforeColumnAdd",e.afterColumnAdd="afterColumnAdd",e.beforeColumnDelete="beforeColumnDelete",e.afterColumnDelete="afterColumnDelete",e.beforeFocusSet="beforeFocusSet",e.afterFocusSet="afterFocusSet",e.beforeEditStart="beforeEditStart",e.afterEditStart="afterEditStart",e.beforeAction="beforeAction",e.afterAction="afterAction",e.beforeEditEnd="beforeEditEnd",e.afterEditEnd="afterEditEnd",e.groupFill="groupFill",e.beforeSheetAdd="beforeSheetAdd",e.afterSheetAdd="afterSheetAdd",e.beforeSheetRemove="beforeSheetRemove",e.afterSheetRemove="afterSheetRemove",e.beforeSheetRename="beforeSheetRename",e.afterSheetRename="afterSheetRename",e.beforeSheetChange="beforeSheetChange",e.afterSheetChange="afterSheetChange",e.beforeSheetClear="beforeSheetClear",e.afterSheetClear="afterSheetClear",e.beforeClear="beforeClear",e.afterClear="afterClear",e.editLineInput="editLineInput",e.editLineFocus="editLineFocus",e.editLineBlur="editLineBlur",e.cellInput="cellInput",e.gridRedraw="gridRedraw",e.afterPopupHide="afterPopupHide";}(t.SpreadsheetEvents||(t.SpreadsheetEvents={})),function(e){e.setCellStyle="setCellStyle",e.setCellValue="setCellValue",e.setCellFormat="setCellFormat",e.removeCellStyles="removeCellStyles",e.lockCell="lockCell",e.deleteRow="deleteRow",e.addRow="addRow",e.deleteColumn="deleteColumn",e.addColumn="addColumn",e.groupAction="groupAction",e.groupRowAction="groupRowAction",e.groupColAction="groupColAction",e.addSheet="addSheet",e.deleteSheet="deleteSheet",e.renameSheet="renameSheet",e.clearSheet="clearSheet",e.clear="clear",e.resizeCol="resizeCol",e.resizeRow="resizeRow",e.setValidation="setValidation",e.sortCells="sortCells",e.insertLink="insertLink",e.fitColumn="fitColumn",e.filter="filter",e.merge="merge",e.unmerge="unmerge";}(t.Actions||(t.Actions={})),function(e){e.e="e",e.ne="ne",e.tc="tc",e.tdc="tdc",e.ts="ts",e.te="te",e.tex="tex",e.d="d",e.db="db",e.da="da",e.gt="gt",e.geq="geq",e.lt="lt",e.leq="leq",e.eq="eq",e.neq="neq",e.ib="ib",e.inb="inb";}(t.FilterConditions||(t.FilterConditions={}));},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.change="change",e.click="click",e.focus="focus",e.blur="blur",e.keydown="keydown",e.beforeShow="beforeShow",e.afterShow="afterShow",e.beforeHide="beforeHide",e.afterHide="afterHide",e.afterValidate="afterValidate",e.beforeValidate="beforeValidate",e.beforeChangeProperties="beforeChangeProperties",e.afterChangeProperties="afterChangeProperties",e.beforeSend="beforesend",e.afterSend="aftersend",e.buttonClick="buttonClick",e.validationFail="validationfail";}(t.FormEvents||(t.FormEvents={})),function(e){e.queue="queue",e.uploaded="uploaded",e.failed="failed",e.inprogress="inprogress";}(t.FileStatus||(t.FileStatus={})),function(e){e.uploadBegin="uploadbegin",e.beforeUploadFile="beforeuploadfile",e.uploadFile="uploadfile",e.uploadFail="uploadfail",e.uploadComplete="uploadcomplete",e.uploadProgress="uploadprogress";}(t.UploaderEvents||(t.UploaderEvents={})),function(e){e.click="click",e.change="change",e.input="input",e.focus="focus",e.blur="blur",e.keydown="keydown",e.changeOptions="changeOptions",e.beforeShow="beforeShow",e.afterShow="afterShow",e.beforeHide="beforeHide",e.afterHide="afterHide",e.beforeValidate="beforeValidate",e.afterValidate="afterValidate",e.beforeUploadFile="beforeUploadFile",e.uploadFile="uploadfile",e.uploadBegin="uploadBegin",e.uploadComplete="uploadComplete",e.uploadFail="uploadFail",e.uploadProgress="uploadProgress",e.beforeChangeProperties="beforeChangeProperties",e.afterChangeProperties="afterChangeProperties";}(t.ItemEvent||(t.ItemEvent={})),function(e){e.value="value",e.validation="validation";}(t.ClearMethod||(t.ClearMethod={})),function(e){e.empty="",e.validEmail="email",e.validInteger="integer",e.validNumeric="numeric",e.validAlphaNumeric="alphanumeric",e.validIPv4="IPv4";}(t.Validation||(t.Validation={})),function(e){e[e.pre=0]="pre",e[e.error=1]="error",e[e.success=2]="success";}(t.ValidationStatus||(t.ValidationStatus={}));},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(1),o=i(3),r=function(){function e(e,t){this.config=t||{},this._uid=this.config.rootId||n.uid();}return e.prototype.mount=function(e,t){t&&(this._view=t),e&&this._view&&this._view.mount&&(this._container=o.toNode(e),this._container.tagName?this._view.mount(this._container):this._container.attach&&this._container.attach(this));},e.prototype.unmount=function(){var e=this.getRootView();e&&e.node&&(e.unmount(),this._view=null);},e.prototype.getRootView=function(){return this._view},e.prototype.getRootNode=function(){return this._view&&this._view.node&&this._view.node.el},e.prototype.paint=function(){this._view&&(this._view.node||this._container)&&(this._doNotRepaint=!1,this._view.redraw());},e}();t.View=r,t.toViewLike=function(e){return {getRootView:function(){return e},paint:function(){return e.node&&e.redraw()},mount:function(t){return e.mount(t)}}};},function(e,t,i){function n(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i]);}Object.defineProperty(t,"__esModule",{value:!0}),n(i(147)),n(i(75));},function(e,t,i){var n,o=this&&this.__rest||function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(i[n[o]]=e[n[o]]);}return i};Object.defineProperty(t,"__esModule",{value:!0});var r=i(6);t.getFormItemCss=function(e,t,i){var n;void 0===i&&(i=!1);var o=e.labelPosition,a=e.required,s=e.disabled,l=e.hiddenLabel,c=e.$validationStatus,u=(n={},n[r.ValidationStatus.pre]="",n[r.ValidationStatus.error]=" dhx_form-group--state_error",n[r.ValidationStatus.success]=" dhx_form-group--state_success",n)[c]||"",d="left"===o?" dhx_form-group--inline":"",h=s?" dhx_form-group--disabled":"",f=l?" dhx_form-group--label_sr":"";return t?d+(i?"":u)+(a?" dhx_form-group--required":"")+h+f:d+h+f};var a=((n={})[r.Validation.validAlphaNumeric]=/^[a-zA-Z0-9_]+$/,n[r.Validation.validEmail]=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,n[r.Validation.validInteger]=/^-?\d+$/,n[r.Validation.validIPv4]=/\b((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.|$)){4}\b/,n[r.Validation.validNumeric]=/^-?\d+(\.\d+)?$/,n);t.getValidationMessage=function(e){var t;return (t={undefined:e.preMessage},t[r.ValidationStatus.pre]=e.preMessage,t[r.ValidationStatus.error]=e.errorMessage,t[r.ValidationStatus.success]=e.successMessage,t)[e.$validationStatus]||""},t.validateTemplate=function(e,t){return !a[e]||a[e].test(t)},t.isBlock=function(e){return Boolean(e.rows)||Boolean(e.cols)},t.validateInput=function(e,t){var i=!0;if("function"==typeof t)i=t(e);else {var n=a[t];n&&(i=n.test(e.toString()));}return i},t.baseInputValidate=function(e,t){var i=t.inputType,n=t.min,o=t.max,r=t.minlength,a=t.maxlength;return "number"===i?void 0!==n&&void 0!==o?Number(n)<=Number(o)&&Number(n)<=Number(e)&&Number(o)>=Number(e):void 0!==n?Number(n)<=Number(e):void 0!==o?Number(o)>=Number(e):0===e||"0"===e||!!e:void 0!==r&&void 0!==a?Number(r)<=String(e).length&&Number(a)>=String(e).length:void 0!==r?Number(r)<=String(e).length:void 0!==a?Number(a)>=String(e).length:"string"==typeof e&&!!e},t.isTimeFormat=function(e,t){return 12===t?/(^0?([1-9][0-2]?):[0-5][0-9]?([AP][M]?)$)/i.test(e):/(^(0[0-9]|1[0-9]|2[0-3]|[0-9]):[0-5][0-9]$)/i.test(e)},t.isVerify=function(e){return ["required","validation","minlength","maxlength","min","max"].some((function(t){switch(t){case"required":return !!e[t];case"validation":return "function"==typeof e[t]||"email"===e[t]||"integer"===e[t]||"numeric"===e[t]||"alphanumeric"===e[t]||"IPv4"===e[t];case"minlength":case"maxlength":return "number"==typeof e[t]||"string"==typeof e[t];case"min":case"max":return ("number"==typeof e[t]||"string"==typeof e[t])&&"number"===e.inputType}}))},t.baseProps=["width","height","padding","css"],t.widgetConfig=function(e){e.width,e.type,e.id,e.name,e.hidden,e.editable,e.valueFormat,e.css,e.required,e.helpMessage,e.preMessage,e.successMessage,e.errorMessage,e.label,e.labelWidth,e.labelPosition,e.hiddenLabel,e.validation,e.icon;return o(e,["width","type","id","name","hidden","editable","valueFormat","css","required","helpMessage","preMessage","successMessage","errorMessage","label","labelWidth","labelPosition","hiddenLabel","validation","icon"])};},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});t.default={undo:"Undo",redo:"Redo",textColor:"Text color",backgroundColor:"Background color",bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",link:"Link",halign:"Horizontal align",valign:"Vertical align",left:"Left",right:"Right",center:"Center",top:"Top",bottom:"Bottom",multiline:"Text wrapping",clip:"Clip",wrap:"Wrap",merge:"Merge",unmerge:"Unmerge",lockCell:"Lock cell",unlockCell:"Unlock cell",clear:"Clear",clearValue:"Clear value",clearStyles:"Clear styles",clearAll:"Clear all",columns:"Columns",rows:"Rows",addColumn:"Add column",removeColumn:"Remove column",fitToData:"Fit to data",addRow:"Add row",removeRow:"Remove row",row:"row",col:"col",format:"Format",common:"Common",number:"Number",currency:"Currency",percent:"Percent",text:"Text",date:"Date",time:"Time",filter:"Filter",help:"Help",custom:"Custom",deleteSheet:"Delete",renameSheet:"Rename",renameSheetAlert:"A sheet with the name $name already exists. Please enter another name. ",file:"File",import:"Import",export:"Export",downloadAs:"Download as...",importAs:"Import as...",data:"Data",validation:"Data validation",search:"Search",sort:"Sort",ascSort:"Sort A to Z",descSort:"Sort Z to A",copy:"Copy",edit:"Edit",insert:"Insert",remove:"Remove",linkCopied:"Link copied to clipboard",e:"Is empty",ne:"Is not empty",tc:"Text contains",tdc:"Text doesn't contain",ts:"Text starts with",te:"Text ends with",tex:"Text is exactly",d:"Date is",db:"Date is before",da:"Date is after",gt:"Greater than",geq:"Greater or equal to",lt:"Less than",leq:"Less or equal to",eq:"Is equal to",neq:"Is not equal to",ib:"Is between",inb:"Is not between",none:"None",empty:"Empty",value:"Value",values:"By values",condition:"By condition",and:"And",cancel:"Cancel",save:"Save",removeValidation:"Remove validation",selectAll:"Select all",unselectAll:"Unselect all",apply:"Apply",ok:"Ok",alertTitle:"There was a problem!",mergeAlertMessage:"You can't $action a range containing merges!",spanMergeAlert:"You can't merge frozen and non-frozen cells!",dontShowAgain:"Don't show again",spanPasteError:"You can't paste merges that cross the boundary of a frozen region",spanMergeLockedError:"You can't merge locked cells!",spanUnmergeLockedError:"You can't unmerge locked cells!",removeAlert:"You can't remove last $name!"};},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.scroll="scroll",e.expand="expand",e.filterChange="filterChange",e.beforeResizeStart="beforeResizeStart",e.resize="resize",e.afterResizeEnd="afterResizeEnd",e.cellClick="cellClick",e.cellRightClick="cellRightClick",e.cellMouseOver="cellMouseOver",e.cellMouseDown="cellMouseDown",e.cellDblClick="cellDblClick",e.headerCellClick="headerCellClick",e.footerCellClick="footerCellClick",e.headerCellMouseOver="headerCellMouseOver",e.footerCellMouseOver="footerCellMouseOver",e.headerCellMouseDown="headerCellMouseDown",e.footerCellMouseDown="footerCellMouseDown",e.headerCellDblClick="headerCellDblClick",e.footerCellDblClick="footerCellDblClick",e.headerCellRightClick="headerCellRightClick",e.footerCellRightClick="footerCellRightClick",e.beforeEditStart="beforeEditStart",e.afterEditStart="afterEditStart",e.beforeEditEnd="beforeEditEnd",e.afterEditEnd="afterEditEnd",e.beforeKeyDown="beforeKeyDown",e.afterKeyDown="afterKeyDown",e.beforeColumnHide="beforeColumnHide",e.afterColumnHide="afterColumnHide",e.beforeColumnShow="beforeColumnShow",e.afterColumnShow="afterColumnShow",e.beforeRowHide="beforeRowHide",e.afterRowHide="afterRowHide",e.beforeRowShow="beforeRowShow",e.afterRowShow="afterRowShow",e.beforeRowDrag="beforeRowDrag",e.dragRowStart="dragRowStart",e.dragRowOut="dragRowOut",e.dragRowIn="dragRowIn",e.canRowDrop="canRowDrop",e.cancelRowDrop="cancelRowDrop",e.beforeRowDrop="beforeRowDrop",e.afterRowDrop="afterRowDrop",e.afterRowDrag="afterRowDrag",e.beforeColumnDrag="beforeColumnDrag",e.dragColumnStart="dragColumnStart",e.dragColumnOut="dragColumnOut",e.dragColumnIn="dragColumnIn",e.canColumnDrop="canColumnDrop",e.cancelColumnDrop="cancelColumnDrop",e.beforeColumnDrop="beforeColumnDrop",e.afterColumnDrop="afterColumnDrop",e.afterColumnDrag="afterColumnDrag",e.beforeRowResize="beforeRowResize",e.afterRowResize="afterRowResize",e.beforeSort="beforeSort",e.afterSort="afterSort";}(t.GridEvents||(t.GridEvents={})),function(e){e.cellTouchMove="cellTouchMove",e.cellTouchEnd="cellTouchEnd",e.headerCellTouchMove="headerCellTouchMove",e.headerCellTouchEnd="headerCellTouchEnd";}(t.GridSystemEvents||(t.GridSystemEvents={})),function(e){e.beforeUnSelect="beforeUnSelect",e.afterUnSelect="afterUnSelect",e.beforeSelect="beforeSelect",e.afterSelect="afterSelect";}(t.GridSelectionEvents||(t.GridSelectionEvents={}));},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=i(1),r=i(18),a=i(10),s=i(26),l={},c=[],u={decimal:".",thousands:","},d="$",h="(\\[\\$[\\w\\W]*?\\]|[\\$]{0,1})",f="([,. ]{0,1})",p="([#0]*)",v=new RegExp("\\[\\$(\\D*[^\\]])|(\\$)"),g=new RegExp(""+h+p+f+p+f+p+"([%]{0,1})\\s?"+h),_={};function m(){return c}function y(e){return c[o.findIndex(c,(function(t){return t.id===e}))]}function b(e){return !isNaN(e-parseFloat(e))}function w(e){if(e&&"string"==typeof e){if(_[e])return _[e];var t=function(e){return {currencyBefore:e[1],digits:e[2],thousandsSeparator:e[3],optionalDigits:e[4],decimalSeparator:e[5],decimalDigits:e[6],percent:e[7],currencyAfter:e[8],decimalLength:0}}(e.match(g));if(!t.decimalSeparator&&t.thousandsSeparator&&(t.decimalSeparator=t.thousandsSeparator,t.decimalDigits=t.optionalDigits,t.thousandsSeparator="",t.optionalDigits=""),t.decimalSeparator||(t.decimalSeparator=u.decimal),t.currencyBefore){var i=t.currencyBefore.match(v);t.currencyBefore=i[1]||i[2];}if(t.currencyAfter){i=t.currencyAfter.match(v);t.currencyAfter=i[1]||i[2];}return t.percent&&(t.currencyBefore="",t.currencyAfter=""),t.decimalDigits&&(t.decimalLength=t.decimalDigits.split("0").length-1),"common"===e&&(t.decimalSeparator=".",t.decimalLength="",t.thousandsSeparator=","),_[e]=t,t}}t.getSeparators=function(){return u},t.getDefaultFormats=m,t.getFormat=y,t.isNumeric=b;var x="15.0031",E="44490.5625";function C(e){var t="string"==typeof e&&e.includes("%"),i=parseFloat((""+e).replace(/[^.\d]/g,""));return t?i/100:i}function S(e,t){if(!o.isDefined(e)||""===e||"boolean"==typeof e||(""+e).startsWith("="))return e;var i=m().find((function(e){return "common"===e.id})),n=t||i,a=n.id,l=n.mask;if("text"===a||!a||!l)return e;var c=b(e);if(a.includes("date")||a.includes("time")){if(c)return +e;var u=s.getDHXDateFormat(l),d=e;if("object"==typeof d&&d.valueOf())return s.getExcelDateFromJs(d);var h=d.replace(/\n/g," ").replace(/\s+/g," ").trim();return r.stringToDate(h,u,!0)&&(d=s.getExcelDateFromJs(r.stringToDate(h,u))),d}return "percent"===a||l.endsWith("%")?C(e):I(e,l)}function I(e,t){if(!t||"string"!=typeof e||e.startsWith("="))return e;var i=w(t),n=i.currencyBefore,o=i.currencyAfter,r=i.decimalSeparator,a=i.thousandsSeparator;return n&&(e=e.replace(n,"")),o&&(e=e.replace(o,"")),e=(e=e.split(a).join("")).split(r).join("."),parseFloat(e)||e}t.initFormat=function(e,t,i){l=e.config,c=[{name:a.default.common,id:"common",mask:"",example:x},{name:a.default.number,id:"number",mask:"#,##0.00",example:x},{name:a.default.percent,id:"percent",mask:"#,##0.00%",example:x},{name:a.default.currency,id:"currency",mask:"$#,##0.00",example:x},{name:a.default.date,id:"date",mask:s.getExcelFormatFromDHX(t),example:E},{name:a.default.time,id:"time",mask:"h:mm "+(i>12?"":"am/pm"),example:E,timeFormat:i},{name:a.default.text,id:"text",mask:"@",example:"some text"}],l.formats.forEach((function(e){var t=o.findIndex(c,(function(t){return t.id===e.id}));if(t>=0)c[t]=e;else {var i=e;s.isDateFormat(e.mask)&&(i=n(n({},e),{mask:s.getExcelFormatFromDHX(e.mask)})),c.push(i);}}));var r=w(y("number").mask);u={decimal:r.decimalSeparator,thousands:r.thousandsSeparator};var h=w(y("currency").mask);d=h.currency||d,l.formats=c,c.forEach((function(e){w(e.mask);}));},t.getDefaultFormatsMap=function(){return c.reduce((function(e,t){return e[t.mask]=t.id,e}),{})},t.getPureNumber=C,t.detectFormat=function(e){var t=m(),i=function(e){return t.find((function(t){return t.id===e}))},n=i("number"),o=i("percent"),r=i("date"),a=i("time"),s=(""+e).startsWith("http");return (""+e).includes("%")||/[a-z]/.exec(""+e)||!b(e)&&!b(I(e,null==n?void 0:n.mask))?!s&&(e instanceof Date||b(S(e,r)))?r:!s&&b(S(e,a))?a:b(I(e,null==o?void 0:o.mask))?o:i("common"):n},t.getCleanValue=S,t.getFormattedValue=function(e,t){if("boolean"==typeof e)return (""+e).toUpperCase();if(!t||"@"===t.mask)return e;var i=t.mask,n=t.id;return n.includes("date")||n.includes("time")?b(e)?r.getFormattedDate(s.getDHXDateFormat(i),s.excelDateToJSDate(+e)):e:function(e,t){if(!t)return e;if(!b(e))return e;var i="";t.currencyBefore&&(i+=t.currencyBefore);var n=parseFloat(e),o=n<0;o&&(n=Math.abs(n));var r=n.toString();if(t.percent&&(n*=100),t.digits){var a=t.decimalDigits.length,s=Math.pow(10,a);r=(n=Math.round(n*s)/s).toFixed(a);}var l=(null==t?void 0:t.digits)+(null==t?void 0:t.optionalDigits),c=r.split(".");if(l&&l.length>c[0].length){for(var u=c[0].split(""),d=c[0],h=0,f=l.length-1;f>-1;f--){var p=l[f],v=u[h];"0"!==p||v||(d="0"+d),h++;}r=d+(c.length>1?"."+c[1]:"");}return i+=t.digits?function(e,t,i,n,o){void 0===t&&(t=""),void 0===n&&(n=3),void 0===o&&(o="");for(var r=e.toString().split("."),a=[],s=o?[]:[""],l=1,c=o.length-1;c>-1;c--){var u=o[c],d=r[1][c];"#"===u&&"0"===d||s.push(d);}for(c=r[0].length-1;c>-1;c--)a.push(r[0][c]),l===n&&c?(a.push(t),l=1):l++;return s=s.reverse().join(""),r[0]=a.reverse().join(""),s?""+r[0]+i+s:r[0]}(r,t.thousandsSeparator,t.decimalSeparator,t.optionalDigits.length,t.decimalDigits):r,i+=t.percent,t.currencyAfter&&(i+=t.currencyAfter),o&&(i="-"+i),i}(e,w(i))},t.addNewFormat=function(e,t,i){var n=i.find((function(t){return t.mask===e}));if(n)return n;var r=s.isDateFormat(e),l=o.uid(),c=a.default.custom+" "+l,u={id:r?r+"_"+l:l,mask:e,example:r?E:x,name:c};return i.push(u),u};},function(e,t,i){function n(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i]);}Object.defineProperty(t,"__esModule",{value:!0}),n(i(23)),n(i(67)),n(i(133)),n(i(134)),n(i(32)),n(i(165)),n(i(24)),n(i(70)),n(i(69)),n(i(166)),n(i(68)),n(i(53));},function(e,t,i){(function(t,i){!function(){t="undefined"!=typeof window?window:this;var n=1,o={},r=!1;function a(e){t.setImmediate?i(e):t.importScripts?setTimeout(e):(n++,o[n]=e,t.postMessage(n,"*"));}function s(e){if("function"!=typeof e&&null!=e)throw TypeError();if("object"!=typeof this||this&&this.then)throw TypeError();var t,i,n=this,o=0,r=0,l=[];n.promise=n,n.resolve=function(e){return t=n.fn,i=n.er,o||(r=e,o=1,a(d)),n},n.reject=function(e){return t=n.fn,i=n.er,o||(r=e,o=2,a(d)),n},n._d=1,n.then=function(e,t){if(1!=this._d)throw TypeError();var i=new s;return i.fn=e,i.er=t,3==o?i.resolve(r):4==o?i.reject(r):l.push(i),i},n.catch=function(e){return n.then(null,e)};var c=function(e){o=e||4,l.map((function(e){3==o&&e.resolve(r)||e.reject(r);}));};try{"function"==typeof e&&e(n.resolve,n.reject);}catch(e){n.reject(e);}return n;function u(e,t,i,n){if(2==o)return n();if("object"!=typeof r&&"function"!=typeof r||"function"!=typeof e)n();else try{var a=0;e.call(r,(function(e){a++||(r=e,t());}),(function(e){a++||(r=e,i());}));}catch(e){r=e,i();}}function d(){var e;try{e=r&&r.then;}catch(e){return r=e,o=2,d()}u(e,(function(){o=1,d();}),(function(){o=2,d();}),(function(){try{1==o&&"function"==typeof t?r=t(r):2==o&&"function"==typeof i&&(r=i(r),o=1);}catch(e){return r=e,c()}r==n?(r=TypeError(),c()):u(e,(function(){c(3);}),c,(function(){c(1==o&&3);}));}));}}t.setImmediate||t.addEventListener("message",(function(e){if(e.source==t)if(r)a(o[e.data]);else {r=!0;try{o[e.data]();}catch(e){}delete o[e.data],r=!1;}})),s.resolve=function(e){if(1!=this._d)throw TypeError();return e instanceof s?e:new s((function(t){t(e);}))},s.reject=function(e){if(1!=this._d)throw TypeError();return new s((function(t,i){i(e);}))},s.all=function(e){if(1!=this._d)throw TypeError();if(!(e instanceof Array))return s.reject(TypeError());var t=new s;return function i(n,o){if(o)return t.resolve(o);if(n)return t.reject(n);0==e.reduce((function(e,t){return t&&t.then?e+1:e}),0)&&t.resolve(e),e.map((function(t,n){t&&t.then&&t.then((function(t){return e[n]=t,i(),t}),i);}));}(),t},s.race=function(e){if(1!=this._d)throw TypeError();if(!(e instanceof Array))return s.reject(TypeError());if(0==e.length)return new s;var t=new s;return function i(n,o){if(o)return t.resolve(o);if(n)return t.reject(n);0==e.reduce((function(e,t){return t&&t.then?e+1:e}),0)&&t.resolve(e),e.map((function(e,t){e&&e.then&&e.then((function(e){i(null,e);}),i);}));}(),t},s._d=1,e.exports=s;}();}).call(this,i(50),i(120).setImmediate);},function(e,t,i){function n(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i]);}Object.defineProperty(t,"__esModule",{value:!0}),n(i(72)),n(i(144)),n(i(55));},function(e,t,i){function n(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i]);}Object.defineProperty(t,"__esModule",{value:!0}),n(i(118)),n(i(119)),n(i(123)),n(i(63)),n(i(49));},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(3),o=function(){function e(){var e=this;this._initHandler=function(t){return e._activeWidgetId=n.locate(t,"data-dhx-widget-id")},this._removeFocusClass=function(e){var t=document.body.classList;t.contains("utilityfocus")&&t.remove("utilityfocus");},this._addFocusClass=function(e){var t=document.body.classList;"Tab"===e.code?t.contains("utilityfocus")||t.add("utilityfocus"):t.contains("utilityfocus")&&t.remove("utilityfocus");},document.addEventListener("focusin",this._initHandler),document.addEventListener("pointerdown",this._initHandler),document.addEventListener("mousedown",this._removeFocusClass),document.addEventListener("keydown",this._addFocusClass);}return e.prototype.getFocusId=function(){return this._activeWidgetId},e.prototype.setFocusId=function(e){this._activeWidgetId=e;},e}();t.focusManager=new o;},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(1),o=i(1);t.locale={monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Monday"],cancel:"Cancel"};var r,a={"%d":function(e){var t=e.getDate();return t<10?"0"+t:t},"%j":function(e){return e.getDate()},"%l":function(e){return t.locale.days[e.getDay()]},"%D":function(e){return t.locale.daysShort[e.getDay()]},"%m":function(e){var t=e.getMonth()+1;return t<10?"0"+t:t},"%n":function(e){return e.getMonth()+1},"%M":function(e){return t.locale.monthsShort[e.getMonth()]},"%F":function(e){return t.locale.months[e.getMonth()]},"%y":function(e){return e.getFullYear().toString().slice(2)},"%Y":function(e){return e.getFullYear()},"%h":function(e){var t=e.getHours()%12;return 0===t&&(t=12),t<10?"0"+t:t},"%g":function(e){var t=e.getHours()%12;return 0===t&&(t=12),t},"%H":function(e){var t=e.getHours();return t<10?"0"+t:t},"%G":function(e){return e.getHours()},"%i":function(e){var t=e.getMinutes();return t<10?"0"+t:t},"%s":function(e){var t=e.getSeconds();return t<10?"0"+t:t},"%a":function(e){return e.getHours()>=12?"pm":"am"},"%A":function(e){return e.getHours()>=12?"PM":"AM"},"%u":function(e){return e.getMilliseconds()}},s={"%d":function(e,t){/(^([0-9][0-9])$)/i.test(t)?e.setDate(Number(t)):e.setDate(Number(1));},"%j":function(e,t){/(^([0-9]?[0-9])$)/i.test(t)?e.setDate(Number(t)):e.setDate(Number(1));},"%m":function(e,t){var i=/(^([0-9][0-9])$)/i.test(t);i?e.setMonth(Number(t)-1):e.setMonth(Number(0)),i&&e.getMonth()!==Number(t)-1&&e.setMonth(Number(t)-1);},"%n":function(e,t){var i=/(^([0-9]?[0-9])$)/i.test(t);i?e.setMonth(Number(t)-1):e.setMonth(Number(0)),i&&e.getMonth()!==Number(t)-1&&e.setMonth(Number(t)-1);},"%M":function(e,i){var n=o.findIndex(t.locale.monthsShort,(function(e){return e===i}));-1===n?e.setMonth(0):e.setMonth(n),-1!==n&&e.getMonth()!==n&&e.setMonth(n);},"%F":function(e,i){var n=o.findIndex(t.locale.months,(function(e){return e===i}));-1===n?e.setMonth(0):e.setMonth(n),-1!==n&&e.getMonth()!==n&&e.setMonth(n);},"%y":function(e,t){/(^([0-9][0-9])$)/i.test(t)?e.setFullYear(Number("20"+t)):e.setFullYear(Number("2000"));},"%Y":function(e,t){/(^([0-9][0-9][0-9][0-9])$)/i.test(t)?e.setFullYear(Number(t)):e.setFullYear(Number("2000"));},"%h":function(e,t,i){/(^0[1-9]|1[0-2]$)/i.test(t)&&"pm"===i||"PM"===i?e.setHours(Number(t)):e.setHours(Number(0));},"%g":function(e,t,i){/(^[1-9]$)|(^0[1-9]|1[0-2]$)/i.test(t)&&"pm"===i||"PM"===i?e.setHours(Number(t)):e.setHours(Number(0));},"%H":function(e,t){/(^[0-2][0-9]$)/i.test(t)?e.setHours(Number(t)):e.setHours(Number(0));},"%G":function(e,t){/(^[1-9][0-9]?$)/i.test(t)?e.setHours(Number(t)):e.setHours(Number(0));},"%i":function(e,t){/(^([0-5][0-9])$)/i.test(t)?e.setMinutes(Number(t)):e.setMinutes(Number(0));},"%s":function(e,t){/(^([0-5][0-9])$)/i.test(t)?e.setSeconds(Number(t)):e.setSeconds(Number(0));},"%u":function(e,t){/(^([0-9][0-9][0-9])$)/i.test(t)?e.setMilliseconds(Number(t)):e.setMilliseconds(Number(0));},"%a":function(e,t){"pm"===t&&e.setHours(e.getHours()+12);},"%A":function(e,t){"PM"===t&&e.setHours(e.getHours()+12);}};function l(e){for(var t=[],i="",n=0;n<e.length;n++)"%"===e[n]?(i.length>0&&(t.push({type:r.separator,value:i}),i=""),t.push({type:r.datePart,value:e[n]+e[n+1]}),n++):i+=e[n];return i.length>0&&t.push({type:r.separator,value:i}),t}function c(e,t,i){if("string"==typeof e){for(var n,o=[],a=0,c=null,u=0,d=l(t);u<d.length;u++){var h=d[u];if(h.type===r.separator){var f=e.indexOf(h.value,a);if(-1===f){if(i)return !1;throw new Error("Incorrect date, see docs: https://docs.dhtmlx.com/suite/calendar__api__calendar_dateformat_config.html")}c&&(o.push({formatter:c,value:e.slice(a,f)}),c=null),a=f+h.value.length;}else h.type===r.datePart&&(c=h.value);}"%A"===c||"%a"===c?o.unshift({formatter:c,value:e.slice(a)}):c&&o.push({formatter:c,value:e.slice(a)}),o.reverse();for(var p=0,v=o;p<v.length;p++){"%A"!==(y=v[p]).formatter&&"%a"!==y.formatter||(n=y.value);}for(var g=new Date(0),_=0,m=o;_<m.length;_++){var y=m[_];s[y.formatter]&&s[y.formatter](g,y.value,n);}return !!i||g}}!function(e){e[e.separator=0]="separator",e[e.datePart=1]="datePart";}(r||(r={})),t.getFormattedDate=function(e,t){return l(e).reduce((function(e,i){return i.type===r.separator?e+i.value:a[i.value]?e+a[i.value](t):e}),"")},t.stringToDate=c;var u=function(){function e(){}return e.copy=function(e){return new Date(e)},e.fromYear=function(e){return new Date(e,0,1)},e.fromYearAndMonth=function(e,t){return new Date(e,t,1)},e.weekStart=function(e,t){var i=(e.getDay()+7-t)%7;return new Date(e.getFullYear(),e.getMonth(),e.getDate()-i)},e.monthStart=function(e){return new Date(e.getFullYear(),e.getMonth(),1)},e.yearStart=function(e){return new Date(e.getFullYear(),0,1)},e.dayStart=function(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate())},e.addDay=function(e,t){return void 0===t&&(t=1),new Date(e.getFullYear(),e.getMonth(),e.getDate()+t)},e.addMonth=function(e,t){return void 0===t&&(t=1),new Date(e.getFullYear(),e.getMonth()+t)},e.addYear=function(e,t){return void 0===t&&(t=1),new Date(e.getFullYear()+t,e.getMonth())},e.withHoursAndMinutes=function(e,t,i,n){return void 0===n||!n&&12===t||n&&12!==t?new Date(e.getFullYear(),e.getMonth(),e.getDate(),t,i):n&&12===t?new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,i):new Date(e.getFullYear(),e.getMonth(),e.getDate(),t+12,i)},e.setMonth=function(e,t){e.setMonth(t);},e.setYear=function(e,t){e.setFullYear(t);},e.mergeHoursAndMinutes=function(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),t.getHours(),t.getMinutes())},e.isWeekEnd=function(e){return 0===e.getDay()||6===e.getDay()},e.getTwelweYears=function(e){var t=e.getFullYear(),i=t-t%12;return n.range(i,i+11)},e.getDayOrdinal=function(t){return (t.valueOf()-e.yearStart(t).valueOf())/864e5},e.getWeekNumber=function(t){6!==t.getDay()&&(t=e.addDay(t,6-t.getDay()));var i=e.getDayOrdinal(t);return i-t.getDay()<0&&(t=new Date(t.getFullYear()-1,12,0),i=e.getDayOrdinal(t)),Math.floor((i-t.getDay()+10)/7)},e.isSameDay=function(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()},e.toDateObject=function(e,t){return "string"==typeof e?c(e,t):new Date(e)},e.nullTimestampDate=new Date(0),e}();t.DateHelper=u;},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);}),r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=i(0),s=i(3),l=i(7),c=i(8),u=function(e){function t(t,i){void 0===i&&(i={});var n=e.call(this,t,i)||this;n._handlers=r({showHelper:function(e){e.preventDefault(),e.stopPropagation(),n._helper.show(e.target,{mode:"left"===n.config.labelPosition?"bottom":"right"});},hideHelper:function(e){e.preventDefault(),e.stopPropagation(),n._helper.hide();}},n._getHandlers());return n.mount(t,a.create({render:function(){return n._draw()}})),n}return o(t,e),t.prototype._destructor=function(){this._helper&&this._helper.destructor(),this.config=this._handlers=this._helper=null,this.unmount();},t.prototype._getHandlers=function(){return {}},t.prototype._init=function(){},t.prototype._draw=function(){return this._drawLabel()},t.prototype._drawLabel=function(){var e=this.config,t=e.id,i=e.helpMessage,n=e.required;this.config.helpMessage&&(this._helper||(this._helper=new c.Popup({css:"dhx_tooltip dhx_tooltip--forced dhx_tooltip--light"})),this._helper.attachHTML(this.config.helpMessage));var o=s.getLabelStyle(this.config);return o&&a.el((this.config.type.includes("group")?"legend":"label")+".dhx_label",{for:t||this._uid,class:i?"dhx_label--with-help":"",style:o.style},i?[(o.label||n)&&a.el("span.dhx_label__holder",o.label),a.el("span.dhx_label-help.dxi.dxi-help-circle-outline",{tabindex:"0",role:"button",onclick:this._handlers.showHelper,onfocus:this._handlers.showHelper,onblur:this._handlers.hideHelper,id:"dhx_label__help_"+(t||this._uid)})]:o.label)},t}(l.View);t.Label=u;},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(17),o=i(3);function r(e){for(var t=e.toLowerCase().match(/\w+/g),i=0,n="",o=0;o<t.length;o++){var r=t[o];"ctrl"===r?i+=4:"shift"===r?i+=2:"alt"===r?i+=1:n=r;}return i+n}var a={Up:"arrowUp",Down:"arrowDown",Right:"arrowRight",Left:"arrowLeft",Esc:"escape",Spacebar:"space"},s=function(){function e(e){var t=this;this._keysStorage={},this._initHandler=function(e){var i;if(e.which>=48&&e.which<=57||e.which>=65&&e.which<=90)i=String.fromCharCode(e.which);else {var r=32===e.which?e.code:e.key;i=o.isIE()&&a[r]||r;}var s=t._keysStorage[(e.ctrlKey||e.metaKey?4:0)+(e.shiftKey?2:0)+(e.altKey?1:0)+(i&&i.toLowerCase())];if(s)for(var l=0;l<s.length;l++){if(t._beforeCall&&!1===t._beforeCall(e,n.focusManager.getFocusId()))return;s[l].handler(e);}},e&&(this._beforeCall=e),document.addEventListener("keydown",this._initHandler);}return e.prototype.destructor=function(){document.removeEventListener("keydown",this._initHandler),this.removeHotKey();},e.prototype.addHotKey=function(e,t){var i=r(e);this._keysStorage[i]||(this._keysStorage[i]=[]),this._keysStorage[i].push({handler:t});},e.prototype.removeHotKey=function(e,t){var i=this;if(e)if(e&&t){var n=r(e),o=function(e){return e.toString().replace(/\n/g,"").replace(/\s/g,"")};this._keysStorage[n].forEach((function(e,r){o(e.handler)===o(t)&&(delete i._keysStorage[n][r],i._keysStorage[n]=i._keysStorage[n].filter((function(e){return e})));}));}else {var a=r(e);delete this._keysStorage[a];}else this._keysStorage={};},e.prototype.exist=function(e){var t=r(e);return !!this._keysStorage[t]},e.prototype.getKeyStorageLength=function(){return Object.keys(this._keysStorage).length},e}();t.KeyManager=s;},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(1),o=i(3);t.transpose=function(e,t){for(var i=[],n=0;n<e.length;n++)for(var o=e[n],r=0;r<o.length;r++){i[r]=i[r]||[];var a=t?t(o[r]):o[r];i[r].push(a);}return i},t.getStyleByClass=function(e,t,i,o){var r,a,s=t.querySelector("."+i),l=(r=s,"string"==typeof(a='<div class="'+e+'"></div>')?(r.insertAdjacentHTML("beforeend",a),r.lastChild):(r.appendChild(a),a)),c=window.getComputedStyle(l),u={color:"rgb(0, 0, 0)"===c.color?o.color:n.rgbToHex(c.color),background:"rgba(0, 0, 0, 0)"===c.backgroundColor?o.background:n.rgbToHex(c.backgroundColor),fontSize:parseFloat(c.fontSize)};return s.removeChild(l),u.color===o.color&&u.background===o.background&&u.fontSize===o.fontSize?null:u},t.removeHTMLTags=function(e){return "string"!=typeof e&&"number"!=typeof e&&"boolean"!=typeof e?"":(""+(null==e?"":e)).replace(/<[^>]*>/g,"").replace(/["]/g,"&quot;").trim()},t.isCssSupport=function(e,t){try{return CSS.supports(e,t)}catch(n){var i=document.createElement("div");return i.style[e]=t,i.style[e]===t}},t.isRowEmpty=function(e){if(e)return Object.keys(e).reduce((function(t,i){return "id"===i||i.startsWith("$")?t:t&&void 0!==e[i]&&""!==e[i]?void 0:t}),!0)},t.isSortable=function(e,t){return !1!==t.sortable&&e.sortable||t.sortable},t.isAutoWidth=function(e,t){if(t)return !1!==t.autoWidth&&e.autoWidth||t.autoWidth;var i=!1;return e.columns.map((function(t){(!1!==t.autoWidth&&e.autoWidth||t.autoWidth)&&(i=!0);})),i},t.isTooltip=function(e,t){return !1!==t.tooltip&&e.tooltip||t.tooltip},t.isHtmlEnable=function(e,t){return !1!==t.htmlEnable&&e.htmlEnable||t.htmlEnable},t.getTotalWidth=function(e){return e.reduce((function(e,t){return e+(t.$width||0)}),0)},t.getTotalHeight=function(e){return e.reduce((function(e,t){return e+(t.$height||0)}),0)},t.scrollFixedColsAndRows=function(e){var t=o.locateNode(e,"data-dhx-widget-id").querySelector(".dhx_grid-body"),i=e.deltaY,n=e.shiftKey?[i,0]:[0,i];null==t||t.scrollBy.apply(t,n);};},function(e,t,i){function n(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i]);}Object.defineProperty(t,"__esModule",{value:!0}),n(i(167)),n(i(168)),n(i(42));},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.all="all",e.level="level",e.leafs="leafs";}(t.TreeFilterType||(t.TreeFilterType={})),function(e){e.afterAdd="afteradd",e.beforeAdd="beforeadd",e.removeAll="removeall",e.beforeRemove="beforeremove",e.afterRemove="afterremove",e.change="change",e.load="load",e.loadError="loaderror",e.beforeLazyLoad="beforelazyload",e.afterLazyLoad="afterlazyload",e.dataRequest="dataRequest";}(t.DataEvents||(t.DataEvents={})),function(e){e.beforeDrag="beforeDrag",e.dragStart="dragStart",e.dragOut="dragOut",e.dragIn="dragIn",e.canDrop="canDrop",e.cancelDrop="cancelDrop",e.beforeDrop="beforeDrop",e.afterDrop="afterDrop",e.afterDrag="afterDrag";}(t.DragEvents||(t.DragEvents={})),function(e){e.json="json",e.csv="csv",e.xml="xml";}(t.DataDriver||(t.DataDriver={}));},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(32),o=i(68);t.isEqualObj=function(e,t){for(var i in e)if(e[i]!==t[i]||Array.isArray(e[i]))return !1;return !0},t.naturalCompare=function(e,t){if(isNaN(e)||isNaN(t)){var i=[],n=[];for(e.replace(/(\d+)|(\D+)/g,(function(e,t,n){i.push([t||1/0,n||""]);})),t.replace(/(\d+)|(\D+)/g,(function(e,t,i){n.push([t||1/0,i||""]);}));i.length&&n.length;){var o=i.shift(),r=n.shift(),a=o[0]-r[0]||o[1].localeCompare(r[1]);if(a)return a}return i.length-n.length}return e-t},t.findByConf=function(e,t){if("function"==typeof t){if(t.call(this,e))return e}else if(t.by&&t.match&&e[t.by]===t.match)return e},t.isDebug=function(){var e=window.dhx;if(void 0!==e)return void 0!==e.debug&&e.debug},t.dhxWarning=function(e){console.warn(e);},t.dhxError=function(e){throw new Error(e)},t.toProxy=function(e){var t=typeof e;return "string"===t?new n.DataProxy(e):"object"===t?e:void 0},t.toDataDriver=function(e){if("string"==typeof e){var t=window.dhx,i=t&&t.dataDrivers||o.dataDrivers;if(i[e])return new i[e];console.warn("Incorrect data driver type:",e),console.warn("Available types:",JSON.stringify(Object.keys(i)));}else if("object"==typeof e)return e},t.copyWithoutInner=function(e,t){var i={};for(var n in e)n.startsWith("$")||t&&t[n]||(i[n]=e[n]);return i},t.isTreeCollection=function(e){return Boolean(e.getRoot)},t.hasJsonOrArrayStructure=function(e){if("object"==typeof e)return !0;if("string"!=typeof e)return !1;try{var t=JSON.parse(e);return "[object Object]"===Object.prototype.toString.call(t)||Array.isArray(t)}catch(e){return !1}};},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(1),o=i(21),r=i(18);function a(e,t){e[t]&&("string"==typeof e[t]?e[t]=[{text:""+e[t]}]:e[t]=e[t].map((function(e){return "string"==typeof e&&(e={text:e}),e})));}t.normalizeColumns=function(e,t){var i=e.columns,n=e.htmlEnable;void 0===t&&(t=!1);for(var o=0,r=i;o<r.length;o++){var s=r[o];s.$htmlEnable=!(!s.htmlEnable&&!n),s.$cellCss=s.$cellCss||{},a(s,"header"),a(s,"footer"),s.header.reduce((function(e,t){return e||!!t.content}),!1)&&(s.$uniqueData=[]),s.minWidth&&s.minWidth<20&&(s.minWidth=20),s.maxWidth&&s.maxWidth<20&&(s.maxWidth=20);var l=s.minWidth||100;s.width&&(l=(l=s.maxWidth&&s.minWidth?s.width>=s.minWidth&&s.width<=s.maxWidth?s.width:s.width>=s.maxWidth?s.maxWidth:s.minWidth:s.maxWidth?s.width<=s.maxWidth?s.width:s.maxWidth>100?s.maxWidth:100:s.minWidth?s.width>=s.minWidth?s.width:s.minWidth:s.width)<20?20:l),s.$width=s.$width&&!t?s.$width:l,s.$width>s.maxWidth&&(s.$width=s.maxWidth),s.$width<s.minWidth&&(s.$width=s.minWidth);}},t.countColumns=function(e,t){var i=0,n=0,o=0,r=!1,a=0,s=!1;return t.forEach((function(e){if(i=Math.max(i,e.header.length),o+=e.$width,e.footer&&(n=Math.max(n,e.footer.length),s||(s=!0)),!r)for(var t=0,a=e.header;t<a.length;t++){if(a[t].colspan)return void(r=!0)}})),t.forEach((function(e){if(e.header.length<i)for(var t=0;t<i;t++)e.header[t]=e.header[t]||{text:""};if(s&&(e.footer=e.footer||[]),e.footer&&e.footer.length<n)for(t=0;t<n;t++)e.footer[t]=e.footer[t]||{text:""};e.header=e.header.map((function(e){return "object"!=typeof e&&(e={text:e}),e.css=e.css||"",e.text||e.css.includes("dhx_cell-empty")||(e.css+=" dhx_cell-empty dxi dxi-select-all"),e})),""===e.header[0].text&&a++;})),e.$totalWidth=o,e.$headerLevel=i,e.$footerLevel=n,e.$colspans=r,e.$footer=s,a},t.calculatePositions=function(e,t,i,n,o){for(var r,a,s=n.columns||[],l=s.length,c=o||[],u=c.length,d=null!==(r=n.leftSplit)&&void 0!==r?r:0,h=null!==(a=n.topSplit)&&void 0!==a?a:0,f=0,p=i.left,v=n.$totalWidth/l,g=0;g<l;g++){if(!((p-=s[g].$width)+v/2>0))break;f++;}var _=0,m=i.top,y=n.$totalHeight/u;for(g=0;g<u;g++){if(!((m-=(O=c[g]).$height)+y/2>0))break;_++;}for(var b=0,w=0,x=-1/0,E=1/0,C=0;C<l;C++){var S=s[C];C>=f&&b<e&&!S.hidden&&(b+=S.$width,w++),S.$width>x&&(x=S.$width),S.$width<E&&(E=S.$width);}var I=0,k=0,M=-1/0,P=1/0;for(C=0;C<u;C++){var O=c[C];C>=_&&I<t&&!O.hidden&&(I+=O.$height,k++),O.$height>M&&(M=O.$height),O.$height<P&&(P=O.$height);}P=P<n.rowHeight?P:n.rowHeight;var A=Math.round(x/E),D=Math.round(M/P);return {xStart:f-A>=d?f-A:d,xEnd:f+w+A,yStart:_-D>=h?_-D:h,yEnd:_+k+D}},t.getUnique=function(e,t,i){var o=e.map((function(e){return e[t]}));return i&&o.forEach((function(e,t){(null==e?void 0:e.includes(", "))&&(e.split(", ").forEach((function(e){return o.push(e)})),delete o[t]);})),o.filter((function(e,t,i){return i.indexOf(e)===t&&n.isDefined(e)})).sort()},t.getMaxRowHeight=function(e,t,i){var r,a;void 0===i&&(i={font:"20px Roboto",lineHeight:20});var s=document.createElement("canvas"),l=s.getContext("2d",{alpha:!1});l.font=i.font;for(var c={},u=t.length,d=0;d<u;d++)t[d].template?c[t[d].id]={width:t[d].$width||0,htmlEnable:t[d].$htmlEnable,template:t[d].template,cols:t[d]}:c[t[d].id]={width:t[d].$width||0,htmlEnable:t[d].$htmlEnable};for(var h=[],f=[],p=0,v=Object.entries(e);p<v.length;p++){var g=v[p],_=g[0],m=g[1];if(c[_]&&"id"!==_&&"height"!==_&&!_.startsWith("$")&&("string"==typeof m||"number"==typeof m)){var y="";if(null===(r=c[_])||void 0===r?void 0:r.template){var b=c[_].template(m,e,c[_].cols);y=c[_].htmlEnable?o.removeHTMLTags(b):b;}else y="string"==typeof m?c[_].htmlEnable?o.removeHTMLTags(m):m:m.toString();h.push(y.split("\n").length),f.push(Math.round(l.measureText(y).width/(null===(a=c[_])||void 0===a?void 0:a.width)));}}var w=Math.max(n.getMaxArrayNymber(h),n.getMaxArrayNymber(f));return s.remove(),w*i.lineHeight},t.getMaxColsWidth=function(e,t,i,n){if(void 0===i&&(i={font:"normal 14.4px Arial"}),e.length&&t.length){var a=document.createElement("canvas"),s=a.getContext("2d",{alpha:!1});s.font=i.font;for(var l={},c=t.length,u=0;u<c;u++){var d=t[u],h=d.template,f=d.$htmlEnable,p=d.format,v=d.id,g=d.type;l[v]=h&&"data"===n?{width:20,htmlEnable:f,template:h,cols:d,type:g}:{width:20,htmlEnable:f,format:"date"===g?p||"%M %d %Y":p,type:g};}var _=e.length;for(u=0;u<_;u++)for(var m=0,y=Object.entries(e[u]);m<y.length;m++){var b=y[m],w=b[0],x=b[1],E=l[w];if(E&&"id"!==w&&"height"!==w&&!w.startsWith("$")&&("string"==typeof x||"number"==typeof x||x instanceof Date)){h=E.template;var C=E.cols,S=(p=E.format,g=E.type,E.htmlEnable),I=E.width,k=void 0;if("function"==typeof h){var M=h(x,e[u],C);k=S?o.removeHTMLTags(M):M;}else k=S?o.removeHTMLTags(x):x.toString();var P=p&&"date"===g&&new Date(k);P&&(k=r.getFormattedDate(p,P));var O=s.measureText(k).width;O>I&&(l[w].width=O);}}a.remove();for(var A={},D=0,F=Object.entries(l);D<F.length;D++){var V=F[D];w=V[0],x=V[1];A[w]=Math.ceil(x.width);}return A}},t.toFormat=function(e,t,i){if("boolean"==typeof e)return e;if(!e&&"number"!=typeof e)return e;switch(t){case"number":case"percent":return i||(i="#"),n.isDefined(e)&&!isNaN(Number(e))?function(t){var n,o,r,a=i.replace(/#+/g,"#").split("#").filter((function(e){return e})),s=i.match(/0/g)&&i.match(/0/g).length;e=("percent"===t?100*Number(e):e).toString();var l=Math.trunc(Number(e));if(s){var c=e.split(".")[1]||"0";r=a.find((function(e){return e.includes("0")})).replace(/0+/g,""),o=Number("0."+c).toFixed(s),Number(o)>=1&&l++,o=o.toString().split(".")[1].padEnd(s,"0");}var u=(e<0&&0===Math.abs(l)?"-":"")+l,d=a.find((function(e){return !e.includes("0")}));return n=d?u.replace(/(\d)(?=(\d{3})+(\D|$))/g,"$1"+d):u,n+=(r||"")+(o||""),"percent"===t?n+"%":n}(t):e;case"date":return i||(i="%M %d %Y"),"string"==typeof e?e=r.getFormattedDate(i,r.stringToDate(e,i)):"object"==typeof e&&(e=r.getFormattedDate(i,e)),e;default:return e}},t.getCalculatedRowHeight=function(e,t){void 0===t&&(t={rowHeight:40,padding:8});var i=t.rowHeight<40?e:e+2*t.padding;return e<t.rowHeight?t.rowHeight:i},t.getTreeCellWidthOffset=function(e){return 20+20*e.$level-(e.$items?20:0)};},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(18);function o(e){return 25569+(e.getTime()-6e4*e.getTimezoneOffset())/864e5}function r(e,t){return isNaN(e)?0:Math.min(t,Math.max(0,e))}function a(e){var t,i,n=0,o=0,a=0;if("string"==typeof e){var s=e.match(/\d+/g);if(!s)return e;e.toLowerCase().includes("pm")&&(t=!0),e.toLowerCase().includes("am")&&(i=!0),o=r(+s[0],23),(t||i)&&(t&&o<12&&(o+=12),i&&12===o&&(o=0)),n=r(+s[1],59),a=r(+s[2],59);}return new Date(1991,0,1,o,n,a)}t.getExcelDateFromJs=o,t.excelDateToJSDate=function(e){var t=new Date(Math.round(86400*(e-25569)*1e3));return new Date(t.getTime()+6e4*t.getTimezoneOffset())},t.addDay=function(e,t){return void 0===t&&(t=1),new Date(e.getFullYear(),e.getMonth(),e.getDate()+t)},t.addTime=function(e,t){return void 0===t&&(t=36e5),new Date(e.getTime()+t)},t.dateDiff=function(e,t){var i=t.getTime(),n=e.getTime();return parseInt(""+(i-n)/864e5)},t.timeDiff=function(e,t){var i=new Date,n=new Date;i.setHours(e.getHours(),e.getMinutes(),e.getSeconds()),n.setHours(t.getHours(),t.getMinutes(),t.getSeconds());var o=n.getTime(),r=i.getTime();return parseInt(""+(o-r))},t.timeStringToJS=a,t.isTimeCheck=function(e){return /([0-2][0-9]:[0-5][0-9]:[0-5][0-9])/i.test(e)},t.getExcelDateFromString=function(e,t){if("string"!=typeof e)return e;var i=t.id,r=t.mask,s=e;if(i.includes("date")&&(s=n.stringToDate(e,c(r),!0)?o(n.stringToDate(e,c(r))):e),"time"===i){var l=a(e);s="string"==typeof l?l:o(l);}return s};var s={mmmm:"%F",mmm:"%M",mm:"%m",m:"%n",dddd:"%I",ddd:"%D",dd:"%d",d:"%j",y:"%y",yy:"%y",yyyy:"%Y",w:"",ww:"",q:"",h:"%G",hh:"%H","AM/PM":"%A","am/pm":"%a","A/P":"%A","a/p":"%a",n:"%i",nn:"%i",s:"%s",ss:"%s"},l={h:"%g",hh:"%h"};function c(e){if(u(e))return e;var t=e.toLowerCase(),i="",n="",o="",r="",a=t.includes("am/pm")||t.includes("a/p");a&&(e=(e=(e=(e=e.replace("AM/PM","%A")).replace("am/pm","%a")).replace("A/P","%A")).replace("a/p","%a"));for(var c=0;c<=e.length;c++){for(var d=e[c],h="",f=c;!h&&f<e.length;){var p=e[f];h=s[p],f++;}"m"===d&&(r.includes("h")||h.includes("s"))&&(d="n"),n&&d!==o&&(i+=n.includes("h")&&a?l[n]:s[n]||o,r=s[n]?n:r,n=""),n+=d,o=d;}return i}function u(e){return e.includes("%")}t.getDHXDateFormat=c,t.getExcelFormatFromDHX=function(e){if(!u(e))return e;var t=e;return Object.keys(s).forEach((function(e){for(var i=s[e];i&&t.includes(i);)t=t.replace(i,e);})),Object.keys(l).forEach((function(e){for(var i=l[e];i&&t.includes(i);)t=t.replace(i,e);})),t},t.isDHXFormat=u,t.isDateFormat=function(e){if(e.includes("#")||e.includes("0"))return !1;var t=u(e)?e:c(e),i=["%F","%M","%m","%n","%I","%D","%d","%j","%y","%Y"].find((function(e){return t.includes(e)})),n=["%G","%H","%i","%s","%g","%h"].find((function(e){return t.includes(e)}));return !(!i&&!n)&&(i?"date":"time")};},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=i(12),r=i(2);function a(e,t,i){return void 0===i&&(i=!0),'<div class="dhx_custom_header_cell">\n\t\t\t'+e+'\n\t\t<div class="dhx_resizer_grip_wrap">\n\t\t\t<div class="dhx_resizer_grip" data-dhx-id='+t+'>\n\t\t\t\t<div class="dhx_resizer_grip_line"></div>\n\t\t\t</div>\n\t\t</div>\n\t\t'+(i?'<i class="dxi dxi-dots-vertical dhx_header_icon" data-dhx-id='+t+"></i>":"")+"\n\t</div>"}t.getHeaderCell=a,t.getIndexRowCell=function(e){return '<div class="dhx_custom_index_cell">'+e+'\n\t<div class="dhx_resizer_grip_wrap">\n\t\t\t<div class="dhx_resizer_grip" data-dhx-id='+(e-1)+'>\n\t\t\t\t<div class="dhx_resizer_grip_line"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>'},t.updateColumns=function(e){var t=e.columns,i=0;null==t||t.map((function(e,t){if(e.width=e.width||120,i+=e.hidden?0:e.width,"$index"!==e.id){var n=r.getLetterFromNumber(t);e.header=[{text:a(n,t),css:""}],e.$letter=n;}})),e.$totalWidth=i;},t.updateRowsIndex=function(e){e.map((function(e,t){e.$index=t+1;}));},t.removeRowsCss=function(e){e.data.map((function(t){e.removeRowCss(t.id,"dhx_selected_row");}));},t.setAutoHeightToRow=function(e,t,i,a){var s,l,c=i.getMeta(),u=c.cols,d=c.rows,h=r.getCellIds(e,t),f=h.row,p=h.col,v="wrap"===a,g=r.getCellInfo(e,i,t),_=d[f],m=g.value,y=g.format;if(m){var b=o.getFormattedValue(m,y),w=null===(s=u[p])||void 0===s?void 0:s.width,x=r.getTextHeight(b,w);if(_.wrap=(_.wrap||0)+(v?1:-1),d[f]=n({},_),i.setMeta({rows:d}),!(null===(l=d[f])||void 0===l?void 0:l.changedByUser)&&!(v&&x<=d[f].height)&&(v||!_.wrap))return d[f]=n(n({},_),{height:v?x:t.config.rowHeight}),i.setMeta({rows:d}),!0}},t.updateSpans=function(e,t,i,o){var r=o.getMeta().merged;if(null==r?void 0:r.length){var a=!1,s=r.map((function(o){var r=o.from,s=o.to;if(e&&(r.column>=i||s.column>=i)){var l={from:u=n({},r),to:n(n({},s),{column:s.column+e})};if(r.column>=i&&e>0||r.column>i&&e<0){var c=u.column;u.column=c+e<0?0:c+e;}return a=!0,l}if(t&&(r.row>=i||s.row>=i)){var u;l={from:u=n({},r),to:n(n({},s),{row:s.row+t})};if(r.row>=i&&t>0||r.column>i&&t<0){var d=u.row;u.row=d+t<0?0:d+t;}return a=!0,l}return {from:r,to:s}}));if(a)return o.setMeta({merged:s}),s}};},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=i(1),r=i(0),a=i(38),s=i(21),l=i(11),c=i(137),u=i(3),d=i(25);function h(e,t,i,n,o){t=u.locateNodeByClassName(o.target,"dhx_grid-fixed-cols-wrap")?0:t;var r=u.locateNodeByClassName(o.target,"dhx_grid-cell"),a=u.locateNodeByClassName(o.target,"dhx_span-cell");if((r||a)&&n){var s=r?r.parentNode:a,l=(r||a).getAttribute("data-dhx-col-id"),c=i.columns.filter((function(e){return !e.hidden})),d=c.find((function(e){return e.id===l})),h=s.getAttribute("data-dhx-id"),f=i.data.find((function(e){return e.id.toString()===h}));n.toLocaleLowerCase().includes("touch")?i._events.fire(n,[f,d,o]):i.events.fire(n,[f,d,o]);}}function f(e,t,i){return {onclick:[h,e,t,i,l.GridEvents.cellClick],onmouseover:[h,e,t,i,l.GridEvents.cellMouseOver],onmousedown:[h,e,t,i,l.GridEvents.cellMouseDown],ondblclick:[h,e,t,i,l.GridEvents.cellDblClick],oncontextmenu:[h,e,t,i,l.GridEvents.cellRightClick],ontouchstart:[h,e,t,i,l.GridEvents.cellMouseDown],ontouchmove:[h,e,t,i,l.GridSystemEvents.cellTouchMove],ontouchend:[h,e,t,i,l.GridSystemEvents.cellTouchEnd]}}function p(e,t,i,o){var a=o.$editable&&o.$editable.row===t.id&&o.$editable.col===i.id,s="",l=i.align?" dhx_align-"+i.align:"dhx_align-left";o.dragMode&&"row"===o.dragItem&&(s+=(t.$drophere&&!a?" dhx_grid-cell--drophere":"")+(t.$dragtarget&&!a?" dhx_grid-cell--dragtarget":"")+(a?"":" dhx_grid-cell--drag"));var c=d.getTreeCellWidthOffset(t);return r.el(".dhx_grid-cell",n({class:"dhx_tree-cell "+(i.$cellCss[t.id]||"")+" "+(t.$items?"dhx_grid-expand-cell":"")+" "+(a?"dhx_tree-editing-cell":"")+" "+s+l,style:{width:i.$width,height:t.$height,padding:t.$items?0:"0 0 0 "+c+"px"},"data-dhx-col-id":i.id},{role:"gridcell","aria-colindex":1}),[t.$items?r.el(".dhx_grid-expand-cell-icon",n(n({class:t.$opened?"dxi dxi-chevron-up":"dxi dxi-chevron-down","data-dhx-id":t.id},function(e){return {role:"button","aria-label":e.$opened?"Collapse group":"Expand group"}}(t)),{style:{padding:t.$level?"0 0 0 "+(4+c)+"px":"0 0 0 4px"}})):null,r.el(".dhx_tree-cell",{class:l+(o.autoHeight?" dhx_tree-cell_auto-height":"")},[e])])}function v(e,t,i){return c.getEditor(e,t,i)}t.getHandlers=f,t.getTreeCell=p,t.getCells=function(e){if(!e.data||!e.columns)return [];var t=e.$positions,i=e.data?e.data.slice(t.yStart,t.yEnd):[],o=e.columns.slice(t.xStart,t.xEnd),a=e.selection.getCell(),l=!0;return i.map((function(c,u){var h=i.length-1===u,f="";return e.rowCss&&(f=e.rowCss(c)),c.$css&&(f+=c.$css),r.el(".dhx_grid-row",n({style:{height:h?c.$height+1:c.$height},"data-dhx-id":c.id,class:f,_key:c.id,_flags:r.KEYED_LIST},{role:"row","aria-rowindex":t.yStart+u+1}),c.$customRender?[c.$customRender(c,e)]:o.map((function(i,o){var u,h;if(!i.hidden){var f=c[i.id];(i.editable||e.editable&&!1!==i.editable)&&("select"===i.editorType||"combobox"===i.editorType||"multiselect"===i.editorType)&&i.options&&(f=(f="string"==typeof f&&"multiselect"===i.editorType?f.split(",").map((function(e){return e.trim()})):[null==f?void 0:f.toString()]).map((function(e){var t,n;return null!==(n=null===(t=i.options.find((function(t){return t.id&&t.id.toString()===e})))||void 0===t?void 0:t.value)&&void 0!==n?n:e})).join(", "));var g=d.toFormat(f,i.type,i.format),_=i.template?i.template(g,c,i):"boolean"!=typeof(h=g)&&"boolean"!==i.type||"string"==typeof h?h||0===h?h:"":""+Boolean(h);"string"==typeof _&&(_=s.isHtmlEnable(e,i)?r.el("div.dhx_grid-cell__content",n({".innerHTML":_},{role:"button","aria-label":"Edit content"})):_);var m=((i.$cellCss&&i.$cellCss[c.id]||"")+" dhx_"+i.type+"-cell").replace(/\s+/g," "),y=i.$width,b=e.$editable&&e.$editable.row===c.id&&e.$editable.col===i.id&&!e.$editable.isSpan,w=e.leftSplit,x=e.columns;return (b||"boolean"===i.type&&(e.editable&&(null===(u=i.editable)||void 0===u||u)||!e.editable&&i.editable))&&(_=v(c,i,e).toHTML(),m+=" dhx_grid-cell__editable",w===x.indexOf(i)+1&&(y-=1)),"tree"===e.type&&e.firstColId===i.id?p(_,c,i,e):(e.dragMode&&"row"===e.dragItem&&(m+=(c.$drophere&&!b?" dhx_grid-cell--drophere":"")+(c.$dragtarget&&!b?" dhx_grid-cell--dragtarget":"")+(b?"":" dhx_grid-cell--drag")),i.align&&(m+=" dhx_align-"+i.align),s.isHtmlEnable(e,i)&&(m+=" dhx_grid-cell__content_html-enable"),e.autoHeight&&(m+=" dhx_grid-cell__content_auto-height"),r.el(".dhx_grid-cell",n({class:m,style:{width:y,height:c.$height+"px"},_key:i.id,"data-dhx-col-id":i.id},function(t,i,o,r){return n({role:"gridcell","aria-colindex":i,"aria-readonly":r?"false":"true"},function(t,i){var n={tabindex:-1};return a?a.row.id===i.id&&a.column.id===t.id&&(n.tabindex=0):l&&(n.tabindex=0,n.onfocus=function(t){if(e.selection&&!a){var i=t.target.parentNode.getAttribute("data-dhx-id"),n=t.target.getAttribute("data-dhx-col-id");n&&i&&(e.selection.setCell(i,n),a=e.selection.getCell());}}),l=!1,n}(t,c))}(i,t.xStart+o+1,0,e.editable)),[_]))}})))}))},t.getSpans=function(e,t){var i,s,l=[],c=e.$positions,u=e.columns,h=e.data,p=e.spans;if(!u.length||!p)return null;for(var g=p.filter((function(t){var i;return null===(i=t.$renderFrom)||void 0===i?void 0:i.includes(e.$renderFrom)})),_=g.sort((function(e,t){return "string"==typeof e.row&&"string"==typeof t.row?e.row.localeCompare(t.row):e.row-t.row})),m=function(p){var g=_[p].row,m=_[p].column,y=_[p].rowspan,b=_[p].colspan,w=_[p].css,x=_[p].$markCss;if(1===y)return "continue";var E=o.findIndex(u,(function(e){return ""+e.id==""+m})),C=o.findIndex(h,(function(e){return ""+e.id==""+g}));if(E<0||C<0)return "continue";var S=u[E],I=h[C];if(S.hidden)return "continue";var k=null!==(i=_[p].text)&&void 0!==i?i:void 0===I[m]?"":I[m],M=S.template||function(e,t,i){return e||0===e?e:""};k="string"==typeof(k=M(k,I,S))?r.el("div.dhx_span-cell-content",{".innerHTML":k}):k;for(var P=0,O=0;O<C;O++)P+=h[O].$height;for(var A=P-(t?0:1),D=0,F=E-1;F>=0;F--)D+=u[F].$width;var V=I.$items&&0===E,R=E===u.length-1,T=E+b===u.length,L=S.header[0].text?" dhx_span-cell":" dhx_span-cell dhx_span-cell--title";L+=V?" dhx_span-expand-cell":"",L+=x?" "+x:"",L+=w?" "+w:"",L+=0===C?" dhx_span-first-row":"",L+=0===E?" dhx_span-first-col":"",L+=R||T?" dhx_span-last-col":"",L+=b?" dhx_span-string-cell":" dhx_span-"+(S.type||"string")+"-cell",L+=S.align?" dhx_align-"+S.align:" dhx_align-left";var H=b>1?a.getWidth(u,b,E):S.$width,N=y>1?a.getHeight(h,y,C):I.$height;if(e.$editable&&e.$editable.row===g&&e.$editable.col===m||"boolean"===S.type&&(e.editable&&(null===(s=S.editable)||void 0===s||s)||!e.editable&&S.editable)){var j=e.leftSplit,$=e.topSplit;if(!(j&&E<j||$&&C<$)){var z=_[p].text;k=v(I,S,e).toHTML(z),L+=" dhx_span__editable",j===E+1&&(H-=1);}}l.push(r.el("div",n({class:L,style:{width:H,height:N,top:A,left:D},"data-dhx-col-id":m,"data-dhx-id":g,"aria-hidden":"true"},f(c.yStart,c.xStart,e)),[V?r.el(".dhx_span-expand-cell-icon",{class:I.$opened?"dxi dxi-chevron-up":"dxi dxi-chevron-down","data-dhx-id":I.id,role:"button","aria-label":I.$opened?"Collapse group":"Expand group",style:{padding:"0 0 0 "+(4+d.getTreeCellWidthOffset(I))+"px"}}):null,k]));},y=0;y<_.length;y++)m(y);return l},t.getShifts=function(e){var t=e.columns.slice(0,e.$positions.xStart),i=e.data.slice(0,e.$positions.yStart);return {x:s.getTotalWidth(t),y:s.getTotalHeight(i)}},t.normalizeSpan=function(e,t){var i=t.leftSplit,o=void 0===i?0:i,r=t.topSplit,a=void 0===r?0:r,s=t.data,l=t.columns,c=e.column,u=e.row,d=e.colspan,h=e.rowspan,f=l.findIndex((function(e){return e.id==c})),p=s.findIndex((function(e){return e.id==u})),v=[];return f+(d||0)>=o&&p+(h||0)>=a&&v.push("render"),f<o&&v.push("fixedCols"),p<a&&f>=o&&v.push("fixedRows"),n(n({},e),{$renderFrom:v})};},function(e,t,i){function n(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i]);}Object.defineProperty(t,"__esModule",{value:!0}),n(i(80)),n(i(156)),n(i(81)),n(i(56));},function(e,t,i){function n(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i]);}Object.defineProperty(t,"__esModule",{value:!0}),n(i(87)),n(i(179));},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n,o={1:"#ERROR",2:"#ERROR",3:"#REF!"},r=function(){return r=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};function a(e,t,i){return i+64*t+64*e*4096}function s(e){return [e<2147483648?e>>18:e/262144&16777215,e>>6&4095,63&e]}function l(e){return e<2147483648?e>>18:e/262144&16777215}function c(e){return e>>6&4095}function u(e){return 63&e}function d(e,t,i){for(var n=s(e),o=n[0],r=n[1],a=s(t),l=a[0]-o,c=a[1]-r,u=0;u<=l;u++)for(var d=0;d<=c;d++)i(e+64*d+4096*u*64);}function h(e,t){for(var i,n,o,r,a,l,c,d,h=e.code,p=e.source,v="",g=h.length,_=0;_<g;_+=3)switch(h[_]){case 5:var m=void 0;9===h[_+6]&&(m=t.pageName(u(h[_+7]))),v+=(-1!==(d=m||e.source.substr(h[_+1],h[_+2])).indexOf(" ")?"'"+d+"'":d)+"!";break;case 7:v+=f(r=(i=s(h[_+4]))[0],l=i[1],h[_+5]);break;case 4:v+=p.substr(h[_+1],h[_+2]).toUpperCase();break;case 8:r=(n=s(h[_+4]))[0],l=n[1],a=(o=s(h[_+7]))[0],c=o[1],v+=f(r,l,h[_+5]),v+=":",v+=f(a,c,h[_+8]);break;case 9:break;case 2:v+="{{"+p.substr(h[_+1],h[_+2])+"}}";break;case 3:v+="#REF!";break;case 1:v+='"'+p.substr(h[_+1],h[_+2])+'"';break;default:v+=p.substr(h[_+1],h[_+2]);}return v}function f(e,t,i){var n="";2&i&&(n+="$");var o="";for(t+=1;t>0;){var r=t%26;0===r&&(r=26),o=String.fromCharCode(64+r)+o,t=(t-r)/26;}return n+=o,1&i&&(n+="$"),n+(e+1)}function p(e){return e<=122}function v(e){return e<=122?e>=65||35===e||36===e||46===e:e>191}function g(e){return e>=97}function _(e){var t=e.charCodeAt(0);return t>=48&&t<=57}function m(e,t){var i;do{t++,i=e.charCodeAt(t);}while(i>=48&&i<=57);return t}function y(e){return " "===e||"\t"===e||"\n"===e||"\r"===e}function b(e,t){var i;do{i=e[++t];}while(y(i));return t}function w(e,t){if("<"===e[t]){var i=e[t+1];">"!==i&&"="!==i||t++;}else ">"===e[t]&&"="===e[t+1]&&t++;return t+1}function x(e,t,i){for(var o=e.length,r=!0,a=t,s=!1,l=!1,c=!1,u=0;a<o;a++){var d=e[a];if("'"!==d){if(!s){c=!0;var h=d.charCodeAt(0);if(v(h)){p(h)?g(h)&&(l=!0):r=!1,1==u&&u++;continue}if(_(d)){0==u&&u++;continue}break}}else {if(c)break;if(s){a++;break}s=!0;}}var f=e[a],m=t,y=a-t;return s&&((y-=1+("'"===e[a-1]?1:0))<0&&(y=0),m++,i=5),0===i&&(":"===f&&r?1!==u?i=3:(i=8,l&&(n=!0)):"!"===f?i="#"===e[m]?3:5:"("===f?(function(e,t,i){var n=e.substr(t,i);return n.toUpperCase()!==n}(e,m,y)&&(n=!0),i=4):"}"===f&&"}"===e[a-1]?i=2:1===u&&r?(i=7,l&&(n=!0)):i=6),[m,y,a,i]}function E(e,t,i){for(var n=0,o=0,r=1,s=1,l=0,c=!1,u=t.length-1;u>=0;u--){var d=t[u].charCodeAt(0);36!==d?d<58?(o+=(d-48)*r,r*=10):(c||(r=1,n=o,o=0,c=!0,s+=1),o+=(d-(d>96?96:64))*r,r*=26):l+=s;}o>4095?e.push(3,0,0):e.push(9,a(n-1,o-1,i),l);}function C(e,t){var i,o,r=[];n=!1;for(var a,s,c=-1,u=0;u<e.length;u++){var d=e[u];if('"'!=d){if(!(c>-1))if("{"!=d||"{"!=e[u+1])if("'"==d||((s=d.charCodeAt(0))<=122?s>=65||35===s||36===s:s>191)){var f=x(e,u,0),p=(V=f[0],R=f[1],f[2]),v=f[3],g=r.length;if(7!==v&&8!==v||5!==r[r.length-3])a=t.z,r.push(v,V,R);else {var C="'"===e[V-2]?1:0,S=r[g-2],I=r[g-1];void 0===(a=t.page(e.substr(S,I)))&&(r.push(3,0,0),a=0),r.push(v,V-I-2*C-1,R+I+2*C+1);}if(u=p-1,6===v)t.name(r,e,t);else if(8===v){var k=r.length;if(E(r,e.substr(V,R),a),V=(i=x(e,u+2,0))[0],R=i[1],p=i[2],5===(v=i[3])&&(V=(o=x(e,p+1,0))[0],R=o[1],p=o[2],v=o[3]),7!==v){r[k-3]=7;continue}E(r,e.substr(V,R),a);var M=r[k+1],P=r[k+4];(M>P||l(M)>l(P))&&(r[k+1]=P,r[k+4]=M),r[k-1]+=R+1,u=p-1;}else 7===v?E(r,e.substr(V,R),a):3!==v&&5!==v||u++;}else if(y(d)){var O=b(e,u);r.push(12,u,O-u),u=O-1;}else if(_(d)){var A=m(e,u);r.push(11,u,A-u),u=A-1;}else {var D=w(e,u);r.push(10,u,D-u),u=D-1;}else {var F=x(e,u+2,2),V=F[0],R=F[1],T=F[2];r.push(2,V,R),u=T+2-1;}}else c>-1?(r.push(1,c+1,u-c-1),c=-1):c=u;}var L={code:r,source:e,exec:null,broken:0,triggers:null};return n&&(L.source=h(L,t)),L}function S(e){return "              ".substr(0,10-e.length)}var I=[">","<","=","+"];function k(e,t){var i=function(e,t){for(var i=e.code,n=e.source,o="",r=0,a=[],s=i.length,l=0;l<s;l+=3)switch(i[l]){case 4:o+='ctx.m["'+n.substr(i[l+1],i[l+2]).toUpperCase()+'"]';break;case 1:o+='"'+n.substr(i[l+1],i[l+2])+'"';break;case 2:o+='ctx.p("'+n.substr(i[l+1],i[l+2])+'")';break;case 6:case 7:var c=void 0,u=void 0;if(10===i[l-3]?c=l-3:12===i[l-3]&&10===i[l-6]&&(c=l-6),10===i[l+6]?u=l+6:12===i[l+6]&&10===i[l+9]&&(u=l+9),c||u){var d=c?n[i[c+1]]:null,h=u?n[i[u+1]]:null;if("&"==d||"&"==h){o+="(ctx.v("+i[l+4]+') === null ? "" : ctx.v('+i[l+4]+"))";break}if(-1!=I.indexOf(d)||-1!=I.indexOf(h)){o+="(ctx.v("+i[l+4]+") === null ? 0 : ctx.v("+i[l+4]+"))";break}}o+="ctx.v("+i[l+4]+")";break;case 8:o+="ctx.r("+i[l+4]+", "+i[l+7]+")";break;case 10:if(1===i[l+2])"&"===(f=n[i[l+1]])?o+='+""+':t&&"+"==f?o+="*1+1*":"="===f?o+="==":";"===f?o+=",":"{"===f?o+="[":"}"===f?o+="]":"%"===f?o+=("/"==a[r]?"*":"/")+"100":("("==f?(r++,a.push("+")):")"==f&&(r--,a.pop()),o+=f),"+"!=f&&"-"!=f&&"*"!=f&&"/"!=f&&"&"!=f||(a[r]=f);else if(2===i[l+2]){var f;o+="<>"===(f=n.substr(i[l+1],i[l+2]))?"!=":f;}else o+=n.substr(i[l+1],i[l+2]);break;case 11:o+=n.substr(i[l+1],i[l+2]);break;case 3:return ""}return o}(e,t);if(!i)return e.broken=3,void(e.exec=null);try{e.exec=new Function("ctx","return "+i);}catch(t){e.broken=1,e.exec=null;}}var M="#DIV/0!",P="#VALUE!",O="#NUM!",A="#N/A";function D(e){var t=new Date(e.getFullYear(),0,0),i=e.valueOf()-t.valueOf()+60*(t.getTimezoneOffset()-e.getTimezoneOffset())*1e3;return Math.floor(i/864e5)}function F(e){var t=new Date(Math.round(86400*(e-25569)*1e3));return new Date(t.getTime()+6e4*t.getTimezoneOffset())}function V(e){return 25569+(e.getTime()-6e4*e.getTimezoneOffset())/864e5}function R(e){return !(!e&&0!==e||(e*=1,isNaN(e)))&&e}function T(e){if(1===e.length){var t=e[0];return "object"==typeof t?t:[t]}for(var i=[],n=0;n<e.length;n++)i=i.concat(e[n]);return i}function L(e){return !e&&0!==e}function H(e){return "string"==typeof e?"TRUE"===e:!!e}function N(e){var t="string"==typeof e?new Date(e):F(e);if(t.getTime())return t;throw e+" is invalid date"}function j(e){var t=R(e);if("number"!=typeof t)throw e+" is not a number";return t}function $(e,t,i,n,o){var r=R(e);r<0&&8==o&&(t=null);var a,s=t?R(t):null;if("number"!=typeof r||"boolean"==typeof s)throw P;if(r<i&&(r=i),r>n&&(r=n),s<-1)throw O;s&&(s=Math.floor(+s));var l=e<0&&16===o?"FF":"";if(a=n<2147483648?(r>>>0&n-i).toString(o):(r>>>0).toString(o),s&&a.length>s)throw O;return (l+a).padStart(s,"0").toUpperCase()}function z(e,t){var i=+xe(e),n=+Ee(e),o=+xe(t),r=+Ee(t);return fe(i*o-n*r,i*r+n*o)}function B(e,t){var i=+xe(e),n=+Ee(e);return fe(i+ +xe(t),n+ +Ee(t))}function W(e){return e>0?Math.floor(e):Math.ceil(e)}function U(e){return e<0?Math.floor(e):Math.ceil(e)}function G(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var i=0,n=T(e),o=0;o<n.length;o++){var r=R(n[o]);"number"==typeof r&&(i+=r);}return i}function q(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var i=0,n=0,o=T(e),r=0;r<o.length;r++){var a=R(o[r]);"number"==typeof a&&(i+=a,n++);}return n?i/n:0}function Y(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var i=T(e),n=0,o=0,r=0;r<i.length;r++){var a=i[r],s=R(i[r]);"number"==typeof s?(n+=s,o++):(!0===a&&n++,(a||!1===a)&&o++);}return o?n/o:0}function X(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var i=0,n=T(e),o=0;o<n.length;o++){"number"==typeof R(n[o])&&i++;}return i}function K(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var i=0,n=T(e),o=0;o<n.length;o++)n[o]&&1*n[o]!=0&&i++;return i}function J(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var i=-1/0,n=T(e),o=0;o<n.length;o++){var r=R(n[o]);"number"==typeof r&&r>i&&(i=r);}return i===-1/0?0:i}function Z(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var i=1/0,n=T(e),o=0;o<n.length;o++){var r=R(n[o]);"number"==typeof r&&r<i&&(i=r);}return i===1/0?0:i}function Q(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var i=!1,n=1,o=T(e),r=0;r<o.length;r++){var a=R(o[r]);"number"==typeof a&&(i=!0,n*=a);}return i?n:null}function ee(e,t,i){for(var n=T(e),o=t?0:-1,r=i?Y.apply(void 0,e):q.apply(void 0,e),a=0,s=0;s<n.length;s++){var l=n[s],c=R(n[s]);if("number"!=typeof c){if(!i||"boolean"!=typeof l&&!l)continue;c=!0===l?1:0;}o++,a+=Math.pow(c-r,2);}return o?a/o:0}function te(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return ee(e,!1,!1)}function ie(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return ee(e,!1,!0)}function ne(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return ee(e,!0,!1)}function oe(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return ee(e,!0,!0)}function re(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Math.sqrt(te.apply(void 0,e))}function ae(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Math.sqrt(ne.apply(void 0,e))}function se(e,t){var i=R(e),n=R(t);if("number"==typeof i&&"number"==typeof n)return Math.pow(i,n)}var le={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1},ce=[];function ue(e){var t=R(e);if("number"==typeof t&&t>-1){var i=Math.floor(t);return 0===i||1===i?1:(ce[i]>0||(ce[i]=ue(i-1)*i),ce[i])}}function de(e,t){var i=R(e),n=R(t);if("number"==typeof i&&"number"==typeof n)return ue(i)/(ue(n)*ue(i-n))}var he=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];function fe(e,t,i){void 0===i&&(i="i");var n=R(e),o=R(t);if("number"!=typeof n&&"number"!=typeof o)throw O;var r="",a="";return e&&(r=e.toString()),t&&1!==t?a=t+i:1===t&&(a=i),t>0?(r?r+"+":"")+a:r+a}function pe(e,t){return void 0===t&&(t=null),$(e,t,-512,511,2)}function ve(e,t){return void 0===t&&(t=null),$(e,t,-274877906944,274877906943,16)}function ge(e,t){return void 0===t&&(t=null),$(e,t,-536870912,536870911,8)}var _e=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17];function me(e){for(var t,i=e<0,n=0,o=0,r=2/(2+(e=Math.abs(e))),a=4*r-2,s=_e.length-1;s>0;s--)t=a*n-o+_e[s],o=n,n=t;var l=r*Math.exp(-e*e+.5*(_e[0]+a*n)-o);return i?l-1:1-l}function ye(e,t){var i=R(e),n=R(t);if("number"==typeof i)return "number"==typeof n?me(n)-me(i):me(i);throw P}var be=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,1.5056327351493116e-7],we=Math.pow(2,39);function xe(e){if("string"!=typeof e)throw P;if(["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(e)>=0)return 0;var t=e.indexOf("+"),i=e.indexOf("-");0===t&&(t=e.indexOf("+",1)),0===i&&(i=e.indexOf("-",1));var n=e.substring(e.length-1,e.length),o="i"===n||"j"===n;if(t>=0||i>=0){if(!o)throw O;if(t>=0){if(isNaN(+e.substring(0,t))||isNaN(+e.substring(t+1,e.length-1)))throw O;return Number(e.substring(0,t))}if(isNaN(+e.substring(0,i))||isNaN(+e.substring(i+1,e.length-1)))throw O;return Number(e.substring(0,i))}if(o){if(isNaN(+e.substring(0,e.length-1)))throw O;return 0}if(isNaN(+e))throw O;return +e}function Ee(e){if("string"!=typeof e)throw P;if(["i","j"].indexOf(e)>=0)return 1;var t=(e=e.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),i=e.indexOf("-");0===t&&(t=e.indexOf("+",1)),0===i&&(i=e.indexOf("-",1));var n=e.substring(e.length-1,e.length),o="i"===n||"j"===n;if(t>=0||i>=0){if(!o)throw O;if(t>=0){if(isNaN(+e.substring(0,t))||isNaN(+e.substring(t+1,e.length-1)))throw O;return Number(e.substring(t+1,e.length-1))}if(isNaN(+e.substring(0,i))||isNaN(+e.substring(i+1,e.length-1)))throw O;return -Number(e.substring(i+1,e.length-1))}if(o){var r=+e.substring(0,e.length-1);if(isNaN(r))throw O;return r}if(isNaN(+e))throw O;return 0}function Ce(e){var t=+xe(e),i=+Ee(e);return fe(Math.cos(t)*Math.cosh(i),-Math.sin(t)*Math.sinh(i))}function Se(e){var t=+xe(e),i=+Ee(e);return fe(Math.cos(i)*(Math.exp(t)+Math.exp(-t))/2,Math.sin(i)*(Math.exp(t)-Math.exp(-t))/2)}function Ie(e,t){var i=+xe(e),n=+Ee(e),o=+xe(t),r=+Ee(t),a=Math.pow(o,2)+Math.pow(r,2);return fe((i*o+n*r)/a,(n*o-i*r)/a)}function ke(e){var t=+xe(e),i=+Ee(e);return fe(Math.sin(t)*Math.cosh(i),Math.cos(t)*Math.sinh(i))}function Me(e){var t=+xe(e),i=+Ee(e);return fe(Math.cos(i)*(Math.exp(t)-Math.exp(-t))/2,Math.sin(i)*(Math.exp(t)+Math.exp(-t))/2)}var Pe=Math.pow(2,29);function Oe(e,t,i){var n=R(t);if("number"!=typeof n||t<0||t>1||i&&(0===t||1===t))throw P;var o=T(e).sort((function(e,t){return e-t}));i&&(o=function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n}([0],o));var r=(o.length+(i?0:-1))*n,a=Math.floor(r);if(void 0===o[a+1])return o[a];var s=o[a+1]-o[a];return o[a]+s*(r-a)}function Ae(e,t,i){var n=R(t);if("number"!=typeof n)throw P;switch(n){case 0:if(i)throw P;return Z.apply(void 0,e);case 1:return Oe(e,.25,i);case 2:return Oe(e,.5,i);case 3:return Oe(e,.75,i);case 4:if(i)throw P;return J.apply(void 0,e);default:throw O}}function De(e,t,i,n){var o=j(e),r=j(t),a=j(i);if(1==t)return 1/a;var s=Math.exp(-Math.pow(o/a,r));return n?1-s:r/Math.pow(a,r)*Math.pow(o,r-1)*s}function Fe(e,t,i,n){void 0===n&&(n=!1);var o=j(e),r=j(t),a=j(i),s=function(e,t,i){return de(t,e)*Math.pow(i,e)*Math.pow(1-i,t-e)};if(!n)return s(o,r,a);for(var l=0,c=0;c<o+1;c++)l+=s(c,r,a);return l}function Ve(e,t,i){var n=e.filter((function(e){return "number"==typeof e})),o=t.filter((function(e){return "number"==typeof e}));if(n.length!==o.length)throw A;var r=n.length;if(0===r)throw M;for(var a=n.reduce((function(e,t){return e+t}),0)/r,s=o.reduce((function(e,t){return e+t}),0)/r,l=0,c=0;c<r;c++)l+=(n[c]-a)*(o[c]-s);return l/(i?r-1:r)}function Re(e,t){return Ve(e,t,!1)}var Te={ABS:function(e){var t=R(e);if("number"==typeof t)return Math.abs(t)},ACOS:function(e){var t=R(e);if("number"==typeof t)return Math.acos(t)},ACOSH:function(e){var t=R(e);if("number"==typeof t)return Math.acosh(t)},ACOT:function(e){var t=R(e);if("number"==typeof t)return Math.atan(1/t)},ACOTH:function(e){var t=R(e);if("number"==typeof t)return .5*Math.log((t+1)/(t-1))},ADD:function(e,t){var i=R(e),n=R(t);if("number"==typeof i&&"number"==typeof n)return i+n},ARABIC:function(e){if(!R(e)&&/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(""+e)){var t=0;return (""+e).replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,(function(e){return t+=le[e],e})),+t}},ASIN:function(e){var t=R(e);if("number"==typeof t)return Math.asin(t)},ASINH:function(e){var t=R(e);if("number"==typeof t)return Math.asinh(t)},ATAN:function(e){var t=R(e);if("number"==typeof t)return Math.atan(t)},ATAN2:function(e,t){var i=R(e),n=R(t);if("number"==typeof i&&"number"==typeof n)return Math.atan2(n,i)},ATANH:function(e){var t=R(e);if("number"==typeof t)return Math.log((1+t)/(1-t))/2},AVEDEV:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=T(e).filter((function(e){return "number"==typeof e})),n=i.length;if(0===n)throw M;var o=i.reduce((function(e,t){return e+t}),0)/n,r=i.reduce((function(e,t){return e+Math.abs(t-o)}),0);return r/n},AVERAGE:q,AVERAGEA:Y,BASE:function(e,t,i){void 0===i&&(i=0);var n=R(e),o=R(t),r=R(i);if("number"==typeof n&&"number"==typeof o&&"number"==typeof r){var a=n.toString(o);return new Array(Math.max(r+1-a.length,0)).join("0")+a.toUpperCase()}},BINOMDIST:Fe,"BINOM.INV":function(e,t,i){for(var n=j(e),o=j(t),r=j(i),a=0;a<=n;a++)if(Fe(a,n,o,!0)>=r)return a},"BINOM.DIST.RANGE":function(e,t,i,n){var o=j(e),r=j(t),a=j(i),s=R(n);"number"!=typeof s&&(s=a);for(var l=0,c=a;c<=s;c++)l+=de(o,c)*Math.pow(r,c)*Math.pow(1-r,o-c);return l},"BINOM.DIST":Fe,BITAND:function(e,t){var i=R(e),n=R(t);if("number"==typeof i&&"number"==typeof n)return i&n;throw P},BITLSHIFT:function(e,t){var i=R(e),n=R(t);if("number"==typeof i&&"number"==typeof n)return n>0?i<<n:i>>-n;throw P},BITOR:function(e,t){var i=R(e),n=R(t);if("number"==typeof i&&"number"==typeof n)return i|n;throw P},BITRSHIFT:function(e,t){var i=R(e),n=R(t);if("number"==typeof i&&"number"==typeof n)return n>0?i>>n:i<<-n;throw P},BITXOR:function(e,t){var i=R(e),n=R(t);if("number"==typeof i&&"number"==typeof n)return i^n;throw P},CEILING:function(e,t,i){void 0===t&&(t=1),void 0===i&&(i=0);var n=R(e),o=R(t),r=R(i);if("number"==typeof n&&"number"==typeof o&&"number"==typeof r)return 0===o?0:(o=Math.abs(o),n>=0?Math.ceil(n/o)*o:0===i?-1*Math.floor(Math.abs(n)/o)*o:-1*Math.ceil(Math.abs(n)/o)*o)},COMBIN:de,COMBINA:function(e,t){var i=R(e),n=R(t);if("number"==typeof i&&"number"==typeof n)return 0===i&&0===n?1:de(i+n-1,i-1)},COMPLEX:fe,CORREL:function(e,t){if(e.length!==t.length)throw A;for(var i=e.filter((function(e){return "number"==typeof e})),n=t.filter((function(e){return "number"==typeof e})),o=i.length,r=i.reduce((function(e,t){return e+t}),0)/o,a=n.reduce((function(e,t){return e+t}),0)/o,s=0,l=0,c=0,u=0;u<o;u++)s+=(i[u]-r)*(n[u]-a),l+=Math.pow(i[u]-r,2),c+=Math.pow(n[u]-a,2);var d=Math.sqrt(l*c);if(!d)throw M;return s/d},COS:function(e){var t=R(e);if("number"==typeof t)return Math.cos(t)},COSH:function(e){var t=R(e);if("number"==typeof t)return Math.cosh(t)},COT:function(e){var t=R(e);if("number"==typeof t)return 1/Math.tan(t)},COTH:function(e){var t=R(e);if("number"==typeof t){var i=Math.exp(2*t);return (i+1)/(i-1)}},COUNT:X,COUNTA:K,COUNTBLANK:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var i=0,n=T(e),o=0;o<n.length;o++)0===n[o]||n[o]||i++;return i},COVAR:Re,"COVARIANCE.P":Re,"COVARIANCE.S":function(e,t){return Ve(e,t,!0)},CSC:function(e){var t=R(e);if("number"==typeof t)return 1/Math.sin(t)},CSCH:function(e){var t=R(e);if("number"==typeof t)return 2/(Math.exp(t)-Math.exp(-t))},DEC2BIN:pe,DEC2HEX:ve,DEC2OCT:ge,DECIMAL:function(e,t){var i=R(e),n=R(t);if(!(""+i).match("/[2-9]/")&&"number"==typeof i&&"number"==typeof n&&n>1&&n<37)return parseInt(""+i,n)},DEGREES:function(e){var t=R(e);if("number"==typeof t)return 180*t/Math.PI},DELTA:function(e,t){var i=R(e),n=R(t);if("number"==typeof i||"number"==typeof i)return +(i===n);throw P},DEVSQ:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=T(e),n=[];i.forEach((function(e){"number"==typeof e&&n.push(e);}));var o=n.reduce((function(e,t){return e+t}),0)/n.length;return n.reduce((function(e,t){return e+Math.pow(t-o,2)}),0)},DIVIDE:function(e,t){var i=R(e),n=R(t);if("number"==typeof i&&"number"==typeof n&&0!==n)return i/n},EQ:function(e,t){return typeof e==typeof t&&e==t},ERF:ye,ERFC:function(e,t){var i=R(e);if("number"==typeof i)return 1-ye(i,t);throw P},EVEN:function(e){var t=R(e);if("number"==typeof t){var i=U(t);return i%2?i+Math.sign(t):i}},EXP:function(e){var t=R(e);if("number"==typeof t)return Math.exp(t);throw P},FACT:ue,FACTDOUBLE:function e(t){var i=R(t);if("number"==typeof i){var n=Math.floor(i);return n<=0?1:n*e(n-2)}},FISHER:function(e){var t=R(e);if("number"==typeof t&&t>-1&&t<1)return .5*Math.log((1+t)/(1-t));throw P},FISHERINV:function(e){var t=R(e);if("number"==typeof t){var i=Math.exp(2*t);return (i-1)/(i+1)}throw P},FLOOR:function(e,t){var i=R(e),n=R(t);if("number"==typeof i&&"number"==typeof n){var o=Math.abs(n);return i>=0?Math.floor(i/o)*o:-1*Math.ceil(Math.abs(i)/o)*o}},GAMMA:function e(t){var i=R(t);if("number"!=typeof i)throw P;if(!(Number.isInteger(i)&&i<=0)){if(i<.5)return Math.PI/(Math.sin(Math.PI*i)*e(1-i));i-=1;for(var n=be[0],o=1;o<9;o++)n+=be[o]/(i+o);var r=i+7+.5;return Math.sqrt(2*Math.PI)*Math.pow(r,i+.5)*Math.exp(-r)*n}throw O},GCD:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=T(e),n=i.length;if(!n)return 1;for(var o=i[0],r=1;"number"!=typeof o;){if(o=i[r],r>i.length)throw "The arguments should contain at least one numeric value";r++;}for(var a=o<0?-o:o;r<n;r++){var s=R(i[r]);if("number"==typeof s){for(var l=s<0?-s:s;a&&l;)a>l?a%=l:l%=a;a+=l;}}return a},GEOMEAN:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=T(e);if(i.some((function(e){return !Number.isFinite(e)||e<=0})))throw O;return Math.pow(i.reduce((function(e,t){return t*e}),1),1/i.length)},GESTEP:function(e,t){void 0===t&&(t=0);var i=R(e),n=R(t);if("number"==typeof i&&"number"==typeof n)return +(e>=t);throw P},GT:function(e,t){var i=R(e),n=R(t);if("number"==typeof i&&"number"==typeof n)return i>n},GTE:function(e,t){var i=R(e),n=R(t);if("number"==typeof i&&"number"==typeof n)return i>=n},HARMEAN:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=T(e);if(i.some((function(e){return !Number.isFinite(e)||e<=0})))throw O;var n=i.reduce((function(e,t){return e+1/t}),0);return 1/(1/i.length*n)},HEX2BIN:function(e,t){return pe(parseInt(e.toString(),16),t)},HEX2DEC:function(e,t){var i=parseInt(e.toString(),16);if(!Number.isFinite(i))throw P;var n=i>we;n&&(i=-(i-2*we));var o=t?R(t):null,r=i.toString();return (n?"-":"")+(o?r.padStart(o,"0"):r)},HEX2OCT:function(e,t){void 0===t&&(t=null);var i=parseInt(e.toString(),16);return i>we&&(i^=we),ge(i,t)},IMABS:function(e){var t=xe(e),i=Ee(e);if(!Number.isFinite(+t)||!Number.isFinite(+i))throw P;return Math.sqrt(Math.pow(+t,2)+Math.pow(+i,2))},IMAGINARY:Ee,IMCONJUGATE:function(e){return fe(+xe(e),-+Ee(e))},IMCOS:Ce,IMCOSH:Se,IMCOT:function(e){return Ie(Ce(e),ke(e))},IMCSC:function(e){return Ie("1",ke(e))},IMCSCH:function(e){return Ie("1",Me(e))},IMDIV:Ie,IMEXP:function(e){var t=+xe(e),i=+Ee(e),n=Math.exp(t);return fe(n*Math.cos(i),n*Math.sin(t))},IMLN:function(e){var t=+xe(e),i=+Ee(e);return fe(Math.log(Math.sqrt(t*t+i*i)),Math.atan(i/t))},IMPOWER:function(e,t){var i=R(t);if("number"!=typeof i)throw P;var n=+xe(e),o=+Ee(e),r=Math.sqrt(n*n+o*o),a=Math.pow(r,i),s=Math.atan(o/n);return fe(a*Math.cos(i*s),a*Math.sin(i*s))},IMPRODUCT:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(0===e.length)throw P;for(var i=e[0],n=0,o=e.slice(1);n<o.length;n++){var r=o[n];i=z(i.toString(),r.toString());}return i.toString()},IMREAL:xe,IMSEC:function(e){return Ie("1",Ce(e))},IMSECH:function(e){return Ie("1",Se(e))},IMSIN:ke,IMSINH:Me,IMSQRT:function(e){var t=+xe(e),i=+Ee(e),n=Math.sqrt(Math.sqrt(t*t+i*i)),o=Math.atan(i/t)/2;return fe(n*Math.cos(o),n*Math.sin(o))},IMSUB:function(e,t){var i=+xe(e),n=+Ee(e);return fe(i-+xe(t),n-+Ee(t))},IMSUM:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(0===e.length)throw P;for(var i=e[0],n=0,o=e.slice(1);n<o.length;n++){var r=o[n];i=B(i.toString(),r.toString());}return i.toString()},IMTAN:function(e){return Ie(ke(e),Ce(e))},INT:function(e){var t=R(e);if("number"==typeof t)return Math.floor(t)},LARGE:function(e,t){var i=R(t),n=e.sort((function(e,t){return e-t}));if("number"==typeof i&&!e.some((function(e){return "number"!=typeof R(e)})))return n[n.length-i];throw P},LN:function(e){var t=R(e);if("number"==typeof t)return Math.log(t)},LOG:function(e,t){void 0===t&&(t=10);var i=R(e),n=R(t);if("number"==typeof i&&"number"==typeof n)return Math.log(i)/Math.log(n)},LOG10:function(e){var t=R(e);if("number"==typeof t)return Math.log(t)/Math.log(10)},LT:function(e,t){var i=R(e),n=R(t);if("number"==typeof i&&"number"==typeof n)return i<n},LTE:function(e,t){var i=R(e),n=R(t);if("number"==typeof i&&"number"==typeof n)return i<=n},MAX:J,MEDIAN:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=T(e);i.sort((function(e,t){return e-t}));var n=Math.floor(i.length/2);return i.length%2?i[n]:(i[n-1]+i[n])/2},MIN:Z,MINUS:function(e,t){var i=R(e),n=R(t);if("number"==typeof i&&"number"==typeof n)return i-n},MOD:function(e,t){var i=R(e),n=R(t);if("number"==typeof i&&"number"==typeof n&&0!==n){var o=Math.abs(i%n);return t>0?o:-o}},MROUND:function(e,t){var i=R(e),n=R(t);if("number"==typeof i&&"number"==typeof n&&i*n>-1)return Math.round(i/n)*n},MULTINOMIAL:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var i=T(e),n=0,o=1,r=0;r<i.length;r++){var a=R(i[r]);"number"==typeof a&&(n+=a,o*=ue(i[r]));}return ue(n)/o},MULTIPLY:function(e,t){var i=R(e),n=R(t);if("number"==typeof i&&"number"==typeof n)return i*n},NE:function(e,t){return typeof e!=typeof t||e!=t},OCT2BIN:function(e,t){void 0===t&&(t=null);var i=parseInt(e.toString(),8);return i&Pe&&(i=-(2*Pe-i)),pe(i,t)},OCT2DEC:function(e,t){void 0===t&&(t=null);var i=t?R(t):null,n=parseInt(e.toString(),8);if(n&Pe&&(n=-(2*Pe-n)),!Number.isFinite(n)||"boolean"==typeof i)throw P;return n.toString().padStart(i||0,"0")},OCT2HEX:function(e,t){void 0===t&&(t=null);var i=parseInt(e.toString(),8);return i&Pe&&(i=-(2*Pe-i)),ve(i,t)},ODD:function(e){var t=R(e);if("number"==typeof t){var i=U(t);return i%2?i:i+Math.sign(t)}},PERCENTILE:Oe,"PERCENTILE.INC":Oe,"PERCENTILE.EXC":function(e,t){return Oe(e,t,!0)},PERMUT:function(e,t){var i=R(e),n=R(t);if("number"==typeof i&&"number"==typeof n)return ue(i)/ue(i-n);throw P},PI:function(){return Math.PI},POW:function(e,t){var i=R(e),n=R(t);if("number"==typeof i&&"number"==typeof n)return se(e,t)},POWER:se,PRODUCT:Q,QUARTILE:Ae,"QUARTILE.INC":Ae,"QUARTILE.EXC":function(e,t){return Ae(e,t,!0)},QUOTIENT:function(e,t){var i=R(e),n=R(t);if("number"==typeof i&&"number"==typeof n)return W(i/n)},RADIANS:function(e){var t=R(e);if("number"==typeof t)return t*Math.PI/180},RAND:function(){return Math.random()},RANDBETWEEN:function(e,t){var i=R(e),n=R(t);if("number"==typeof i&&"number"==typeof n)return i+Math.ceil((n-i+1)*Math.random())-1},ROMAN:function(e){var t=R(e);if("number"==typeof t){for(var i=String(t).split(""),n="",o=3;o--;)n=(he[+i.pop()+10*o]||"")+n;return new Array(+i.join("")+1).join("M")+n}},ROUND:function(e,t){var i=R(e),n=R(t)||0;if("number"==typeof i&&"number"==typeof n)return parseFloat(i.toFixed(n))},ROUNDDOWN:function(e,t){var i=R(e),n=R(t)||0;if("number"==typeof i&&"number"==typeof n)return Math.floor(i*Math.pow(10,n))/Math.pow(10,n)},ROUNDUP:function(e,t){var i=R(e),n=R(t)||0;if("number"==typeof i&&"number"==typeof n)return Math.ceil(i*Math.pow(10,n))/Math.pow(10,n)},SEC:function(e){var t=R(e);if("number"==typeof t)return 1/Math.cos(t)},SECH:function(e){var t=R(e);if("number"==typeof t)return 2/(Math.exp(t)+Math.exp(-t))},SIGN:function(e){var t=R(e);if("number"==typeof t)return 0===t?0:t/Math.abs(t);throw P},SIN:function(e){var t=R(e);if("number"==typeof t)return Math.sin(t)},SINH:function(e){var t=R(e);if("number"==typeof t)return Math.sinh(t)},SMALL:function(e,t){var i=R(t),n=e.sort((function(e,t){return e-t}));if("number"==typeof i&&!e.some((function(e){return "number"!=typeof R(e)})))return n[i-1];throw P},SQRT:function(e){var t=R(e);if("number"==typeof t&&t>=0)return Math.sqrt(t)},SQRTPI:function(e){var t=R(e);if("number"==typeof t&&t>-1)return Math.sqrt(t*Math.PI)},STDEV:re,"STDEV.S":re,"STDEV.P":ae,STDEVA:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Math.sqrt(ie.apply(void 0,e))},STDEVP:ae,STDEVPA:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Math.sqrt(oe.apply(void 0,e))},STEYX:function(e,t){if(e.length!==t.length)throw A;var i=e.filter((function(e){return "number"==typeof e})),n=t.filter((function(e){return "number"==typeof e})),o=i.length;if(2===o)throw M;for(var r=i.reduce((function(e,t){return e+t}),0)/o,a=n.reduce((function(e,t){return e+t}),0)/o,s=0,l=0,c=0,u=0;u<o;u++)s+=(i[u]-r)*(n[u]-a),l+=Math.pow(i[u]-r,2),c+=Math.pow(n[u]-a,2);if(2===c)throw M;return Math.sqrt((l-Math.pow(s,2)/c)/(o-2))},SUBTOTAL:function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];var n=R(e),o=T(t);if("number"==typeof n)switch(n){case 1:case 101:return q.apply(void 0,o);case 102:case 2:return X.apply(void 0,o);case 103:case 3:return K.apply(void 0,o);case 104:case 4:return J.apply(void 0,o);case 105:case 5:return Z.apply(void 0,o);case 106:case 6:return Q.apply(void 0,o);case 107:case 7:case 110:case 10:return;case 108:case 8:return ae.apply(void 0,o);case 109:case 9:return G.apply(void 0,o);case 111:case 11:return ne.apply(void 0,o)}},SUM:G,SUMPRODUCT:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=e[0].length;for(var n in e)if(e[n].length!==i)return;var o=0;for(n=0;n<e[0].length;n++){var r=!1,a=1;for(var s in e){var l=R(e[s][n]);"number"==typeof l&&(a*=l,r=!0);}r&&(o+=a);}return o},SUMSQ:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var i=0,n=T(e),o=0;o<n.length;o++){var r=R(n[o]);"number"==typeof r&&(i+=Math.pow(r,2));}return i},SUMX2MY2:function(e,t){if(!e.find((function(e){return "number"!=typeof R(e)}))&&!t.find((function(e){return "number"!=typeof R(e)}))){for(var i=0,n=0;n<e.length;n++)i+=e[n]*e[n]-t[n]*t[n];return i}},SUMX2PY2:function(e,t){if(!e.find((function(e){return "number"!=typeof R(e)}))&&!t.find((function(e){return "number"!=typeof R(e)}))){for(var i=0,n=0;n<e.length;n++)i+=e[n]*e[n]+t[n]*t[n];return i}},SUMXMY2:function(e,t){if(!e.find((function(e){return "number"!=typeof R(e)}))&&!t.find((function(e){return "number"!=typeof R(e)}))){for(var i=0,n=0;n<e.length;n++)i+=Math.pow(e[n]-t[n],2);return i}},TAN:function(e){var t=R(e);if("number"==typeof t)return Math.tan(t)},TANH:function(e){var t=R(e);if("number"==typeof t)return Math.tanh(t)},TRUNC:function(e){var t=R(e);if("number"==typeof t)return W(t)},VAR:te,"VAR.S":te,"VAR.P":ne,VARA:ie,VARP:ne,VARPA:oe,WEIBULL:De,"WEIBULL.DIST":De},Le=/[\0-\x1F]/g,He=Object.freeze({__proto__:null,CONCATENATE:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return T(e).join("")},LEFT:function(e,t){return L(e)?"":e.toString().substring(0,t)},MID:function(e,t,i){return L(e)?"":e.toString().substring(t,t+i)},RIGHT:function(e,t){return L(e)?"":e.toString().substring(e.length-t)},LOWER:function(e){return L(e)?"":e.toString().toLowerCase()},UPPER:function(e){return L(e)?"":e.toString().toUpperCase()},PROPER:function(e){if(L(e))return "";var t=e.toString().toLowerCase().split(" ");for(var i in e="",t)e+=(e?" ":"")+t[i].substring(0,1).toUpperCase()+t[i].substring(1);return e},TRIM:function(e){return L(e)?"":e.toString().trim()},LEN:function(e){return L(e)?0:e.toString().length},CHAR:function(e){var t=R(e);if("number"==typeof t)return String.fromCharCode(t)},CLEAN:function(e){return void 0===e&&(e=""),(""+e).replace(Le,"")},CODE:function(e){return void 0===e&&(e=""),(""+e).charCodeAt(0)},EXACT:function(e,t){return e===t},FIND:function(e,t,i){void 0===i&&(i=0);var n=R(i);if("number"==typeof n&&t)return (""+t).indexOf(""+e,n-1)+1;throw "index cannot be string"},FIXED:function(e,t,i){void 0===t&&(t=2),void 0===i&&(i=!1);var n=R(e),o=R(t);if("number"==typeof n&&"number"==typeof o){var r=n.toFixed(o);if(H(i))return ""+r;var a=(""+r).split("."),s=a[0],l=a[1];return s.replace(/\B(?=(\d{3})+(?!\d))/g,",")+"."+l}},NUMBERVALUE:function(e,t,i){if(void 0===t&&(t="."),void 0===i&&(i=","),"string"==typeof e&&"string"==typeof t&&"string"==typeof i)return Number(e.replace(t,".").replace(i,""))},REGEXEXTRACT:function(e,t){if("string"==typeof e&&"string"==typeof t){var i=e.match(new RegExp(t));return i?i[i.length>1?i.length-1:0]:null}},REGEXMATCH:function(e,t){if("string"==typeof e&&"string"==typeof t)return !!e.match(new RegExp(t))},REGEXREPLACE:function(e,t,i){if("string"==typeof e&&"string"==typeof t)return e.replace(new RegExp(t),""+i)},REPT:function(e,t){var i=R(t);if("number"==typeof i)return new Array(i+1).join(""+e)},SEARCH:function(e,t,i){void 0===i&&(i=0);var n=R(i);if("number"==typeof n){var o=(""+t).toLowerCase().indexOf((""+e).toLowerCase(),n-1)+1;if(0!==o)return o;throw "not found"}},SUBSTITUTE:function(e,t,i,n){if(!e||!t||!i&&""!==i)return ""+e;if(void 0===n)return (""+e).replace(new RegExp(""+t,"g"),""+i);for(var o=0,r=0;(""+e).indexOf(""+t,o)>0;)if(o=(""+e).indexOf(""+t,o+1),++r===n)return (""+e).substring(0,o)+i+(""+e).substring(o+(""+t).length)},T:function(e){return "string"==typeof e&&"TRUE"!==e&&"FALSE"!==e?""+e:""},JOIN:function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];var n=[];return t.forEach((function(t){"object"==typeof t?n.push(t.join(""+e)):n.push(t);})),n.join(""+e)},REPLACE:function(e,t,i,n){var o=R(t),r=R(i);if("number"==typeof o&&"number"==typeof r){var a=e.toString(),s=n.toString();return a.replace(a.substr(o-1,r),s)}},ARRAYTOTEXT:function(e,t){return t?"{"+e.map((function(e){return "string"==typeof e?'"'+e+'"':e})).join("; ")+"}":e.join("; ")}});function Ne(e){return void 0===e?null:e}function je(e,t,i,n){void 0===i&&(i=0);var o=-1;if(0===i)o=t.indexOf(e);else {var r="string"==typeof e?"":-1/0*i;1===i?t.forEach((function(t,i){t<=e&&t>r&&(r=t,o=i);})):-1===i&&t.forEach((function(t,i){t>=e&&t<r&&(r=t,o=i);}));}return o+1}var $e={LOOKUP:function(e,t,i){var n=je(e,t,1);if(0===n)throw "#N/A";return (i||t)[n-1]},HLOOKUP:function(e,t,i,n){var o=!0;void 0!==n&&(o=H(n));var r=t.$width?t.$width:t.length,a=je(e,t.slice(0,r),o?1:0);if(0===a)throw "#N/A";return Ne(t[r*((i||1)-1)+a-1])},VLOOKUP:function(e,t,i,n){var o=!0;void 0!==n&&(o=H(n));var r,a=t.$width?t.$width:1,s=t.length/a;if(1===s)r=t;else {r=[];for(var l=0;l<s;l++)r.push(t[a*l]);}var c=i,u=je(e,r,o?1:0);if(0===u)throw "#N/A";return Ne(t[a*(u-1)+(c||1)-1])},XLOOKUP:function(e,t,i,n,o,r){var a=je(e,t,o);if(0===a){if(void 0!==n)return n;throw "#N/A"}return (i||t)[a-1]},INDEX:function(e,t,i){var n=t,o=i;return Ne(e[(e.$width?e.$width:1)*(n-1)+(o||1)-1])},MATCH:function(e,t,i){var n=i;void 0===i&&(n=1);var o=je(e,t,n);if(0===o)throw "#N/A";return o},XMATCH:function(e,t,i,n){var o=je(e,t,i);if(0===o)throw "#N/A";return o}},ze=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],Be=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],We=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];function Ue(e,t){var i=N(e),n=N(t);if(i&&n)return Math.round((i.getTime()-n.getTime())/864e5)}function Ge(e){var t=N(e);if(t){t.setHours(0,0,0),t.setDate(t.getDate()+4-(t.getDay()||7));var i=new Date(t.getFullYear(),0,1);return Math.ceil(((t.getTime()-i.getTime())/864e5+1)/7)}}function qe(e,t,i,n){var o=N(e),r=N(t);if(o&&r){for(var a=void 0===i?We[1]:We[i],s=n||[],l=0;l<s.length;l++){if((v=F(s[l]))instanceof Error)throw "The "+s[l]+" is not a  number";s[l]=v;}var c=(r.getTime()-o.getTime())/864e5+1,u=Math.round(c),d=o;for(l=0;l<c;l++){var h=(new Date).getTimezoneOffset()>0?d.getUTCDay():d.getDay(),f=!1;h!==a[0]&&h!==a[1]||(f=!0);for(var p=0;p<s.length;p++){var v;if((v=s[p]).getDate()===d.getDate()&&v.getMonth()===d.getMonth()&&v.getFullYear()===d.getFullYear()){f=!0;break}}f&&u--,d.setDate(d.getDate()+1);}return u}}function Ye(e,t,i,n){var o=N(e),r=R(t);if(o&&"number"==typeof r){for(var a=void 0===i?We[1]:We[i],s=n||[],l=0;l<s.length;l++){if((h=F(s[l]))instanceof Error)throw "The "+s[l]+" is not a  number";s[l]=h;}for(var c=0;c<r;){o.setDate(o.getDate()+1);var u=o.getDay();if(u!==a[0]&&u!==a[1]){for(var d=0;d<s.length;d++){var h;if((h=s[d]).getDate()===o.getDate()&&h.getMonth()===o.getMonth()&&h.getFullYear()===o.getFullYear()){c--;break}}c++;}}return V(o)}}function Xe(e){return 1===new Date(e,1,29).getMonth()}function Ke(e,t,i){void 0===i&&(i=0);var n=N(e),o=N(t);if(n&&o){var r=n.getDate(),a=n.getMonth()+1,s=n.getFullYear(),l=o.getDate(),c=o.getMonth()+1,u=o.getFullYear(),d=365,h=u-s+1,f=(new Date(u+1,0,1).getTime()-new Date(s,0,1).getTime())/1e3/60/60/24/h;switch(i){case 0:return 31===r&&31===l?(r=30,l=30):31===r?r=30:30===r&&31===l&&(l=30),(l+30*c+360*u-(r+30*a+360*s))/360;case 1:return s===u||s+1===u&&(a>c||a===c&&r>=l)?((s===u&&Xe(s)||function(e,t){var i=e.getFullYear(),n=new Date(i,2,1);if(Xe(i)&&e<n&&t>=n)return !0;var o=t.getFullYear(),r=new Date(o,2,1);return Xe(o)&&t>=r&&e<r}(n,o)||1===c&&29===l)&&(d=366),Ue(o.toDateString(),n.toDateString())/d):Ue(o.toDateString(),n.toDateString())/f;case 2:return Ue(o.toDateString(),n.toDateString())/360;case 3:return Ue(o.toDateString(),n.toDateString())/365;case 4:return (l+30*c+360*u-(r+30*a+360*s))/360}}}var Je={DATE:function(e,t,i){return V(new Date(e,t-1,i))},TIME:function(e,t,i){var n=V(new Date(1900,0,1,e,t,i,0));return n-Math.trunc(n)},DAY:function(e){return F(e).getDate()},MONTH:function(e){return F(e).getMonth()+1},YEAR:function(e){return F(e).getFullYear()},HOUR:function(e){return F(e).getHours()},MINUTE:function(e){return F(e).getMinutes()},SECOND:function(e){return F(e).getSeconds()},NOW:function(){return V(new Date)},DATEDIF:function(e,t,i){var n=i.toLowerCase();if("d"===n)return t-e;var o=F(e),r=F(t);switch(n){case"y":return r.getFullYear()-o.getFullYear();case"m":return (s=12*(r.getFullYear()-o.getFullYear()))+r.getMonth()-o.getMonth();case"d":return Math.floor(t-e);case"md":if((l=r.getDate()-o.getDate())<0){var a=new Date(o.getFullYear(),o.getMonth()+1,0).getDate();return r.getDate()+a-o.getDate()}return l;case"ym":var s;return (s=r.getMonth()-o.getMonth())<0?12+s:s;case"yd":var l;return (l=D(r)-D(o))<0?365+l:l}},DATEVALUE:function(e){if("string"==typeof e)return V(new Date(new Date(e).toDateString()))},DAYS:Ue,DAYS360:function(e,t,i){void 0===i&&(i=0);var n=N(e),o=N(t);if(n&&o){var r=n.getMonth(),a=o.getMonth(),s=void 0,l=void 0;if(H(i))s=31===n.getDate()?30:n.getDate(),l=31===o.getDate()?30:o.getDate();else {var c=new Date(n.getFullYear(),r+1,0).getDate(),u=new Date(o.getFullYear(),a+1,0).getDate();s=n.getDate()===c?30:n.getDate(),o.getDate()===u?s<30?(a++,l=1):l=30:l=o.getDate();}return 360*(o.getFullYear()-n.getFullYear())+30*(a-r)+(l-s)}},EDATE:function(e,t){var i=N(e),n=R(t);if(i&&"number"==typeof n)return i.setMonth(i.getMonth()+n),V(i)},EOMONTH:function(e,t){var i=N(e),n=R(t);if(i&&"number"==typeof n)return V(new Date(i.getFullYear(),i.getMonth()+n+1,0))},ISOWEEKNUM:Ge,NETWORKDAYS:function(e,t,i){return qe(e,t,1,i)},"NETWORKDAYS.INTL":qe,TIMEVALUE:function(e){if("string"==typeof e){var t=e.split(" "),i=t[1],n=t[0].split(":"),o=new Date;return o.setHours(+n[0]),i&&"PM"===i.toUpperCase()&&o.setHours(o.getHours()+12),o.setMinutes(+n[1]),n[2]&&o.setSeconds(+n[2]),(3600*o.getHours()+60*o.getMinutes()+o.getSeconds())/86400}},WEEKNUM:function(e,t){void 0===t&&(t=1);var i=N(e);if(21===t)return Ge(t);var n=Be[t],o=new Date(i.getFullYear(),0,1),r=o.getDay()<n?1:0,a=o.getTime()-24*Math.abs(o.getDay()-n)*60*60*1e3;return Math.floor((i.getTime()-a)/864e5/7+1)+r},WEEKDAY:function(e,t){void 0===t&&(t=1);var i=N(e).getDay();return ze[t][i]},WORKDAY:function(e,t,i){return Ye(e,t,1,i)},"WORKDAY.INTL":Ye,YEARFRAC:Ke},Ze=Object.freeze({__proto__:null,IF:function(e,t,i){return e?t:i},AND:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var i=0;i<e.length;i++)if(!H(e[i]))return !1;return !0},NOT:function(e){return !H(e)},OR:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var i=0;i<e.length;i++)if(e[i])return !0;return !1},CHOOSE:function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];var n=R(e);if(t.length>1&&"number"==typeof n){if(t.length<n)throw "the index number is greater than the length of the array of values";if(n<=0)throw "index cannot be less than or equal to 0";return t[--n]}},FALSE:function(){return !1},TRUE:function(){return !0}}),Qe=Object.freeze({__proto__:null,ISBLANK:function(e){return L(e)},ISBINARY:function(e){return /^[01]{1,10}$/.test(""+e)},ISEVEN:function(e){var t=R(e);return "number"==typeof t&&t%2==0},ISODD:function(e){var t=R(e);return "number"==typeof t&&t%2!=0},ISNONTEXT:function(e){return "string"!=typeof e},ISNUMBER:function(e){return "number"==typeof R(e)},ISTEXT:function(e){return "string"==typeof e},N:function(e){var t=R(e);if("number"==typeof t)return t;var i=new Date(e);return i.getTime()?V(i):"TRUE"===e||!0===e?1:0}});function et(e,t,i,n,o){void 0===n&&(n=0),void 0===o&&(o=0);var r,a=j(e),s=j(t),l=j(i),c=j(n);if(0===a)r=(l+c)/s;else {var u=Math.pow(1+a,s);r=a*(l*u+c)/(u-1),1===o&&(r/=1+a);}return -r}function tt(e,t,i,n,o){void 0===n&&(n=0),void 0===o&&(o=0);var r,a=j(e),s=j(t),l=j(i),c=j(n);if(0!==a){var u=Math.pow(1+a,s);return r=c*u+l*(u-1)/a,1===o&&(r=c*u+l*(1+a)*(u-1)/a),-r}r=c+l*s;}function it(e,t,i,n,o,r){void 0===o&&(o=0),void 0===r&&(r=0);var a=j(e),s=j(i),l=j(t),c=j(n),u=et(a,s,c,j(o),r);return (1===l?1===r?0:-c:1===r?tt(a,l-2,u,c,1)-u:tt(a,l-1,u,c,0))*a}var nt=Object.freeze({__proto__:null,ACCRINT:function(e,t,i,n,o,r,a){void 0===o&&(o=0),void 0===a&&(a=0);var s=N(e),l=N(i),c=j(n),u=j(o),d=j(r),h=j(a);if(1!==d)throw "This function is only supported with frequency 1";if(-1===[0,1,2,3,4].indexOf(h))throw "Basis is "+a+". It's should be 0, 1, 2, 3 or 4";if(l<=s)throw "Settlement canot be before or equal to issue";return u*c*Ke(e,i,h)},PMT:et,FV:tt,DB:function(e,t,i,n,o){void 0===o&&(o=12);var r=j(e),a=j(t),s=j(i),l=j(n),c=j(o);if(r<0||a<0||s<0||l<0)throw "Parameters cannot be negative";if(-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(c))throw "Month is "+o+". It's should be beetwen 1 and 12";if(l>s)throw "Period cannot be greater than life";if(a>=r)return 0;for(var u=+(1-Math.pow(a/r,1/s)).toFixed(3),d=r*u*c/12,h=d,f=0,p=n===s?s-1:n,v=2;v<=p;v++)h+=f=(r-h)*u;return 1===n?d:n===s?(r-h)*u:f},DDB:function(e,t,i,n,o){void 0===o&&(o=2);var r=j(e),a=j(t),s=j(i),l=j(n),c=j(o);if(r<0||a<0||s<0||l<0||c<0)throw "Parameters cannot be negative";if(l>s)throw "Period cannot be greater than life";if(a>=r)return 0;for(var u=0,d=0,h=1;h<=n;h++)u+=d=Math.min(c/s*(r-u),r-a-u);return d},DOLLAR:function(e,t){void 0===t&&(t=2);var i=R(e),n=R(t);if("number"==typeof i&&"number"==typeof n){if(n>=0)return "$"+i.toFixed(n);var o=Math.pow(10,-n);return "$"+Math.trunc(i/o)*o}},DOLLARDE:function(e,t){var i=j(e),n=j(t);if(n<0)throw "Fraction cannot be negative";if(n>=0&&n<1)throw "Fraction cannot be zero";n=parseInt(""+n,10);var o=parseInt(""+e,10);o+=i%1*Math.pow(10,Math.ceil(Math.log(n)/Math.LN10))/n;var r=Math.pow(10,Math.ceil(Math.log(n)/Math.LN2)+1);return Math.round(o*r)/r},DOLLARFR:function(e,t){var i=j(e),n=j(t);if(n<0)throw "Fraction cannot be negative";if(n>=0&&n<1)throw "Fraction cannot be zero";return n=parseInt(""+n,10),parseInt(""+e,10)+i%1*Math.pow(10,-Math.ceil(Math.log(n)/Math.LN10))*n},EFFECT:function(e,t){var i=j(e),n=j(t);if(i<=0)throw "Rate cannot be less than or equal to zero";if(n<1)throw "Periods cannot be less than 1";return n=parseInt(""+n,10),Math.pow(1+i/n,n)-1},FVSCHEDULE:function(e,t){for(var i=j(e),n=t.map((function(e){return j(e)})),o=n.length,r=i,a=0;a<o;a++)r*=1+n[a];return r},IRR:function(e,t){void 0===t&&(t=0);for(var i=T(e).map((function(e){return j(e)})),n=j(t),o=function(e,t,i){for(var n=i+1,o=e[0],r=1;r<e.length;r++)o+=e[r]/Math.pow(n,(t[r]-t[0])/365);return o},r=function(e,t,i){for(var n=i+1,o=0,r=1;r<e.length;r++){var a=(t[r]-t[0])/365;o-=a*e[r]/Math.pow(n,a+1);}return o},a=[],s=!1,l=!1,c=0;c<i.length;c++)a[c]=0===c?0:a[c-1]+365,i[c]>0&&(s=!0),i[c]<0&&(l=!0);if(!s||!l)throw "Values should contain at least one positive value and one negative value";var u,d,h,f=n=void 0===t?.1:n,p=!0;do{u=f-(h=o(i,a,f))/r(i,a,f),d=Math.abs(u-f),f=u,p=d>1e-10&&Math.abs(h)>1e-10;}while(p);return f},IPMT:it,ISPMT:function(e,t,i,n){var o=j(e),r=j(t),a=j(i);return j(n)*o*(r/a-1)},NPV:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var i=T(e).map((function(e){return j(e)})),n=j(i[0]),o=0,r=1;r<i.length;r++)o+=i[r]/Math.pow(1+n,r);return o},NOMINAL:function(e,t){var i=j(e),n=j(t);if(i<=0)throw "Rate cannot be less then or equal to zero";if(n<1)throw "Periods cannot be less then 1";return n=parseInt(""+n,10),(Math.pow(i+1,1/n)-1)*n},NPER:function(e,t,i,n,o){void 0===n&&(n=0),void 0===o&&(o=0);var r=j(e),a=j(t),s=j(i),l=j(n),c=j(o),u=a*(1+r*c)-l*r,d=s*r+a*(1+r*c);return Math.log(u/d)/Math.log(1+r)},PDURATION:function(e,t,i){var n=j(e),o=j(t),r=j(i);if(n<=0)throw "Rate cannot be less then or equal to zero";return (Math.log(r)-Math.log(o))/Math.log(1+n)},PPMT:function(e,t,i,n,o,r){void 0===o&&(o=0),void 0===r&&(r=0);var a=j(e),s=j(t),l=j(i),c=j(n),u=j(o),d=j(r);return et(a,l,c,u,d)-it(a,s,l,c,u,d)},PV:function(e,t,i,n,o){void 0===n&&(n=0),void 0===o&&(o=0);var r=j(e),a=j(t),s=j(i),l=j(n),c=j(o);return 0===r?-s*a-l:((1-Math.pow(1+r,a))/r*s*(1+r*c)-l)/Math.pow(1+r,a)},SYD:function(e,t,i,n){var o=j(e),r=j(t),a=j(i);return (o-r)*(a-j(n)+1)*2/(a*(a+1))},TBILLPRICE:function(e,t,i){var n=N(e),o=N(t),r=j(i);if("number"==typeof r&&o>n)return 100*(1-r*Math.round((o.getTime()-n.getTime())/864e5)/360)},TBILLYIELD:function(e,t,i){var n=N(e),o=N(t),r=j(i);if("number"==typeof r&&o>n)return (100-r)/r*360/Math.round((o.getTime()-n.getTime())/864e5)}}),ot={number:Te,string:He,date:Je,other:Ze,information:Qe,financial:nt,lookup:$e},rt=r(r(r(r(r(r(r({},Te),He),Je),Ze),Qe),nt),$e),at=Math.pow(10,8);function st(e,t,i){i.add?e.has(t)||i.add(t):e.add(t);}function lt(e){if(e.keys)return Array.from(e.keys());var t=[];return e.forEach((function(e,i){return t.push(i)})),t}function ct(e){if(e.values)return e.values();var t=[];e.forEach((function(e,i){return t.push(i)}));var i=0;return {add:function(e){t.push(e);},next:function(){var e=t[i];return {done:++i>t.length,value:e}}}}var ut=function(){function e(e){var t=this;(e=e||{get:null,set:null,strict:!1})&&(this._getter=e.get,this._setter=e.set,this._strict=e.strict),this._parser=C,this._printer=k,this._parseContext={name:function(){},pageName:function(){return ""},pageObj:function(){return null},page:function(){return 0},z:0},this.$count=0,this._data=new Map,this._triggers=new Map,this._holders={},this._context={v:function(e){if(-1===e)throw new Error;var i=t._getter(e);return void 0===i?null:i},r:function(e,i){var n=s(e),o=n[0],r=n[1],a=s(i),l=a[0]-o,c=a[1]-r+1,u=[];u.$width=c;for(var d=0;d<=l;d++)for(var h=0;h<c;h++)u[d*c+h]=t._getter(e+64*h+4096*d*64);return u},m:rt,e:function(e){throw e},p:function(e){return t.getPlaceholder(e)}};}return e.prototype.setValue=function(e,t,i,n){""===t&&(t=null),this._removeTriggers(e,null),this._setter(e,t,i)&&(n||this.trigger(e));},e.prototype.clean=function(e){this._removeTriggers(e,null);},e.prototype.getValue=function(e){return this._getter(e)},e.prototype.setPlaceholder=function(e,t){var i=this;"*"===e?Object.entries(t).forEach((function(e){return i.setPlaceholder(e[0],e[1])})):(null===t?delete this._holders[e]:this._holders[e]=t,this.each((function(t,n){(function(e,t,i){for(var n=0;n<e.length;n+=3)if(2===e[n]&&t.substr(e[n+1],e[n+2])==i)return !0;return !1})(n.code,n.source,e)&&i.setMath(t,n.source,i._parseContext);})));},e.prototype.getPlaceholder=function(e){if("*"===e)return this._holders;var t=this._holders[e];return void 0===t?null:t},e.prototype.setMath=function(e,t,i,n){var o=this._generate(t,i),r=this._setMathAt(e,o);n||this._execAndTrigger(r);},e.prototype.refresh=function(e){this._execAndTrigger(e);},e.prototype.getMath=function(e){return this._data.get(e)},e.prototype.trigger=function(e,t){var i=this._triggers.get(e);if(i){var n=!t;t||(t=new Set);for(var o=0;o<i.length;o++)t.add(i[o]);n&&this.triggerSet(t);}return null},e.prototype.triggerSet=function(e){for(var t=this,i=new Map;e.size;){var n=ct(e),o=!1;e:for(var r=n.next();!r.done;r=n.next()){var a=this._data.get(r.value),s=i.get(r.value);if(!s||(1==s&&(s=this._check_for_loops(r.value,a.triggers,i)),2!=s)){var l=a.triggers;if(l)for(var c=0;c<l.length;c++)if(e.has(l[c]))continue e;this._execAndTrigger(r.value,e),s||i.set(r.value,1),e.delete(r.value),o=!0;}}if(!o)return void e.forEach((function(i){return t._errorAndTrigger(i,e)}))}},e.prototype.getStats=function(){return {math:this._data.size,trigger:this._triggers.size}},e.prototype._check_for_loops=function(e,t,i){var n=new Set;t.forEach((function(e){return n.add(e)}));for(var o=ct(n),r=o.next();!r.done;r=o.next()){if(r.value==e)return i.set(e,2),2;var a=i.get(r.value);if(a&&a>1)return i.set(e,a),a;var s=this._data.get(r.value);s&&s.triggers&&s.triggers.forEach((function(e){return st(n,e,o)}));}return i.set(e,3),3},e.prototype._setMathAt=function(e,t){if(this._removeTriggers(e,t)){if(t.triggers)if(-1===t.triggers.indexOf(e)&&3!==t.broken)for(var i=0;i<t.triggers.length;i++){var n=t.triggers[i],o=this._triggers.get(n);void 0===o&&(o=[],this._triggers.set(n,o)),o.push(e);}else t=r(r({},t),{broken:3});return this._data.set(e,t),e}},e.prototype._removeTriggers=function(e,t){var i=this._data.get(e);if(!i)return !0;if(i===t)return !1;var n=i.triggers;if(n&&3!==i.broken)for(var o=0;o<n.length;o++){var r=n[o],a=this._triggers.get(r);if(a){var s=a.filter((function(t){return t!==e}));s.length?this._triggers.set(r,s):this._triggers.delete(r);}}return this._data.delete(e),!0},e.prototype.parse=function(e,t){return this._parser(e,t||this._parseContext)},e.prototype.exec=function(e,t){var i=this._generate(e,t);return this._exec(i)},e.prototype.each=function(e){var t=this;lt(this._data).forEach((function(i){return e(i,t._data.get(i))}));},e.prototype.setLogger=function(e){this._err_handler=e;},e.prototype._setErr=function(e,t){return e.broken=2,t&&this._err_handler&&this._err_handler(t),o[e.broken]},e.prototype._exec=function(e){if(e.broken>0&&2!==e.broken)return o[e.broken];try{var t=e.exec(this._context);return e.broken=0,"number"==typeof t?isFinite(t)?Math.round(t*at)/at:this._setErr(e):t}catch(t){return this._setErr(e,t)}},e.prototype.toString=function(e,t){return h(e,t||this._parseContext)},e.prototype.regenerate=function(e,t,i){var n=this;i=r({},i||this._parseContext),lt(this._data).forEach((function(o){var r=!1,a=n._data.get(o),s=u(o);if(t&&s===e)n._removeTriggers(o,null);else {for(var l=0;l<a.code.length;l+=3)if(9===a.code[l]&&u(a.code[l+1])===e){r=!0;break}r&&(i.z=s,t?n.setMath(o,a.source,i):(a.source=h(a,i),a.code=n._parser(a.source,i).code));}}));},e.prototype.recalculate=function(e,t){var i=this;t=r({},t||this._parseContext);var n=new Set;this.each((function(o){if(e){var r=i._data.get(o);if(r.broken&&2!==r.broken)return t.z=u(o),void i.setMath(o,r.source,t)}n.add(o);})),this.triggerSet(n);},e.prototype._generate=function(e,t,i){var n=i||this._parser(e,t||this._parseContext);return this._printer(n,this._strict),n.triggers=function(e){for(var t=[],i=e.code,n=i.length,o=0;o<n;o+=3)switch(i[o]){case 7:case 6:var r=i[o+4];t.push(r);break;case 8:d(i[o+4],i[o+7],(function(e){return t.push(e)}));}if(t.length>10){var a=new Set;t=t.filter((function(e){return !a.has(e)&&(a.add(e),!0)}));}return t.length?t:null}(n),n},e.prototype._execAndTrigger=function(e,t){this.$count+=1;var i=this._data.get(e);if(i){var n=this._exec(i);this._setter(e,n,2)&&this.trigger(e,t);}},e.prototype._errorAndTrigger=function(e,t){var i=this._data.get(e),n=this._setErr(i);this._setter(e,n,2)&&this.trigger(e,t);},e.prototype.debug=function(e){console.log(function(e){for(var t=e.code,i=e.source,n="",o=t.length,r=0;r<o;r+=3){var a=t[r],s=void 0;switch(a){case 4:s="method";break;case 1:s="text";break;case 5:s="page";break;case 2:s="holder";break;case 6:s="name";break;case 7:s="arg";break;case 8:s="range";break;case 9:s="data";break;case 10:s="op";break;case 11:s="number";break;case 3:s="error";break;case 12:s="extra";}n+=9===a?"              "+t[r+1]+" x "+t[r+2]+")\n":"["+s+"]"+S(s)+i.substr(t[r+1],t[r+2])+"\n";}return n}(this.parse(e)));},e.prototype.transpose=function(e,t,i,n){var o=this;n=n||this._parseContext;var l=s(e),c=l[0],u=l[1],d=l[2],h=new Map,f=new Map,p=new Set;lt(this._data).forEach((function(e){var l=s(e),v=l[0],g=l[1],_=l[2],m=o._data.get(e),y=_===n.z?n:r(r({},n),{z:_}),b=o._transpose(m,c,u,t,i,n,y),w=e;if(_===d&&(g>=u||v>=c)&&(w=a(v>=c?v+t:v,g>=u?g+i:g,_)),m!==b||e!==w){if(f.set(e,b),_===d&&(i<0&&g>=u&&g<u-i||t<0&&v>=c&&v<c-t))return;h.set(w,b),m.broken!==b.broken&&p.add(w);}})),lt(h).forEach((function(e){return o._setMathAt(e,h.get(e))})),Array.from(f.keys()).forEach((function(e){h.has(e)||o._removeTriggers(e,null);})),t>0&&this._triggerRow(c,t,p),i>0&&this._triggerColumn(u,i,p),t<0&&this._triggerColumn(c-1,2,p),i<0&&this._triggerColumn(u-1,2,p),this.triggerSet(p);},e.prototype._triggerColumn=function(e,t,i){var n=this,o=t?e+t:e;lt(this._triggers).forEach((function(t){var r=c(t);r>=e&&r<o&&n.trigger(t,i);}));},e.prototype._triggerRow=function(e,t,i){var n=this,o=t?e+t:e;lt(this._triggers).forEach((function(t){var r=l(t);r>=e&&r<o&&n.trigger(t,i);}));},e.prototype.transposeMath=function(e,t,i,n){return "string"==typeof e&&(e=this.parse(e,n)),n=n||this._parseContext,this._transpose(e,-1,-1,t,i,n,n).source},e.prototype._transpose=function(e,t,i,n,o,r,l){for(var c=!0,u=e.code,d=!(t<0||i<0),f=0;f<u.length;f+=3)if(7===u[f]){var p=s(u[f+4]),v=p[0],g=p[1],_=p[2];if(r.z!==_)continue;var m=u[f+5];if(!d&&3==m)continue;(d||0==(1&m))&&0!==n&&v>=t&&(c&&(u=[].concat(u),c=!1),((v+=n)<t||v<0)&&(u[f]=3)),(d||0==(2&m))&&0!==o&&g>=i&&(c&&(u=[].concat(u),c=!1),((g+=o)<i||g<0)&&(u[f]=3)),c||(u[f+4]=a(v,g,_)),f+=3;}else if(8===u[f]){var y=u[f+5],b=u[f+8];if(!d&&3===y&&3===b)continue;var w=s(u[f+4]),x=w[0],E=w[1],C=(_=w[2],s(u[f+7])),S=C[0],I=C[1];if(r.z!==_)continue;0!==n&&((d||0==(1&y))&&(n>0?x>=t:x>t)&&(c&&(u=[].concat(u),c=!1),(x+=n)<0&&(u[f]=3)),(d||0==(1&b))&&S>=t&&(c&&(u=[].concat(u),c=!1),(S+=n)<x&&(u[f]=3))),0!==o&&((d||0==(2&y))&&(o>0?E>=i:E>i)&&(c&&(u=[].concat(u),c=!1),(E+=o)<0&&(u[f]=3)),(d||0==(2&b))&&I>=i&&(c&&(u=[].concat(u),c=!1),(I+=o)<E&&(u[f]=3))),c||(u[f+4]=a(x,E,_),u[f+7]=a(S,I,_)),f+=6;}if(c)return e;var k={code:u,broken:e.broken,source:e.source,triggers:null,exec:null};return k=this._parser(h(k,l),l),this._generate(k.source,l,k)},e}(),dt=function(){function e(e,t,i){this._data=[],this._id=e,this._store=t,this._meta={},this._parseContext=r(r({},i),{z:e});}return e.prototype.getMeta=function(){return this._meta},e.prototype.setMeta=function(e){this._meta=r(r({},this._meta),e);},e.prototype.getID=function(){return this._id},e.prototype.cellID=function(e,t){return a(e,t,this._id)},e.prototype.getSize=function(){var e=this._data.length,t=0;return this._data.forEach((function(e){e&&e.length>t&&(t=e.length);})),[e,t]},e.prototype.getContext=function(){return this._parseContext},e.prototype.addRow=function(e,t){this._data.splice.apply(this._data,ht(e,t)),this._store.transpose(a(e,0,this._id),t,0,this._parseContext);},e.prototype.removeRow=function(e,t){this._data.splice(e,t),this._store.transpose(a(e,0,this._id),-t,0,this._parseContext);},e.prototype.addColumn=function(e,t){var i=ht(e,t);this._data.forEach((function(e){e&&e.splice.apply(e,i);})),this._store.transpose(a(0,e,this._id),0,t,this._parseContext);},e.prototype.removeColumn=function(e,t){this._data.forEach((function(i){i&&i.splice(e,t);})),this._store.transpose(a(0,e,this._id),0,-t,this._parseContext);},e.prototype.setCell=function(e,t,i){var n=this._data[e];n||(n=this._data[e]=[]);var o=n[t];n[t]=o?r(r(r({},o),i),{value:o.value}):i,void 0!==i.value&&this.setValue(e,t,i.value);},e.prototype.setValue=function(e,t,i,n){"string"==typeof i&&i.length>1&&"="===i[0]?this._store.setMath(a(e,t,this._id),i.substr(1),this._parseContext):this._store.setValue(a(e,t,this._id),i,n);},e.prototype.getCell=function(e,t,i){var n=this._data[e],o=n?n[t]:null;return o||!i||(n||(n=this._data[e]=[]),(o=n[t])||(o=n[t]={value:""})),o},e.prototype.getValue=function(e,t,i){if(i){var n=this._store.getMath(a(e,t,this._id));if(n)return "="+n.source}var o=this.getCell(e,t,!1);return o?o.value:null},e.prototype.getRange=function(e,t,i,n){for(var o=[],r=e;r<=i;r++)for(var a=t;a<=n;a++)o.push(this.getValue(r,a,!1));return o},e.prototype.getCellRange=function(e,t,i,n){for(var o=[],r=e;r<=i;r++)for(var a=t;a<=n;a++)o.push(this.getCell(r,a));return o},e.prototype.eachCell=function(e){this._data.forEach((function(t,i){t&&t.forEach((function(t,n){t&&e(i,n,t);}));}));},e.prototype.serialize=function(e){var t=this,i=[];return this.eachCell((function(n,o,s){if(s=r({},s),e){var l=t._store.getMath(a(n,o,t.getID()));l&&(s.value="="+l.source);}i.push([n,o,s]);})),i},e.prototype.parse=function(e,t){var i=this;this._store.each((function(e){u(e)===i._id&&i._store.clean(e);})),this._data=[];var n=new Set;e.forEach((function(e){var o=e[0],s=e[1],l=e[2],c=i._data[o];c||(c=i._data[o]=[]);var u=(l=c[s]=r({},l)).value;if(u)if("string"==typeof u&&u.length>1&&"="===u[0]){var d=a(o,s,i._id),h=u.substr(1);i._store.setMath(d,h,i.getContext(),!0),n.add(d);}else t&&(l.value=null,d=a(o,s,i._id),i._store.setValue(d,u,null,!0),i._store.trigger(d,n));})),this._store.triggerSet(n);},e}();function ht(e,t){for(var i=[e,0],n=0;n<t;n++)i.push(null);return i}var ft=function(){function e(e,t,i){this._ranges=new Map,this._counter=1,this._rangeOrder=[],this._store=e,this._page=t,this._pageGetter=i;}return e.prototype.get=function(e){return this._store.getMath(this._ranges.get(e))},e.prototype.toId=function(e){return this._ranges.get(e)},e.prototype.add=function(e,t){var i=this._ranges.get(e)||this._next_id();this._store.setMath(i,t,this._page.getContext()),this._ranges.set(e,i),this._refresh(e);},e.prototype.remove=function(e){this._ranges.delete(e),this._counter=1,this._refresh(e);},e.prototype.serialize=function(){var e=this;return Array.from(this._ranges.keys()).map((function(t){return [t,e.get(t).source]}))},e.prototype.parse=function(e){var t=this;e.forEach((function(e){return t.add(e[0],e[1])}));},e.prototype._refresh=function(e){var t=this,i=e.indexOf("!"),n="";-1!==i&&(n=e.substr(0,i),e=e.substr(i+1)),this._store.each((function(i,o){if(function(e,t,i,n){for(var o=0;o<e.length;o+=3)if(6===e[o]){if(""!==i){if(5===e[o-3]&&t.substr(e[o-2],e[o-1])!==i)continue;return !0}if(t.substr(e[o+1],e[o+2])===n)return !0}return !1}(o.code,o.source,n,e)){var r=u(i);t._store.setMath(i,o.source,t._pageGetter(r).getContext());}}));},e.prototype._next_id=function(){for(;this._rangeOrder[this._counter];)this._counter++;return this._rangeOrder[this._counter]=!0,a(this._counter,0,this._page.getID())},e.prototype.renamePage=function(e,t){var i=this;e+="!",t&&(t+="!"),this._ranges.forEach((function(n,o,r){0===o.indexOf(e)&&(t?r.set(o.replace(e,t),n):i._store.clean(n),r.delete(o));}));},e}(),pt=function(){function e(e){var t=this;this._cfg=e||{strict:!1},this._pages=[],this._pageNames=[],this._pageName2ID=new Map,this._pCounter=0,this._parseContext={page:function(e){return t._pageName2ID.get(e)},pageName:function(e){return t._pageNames[e]},pageObj:function(e){return t._pages[e]},name:function(e,i,n){var o,r=e.length,a=i.substr(e[r-2],e[r-1]);if(5===e[r-6]){var s=i.substr(e[r-5],e[r-4]);o=t._ranges.toId(s+"!"+a)||t._ranges.toId(a);}else o=t._ranges.toId(n.pageName(n.z)+"!"+a)||t._ranges.toId(a);e.push(9,o||-1,0);},z:0},this._store=new ut(r(r({},this._cfg),{get:function(e){var i=s(e),n=i[0],o=i[1],r=i[2];return t._pages[r].getValue(n,o)},set:function(e,i,n){var o=s(e),r=o[0],a=o[1],l=o[2],c=t._pages[l].getCell(r,a,!0),u=2===n;if(null!=n&&2!=n||(n=c.$format||0),c.$format=n,"string"==typeof i&&1!=n&&i){var d=parseFloat(i);u&&(d=d.toString()),d==i&&(i=parseFloat(i));}return c.value!==i&&(c.value=i,!0)}}));var i=this._pages[63]=new dt(63,this._store,this._parseContext);this._ranges=new ft(this._store,i,this.getPage.bind(this));}return e.prototype.addPage=function(e){for(;this._pages[this._pCounter];)this._pCounter++;var t=this._pCounter,i=new dt(t,this._store,this._parseContext);return this._pageName2ID.set(e,t),this._pages[t]=i,this._pageNames[t]=e,i},e.prototype.renamePage=function(e,t){if(e!==t){var i=this._pageName2ID.get(e);this._pageName2ID.delete(e),this._pageName2ID.set(t,i),this._pageNames[i]=t,this._ranges.renamePage(e,t);var n=this._pages[i].getContext();this._store.regenerate(i,!1,n);}},e.prototype.removePage=function(e){var t=this._pageName2ID.get(e),i=this._pages[t].getContext();this._pageName2ID.delete(e),this._pages[t]=this._pageNames[t]=null,this._pCounter=0,this._ranges.renamePage(e,null),this._store.regenerate(t,!0,i);},e.prototype.getPage=function(e){return "string"==typeof e&&(e=this._pageName2ID.get(e)),this._pages[e]},e.prototype.getRanges=function(){return this._ranges},e.prototype.getStore=function(){return this._store},e}();t.D_COMMON=0,t.D_STRING=1,t.DataPage=dt,t.DataStore=pt,t.Store=ut,t.T_ARG=7,t.T_DATA=9,t.T_ERROR=3,t.T_METHOD=4,t.T_NAME=6,t.T_NUMBER=11,t.T_OPERATOR=10,t.T_PAGE=5,t.T_PLACEHOLDER=2,t.T_RANGE=8,t.T_SPACE=12,t.T_TEXT=1,t.addMethod=function(e,t){rt[e]=t;},t.column=c,t.fromId=s,t.methodGroups=ot,t.methods=rt,t.page=u,t.row=l,t.str2id=function(e){var t=[];return E(t,e,0),t[1]},t.str2pos=function(e){var t=[];return E(t,e,0),s(t[1]).slice(0,2)},t.str2range=function(e){var t=[];e.split(":").map((function(e){return E(t,e,0)}));var i=s(t[1]),n=i[0],o=i[1],r=s(t[4]);return [n,o,r[0],r[1]]},t.toId=a;},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(53),o=function(){function e(e,t){this.url=this._url=e,this.config=t;}return e.prototype.updateUrl=function(e,t){for(var i in void 0===t&&(t={}),this._url=this.url=e||this._url,this.url+=this.url.includes("?")?"&":"?",t)this.config[i]=t[i],this.url+=i+"="+encodeURIComponent(t[i])+"&";this.url=this.url.slice(0,-1);},e.prototype.load=function(){return n.ajax.get(this.url,null,{responseType:"text"})},e.prototype.save=function(e,t){switch(t){case"delete":return n.ajax.delete(this.url,e);case"update":return n.ajax.put(this.url,e);default:return n.ajax.post(this.url,e)}},e}();t.DataProxy=o;},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)},o=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),a=i(3),s=i(25),l=i(21),c=i(28),u=i(85),d=i(86),h=i(1);function f(e,t,i){var o=e.config,r=o.columns.filter((function(e){return !e.hidden})),a=s.calculatePositions(i.width,i.height,e._scroll,o,t),l=r.slice(a.xStart,a.xEnd),c=t.slice(a.yStart,a.yEnd),u=r.slice(0,o.leftSplit||0),d=t.slice(0,o.topSplit||0);return n(n({},o),{data:t,columns:r,scroll:e._scroll,$positions:a,headerHeight:o.$headerLevel*o.headerRowHeight,footerHeight:o.$footerLevel*o.footerRowHeight,firstColId:r[0]&&r[0].id,events:e.events,_events:e._events,currentColumns:l,currentRows:c,fixedColumns:u,fixedRows:d,sortBy:e._sortBy,sortDir:e._sortDir,content:e.content,gridId:e._uid,$renderFrom:"render"})}function p(e){if(e&&(e.tagName||(e=e._parent._container),e)){var t=e.currentStyle||window.getComputedStyle(e),i=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight)||0,n=parseFloat(t.paddingTop)+parseFloat(t.paddingBottom)||0;return {width:e.clientWidth-i,height:e.clientHeight-n}}}function v(e,t){var i=e.currentColumns,r=e.currentRows,s=e.fixedRows,l=e.fixedColumns,c=e.eventHandlers,u={},d=function(e){var n,c,u=a.locate(e,"data-dhx-id"),d=a.locate(e,"data-dhx-col-id");switch(t){case"leftSplit":n=o(s,r).find((function(e){return e.id.toString()===u})),c=l.find((function(e){return e.id===d}));break;case"topSplit":n=s.find((function(e){return (null==e?void 0:e.id.toString())===u})),c=o(l,i).find((function(e){return e.id===d}));break;default:n=r.find((function(e){return e.id.toString()===u})),c=i.find((function(e){return e.id===d}));}return {row:u?n:{},col:d?c:{}}};if(c)for(var h in c)if(c.hasOwnProperty(h)){var f=c[h];u[h]=a.eventHandler((function(e){return d(e)}),n({},f));}return u}function g(e,t){var i,o=c.getCells(e),a=e.columns,s=e.$resizing,u=e.$totalHeight,d=e.$totalWidth,f=e.leftSplit,p=e.data,g=e.$positions,_=c.getSpans(e);if(s){var m=h.findIndex(a,(function(e){return e.id===s})),y=l.getTotalWidth(a.slice(0,m))+a[m].$width;i=r.el(".dhx_grid-resize-line",{style:{top:0,left:y,height:u}});}var b=e.selection?e.selection.toHTML():null;b="string"==typeof b?r.el("div.dhx_selection",{".innerHTML":b}):b;var w,x=g,E=v(e);return r.el(".dhx_data-wrap",n({style:{height:u,width:d,"padding-left":t.x,"padding-top":t.y},role:"presentation"},E),[r.el(".dhx_grid_data"+(f?".dhx_grid_fixed_left":""),n(n({_flags:r.KEYED_LIST},c.getHandlers(x.yStart,x.xStart,e)),(w=p.length,{role:"rowgroup","aria-rowcount":w})),o),r.el(".dhx_span-spans",{role:"presentation"},_),r.el(".dhx_grid_selection",{_ref:"selection","aria-hidden":"true"},[b,i])])}function _(e,i,n){var o=n.height-t.BORDERS;return o=i?o:o-e.headerHeight,e.$footer?i?o:o-e.footerHeight:o}function m(e,i,n,o,r){void 0===n&&(n=!0),void 0===o&&(o=!1),void 0===r&&(r=!1);var s=!r&&e.$totalHeight>=i.height-e.headerRowHeight?a.getScrollbarWidth():0,c=i.width-t.BORDERS-s,u=e.columns.filter((function(e){return !e.hidden})),d=u.filter((function(t){return !t.width&&!t.$fixed&&l.isAutoWidth(e,t)})),h=l.getTotalWidth(u.filter((function(t){return t.width||t.$fixed||!l.isAutoWidth(e,t)}))),f=d.reduce((function(e,t){return e+(t.gravity||1)}),0);if(c<e.$totalWidth){var p=d.reduce((function(e,t){return e+(t.maxWidth||t.$width)}),0);d.length&&d.forEach((function(e){var t=0,i=(t=n?Math.abs(c-p)*((e.gravity||1)/f):Math.abs(c-h)*((e.gravity||1)/f))<e.minWidth,o=t>e.maxWidth;i||o?i?(h+=e.$width-t,e.$fixed=!0):o&&(e.$width=e.maxWidth,e.$fixed=!0):e.$width=t,e.$width<20&&(e.$width=20);}));}else d.forEach((function(e){var t=Math.abs(c-h)*((e.gravity||1)/f),i=t<e.minWidth,r=t>e.maxWidth;i||r?i?(h+=e.$width-t,o&&(e.$fixed=!0)):r&&(e.$width=e.maxWidth,o&&(e.$fixed=!0)):e.$width=t,e.$width<20&&(e.$width=20),!n&&e.$fixed&&delete e.$fixed;}));n&&m(e,i,!1,o,r);}t.BORDERS=2,t.getRenderConfig=f,t.getEvents=v,t.render=function(e,i,o,a,s){if(i._container||(i.config.width=1,i.config.height=1),e&&e.node&&e.node.parent&&e.node.parent.el){var h=p(e.node.parent.el);i.config.width=h.width,i.config.height=h.height;}var v=i.config;if(!v)return r.el("div");if(!v.columns.length)return r.el(".dhx_grid",{"data-dhx-widget-id":s,"data-dhx-root-id":v.rootParent,role:"empty-grid"});var y=i.data.getRawData(0,-1,null,2);v.columns.reduce((function(e,t){return t.hidden?e:t.hidden}),!0)?v.$totalHeight=0:v.$totalHeight=y.reduce((function(e,t){return e+(t.$height||0)}),0);var b=p(i._container),w={width:(v.width?v.width:b&&b.width)||0,height:(v.height?v.height:b&&b.height)||0};l.isAutoWidth(v)&&(m(v,w),v.$totalWidth=l.getTotalWidth(v.columns.filter((function(e){return !e.hidden})))),v.width=w.width,v.height=w.height;var x=f(i,y,w);x.selection=a,x.datacollection=i.data;var E,C,S,I,k=c.getShifts(x),M=l.isCssSupport("position","sticky"),P=_(x,M,w),O={wrapper:w,sticky:M,shifts:k,gridBodyHeight:P},A=d.getFixedRows(x,n(n({},O),{name:"header",position:"top"})),D=x.$footer?d.getFixedRows(x,n(n({},O),{name:"footer",position:"bottom"})):null,F=x.$totalWidth+t.BORDERS<w.width?"dhx_grid-less-width":"",V=x.$totalHeight+t.BORDERS<w.height?"dhx_grid-less-height":"";if(!e.node){var R=i.getScrollState(),T=R.x,L=R.y;r.awaitRedraw().then((function(){i.scroll(T,L);}));}return r.el(".dhx_grid.dhx_widget",n({class:(x.css||"")+(M?"":" dhx_grid_border")+(v.multiselection?" dhx_no-select--pointer":""),"data-dhx-widget-id":s,"data-dhx-root-id":v.rootParent},(E=x.data,C=v.columns,S=x.editable,I=x.multiselection,{role:"grid","aria-rowcount":E.length,"aria-colcount":C.filter((function(e){return !e.hidden})).length,"aria-readonly":S?"false":"true","aria-multiselectable":I?"true":"false"})),[r.resizer((function(e){return l.isAutoWidth(i.config)&&e&&(v.$totalWidth=0,m(v,w,!0,!0)),i.paint()})),r.el(".dhx_grid-content",{style:n({},w),onclick:o.onclick,onmouseover:o.onmouseover,class:(F+" "+V).trim(),role:"presentation"},[M?null:A,r.el(".dhx_grid-body",{style:{height:P,width:w.width-t.BORDERS},onscroll:o.onscroll,_ref:"grid_body",role:"presentation"},[r.el("div",{},[M?A:null,g(x,k),M?D:null])]),u.getFixedColsHeader(x,O),u.getFixedCols(x,O),d.getFixedDataRows(x,O),M?null:D])])},t.proRender=function(e,i,o,a,s){if(i._container||(i.config.width=1,i.config.height=1),e&&e.node&&e.node.parent&&e.node.parent.el){var h=p(e.node.parent.el);i.config.width=h.width,i.config.height=h.height;}var v=i.config;if(!v)return r.el("div");if(!v.columns.length)return r.el(".dhx_grid",{"data-dhx-widget-id":s,"data-dhx-root-id":v.rootParent,role:"empty-grid"});var y=i.data.getRawData(0,-1,null,2);v.columns.reduce((function(e,t){return t.hidden?e:t.hidden}),!0)?v.$totalHeight=0:v.$totalHeight=y.reduce((function(e,t){return e+(t.$height||0)}),0);var b=p(i._container),w={width:(v.width?v.width:b&&b.width)||0,height:(v.height?v.height:b&&b.height)||0};l.isAutoWidth(v)&&(m(v,w,!0,!1,i.scrollView&&i.scrollView.config.enable),v.$totalWidth=l.getTotalWidth(v.columns.filter((function(e){return !e.hidden})))),v.width=w.width,v.height=w.height;var x=f(i,y,w);x.selection=a,x.datacollection=i.data;var E=c.getShifts(x),C=l.isCssSupport("position","sticky"),S=_(x,C,w),I={wrapper:w,sticky:C,shifts:E,gridBodyHeight:S},k=d.getFixedRows(x,n(n({},I),{name:"header",position:"top"})),M=x.$footer?d.getFixedRows(x,n(n({},I),{name:"footer",position:"bottom"})):null,P=x.$totalWidth+t.BORDERS<w.width?"dhx_grid-less-width":"",O=x.$totalHeight+t.BORDERS<w.height?"dhx_grid-less-height":"";if(!e.node){var A=i.getScrollState(),D=A.x,F=A.y;r.awaitRedraw().then((function(){i.scroll(D,F);}));}var V=r.el("div",{},[C?k:null,g(x,E),C?M:null]);return r.el(".dhx_grid.dhx_widget",{class:(x.css||"")+(C?"":" dhx_grid_border")+(v.multiselection?" dhx_no-select--pointer":""),"data-dhx-widget-id":s,"data-dhx-root-id":v.rootParent,role:"grid","aria-rowcount":x.data.length,"aria-colcount":v.columns.filter((function(e){return !e.hidden})).length},[r.resizer((function(e){return l.isAutoWidth(i.config)&&e&&(v.$totalWidth=0,m(v,w,!0,!0)),i.paint()})),r.el(".dhx_grid-content",{style:n({},w),onclick:o.onclick,onmouseover:o.onmouseover,class:(P+" "+O).trim(),role:"presentation"},[C?null:k,r.el(".dhx_grid-body",{style:{height:S,width:w.width-t.BORDERS},onscroll:o.onscroll,_ref:"grid_body",role:"presentation"},[i.scrollView&&i.scrollView.config.enable?i.scrollView.render([V]):V]),u.getFixedColsHeader(x,I),u.getFixedCols(x,I),d.getFixedDataRows(x,I),C?null:M])])};},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(1),o=i(0),r=i(3);t.scrollViewConfig={enable:!1,autoHide:!0,timeout:1e3,scrollHandler:function(){}};var a=function(){function e(e,i){var o,a=this;void 0===i&&(i={}),this.config=n.extend({enable:t.scrollViewConfig.enable,autoHide:t.scrollViewConfig.autoHide,timeout:t.scrollViewConfig.timeout,scrollHandler:t.scrollViewConfig.scrollHandler},i),this._wheelName=r.isIE()?"onmousewheel":"onwheel",this._getRootView=e,this._scrollYTop=this._scrollXLeft=this._runnerYTop=this._runnerXLeft=this._runnerHeight=this._runnerWidth=0,this._visibleYArea=this._visibleXArea=1,this._scrollWidth=r.getScrollbarWidth(),this._scrollHeight=r.getScrollbarHeight(),this._handlers=((o={onscroll:function(e){a.config.scrollHandler(e),a.update();}})[this._wheelName]=function(e){var t=!!r.locateNodeByClassName(e.target,"y-scroll");e.preventDefault();var i=40*((e.deltaY||-e.wheelDelta)>0?1:-1),n=a._getRefs().area;if(t){var o=n.scrollHeight-a._runnerHeight,s=a._scrollYTop+i;n.scrollTop=s<0?0:s>o?o:s;}else {var l=n.scrollWidth-a._runnerWidth,c=a._scrollXLeft+i;n.scrollLeft=c<0?0:c>l?l:c;}a.update();},o.onmousedownRunner=function(e){e.preventDefault();var t=!!r.locateNodeByClassName(e.target,"y-scroll"),i=a._getRefs(),n=i.area,o=i.runnerY,s=i.runnerX,l=n.getBoundingClientRect(),c=l.top+window.pageYOffset,u=l.bottom+window.pageYOffset,d=n.scrollHeight-a._runnerHeight,h=e.pageY-o.getBoundingClientRect().top-window.pageYOffset,f=l.left+window.pageXOffset,p=l.right+window.pageXOffset,v=n.scrollWidth-a._runnerWidth,g=e.pageX-s.getBoundingClientRect().left-window.pageXOffset,_=function(e){if(t){var i=e.pageY-h;n.scrollTop=i<=c?0:i>u?d:(i-c)/a._visibleYArea;}else {var o=e.pageX-g;n.scrollLeft=o<=f?0:o>p?v:(o-f)/a._visibleXArea;}a.update();},m=function(){document.removeEventListener("mousemove",_),document.removeEventListener("mouseup",m),document.body.classList.remove("dhx-no-select");};document.body.classList.add("dhx-no-select"),document.addEventListener("mousemove",_),document.addEventListener("mouseup",m);},o.onmousedownArea=function(e){if(!r.locateNodeByClassName(e,"scroll-runner")){e.preventDefault();var t=!!r.locateNodeByClassName(e.target,"y-scroll"),i=a._getRefs(),n=i.area,o=i.runnerY,s=i.runnerX;t?n.scrollTop+=(e.pageY-o.getBoundingClientRect().top)/a._visibleYArea:n.scrollLeft+=(e.pageX-s.getBoundingClientRect().left)/a._visibleXArea,a.update();}},o.onmouseenter=function(e){if(!r.locateNodeByClassName(e,"scroll-runner")){var t=a._getRefs();if(t){var i=!!r.locateNodeByClassName(e.target,"y-scroll"),n=t.areaX,o=t.areaY;i&&a._runnerHeight>0?o.style.background="#eee":!i&&a._runnerWidth>0&&(n.style.background="#eee");}}},o.onmouseleave=function(e){if(!r.locateNodeByClassName(e,"scroll-runner")){var t=a._getRefs();if(t){var i=!!r.locateNodeByClassName(e.target,"y-scroll"),n=t.areaX,o=t.areaY;i&&a._runnerHeight>0?o.style.background="transparent":!i&&a._runnerWidth>0&&(n.style.background="transparent");}}},o);}return e.prototype.enable=function(){this.config.enable=!0,this._getRootView().redraw();},e.prototype.disable=function(){this.config.enable=!1,this._getRootView().redraw();},e.prototype.render=function(e,t){var i,n,r=this;if(void 0===t&&(t=""),!this.config.enable||!e.length)return e;t&&(this._uid=t);var a=this.config.enable?[o.el(".y-scroll",(i={},i[this._wheelName]=this._handlers[this._wheelName],i._ref=t?"scroll-y-area-"+t:"scroll-y-area",i.onmousedown=this._handlers.onmousedownArea,i.onmouseenter=this._handlers.onmouseenter,i.onmouseleave=this._handlers.onmouseleave,i.style={width:"6px",height:"100%",right:0,top:0,position:"absolute"},i),[o.el(".scroll-runner",{_ref:t?"scroll-y-runner-"+t:"scroll-y-runner",onmousedown:this._handlers.onmousedownRunner,style:{height:this._runnerHeight+"px",top:this._runnerYTop}})]),o.el(".x-scroll",(n={},n[this._wheelName]=this._handlers[this._wheelName],n._ref=t?"scroll-x-area-"+t:"scroll-x-area",n.onmousedown=this._handlers.onmousedownArea,n.onmouseenter=this._handlers.onmouseenter,n.onmouseleave=this._handlers.onmouseleave,n.style={width:"100%",height:"6px",left:0,bottom:0,position:"absolute"},n),[o.el(".scroll-runner",{_ref:t?"scroll-x-runner-"+t:"scroll-x-runner",onmousedown:this._handlers.onmousedownRunner,style:{width:this._runnerWidth+"px",left:this._runnerXLeft}})])]:null;return o.el(".scroll-view-wrapper",[o.el(".scroll-view",{onscroll:this._handlers.onscroll,_ref:t?"scroll-view-"+t:"scroll-view",_hooks:{didInsert:function(){r.update();},didRecycle:function(){r.update();}},style:{width:"calc(100% + "+this._scrollWidth+"px)",height:"calc(100% + "+this._scrollHeight+"px)"}},e)].concat(a))},e.prototype.update=function(){var e=this._getRefs();if(e){var t=e.area,i=e.areaX,o=e.areaY,r=e.runnerY,a=e.runnerX;this._visibleYArea=t.clientHeight/t.scrollHeight,this._visibleXArea=t.clientWidth/t.scrollWidth,this._scrollYTop=t.scrollTop,this._scrollXLeft=t.scrollLeft,this._runnerYTop=this._scrollYTop*this._visibleYArea,this._runnerXLeft=this._scrollXLeft*this._visibleXArea,this._runnerHeight=this._visibleYArea<1?t.clientHeight*this._visibleYArea:0,this._runnerWidth=this._visibleXArea<1?t.clientWidth*this._visibleXArea:0;var s=r.style.top,l=a.style.left;r.style.opacity=1,r.style.top=this._runnerYTop+"px",r.style.height=this._runnerHeight+"px",a.style.opacity=1,a.style.left=this._runnerXLeft+"px",a.style.width=this._runnerWidth+"px",s!==r.style.top&&(o.style.opacity=.9,o.style.width="10px"),l!==a.style.left&&(i.style.opacity=.9,i.style.height="10px"),this.config.autoHide?!this._autoHideFunc&&(this._autoHideFunc=n.debounce((function(){r.style.opacity=0,o.style.width="6px",a.style.opacity=0,i.style.height="6px";}),this.config.timeout)):this._autoHideFunc=n.debounce((function(){o.style.width="6px",i.style.height="6px";}),this.config.timeout),this._autoHideFunc();}},e.prototype._getRefs=function(){var e=this._getRootView(),t=!(!e.refs["scroll-view"]||!e.refs["scroll-x-runner"]&&!e.refs["scroll-y-runner"]),i=!(!this._uid||!e.refs["scroll-view-"+this._uid]||!e.refs["scroll-x-runner-"+this._uid]&&!e.refs["scroll-y-runner-"+this._uid]);if(e.refs){if(t)return {area:e.refs["scroll-view"].el,areaY:e.refs["scroll-y-area"].el,areaX:e.refs["scroll-x-area"].el,runnerY:e.refs["scroll-y-runner"].el,runnerX:e.refs["scroll-x-runner"].el};if(i)return {area:e.refs["scroll-view-"+this._uid].el,areaY:e.refs["scroll-y-area-"+this._uid].el,areaX:e.refs["scroll-x-area-"+this._uid].el,runnerY:e.refs["scroll-y-runner-"+this._uid].el,runnerX:e.refs["scroll-x-runner-"+this._uid].el}}},e}();t.ScrollView=a;},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=i(0),r=i(1);t.getCount=function(e,t,i){var n={danger:" dhx_navbar-count--color_danger",secondary:" dhx_navbar-count--color_secondary",primary:" dhx_navbar-count--color_primary",success:" dhx_navbar-count--color_success"}[e.countColor]||" dhx_navbar-count--color_danger";return o.el(".dhx_navbar-count",{class:t+n+(!i&&parseInt(e.count,10)>99?" dhx_navbar-count--overlimit":"")},i&&parseInt(e.count,10)>99?"99+":e.count)},t.getIcon=function(e,t){return void 0===e&&(e=""),e.startsWith("dxi")&&(e="dxi "+e),o.el("span",{class:"dhx_"+t+"__icon "+e,"aria-hidden":"true"})};t.navbarComponentMixin=function(e,t,i,r){var a,s,l=function(e,t,i){var n="",o="";return o=(n=i?"dhx_menu-item":"dhx_"+e+"__item")+(t.css?" "+t.css:""),"spacer"!==t.type&&"separator"!==t.type||(o+=" "+n+"--"+t.type),"button"!==t.type||"sidebar"!==e||t.icon||(o+=" dhx_navbar-item--colapse_hidden"),o}(e,t,i),c="ribbon"===e&&("navItem"===t.type||"imageButton"===t.type);return o.el("li",n({_key:t.id,class:l+(t.icon&&!t.value&&c?" dhx_ribbon__item--icon":"")+(t.src&&!t.value&&c?" dhx_ribbon__item--icon":"")+(t.size&&c?" dhx_ribbon__item--"+t.size:""),".innerHTML":"customHTML"===t.type?t.html:void 0,"data-dhx-id":"customHTML"===t.type?t.id:void 0},(a=t.type,s={role:"none"},"separator"===a&&(s.role="separator",s["aria-orientation"]="vertical"),s)),"customHTML"!==t.type?[r]:void 0)},t.getNavbarButtonCSS=function(e,t){var i=e.color,n=e.size,o=e.view,a=e.full,s=e.icon,l=e.circle,c=e.loading,u=e.value,d=e.active,h=e.count;return ({danger:" dhx_button--color_danger",secondary:" dhx_button--color_secondary",primary:" dhx_button--color_primary",success:" dhx_button--color_success"}[i]||" dhx_button--color_primary")+({small:" dhx_button--size_small",medium:" dhx_button--size_medium"}[n]||" dhx_button--size_medium")+({flat:" dhx_button--view_flat",link:" dhx_button--view_link"}[o]||" dhx_button--view_flat")+(a?" dhx_button--width_full":"")+(l?" dhx_button--circle":"")+(c?" dhx_button--loading":"")+(d?" dhx_button--active":"")+(s&&!u?" dhx_button--icon":"")+(r.isDefined(h)?" dhx_button--count":"")};},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.uploadBegin="uploadbegin",e.beforeUploadFile="beforeuploadfile",e.uploadFile="uploadfile",e.uploadFail="uploadfail",e.uploadComplete="uploadcomplete",e.uploadProgress="uploadprogress";}(t.UploaderEvents||(t.UploaderEvents={})),function(e){e.cancel="cancel";}(t.ProgressBarEvents||(t.ProgressBarEvents={})),function(e){e.queue="queue",e.uploaded="uploaded",e.failed="failed",e.inprogress="inprogress";}(t.FileStatus||(t.FileStatus={})),function(e){e.grid="grid",e.list="list";}(t.VaultMode||(t.VaultMode={}));},function(e,t,i){function n(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i]);}Object.defineProperty(t,"__esModule",{value:!0}),n(i(71)),n(i(163)),n(i(11)),n(i(38));var o=i(28);t.getTreeCell=o.getTreeCell,n(i(25)),n(i(21));},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(1);t.getWidth=function(e,t,i){var n=e.filter((function(e){return !e.hidden}));return t?n.reduce((function(e,n,o){var r=n.$width;return e+=o>=i&&o<i+t?r:0}),0):n[i].$width},t.getHeight=function(e,t,i){var n=e.filter((function(e){return !e.hidden}));return t?n.reduce((function(e,n,o){var r=n.$height;return e+=o>=i&&o<i+t?r:0}),0):n[i].$height},t.getSpan=function(e,t,i){if(i.spans){var o=i.data.findIndex((function(t){return t.id.toString()===e.toString()})),r=i.columns.findIndex((function(e){return e.id.toString()===t})),a=n.findIndex(i.spans,(function(e){var t=i.data.findIndex((function(t){return t.id.toString()===e.row.toString()})),n=i.columns.findIndex((function(t){return t.id.toString()===e.column.toString()})),a=t,s=e.rowspan?t+e.rowspan:t+1,l=n,c=e.colspan?n+e.colspan:n+1;return o>=a&&o<s&&r>=l&&r<c}));return i.spans[a]}};},function(e,t,i){function n(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i]);}Object.defineProperty(t,"__esModule",{value:!0}),n(i(141)),n(i(78));},function(e,t,i){function n(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i]);}Object.defineProperty(t,"__esModule",{value:!0}),n(i(79)),n(i(158)),n(i(84));},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.beforeUnSelect="beforeunselect",e.afterUnSelect="afterunselect",e.beforeSelect="beforeselect",e.afterSelect="afterselect";}(t.SelectionEvents||(t.SelectionEvents={}));},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(13);t.DataEvents=n.DataEvents,function(e){e.inputCreated="inputCreated",e.click="click",e.openMenu="openMenu",e.beforeHide="beforeHide",e.afterHide="afterHide",e.inputFocus="inputFocus",e.inputBlur="inputBlur",e.inputChange="inputChange";}(t.NavigationBarEvents||(t.NavigationBarEvents={}));},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=i(1),r=i(5),a=i(183),s=i(184),l=i(185),c=i(186),u=i(187),d=i(188),h=i(189),f=i(190),p=i(191),v=i(192),g=i(193),_=i(194),m=i(195),y=i(196),b=i(197),w=i(198),x=i(199),E=i(200),C=i(201),S=i(2),I=i(202),k=i(203),M=i(204),P=i(205),O=i(206),A=i(207),D=i(208);t.actions={setCellStyle:y.SetCellStyle,setCellValue:b.SetCellValue,setCellFormat:m.SetCellFormat,removeCellStyles:g.RemoveCellStyles,lockCell:v.LockCell,deleteRow:u.DeleteRow,addRow:s.AddRow,deleteColumn:c.DeleteColumn,addColumn:a.AddColumn,groupAction:h.GroupAction,groupRowAction:p.GroupRowAction,groupColAction:f.GroupColAction,addSheet:l.AddSheet,deleteSheet:d.DeleteSheet,renameSheet:_.RenameSheet,clear:w.Clear,clearSheet:x.ClearSheet,resizeCol:E.ResizeCol,resizeRow:C.ResizeRow,setValidation:I.SetValidation,sortCells:k.SortCells,insertLink:M.InsertLink,fitColumn:P.FitColumn,filter:O.Filter,merge:A.Merge,unmerge:D.Unmerge};var F=function(){function e(e){this._config=e,this._actions=[],this._redoActions=[],this._sheets=[],this._redoSheets=[],this._dataStore=e.dataStore,this._events=e.events;}return e.prototype.execute=function(e,i){if(Array.isArray(e)){var a=function(e,i){var o=e.map((function(e){var o=e.groupAction||e.action;if(o)return new t.actions[o](n(n({},e),i))}));return {do:function(){o.map((function(e){return e.do()}));},undo:function(){o.map((function(e){return e.undo()}));},config:i}}(e,this._config);return a.do(),this._actions.push({command:e[0].action,action:a}),void this._sheets.push(this._config.spreadsheet.activeSheetName)}if(o.extend(i,this._config),t.actions[e]){var s=new t.actions[e](i);if(!this._events.fire(r.SpreadsheetEvents.beforeAction,[e,S.cleanActionConfig(i)]))return;s.do(),i.action===r.Actions.addSheet||i.action===r.Actions.deleteSheet||i.action===r.Actions.renameSheet?this._sheets.push(null):this._sheets.push(this._config.spreadsheet.activeSheetName),this._actions.push({command:e,action:s}),e!==r.Actions.resizeCol&&e!==r.Actions.resizeRow&&this._events.fire(r.SpreadsheetEvents.afterAction,[e,S.cleanActionConfig(i)]);}},e.prototype.undo=function(){var e=this._actions[this._actions.length-1];if(e){var t=e.command,i=e.action;if(!this._events.fire(r.SpreadsheetEvents.beforeAction,[t,S.cleanActionConfig(i.config),!0]))return;this._actions.pop(),i.undo();var n=this._sheets.pop();if(n){var o=this._dataStore.getPage(n);this._config.spreadsheet._changeSheet(o.getMeta().toolbarId);}this._redoActions.push({command:t,action:i}),this._redoSheets.push(n),t!==r.Actions.resizeCol&&t!==r.Actions.resizeRow&&this._events.fire(r.SpreadsheetEvents.afterAction,[t,S.cleanActionConfig(i.config)]);}},e.prototype.redo=function(){var e=this._redoActions[this._redoActions.length-1];if(e){var t=e.command,i=e.action;if(!this._events.fire(r.SpreadsheetEvents.beforeAction,[t,S.cleanActionConfig(i.config),!0]))return;this._redoActions.pop(),i.do();var n=this._redoSheets.pop();if(n){var o=this._dataStore.getPage(n);this._config.spreadsheet._changeSheet(o.getMeta().toolbarId);}this._actions.push({command:t,action:i}),this._sheets.push(n),t!==r.Actions.resizeCol&&t!==r.Actions.resizeRow&&this._events.fire(r.SpreadsheetEvents.afterAction,[t,S.cleanActionConfig(i.config)]);}},e}();t.ActionsManager=F;},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)},o=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var r=i(10),a=i(12),s=i(2);function l(e,t){return '<div class="dxi dxi-'+t+' dhx_toolbar-button__icon dhx_toolbar-button__colorpicker" style="border-bottom: solid 3px '+e+'"></div>'}function c(e,t){void 0===t&&(t="1500.31");var i=e.name,n=a.getFormattedValue(t,e);return '<div class="dhx_format-item"><span class="dhx_format-name">'+(r.default[i]||i)+' </span><span class="dhx_format-helper">'+n+"</span></div>"}function u(e){return {id:e.id,css:"dhx_format-name-wrap",twoState:!0,html:c(e,e.example)}}t.getColorpickerTemplate=l,t.updateToolbar=function(e,t,i,o){var c=i.getMeta(),u=c.merged,d=c.focusedCell,h=c.selectedCells;if(h&&d){var f=h.join(","),p=n({locked:!1,format:a.getFormat("common")},s.getCellInfo(d.cell,i,o)),v=[],g=!!s.getCellsArray(f,o).find((function(e){return !s.isCellSpaned(e,u)}));p.css&&(v="string"==typeof p.css?p.css.split(" "):p.css);for(var _={},m=0,y=v;m<y.length;m++){var b=y[m];_=n(n({},_),dhx.css.get(b));}var w=n({color:"#4C4C4C",background:"#FFF","text-align":"left","vertical-align":"center","font-style":"","font-weight":"","text-decoration":"",multiline:"clip"},_),x=r.default[g?"merge":"unmerge"],E="dxi dxi-table-"+(g?"merge":"split")+"-cell"+(g?"s":"");e.data.update("merge",{active:!g,icon:E,tooltip:x}),t.data.update("merge",{value:x,tooltip:x}),function(i){var n=function(n){switch(n){case"color":e.data.update(n,{html:l(i[n]||"#4C4C4C","format-color-text")});break;case"background":case"background-color":e.data.update("background",{html:l(i[n]||"#FFF","format-color-fill")});break;case"text-align":var o="halign-"+i[n];if(!e.data.exists("halign")||!e.data.exists(o))return {value:void 0};e.data.update("halign",{icon:e.data.getItem(o).icon});var r={};e.data.getItem("halign").items.forEach((function(e){r[e.id]=!1,t.data.update(e.id,{active:e.id===o});})),r[o]=!0,e.setState(r);break;case"vertical-align":var a="valign-"+i[n];if(!e.data.exists("valign")||!e.data.exists(a))return {value:void 0};var s={};e.data.getItem("valign").items.forEach((function(e){s[e.id]=!1,t.data.update(e.id,{active:e.id===a});})),s[a]=!0,e.setState(s),e.data.update("valign",{icon:e.data.getItem(a).icon});break;case"multiline":if(!e.data.exists("multiline"))return {value:void 0};var c="multiline-"+i[n],u={};e.data.getItem("multiline").items.forEach((function(e){u[e.id]=!1,t.data.update(e.id,{active:e.id===c});})),u[c]=!0,e.setState(u),e.data.update("multiline",{icon:e.data.getItem(c).icon});break;case"font-weight":e.data.update("font-weight-bold",{active:"bold"==i[n]||"700"==i[n]}),t.data.update("font-weight-bold",{active:"bold"==i[n]||"700"==i[n]});break;case"font-style":e.data.update("font-style-italic",{active:"italic"===i[n]}),t.data.update("font-style-italic",{active:"italic"===i[n]});break;case"text-decoration":var d={active:i[n].includes("underline")};e.data.update("text-decoration-underline",d),t.data.update("text-decoration-underline",d);var h={active:i[n].includes("line-through")};e.data.update("text-decoration-line-through",h),t.data.update("text-decoration-line-through",h);}};for(var o in i){var r=n(o);if("object"==typeof r)return r.value}}(w);var C=e.data.getItem("format");C&&C.items.map((function(e){return e.active=!1}));var S=function(i){switch(i){case"locked":e.data.getItem("lock")&&e.data.update("lock",{active:p[i]});break;case"format":var n=a.getDefaultFormatsMap()[p[i].mask]||"common",o=e.data.getItem(n);e.data.getItem("format")&&e.data.update("format",{value:o?a.getFormat(n).name:e.data.getItem("custom_format").value}),o&&e.data.update(n,{active:!0}),e.data.update("custom_format",{hidden:!!o,active:!o}),t.data.getItems("format").forEach((function(e){t.data.update(e.id,{active:n===e.id});}));}};for(var I in p)S(I);for(var I in i)if("filter"===I)e.data.getItem("filter")&&e.data.update("filter",{active:i[I]});}},t.getToggledValue=function(e,t,i,o,r){var a=s.getCellInfo(t,e,r),l=[];a.css&&(l="string"==typeof a.css?a.css.split(" "):a.css);for(var c={},u=0,d=l;u<d.length;u++){var h=d[u];c=n(n({},c),dhx.css.get(h));}var f=c[i],p=f&&"none"!==f?f:"",v=p.includes(o)?p.split(o).join(""):p+" "+o;return "text-decoration"!==i||v||(v="none"),v.trim()},t.getFormatItem=c,t.getFormatsDropdown=function(e){var t=e.formats;return o(t.map((function(e){return u(e)})),[{id:"custom_format",css:"dhx_format-name-wrap",twoState:!0,hidden:!0,value:r.default.custom}])},t.normalizeToolbarFormat=u;},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.resize="resize",e.headerDoubleClick="headerdoubleclick",e.move="move",e.afterShow="aftershow",e.afterHide="afterhide",e.beforeShow="beforeshow",e.beforeHide="beforehide";}(t.WindowEvents||(t.WindowEvents={}));},function(e,t,i){function n(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i]);}Object.defineProperty(t,"__esModule",{value:!0}),n(i(88)),n(i(225));},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);}),r=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var a=i(0),s=i(1),l=i(9),c=i(19),u=i(4),d=i(6),h=function(e){function t(t,i){void 0===i&&(i={});var n=e.call(this,null,i)||this;return n.events=new u.EventSystem,n._propsItem=["inputType","required","validation","icon","placeholder","autocomplete","readOnly","maxlength","minlength","min","max","step","label","labelWidth","labelPosition","hiddenLabel","helpMessage","preMessage","successMessage","errorMessage"],n._props=r(l.baseProps,n._propsItem),n._isValid=!0,n._initView(i),n._initHandlers(),n}return o(t,e),t.prototype.destructor=function(){this.events&&this.events.clear(),this.events=this._uid=this._isValid=this._propsItem=this._propsItem=null,e.prototype._destructor.call(this),this.unmount();},t.prototype.setProperties=function(e){if(e&&!s.isEmptyObj(e)&&this.events.fire(d.ItemEvent.beforeChangeProperties,[this.getProperties()])){for(var t in e)this._props.includes(t)&&(this.config[t]=e[t]);this.events.fire(d.ItemEvent.afterChangeProperties,[this.getProperties()]),this.paint();}},t.prototype.getProperties=function(){for(var e={},t=0,i=this._props;t<i.length;t++){var n=i[t];e[n]=this.config[n];}return e},t.prototype.show=function(){var e=this.config,t=e.value;e.hidden&&this.events.fire(d.ItemEvent.beforeShow,[t])&&(this.config.hidden=!1,this.events.fire(d.ItemEvent.afterShow,[t]));},t.prototype.hide=function(e){var t=this.config,i=t.value;t.hidden&&!e||!this.events.fire(d.ItemEvent.beforeHide,[i,e])||(this.config.hidden=!0,this.events.fire(d.ItemEvent.afterHide,[i,e]));},t.prototype.isVisible=function(){return !this.config.hidden},t.prototype.disable=function(){this.config.disabled=!0,this.paint();},t.prototype.enable=function(){this.config.disabled=!1,this.paint();},t.prototype.isDisabled=function(){return this.config.disabled},t.prototype.validate=function(e,t){void 0===e&&(e=!1);var i=void 0===t?this.getValue():t;if(e||this.events.fire(d.ItemEvent.beforeValidate,[i]))return this._isValid=this.config.validation?l.validateInput(i,this.config.validation):this.config.required?!(!l.baseInputValidate(i,this.config)||!String(i).trim().length):l.baseInputValidate(i,this.config),e||(this.config.$validationStatus=this._isValid?d.ValidationStatus.success:d.ValidationStatus.error,this.events.fire(d.ItemEvent.afterValidate,[i,this._isValid])),this._isValid},t.prototype.clearValidate=function(){this.config.$validationStatus=d.ValidationStatus.pre,this.paint();},t.prototype.clear=function(){""!==this.config.value&&(this.config.value="",this.events.fire(d.ItemEvent.change,[this.getValue()]));},t.prototype.setValue=function(e){void 0!==e&&this.config.value!==e&&(this.config.value=e,this.events.fire(d.ItemEvent.change,[this.getValue()]),l.isVerify(this.config)&&this.validate());},t.prototype.getValue=function(){var e=this.config,t=e.inputType,i=e.value;return "number"===t&&"number"==typeof i||null===i?i:"number"===t&&"string"==typeof i?i.length?Number(i):"":"string"==typeof i?i.length?i:"":void 0===i?"":String(i)},t.prototype.focus=function(){var e=this;a.awaitRedraw().then((function(){e.getRootView().refs.input.el.focus();}));},t.prototype.blur=function(){var e=this;a.awaitRedraw().then((function(){e.getRootView().refs.input.el.blur();}));},t.prototype._initView=function(e){var t=this;if(s.isEmptyObj(e))throw new Error("Check the configuration is correct");for(var i in this.config={type:"input",id:e.id,name:e.name,disabled:!1,hidden:!1,inputType:"text",required:!1,icon:"",placeholder:"",autocomplete:!1,readOnly:!1,label:"",labelWidth:"",labelPosition:"top",hiddenLabel:!1,helpMessage:"",preMessage:"",successMessage:"",errorMessage:"",width:"content",height:"content"},e)"id"!==i&&"type"!==i&&"name"!==i&&(this.config[i]=e[i]);this.config.hidden&&a.awaitRedraw().then((function(){t.hide(!0);})),this.paint();},t.prototype._initHandlers=function(){var e=this;this.events.on(d.ItemEvent.change,(function(){return e.paint()})),this.events.on(d.ItemEvent.afterValidate,(function(){e.config.$validationStatus=e._isValid?d.ValidationStatus.success:d.ValidationStatus.error,e.paint();}));},t.prototype._getHandlers=function(){var e=this;return {oninput:function(t){var i=t.target.value;e.config.value=i,e.events.fire(d.ItemEvent.input,[i]);},onchange:function(t){var i=t.target.value;e.config.value=i,e.events.fire(d.ItemEvent.change,[e.getValue()]),l.isVerify(e.config)&&e.validate(),e.paint();},onfocus:function(){e.events.fire(d.ItemEvent.focus,[e.getValue()]),e.paint();},onblur:function(){e._uid&&(e.events.fire(d.ItemEvent.blur,[e.getValue()]),e.paint());},onkeydown:function(t){"Enter"===t.code&&"input"===e.config.type&&t.preventDefault(),e.events.fire(d.ItemEvent.keydown,[t]);}}},t.prototype._draw=function(){var e,t,i,n=this.config,o=n.id,r=n.value,c=n.disabled,u=n.name,d=n.icon,h=n.placeholder,f=n.required,p=n.inputType,v=n.hidden,g=n.autocomplete,_=n.readOnly,m=n.maxlength,y=n.minlength,b=n.max,w=n.min,x=n.label,E=n.helpMessage,C=v?" dhx_form-group--hidden":"",S=(null===(i=null===(t=null===(e=this.getRootView())||void 0===e?void 0:e.refs)||void 0===t?void 0:t.input)||void 0===i?void 0:i.el)===document.activeElement;return a.el("div.dhx_form-group",{class:l.getFormItemCss(this.config,l.isVerify(this.config),S)+C},[this._drawLabel(),a.el(".dhx_input__wrapper",{},[a.el("div.dhx_input__container",{},[this.config.icon?a.el(".dhx_input__icon",{class:this.config.icon}):null,a.el("input.dhx_input",{type:["text","number","password"].includes(p)?p:"text","data-dhx-id":u||o,id:o||this._uid,placeholder:h||"",value:s.isDefined(r)?r:"",name:u||"",disabled:c,required:f,readOnly:_,maxlength:m,minlength:y,max:b,min:w,onblur:this._handlers.onblur,oninput:this._handlers.oninput,onchange:this._handlers.onchange,onfocus:this._handlers.onfocus,onkeydown:this._handlers.onkeydown,class:d?"dhx_input--icon-padding":"",autocomplete:g?"on":"off",_ref:"input","aria-label":x||E||"type "+(u||p||"text"),"aria-describedby":E?"dhx_label__help_"+(o||this._uid):null})]),l.getValidationMessage(this.config)&&a.el("span.dhx_input__caption",l.getValidationMessage(this.config))])])},t}(c.Label);t.Input=h;},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});t.default={dragAndDrop:"Drag & drop",or:"or",grid:"Grid",list:"List",browse:"Browse files",filesOrFoldersHere:"files or folders here",cancel:"Cancel",clearAll:"Clear all",clearAllSelected:"Clear selected",clear:"Clear",add:"Add",upload:"Upload",download:"Download",error:"error",byte:"B",kilobyte:"KB",megabyte:"MB",gigabyte:"GB"};},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.left="left",e.right="right",e.top="top",e.bottom="bottom",e.center="center";}(t.RealPosition||(t.RealPosition={})),function(e){e.right="right",e.bottom="bottom",e.center="center",e.left="left",e.top="top";}(t.Position||(t.Position={})),function(e){e.topLeft="top-left",e.topRight="top-right",e.bottomLeft="bottom-left",e.bottomRight="bottom-right";}(t.MessageContainerPosition||(t.MessageContainerPosition={}));},function(e,t){var i,n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};i=function(){return this}();try{i=i||new Function("return this")();}catch(e){"object"===("undefined"==typeof window?"undefined":n(window))&&(i=window);}e.exports=i;},function(e,t,i){function n(e){e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(e,t,i,n){return t+t+i+i+n+n}));var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}function o(e){var t,i,n=e.r/255,o=e.g/255,r=e.b/255,a=Math.max(n,o,r),s=a-Math.min(n,o,r),l=function(e){return (a-e)/6/s+.5};if(0===s)t=i=0;else {i=s/a;var c=l(n),u=l(o),d=l(r);n===a?t=d-u:o===a?t=1/3+c-d:r===a&&(t=2/3+u-c),t<0?t+=1:t>1&&(t-=1);}return {h:Math.floor(360*t),s:i,v:a}}Object.defineProperty(t,"__esModule",{value:!0}),t.HSVtoRGB=function(e){var t={r:0,g:0,b:0},i=e.h/60,n=e.s,o=e.v,r=Math.floor(i)%6,a=i-Math.floor(i),s=255*o*(1-n),l=255*o*(1-n*a),c=255*o*(1-n*(1-a));switch(o*=255,r){case 0:t.r=o,t.g=c,t.b=s;break;case 1:t.r=l,t.g=o,t.b=s;break;case 2:t.r=s,t.g=o,t.b=c;break;case 3:t.r=s,t.g=l,t.b=o;break;case 4:t.r=c,t.g=s,t.b=o;break;case 5:t.r=o,t.g=s,t.b=l;}for(var u in t)t[u]=Math.round(t[u]);return t},t.RGBToHex=function(e){return Object.keys(e).reduce((function(t,i){var n=e[i].toString(16).toUpperCase();return t+(n=1===n.length?"0"+n:n)}),"#")},t.HexToRGB=n,t.RGBToHSV=o,t.HexToHSV=function(e){return o(n(e))},t.isHex=function(e){return /(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e)};},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});t.default={cancel:"Cancel",select:"Select",rightClickToDelete:"Right click to delete",customColors:"Custom colors",addNewColor:"Add new color"};},function(e,t,i){(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=i(23),o=i(24);function r(e){return e?e.includes("json")?"json":e.includes("xml")?"xml":"text":"text"}function a(t,i,a,s,l){var c=s||{};if(l&&(c.Accept="application/"+l),"GET"!==a&&(c["Content-Type"]=c["Content-Type"]||"application/json"),"GET"===a){var u=i&&"object"==typeof i?function(e){return Object.keys(e).reduce((function(t,i){var n="object"==typeof e[i]?JSON.stringify(e[i]):e[i];return t.push(i+"="+encodeURIComponent(n)),t}),[]).join("&")}(i):i&&"string"==typeof i?i:"";u&&(t+=t.includes("?")?"&":"?",t+=u),i=null;}return window.fetch?("application/json"===c["Content-Type"]&&i&&"object"==typeof i&&(i=JSON.stringify(i)),window.fetch(t,{method:a,body:i||null,headers:c}).then((function(t){if(!t.ok)return t.text().then((function(i){return e.reject({status:t.status,statusText:t.statusText,message:i})}));var i=l||r(t.headers.get("Content-Type"));if("raw"===i)return {headers:Object.fromEntries(t.headers.entries()),url:t.url,body:t.body};if(204!==t.status)switch(i){case"json":return t.json();case"xml":var a=o.toDataDriver(n.DataDriver.xml);return a?t.text().then((function(e){return a.toJsonObject(e)})):t.text();default:return t.text()}}))):new e((function(e,s){var u=new XMLHttpRequest;for(var d in u.onload=function(){u.status>=200&&u.status<300?("raw"===l&&e({url:u.responseURL,headers:u.getAllResponseHeaders().trim().split(/[\r\n]+/).reduce((function(e,t){var i=t.split(": ");return e[i[0]]=i[1],e}),{}),body:u.response}),204===u.status?e():e(function(e,t){switch(t){case"json":return JSON.parse(e);case"text":default:return e;case"xml":var i=o.toDataDriver(n.DataDriver.xml);return i?i.toJsonObject(e):{parseError:"Incorrect data driver type: 'xml'"}}}(u.responseText,l||r(u.getResponseHeader("Content-Type"))))):s({status:u.status,statusText:u.statusText});},u.onerror=function(){s({status:u.status,statusText:u.statusText,message:u.responseText});},u.open(a,t),c)u.setRequestHeader(d,c[d]);switch(a){case"POST":case"DELETE":case"PUT":u.send(void 0!==i?JSON.stringify(i):"");break;default:u.send();}}))}t.ajax={get:function(e,t,i){return a(e,t,"GET",i&&i.headers,void 0!==i?i.responseType:void 0)},post:function(e,t,i){return a(e,t,"POST",i&&i.headers,void 0!==i?i.responseType:void 0)},put:function(e,t,i){return a(e,t,"PUT",i&&i.headers,void 0!==i?i.responseType:void 0)},delete:function(e,t,i){return a(e,t,"DELETE",i&&i.headers,void 0!==i?i.responseType:void 0)}};}).call(this,i(14));},function(e,t,i){function n(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i]);}Object.defineProperty(t,"__esModule",{value:!0}),n(i(142)),n(i(77));},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.beforeShow="beforeShow",e.afterShow="afterShow",e.beforeHide="beforeHide",e.afterHide="afterHide",e.beforeResizeStart="beforeResizeStart",e.resize="resize",e.afterResizeEnd="afterResizeEnd",e.beforeAdd="beforeAdd",e.afterAdd="afterAdd",e.beforeRemove="beforeRemove",e.afterRemove="afterRemove",e.beforeCollapse="beforeCollapse",e.afterCollapse="afterCollapse",e.beforeExpand="beforeExpand",e.afterExpand="afterExpand";}(t.LayoutEvents||(t.LayoutEvents={}));},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.click="click",e.doubleClick="doubleclick",e.focusChange="focuschange",e.beforeEditStart="beforeEditStart",e.afterEditStart="afterEditStart",e.beforeEditEnd="beforeEditEnd",e.afterEditEnd="afterEditEnd",e.itemRightClick="itemRightClick",e.itemMouseOver="itemMouseOver",e.contextmenu="contextmenu";}(t.ListEvents||(t.ListEvents={}));},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(12),o=i(2),r=i(26);function a(e,t,i){var n=o.getCellIndex(e,i),r=o.getCellIndex(t,i),a=r.col-n.col,s=r.row-n.row,l=a<0||s<0;return {x:a,y:s,isLargerByX:Math.abs(a)>Math.abs(s),negativeDir:l}}function s(e){var t=e.map((function(e){return parseFloat(e)||0})),i=t.reduce((function(e,t){return e+t}),0),n=t.length;return (i/n*2-2*t[0])/(n-1)}function l(e){for(var t=r.dateDiff(e[0],e[1]),i=1;i<e.length-1;i++)r.dateDiff(e[i],e[i+1])!==t&&(t=0,i=e.length);return t}function c(e){for(var t=r.timeDiff(e[0],e[1]),i=1;i<e.length-1;i++)r.timeDiff(e[i],e[i+1])!==t&&(t=0,i=e.length);return t}t.alphaRegex=/(\d+$)/,t.getCellsDiff=a,t.getLastCopyingCell=function(e,t,i){o.isRangeId(e)&&(e=e.split(":")[1]);var n=o.getCellIndex(e,i),r=a(e,t,i),s=r.x,l=r.y,c=r.isLargerByX,u=n.row+l,d=n.col+s,h=c?d:n.col,f=c?n.row:u;return o.getCellNameByIndex(f,h,i)},t.getProgressionStep=s,t.getDateStep=l,t.getTimeStep=c,t.isCellGreater=function(e,t,i){var n=o.getCellIndex(e,i),r=o.getCellIndex(t,i);return n.row===r.row?n.col>r.col:n.row>r.row},t.getAutoFilledCells=function(e,i,u,d,h){var f=e.filter((function(e){var t=e.value,i=e.format;return n.isNumeric(t)&&"date"!==i.id&&"time"!==i.id&&"text"!==i.id})).map((function(e){return e.value})),p=e.filter((function(e){var t=e.value,i=e.format;return n.isNumeric(t)&&"date"===i.id})).map((function(e){return r.excelDateToJSDate(e.value)})),v=e.filter((function(e){var t=e.value,i=e.format;return n.isNumeric(t)&&"time"===i.id})).map((function(e){return r.excelDateToJSDate(e.value)})),g=e.filter((function(e){var i=e.value;return !n.isNumeric(i)&&i.match(t.alphaRegex)})).map((function(e){return e.value})).map((function(e){return parseInt(e.match(t.alphaRegex)[0])})),_=p.length<2?1:l(p),m=v.length<2?36e5:c(v),y=o.getCellsArray(i,h),b=s(1===f.length?[f[0],f[0]+1]:f),w=s(1===g.length?[g[0],g[0]+1]:g),x=function(e,t){var i=o.getCellIndex(e,h),n=o.getCellIndex(t,h);return i.row===n.row?i.col>n.col:i.row>n.row},E=[],C=parseFloat(f[f.length-1]),S=p[p.length-1],I=v[v.length-1],k=g[g.length-1],M=0,P=i.split(":"),O=P[0],A=P[1],D=u.split(":"),F=D[0],V=D[1],R=a(O===F&&A?A:O,F,h).isLargerByX,T=x(O,x(F,V)?V:F);T&&(_=-_,S=p[0],m=-m,I=v[0],b=-b,C=f[f.length-1],w=-w,k=g[g.length-1]);var L=o.getCellsArray(u,h).filter((function(e){return !y.includes(e)}));T&&(L=L.reverse(),e=e.reverse());var H=L.map((function(i,a){var s,l;l=e[M].value.toString().startsWith("="),s=e[M].value;var c=e[M].span;if(c){var u=c,f=u.from,p=u.to,v=o.getCellIndex(i,h),g=i+":"+o.getCellNameByIndex(v.row+p.row-f.row,v.col+p.column-f.column,h);E.includes(g)||E.push(g);}if(l){var x=0,P=0,O=T?-1*(a+M+y.length+1):a-M+y.length;R?P=O:x=O,s=d.transposeMath(s,x,P);}if(n.isNumeric(s))switch(e[M].format.id){case"date":S=r.addDay(S,_),s=r.getExcelDateFromJs(S);break;case"time":I=r.addTime(I,m),s=r.getExcelDateFromJs(I);break;default:s=(C+=b).toFixed(5);}else s.match(t.alphaRegex)&&(k+=w,s=s.replace(t.alphaRegex,Math.abs(k)));return M=void 0!==e[M+1]?M+1:0,s}));return T&&(H=H.reverse()),{cells:L[0]+":"+L[L.length-1],value:H,spans:E}};},function(e,t,i){function n(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i]);}Object.defineProperty(t,"__esModule",{value:!0}),n(i(89)),n(i(241)),n(i(6));var o=i(6);t.FormEvents=o.FormEvents;},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);}),r=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var a=i(0),s=i(4),l=i(9),c=i(8),u=i(6),d=i(19),h=i(1),f=function(e){function t(t,i){void 0===i&&(i={});var n=e.call(this,t,i)||this;n.events=new s.EventSystem,n._isValid=!0,n._propsItem=["required","label","labelWidth","labelPosition","hiddenLabel","helpMessage","preMessage","successMessage","errorMessage","text"],n._props=r(l.baseProps,n._propsItem),n._initView(i),n._initHandlers();return n.mount(t,a.create({render:function(){return n._draw()}})),n}return o(t,e),t.prototype.setProperties=function(e,t){if(void 0===t&&(t=!1),e&&!h.isEmptyObj(e)&&(t||this.events.fire(u.ItemEvent.beforeChangeProperties,[this.getProperties()]))){for(var i in e)this._props.includes(i)&&(this.config[i]=e[i]);!t&&this.events.fire(u.ItemEvent.afterChangeProperties,[this.getProperties()]),this.paint();}},t.prototype.getProperties=function(){for(var e={},t=0,i=this._props;t<i.length;t++){var n=i[t];e[n]=this.config[n];}return e},t.prototype.show=function(){this.config.hidden&&this.events.fire(u.ItemEvent.beforeShow,[this.getValue()])&&(this.config.hidden=!1,this.events.fire(u.ItemEvent.afterShow,[this.getValue()]));},t.prototype.hide=function(e){this.config.hidden&&!e||!this.events.fire(u.ItemEvent.beforeHide,[this.getValue(),e])||(this.config.hidden=!0,this.events.fire(u.ItemEvent.afterHide,[this.getValue(),e]));},t.prototype.isVisible=function(){return !this.config.hidden},t.prototype.disable=function(){this.config.disabled=!0,this.paint();},t.prototype.enable=function(){this.config.disabled=!1,this.paint();},t.prototype.isDisabled=function(){return this.config.disabled},t.prototype.validate=function(e){if(void 0===e&&(e=!1),e||this.events.fire(u.ItemEvent.beforeValidate,[this.getValue()]))return (this.config.required||this.config.$required)&&(this._isValid=!!this.config.checked),e||(this.config.$validationStatus=this._isValid?u.ValidationStatus.success:u.ValidationStatus.error,this.events.fire(u.ItemEvent.afterValidate,[this.getValue(),this._isValid])),this._isValid},t.prototype.clearValidate=function(){this.config.$validationStatus=u.ValidationStatus.pre,this.paint();},t.prototype.setValue=function(e,t){void 0===t&&(t=!1),void 0!==e&&e!==this.config.checked&&(this.config.checked=!!e,t||(this.events.fire(u.ItemEvent.change,[this.getValue()]),l.isVerify(this.config)&&this.validate()));},t.prototype.getValue=function(){var e=this.config,t=e.value,i=e.checked;return t?i?t:"":!!i},t.prototype.clear=function(e){this.config.checked&&(this.config.checked=!1,e||this.events.fire(u.ItemEvent.change,[this.getValue()]));},t.prototype.destructor=function(){this.events&&this.events.clear(),this._inGroup=this._propsItem=this._props=this._isValid=this._uid=this.events=null,e.prototype._destructor.call(this),this.unmount();},t.prototype.focus=function(){var e=this;a.awaitRedraw().then((function(){e.getRootView().refs.input.el.focus();}));},t.prototype.blur=function(){var e=this;a.awaitRedraw().then((function(){e.getRootView().refs.input.el.blur();}));},t.prototype.isChecked=function(){return !!this.config.checked},t.prototype._initView=function(e){var t=this;if(this._inGroup=this.config.$group,this._inGroup){for(var i in this.config={type:e.type,id:e.id,text:"",width:"content",height:"content",padding:0},e)"id"!==i&&"type"!==i&&"name"!==i&&(this.config[i]=e[i]);this._handlers={onchange:function(e){t.config.checked=e.target.checked,t.events.fire(u.ItemEvent.change,[t.getValue()]),l.isVerify(t.config)&&t.validate();},onfocus:function(){return t.events.fire(u.ItemEvent.focus,[t.getValue(),t.config.id])},onblur:function(){var e;return null===(e=t.events)||void 0===e?void 0:e.fire(u.ItemEvent.blur,[t.getValue(),t.config.id])},onkeydown:function(e){t.events.fire(u.ItemEvent.keydown,[e,t.config.id]);}};}else {for(var i in this.config={type:e.type,id:e.id,name:e.name,disabled:!1,required:!1,label:"",labelWidth:"",labelPosition:"top",hiddenLabel:!1,helpMessage:"",preMessage:"",successMessage:"",errorMessage:"",width:"content",height:"content"},e)"id"!==i&&"type"!==i&&"name"!==i&&(this.config[i]=e[i]);this.config.helpMessage&&(this._helper=new c.Popup({css:"dhx_tooltip dhx_tooltip--forced dhx_tooltip--light"}),this._helper.attachHTML(this.config.helpMessage)),this._handlers={showHelper:function(e){e.preventDefault(),e.stopPropagation(),t._helper.show(e.target,{mode:"left"===t.config.labelPosition?"bottom":"right"});},hideHelper:function(e){e.preventDefault(),e.stopPropagation(),t._helper.hide();},onchange:function(e){t.config.checked=e.target.checked,t.events.fire(u.ItemEvent.change,[t.getValue()]),l.isVerify(t.config)&&t.validate();},onfocus:function(){return t.events.fire(u.ItemEvent.focus,[t.getValue()])},onblur:function(){var e;return null===(e=t.events)||void 0===e?void 0:e.fire(u.ItemEvent.blur,[t.getValue()])},onkeydown:function(e){t.events.fire(u.ItemEvent.keydown,[e]);}};}this.config.hidden&&a.awaitRedraw().then((function(){t.hide(!0);}));},t.prototype._initHandlers=function(){var e=this;this.events.on(u.ItemEvent.change,(function(){return e.paint()})),this.events.on(u.ItemEvent.afterValidate,(function(){e.config.$validationStatus=e._isValid?u.ValidationStatus.success:u.ValidationStatus.error,e.paint();}));},t.prototype._draw=function(){var e=this.config,t=e.id,i=e.value,n=e.checked,o=e.disabled,r=e.name,s=e.required,c=e.$required,u=e.text,d=e.label,h=e.labelWidth,f=e.helpMessage;return a.el("label.dhx_checkbox.dhx_form-group.dhx_form-group--checkbox",{class:l.getFormItemCss(this.config,l.isVerify(this.config)||!!c)},this._inGroup?[a.el(".dhx_checkbox__holder",[a.el("input.dhx_checkbox__input",{type:"checkbox",id:t,value:i||"",name:r||"",disabled:o,checked:n,onchange:this._handlers.onchange,onfocus:this._handlers.onfocus,onblur:this._handlers.onblur,onkeydown:this._handlers.onkeydown,required:s,_ref:"input"}),a.el("span.dhx_checkbox__visual-input"),a.el("span.dhx_text",[u])])]:[d||h||f||s?this._drawLabel():null,a.el(".dhx_checkbox__container",[a.el(".dhx_checkbox__holder",[a.el("input.dhx_checkbox__input",{type:"checkbox","data-dhx-id":r||t,id:t,value:i,name:r,disabled:o,checked:n,onchange:this._handlers.onchange,onfocus:this._handlers.onfocus,onblur:this._handlers.onblur,onkeydown:this._handlers.onkeydown,required:s,_ref:"input","aria-label":d||"checkbox "+(u||""),"aria-describedby":f?"dhx_label__help_"+(t||this._uid):null}),a.el("span.dhx_checkbox__visual-input"),a.el("span.dhx_text",[u])]),s&&l.getValidationMessage(this.config)&&a.el("span.dhx_input__caption",l.getValidationMessage(this.config))])])},t}(d.Label);t.Checkbox=f;},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(1),o=function(){function e(){this._classes={};var e=document.createElement("style");e.id="dhx_generated_styles",this._styleCont=document.head.appendChild(e);}return e.prototype.update=function(){this._styleCont.innerHTML!==this._generateCss()&&(document.head.appendChild(this._styleCont),this._styleCont.innerHTML=this._generateCss());},e.prototype.remove=function(e){delete this._classes[e],this.update();},e.prototype.add=function(e,t,i){void 0===i&&(i=!1);var n=this._toCssString(e),o=this._findSameClassId(n);return o&&t&&t!==o?(this._classes[t]=this._classes[o],t):o||this._addNewClass(n,t,i)},e.prototype.get=function(e){if(this._classes[e]){for(var t={},i=0,n=this._classes[e].split(";");i<n.length;i++){var o=n[i];if(o){var r=o.split(":");t[r[0]]=r[1];}}return t}return null},e.prototype.destructor=function(){this._classes=this._styleCont=null;},e.prototype._findSameClassId=function(e){for(var t in this._classes)if(e===this._classes[t])return t;return null},e.prototype._addNewClass=function(e,t,i){var o=t||"dhx_generated_class_"+n.uid();return this._classes[o]=e,i||this.update(),o},e.prototype._toCssString=function(e){var t="";for(var i in e){var n=e[i];t+=i.replace(/[A-Z]{1}/g,(function(e){return "-"+e.toLowerCase()}))+":"+n+";";}return t},e.prototype._generateCss=function(){var e="";for(var t in this._classes){e+="."+t+"{"+this._classes[t]+"}\n";}return e},e}();t.CssManager=o,t.cssManager=new o;},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});t.default={apply:"apply",reject:"reject"};},function(e,t,i){function n(e){var t=document.activeElement;t.classList.contains("dhx_alert__apply-button")&&"Enter"===e.key||t.classList.contains("dhx_alert__confirm-reject")||t.classList.contains("dhx_alert__confirm-aply")||e.preventDefault();}Object.defineProperty(t,"__esModule",{value:!0}),t.blockScreen=function(e){var t=document.createElement("div");return t.className="dhx_alert__overlay "+(e||""),document.body.appendChild(t),document.addEventListener("keydown",n),function(){document.body.removeChild(t),document.removeEventListener("keydown",n);}};},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=i(3),r=i(49),a=750,s=200;function l(e,t,i,n,o,a){var s,c,u;switch(void 0===o&&(o=8),void 0===a&&(a=0),a>1&&(t=r.Position.center),t){case r.Position.center:return (c=e.left+window.pageXOffset+(e.width-i)/2)+o<window.pageXOffset&&(c=e.left+window.pageXOffset),{left:c,top:u=e.top+window.pageYOffset+(e.height-n)/2,pos:s=r.RealPosition.center};case r.Position.right:return s=r.RealPosition.right,(c=e.right+window.pageXOffset+o)+i>window.innerWidth+window.pageXOffset?l(e,r.Position.left,i,n,o,++a):{left:c,top:u=window.pageYOffset+e.top+(e.height-n)/2,pos:s};case r.Position.left:return s=r.RealPosition.left,(c=window.pageXOffset+e.left-i-o)<0?l(e,r.Position.right,i,n,o,++a):{left:c,top:u=window.pageYOffset+e.top+(e.height-n)/2,pos:s};case r.Position.top:return s=r.RealPosition.top,(c=window.pageXOffset+e.left+(e.width-i)/2)+i>window.innerWidth+window.pageXOffset?c=window.innerWidth+window.pageXOffset-i:c<0&&(c=0),(u=window.pageYOffset+e.top-n-o)-n<0?l(e,r.Position.bottom,i,n,o,++a):{left:c,top:u,pos:s};case r.Position.bottom:default:return (c=window.pageXOffset+e.left+(e.width-i)/2)+i>window.innerWidth+window.pageXOffset?c=window.innerWidth+window.pageXOffset-i:c<0&&(c=0),s=r.RealPosition.bottom,(u=window.pageYOffset+e.bottom+o)+n>window.innerHeight+window.pageYOffset?l(e,r.Position.top,i,n,o,++a):{left:c,top:u,pos:s}}}t.findPosition=l;var c=document.createElement("div"),u=document.createElement("span");u.className="dhx_tooltip__text",c.appendChild(u),c.setAttribute("role","tooltip"),c.style.position="absolute";var d,h=null,f=!1,p=null,v=null;function g(e){return e&&(e.classList.contains("dhx_popup--window")&&e.classList.contains("dhx_popup--window_active")||e.classList.contains("dhx_popup--window_modal")||e.classList.contains("dhx_popup"))?2147483647:(null==e?void 0:e.classList.contains("dhx_popup--window"))?2147483646:e&&e.offsetParent?g(e.offsetParent):null}function _(e,t,i,n,o,a,s){void 0===o&&(o=!1),void 0===a&&(a=8);var d=e.getBoundingClientRect();s?u.innerHTML=t:u.textContent=t,document.body.appendChild(c),c.className="dhx_widget dhx_tooltip"+(o?" dhx_tooltip--forced":"");var h=c.getBoundingClientRect(),p=l(d,i,h.width,h.height,a),v=p.left,_=p.top,m=p.pos,y=g(e);switch(y&&(c.style.zIndex=y.toString()),m){case r.RealPosition.bottom:case r.RealPosition.top:case r.RealPosition.left:case r.RealPosition.right:case r.RealPosition.center:c.style.left=v+"px",c.style.top=_+"px";}c.className+=" dhx_tooltip--"+m+" "+(n||""),f=!0,o||setTimeout((function(){c.className+=" dhx_tooltip--animate";}));}function m(e,t,i){var n=i.force,o=i.showDelay,l=i.hideDelay,u=i.position,g=i.css,m=i.htmlEnable,y=i.margin;n||(v=setTimeout((function(){_(e,t,u||r.Position.bottom,g,!1,y,m);}),o||a));var b=function(){var t;f&&(t=l,h&&(p=setTimeout((function(){document.body.removeChild(c),f=!1,p=null;}),t||s))),clearTimeout(v),e.removeEventListener("mouseleave",b),e.removeEventListener("blur",b),document.removeEventListener("mousedown",b),h=null,d=null;};n&&_(e,t,u,g,n,y,m),e.addEventListener("mouseleave",b),e.addEventListener("blur",b),document.addEventListener("mousedown",b),d=b;}function y(e,t){var i=o.toNode(t.node);i!==h&&(d&&(d(),d=null),h=i,p?(clearTimeout(p),p=null,m(i,e,n(n({},t),{force:!0}))):m(i,e,t));}function b(e){var t=o.locateNode(e,"dhx_tooltip_text");t&&y(t.getAttribute("dhx_tooltip_text"),{position:t.getAttribute("dhx_tooltip_position")||r.Position.bottom,node:t});}t.getZIndex=g,t.tooltip=y,t.enableTooltip=function(){document.addEventListener("mousemove",b);},t.disableTooltip=function(){document.removeEventListener("mousemove",b);};},function(e,t,i){function n(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i]);}Object.defineProperty(t,"__esModule",{value:!0}),n(i(125)),n(i(66)),n(i(65)),n(i(51));var o=i(52);t.locale=o.default;},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.grayShades=["#000000","#4C4C4C","#666666","#808080","#999999","#B3B3B3","#CCCCCC","#E6E6E6","#F2F2F2","#FFFFFF"],t.palette=[["#D4DAE4","#B0B8CD","#949DB1","#727A8C","#5E6677","#3F4757","#1D2534"],["#FFCDD2","#FE9998","#F35C4E","#E94633","#D73C2D","#CA3626","#BB2B1A"],["#F9E6AD","#F4D679","#EDB90F","#EAA100","#EA8F00","#EA7E00","#EA5D00"],["#BCE4CE","#90D2AF","#33B579","#36955F","#247346","#1D5B38","#17492D"],["#BDF0E9","#92E7DC","#02D7C5","#11B3A5","#018B80","#026B60","#024F43"],["#B3E5FC","#81D4FA","#29B6F6","#039BE5","#0288D1","#0277BD","#01579B"],["#AEC1FF","#88A3F9","#5874CD","#2349AE","#163FA2","#083596","#002381"],["#C5C0DA","#9F97C1","#7E6BAD","#584A8F","#4F4083","#473776","#3A265F"],["#D6BDCC","#C492AC","#A9537C","#963A64","#81355A","#6E3051","#4C2640"],["#D2C5C1","#B4A09A","#826358","#624339","#5D4037","#4E342E","#3E2723"]];},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.change="change",e.apply="apply",e.cancelClick="cancelClick",e.modeChange="modeChange",e.selectClick="selectClick",e.colorChange="colorChange",e.viewChange="viewChange";}(t.ColorpickerEvents||(t.ColorpickerEvents={}));},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)},o=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var r=i(4),a=i(129),s=i(132),l=i(32),c=i(24),u=i(23),d=i(1),h=function(){function e(e,t){var i=this;this._changes={order:[]},this.config=e||{},this._sort=new s.Sort,this._loader=new a.Loader(this,this._changes),this.events=t||new r.EventSystem(this),this.events.on(u.DataEvents.dataRequest,(function(e,t){var n=i.dataProxy;n&&n.updateUrl&&(n.updateUrl(null,{from:e,limit:n.config.limit||t-e}),i.load(n));})),this.events.on(u.DataEvents.loadError,(function(e){setTimeout((function(){"string"!=typeof e?c.dhxError(e):c.dhxWarning(e);}),0);})),this._reset();}return e.prototype._reset=function(){this._order=[],this._pull={},this._changes={order:[]},this._initOrder=null,this._meta=new WeakMap,this._loaded=!1;},e.prototype.add=function(e,t){var i,n=this;if(this.events.fire(u.DataEvents.beforeAdd,[e]))return i=Array.isArray(e)?e.map((function(e,i){return 0!==i&&(t+=1),n._add(e,t)})):this._add(e,t),this._applySmart(),i},e.prototype.remove=function(e){var t=this;e&&(e instanceof Array?o(e).map((function(e){t._remove(e);})):this._remove(e));},e.prototype.removeAll=function(){this._reset(),this.events.fire(u.DataEvents.removeAll),this.events.fire(u.DataEvents.change);},e.prototype.exists=function(e){return !!this._pull[e]},e.prototype.getNearId=function(e){if(!this._pull[e])return this._order[0].id||""},e.prototype.getItem=function(e){return this._pull[e]},e.prototype.update=function(e,t,i){var n=this.getItem(e);if(n){if(c.isEqualObj(t,n))return;t.id&&e!==t.id?(c.dhxWarning("this method doesn't allow change id"),c.isDebug()):(t.parent&&n.parent&&t.parent!==n.parent&&this.move(e,-1,this,t.parent),d.extend(this._pull[e],t,!1),this.config.update&&this.config.update(this._pull[e]),i||this._onChange("update",e,this._pull[e])),this._applySmart();}else c.dhxWarning("item not found");},e.prototype.getIndex=function(e){if(!e)return -1;var t=d.findIndex(this._order,(function(t){return t&&t.id.toString()===e.toString()}));return this._pull[e]&&t>=0?t:void 0},e.prototype.getId=function(e){if(this._order[e])return this._order[e].id},e.prototype.getLength=function(){return this._order.length},e.prototype.isDataLoaded=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=this._order.length),d.isNumeric(e)&&d.isNumeric(t)?0===this._order.slice(e,t).filter((function(e){return e&&e.$empty})).length:(this._loaded||(this._loaded=!this.find((function(e){return e.$empty}))),!!this._loaded)},e.prototype.filter=function(e,t){if(this.isDataLoaded()){if(t&&t.add||(this._order=this._initOrder||this._order,this._initOrder=null),e&&"function"!=typeof e){var i=e;void 0!==i.by&&void 0!==i.match&&(e=i.compare?function(e){return i.compare(e[i.by],i.match,e,i.multi)}:function(e){return e[i.by]==i.match});}this._filter=t&&t.smartFilter?e:null,this._applyFilters(e),this.events.fire(u.DataEvents.change);}else c.dhxWarning("the method doesn't work with lazyLoad");},e.prototype.find=function(e){for(var t in this._pull){var i=c.findByConf(this._pull[t],e);if(i)return i}return null},e.prototype.findAll=function(e){var t=[];for(var i in this._pull){var n=c.findByConf(this._pull[i],e);n&&t.push(n);}return t},e.prototype.sort=function(e,t){this.isDataLoaded()?(t&&t.smartSorting&&(this._sorter=e),e&&this._applySorters(e),this.events.fire(u.DataEvents.change)):c.dhxWarning("the method doesn't work with lazyLoad");},e.prototype.copy=function(e,t,i,n){var o=this;return e instanceof Array?e.map((function(e,r){return o._copy(e,t,i,n,r)})):this._copy(e,t,i,n)},e.prototype.move=function(e,t,i,n,o){var r=this;return e instanceof Array?e.map((function(e,o){return r._move(e,t,i,n,o)})):this._move(e,t,i,n,0,o)},e.prototype.forEach=function(e){for(var t=0;t<this._order.length;t++)e.call(this,this._order[t],t,this._order);},e.prototype.load=function(e,t){return "string"==typeof e&&(this.dataProxy=e=new l.DataProxy(e)),this.dataProxy=e,this._loader.load(e,t)},e.prototype.parse=function(e,t){return this._reset(),this._loader.parse(e,t)},e.prototype.$parse=function(e){var t=this.config.approximate;t&&(e=this._approximate(e,t.value,t.maxNum)),this._parse_data(e),this._applySmart(),this.events.fire(u.DataEvents.change,["load"]),this.events.fire(u.DataEvents.load);},e.prototype.save=function(e){"string"==typeof e&&(e=new l.DataProxy(e)),this._loader.save(e);},e.prototype.changeId=function(e,t,i){if(void 0===t&&(t=d.uid()),i||this.isDataLoaded()){var n=this.getItem(e);n?(n.id=t,d.extend(this._pull[e],n),this._pull[t]=this._pull[e],i||this._onChange("update",t,this._pull[t]),delete this._pull[e]):c.dhxWarning("item not found");}else c.dhxWarning("the method doesn't work with lazyLoad");},e.prototype.isSaved=function(){return !this._changes.order.length},e.prototype.map=function(e){for(var t=[],i=0;i<this._order.length;i++)t.push(e.call(this,this._order[i],i,this._order));return t},e.prototype.mapRange=function(e,t,i){e<0&&(e=0),t>this._order.length-1&&(t=this._order.length-1);for(var n=this._order.slice(e,t),o=[],r=e;r<=t;r++)o.push(i.call(this,this._order[r],r,n));return o},e.prototype.reduce=function(e,t){for(var i=0;i<this._order.length;i++)t=e.call(this,t,this._order[i],i);return t},e.prototype.serialize=function(e){void 0===e&&(e=u.DataDriver.json);for(var t=[],i=function(e){var i=n({},o._order[e]);Object.keys(i).forEach((function(e){e.startsWith("$")&&delete i[e];})),t.push(i);},o=this,r=0;r<this._order.length;r++)i(r);var a=c.toDataDriver(e);if(a)return a.serialize(t)},e.prototype.getInitialData=function(){return this._initOrder},e.prototype.setMeta=function(e,t,i){if(e){var n=this._meta.get(e);n||(n={},this._meta.set(e,n)),n[t]=i;}},e.prototype.getMeta=function(e,t){var i=this._meta.get(e);return i?i[t]:null},e.prototype.getMetaMap=function(e){return this._meta.get(e)},e.prototype.setRange=function(e,t){this._range=t?[e,t]:null;},e.prototype.getRawData=function(e,t,i,n){if(i=i||this._order,1===n)return i;if(this._range)if(e=this._range[0]+e,-1===t)t=this._range[1];else {var o=Math.abs(t-e);t=e+o>this._range[1]?this._range[1]:e+o;}if(!t||0===e&&(-1===t||t===i.length))return i;if(e>=i.length)return [];(-1===t||t>i.length)&&(t=i.length);var r=i.slice(e,t);return 0!==r.filter((function(e){return e.$empty})).length&&this.events.fire(u.DataEvents.dataRequest,[e,t]),r},e.prototype._add=function(e,t){if(this.isDataLoaded()){var i=this._addCore(e,t);return this._onChange("add",e.id,e),this.events.fire(u.DataEvents.afterAdd,[e]),i}c.dhxWarning("the method doesn't work with lazyLoad");},e.prototype._remove=function(e){if(this.isDataLoaded()){var t=this._pull[e];if(t){if(!this.events.fire(u.DataEvents.beforeRemove,[t]))return;this._removeCore(t.id),this._onChange("remove",e,t);}this.events.fire(u.DataEvents.afterRemove,[t]);}else c.dhxWarning("the method doesn't work with lazyLoad");},e.prototype._copy=function(t,i,o,r,a){if(this.isDataLoaded()){if(!this.exists(t))return null;var s=d.uid();return a&&(i=-1===i?-1:i+a),o?o instanceof e||!r?o.exists(t)?(o.add(n(n({},c.copyWithoutInner(this.getItem(t))),{id:s}),i),s):(o.add(c.copyWithoutInner(this.getItem(t)),i),t):void o.add(c.copyWithoutInner(this.getItem(t)),i):(this.add(n(n({},c.copyWithoutInner(this.getItem(t))),{id:s}),i),s)}c.dhxWarning("the method doesn't work with lazyLoad");},e.prototype._move=function(e,t,i,n,o,r){if(this.isDataLoaded()){if(o&&(t=-1===t?-1:t+o),i&&i!==this&&this.exists(e)){var a=d.copy(this.getItem(e),!0);return r&&(a.id=r),(!r&&i.exists(e)||i.exists(r))&&(a.id=d.uid()),n&&(a.parent=n),i.add(a,t),this.remove(e),a.id}if(this.getIndex(e)===t)return null;var s=this._order.splice(this.getIndex(e),1)[0];return -1===t&&(t=this._order.length),this._order.splice(t,0,s),this.events.fire(u.DataEvents.change,[e,"update",this.getItem(e)]),e}c.dhxWarning("the method doesn't work with lazyLoad");},e.prototype._addCore=function(e,t){var i;return this.config.init&&(e=this.config.init(e)),e.id=null!==(i=e.id)&&void 0!==i?i:d.uid(),this._pull[e.id]&&c.dhxError("Item "+e.id+" already exist"),this._initOrder&&!c.isTreeCollection(this)&&this._addToOrder(this._initOrder,e,t),this._addToOrder(this._order,e,t),e.id},e.prototype._removeCore=function(e){this.getIndex(e)>=0&&(this._order=this._order.filter((function(t){return t.id!==e})),delete this._pull[e]),this._initOrder&&this._initOrder.length&&(this._initOrder=this._initOrder.filter((function(t){return t.id!==e})),delete this._pull[e]);},e.prototype._parse_data=function(e){var t=this._order.length;this.config.prep&&(e=this.config.prep(e));for(var i=0,n=e;i<n.length;i++){var o=n[i];this._addCore(o,t++);}},e.prototype._approximate=function(e,t,i){for(var n=e.length,o=t.length,r=Math.floor(n/i),a=Array(Math.ceil(n/r)),s=0,l=0;l<n;l+=r){for(var c=d.copy(e[l]),u=Math.min(n,l+r),h=0;h<o;h++){for(var f=0,p=l;p<u;p++)f+=e[p][t[h]];c[t[h]]=f/(u-l);}a[s++]=c;}return a},e.prototype._onChange=function(e,t,i){for(var o=0,r=0,a=this._changes.order;r<a.length;r++){var s=a[r],l=this._changes.order.indexOf(s);if(s.id===t&&!s.saving&&(o+=1,l===this._changes.order.length-1||this._changes.order[l+1].id!==t)){if(s.error&&(s.error=!1),s=n(n({},s),{obj:i,status:e}),(o+=1)>10?this._changes.order.splice(l,o-10,s):this._changes.order.splice(l+1,0,s),this._loader.updateChanges(this._changes),"remove"===e&&i.$emptyRow)return;return void this.events.fire(u.DataEvents.change,[t,e,i])}}this._changes.order.push({id:t,status:e,obj:n({},i),saving:!1}),this._loader.updateChanges(this._changes),this.events.fire(u.DataEvents.change,[t,e,i]);},e.prototype._addToOrder=function(e,t,i){i>=0&&e[i]?(this._pull[t.id]=t,e.splice(i,0,t)):(this._pull[t.id]=t,e.push(t));},e.prototype._applySmart=function(){this._filter&&this._applyFilters(),this._sorter&&this._applySorters();},e.prototype._applySorters=function(e){this._sort.sort(this._order,e,this._sorter),this._initOrder&&this._initOrder.length&&this._sort.sort(this._initOrder,e,this._sorter);},e.prototype._applyFilters=function(e){var t=this._filter;if(e===t&&(e=null),e||t){var i=this._order.filter((function(i){return (!e||e(i))&&(!t||t(i))}));this._initOrder||(this._initOrder=this._order),this._order=i;}},e}();t.DataCollection=h;},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=i(69),r=i(70),a=i(130);t.dataDrivers={json:o.JsonDriver,csv:r.CsvDriver},t.dataDriversPro=n(n({},t.dataDrivers),{xml:a.XMLDriver});},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.toJsonArray=function(e){return this.getRows(e)},e.prototype.serialize=function(e){return e},e.prototype.getFields=function(e){return e},e.prototype.getRows=function(e){return "string"==typeof e?JSON.parse(e):e},e}();t.JsonDriver=n;},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e){this.config=n(n({},{skipHeader:0,nameByHeader:!1,rowDelimiter:"\n",columnDelimiter:","}),e),this.config.nameByHeader&&(this.config.skipHeader=1);}return e.prototype.getFields=function(e,t){for(var i=new RegExp('(?<!")'+this.config.columnDelimiter+'(?!")'),n=e.trim().split(i),o={},r=0;r<n.length;r++)o[t?t[r]:r+1]=isNaN(Number(n[r]))?n[r].replace(/"[,;"]"/gi,(function(e){return e.split("").splice(1,1).slice(-1,1).join("")})):parseFloat(n[r]);return o},e.prototype.getRows=function(e){return e.trim().split(this.config.rowDelimiter)},e.prototype.toJsonArray=function(e){var t=this,i=this.getRows(e),n=this.config.names;if(this.config.skipHeader){var o=i.splice(0,this.config.skipHeader);this.config.nameByHeader&&(n=o[0].trim().split(this.config.columnDelimiter));}return i.map((function(e){return t.getFields(e,n)}))},e.prototype.serialize=function(e,t){var i=e[0]?Object.keys(e[0]).filter((function(e){return !e.startsWith("$")})).join(this.config.columnDelimiter)+this.config.columnDelimiter+this.config.rowDelimiter:"",n=this._serialize(e);return t?n:i+n},e.prototype._serialize=function(e){var t=this;return e.reduce((function(e,i){var n=Object.keys(i).reduce((function(e,n,o){return n.startsWith("$")||"items"===n?e:""+e+i[n].replaceAll(/[,;"]/gi,(function(e){return '"'+e+'"'}))+(o===i.length-1?"":t.config.columnDelimiter)}),"");return i.items?e+(e?"\n":"")+n+t._serialize(i.items):""+e+(e?t.config.rowDelimiter:"")+n}),"")},e}();t.CsvDriver=o;},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);}),r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=i(0),s=i(4),l=i(3),c=i(1),u=i(20),d=i(7),h=i(13),f=i(135),p=i(25),v=i(38),g=i(21),_=i(136),m=i(11),y=i(33),b=i(18),w=i(160),x=i(161),E=i(16),C=i(162),S=i(17),I=i(28),k=function(e){function t(t,i){var n=e.call(this,t,i)||this;n._touch={duration:350,dblDuration:300,timer:null,start:!1,timeStamp:null},n.config=c.extend({rowHeight:40,headerRowHeight:40,footerRowHeight:40,keyNavigation:!0,sortable:!0,columns:[],data:[],tooltip:!0,rootParent:"string"==typeof t&&t||n._uid,headerSort:!0},i),n.content=w.getContent(),n._scroll={top:0,left:0};var o=function(){var e;n.config.spans=null===(e=n.config.spans)||void 0===e?void 0:e.map((function(e){return I.normalizeSpan(e,n.config)}));};n.config.data instanceof h.DataCollection?a.awaitRedraw().then((function(){return o()})):o(),n.config.autoWidth=n.config.autoWidth||n.config.fitToContainer,n.config.adjust=n.config.adjust||n.config.columnsAutoWidth,n.config.editable=n.config.editable||n.config.editing,n.config.leftSplit=n.config.leftSplit||n.config.splitAt,n.config.sortable&&n.config.headerSort||(n.config.sortable=!1),n.config.columns.forEach((function(e){e.format=e.format||e.dateFormat;}));var r=function(e,t,i){if(e&&t&&g.isTooltip(n.config,t)){var o=p.toFormat(e[t.id],t.type,t.format),r=function(){return !!o||"boolean"==typeof o};t.tooltipTemplate?o=t.tooltipTemplate(o,e,t)||null:r()&&t.template&&(o=t.template(o,e,t)),r()&&E.tooltip(o.toString(),{css:"dhx_grid_tooltip",node:i,htmlEnable:g.isHtmlEnable(n.config,t)});}},s=function(e,t){if(t&&g.isTooltip(n.config,t)){var i=e.target.querySelector(".dhx_grid-header-cell-text span")&&e.target.querySelector(".dhx_grid-header-cell-text span").textContent||e.target.querySelector(".dhx_grid-footer-cell-text span")&&e.target.querySelector(".dhx_grid-footer-cell-text span").textContent||"";i&&E.tooltip(i,{css:"dhx_grid_tooltip",node:e.target,htmlEnable:g.isHtmlEnable(n.config,t)});}};return n._htmlEvents={onclick:l.eventHandler((function(e){return l.locate(e)}),{"dhx_grid-header-cell--sortable":function(e,t){var i,o=e.target.getAttribute("dhx_resized"),r=n._getColumn(t);if(r&&g.isSortable(n.config,r)&&!o&&n.events.fire(m.GridEvents.beforeSort,[r,n._sortDir?"asc":"desc"])){var a=null===(i=l.locateNodeByClassName(e,"dhx_grid-header-cell"))||void 0===i?void 0:i.querySelector(".dhx_grid-header-cell-text_content").innerHTML,s=a?r.header.find((function(e){return e.text===a})):null,c="asc"===n._sortDir&&n._sortBy===t?"desc":"asc";n._sort(t,c,null==s?void 0:s.sortAs);}},"dhx_grid-expand-cell":function(e,t){e.target.classList.contains("dhx_grid-expand-cell-icon")&&n.events.fire(m.GridEvents.expand,[t]);},"dhx_span-expand-cell":function(e,t){e.target.classList.contains("dhx_span-expand-cell-icon")&&n.events.fire(m.GridEvents.expand,[t]);}}),onscroll:function(e){n.events.fire(m.GridEvents.scroll,[{y:e.target.scrollTop,x:e.target.scrollLeft}]);},onmouseover:{".dhx_grid-cell.dhx_boolean-cell .dhx_checkbox.dhx_cell-editor__checkbox":function(e){var t=e.composedPath(),i=n.data.getItem(t[2].getAttribute("data-dhx-id")),o=n._getColumn(t[1].getAttribute("data-dhx-col-id"));r(i,o,e.target);},".dhx_grid-cell:not(.dhx_boolean-cell)":function(e){var t=n.data.getItem(e.composedPath()[1].getAttribute("data-dhx-id")),i=n._getColumn(e.target.getAttribute("data-dhx-col-id"));r(t,i,e.target);},".dhx_grid-cell:not(.dhx_tree-cell) .dhx_grid-cell__content, .dhx_tree-cell :not(.dhx_grid-cell__content)":function(e){var t=e.composedPath(),i=n.data.getItem(t[2].getAttribute("data-dhx-id")),o=n._getColumn(t[1].getAttribute("data-dhx-col-id"));r(i,o,e.target);},".dhx_grid-cell.dhx_tree-cell .dhx_grid-cell__content":function(e){var t=e.composedPath(),i=n.data.getItem(t[3].getAttribute("data-dhx-id")),o=n._getColumn(t[2].getAttribute("data-dhx-col-id"));r(i,o,t[2]);},".dhx_span-cell:not(.dhx_grid-header-cell)":function(e){var t=n.data.getItem(e.target.getAttribute("data-dhx-id")),i=n._getColumn(e.target.getAttribute("data-dhx-col-id")),o=n.getSpan(t.id,i.id);if(t&&o&&g.isTooltip(n.config,o)){var r=o.text||p.toFormat(t[i.id],i.type,i.format);o.tooltipTemplate?r=o.tooltipTemplate(r,o):i.template&&(r=i.template(r,t,i)),r&&E.tooltip(r,{css:"dhx_grid_tooltip",node:e.target,htmlEnable:!0});}},".dhx_grid-header-cell:not(.dhx_span-cell)":function(e){var t=n._getColumn(e.target.getAttribute("data-dhx-id"));s(e,t);},".dhx_grid-footer-cell:not(.dhx_span-cell)":function(e){var t=n._getColumn(e.target.getAttribute("data-dhx-id"));s(e,t);},".dhx_grid-header-cell.dhx_span-cell":function(e){var t=n._getColumn(e.target.getAttribute("data-dhx-id")),i=t&&t.header.find((function(e){return !(!e.rowspan&&!e.colspan)}));if(t&&i&&g.isTooltip(n.config,t)){var o=i.text||"";o&&E.tooltip(o,{css:"dhx_grid_tooltip",node:e.target,htmlEnable:g.isHtmlEnable(n.config,t)});}},".dhx_grid-header-cell-text_content":function(e){var t=e.composedPath(),i=n._getColumn(t[1].getAttribute("data-dhx-id"));if(i&&g.isTooltip(n.config,i)){var o=t[2].querySelector(".dhx_grid-header-cell-text_content")&&t[2].querySelector(".dhx_grid-header-cell-text_content").textContent||"";o&&E.tooltip(o,{css:"dhx_grid_tooltip",node:t[1],htmlEnable:g.isHtmlEnable(n.config,i)});}}}},(n.config.dragMode||n.config.dragItem)&&(h.dragManager.setItem(n._uid,n),n.config.dragItem||(n.config.dragItem="row"),n.config.dragMode||(n.config.dragMode="both")),n._init(),n.config.columns&&n._parseColumns(!0),n.config.data&&n.config.data instanceof Array&&n.config.data.length&&n.config.columns&&n.data.parse(n.config.data),n.selection=new _.Selection(n,{disabled:!n.config.selection},n.events,n._uid),n.mount(t,n._createView()),n.config.autoWidth&&n.config.autoHeight&&n._prepareData(n.config.data),a.awaitRedraw().then((function(){n.config.keyNavigation&&(n.keyManager=new u.KeyManager((function(e,t){return !(t!==n._uid||!n.events.fire(m.GridEvents.beforeKeyDown,[e]))&&(n.events.fire(m.GridEvents.afterKeyDown,[e]),!0)})),n._initHotKey(),S.focusManager.setFocusId(n._uid));})),i.autoEmptyRow&&0===n.data.getLength()&&(n._addEmptyRow(),n.paint()),n}return o(t,e),t.prototype.destructor=function(){this._destroyContent(),this.keyManager&&this.keyManager.destructor(),this.events.events={},this.events.context=null,this._activeFilters=this._filterData=this._scroll=this.content=null,this.unmount();},t.prototype.setColumns=function(e){var t=this;this.config.columns=e,this._parseColumns(!0),this._adjustColumns(),this._checkFilters(),this._checkMarks(),this.paint(),this.config.keyNavigation&&a.awaitRedraw().then((function(){t._initHotKey(!0),t.paint();}));},t.prototype.addRowCss=function(e,t){var i=this.data.getItem(e),n=i.$css||"";n.match(new RegExp(t,"g"))||(i.$css=n+" "+t,this.paint());},t.prototype.removeRowCss=function(e,t){var i=this.data.getItem(e),n=i.$css?i.$css.replace(t,""):"";i.$css=n,this.paint();},t.prototype.addCellCss=function(e,t,i){var n=this._getColumn(t),o=this.config.spans?this.getSpan(e,t):null;if(o||n){var r=o?o.css:n.$cellCss[e];if(r){var a=r.match(new RegExp(i,"g"))?"":" "+i;o?o.css+=a:n.$cellCss[e]+=a;}else this.data.getItem(e)&&(o?o.css=i+" ":n.$cellCss[e]=i+" ");this.paint();}},t.prototype.removeCellCss=function(e,t,i){var n=this._getColumn(t);n&&(n.$cellCss[e]?(n.$cellCss[e]=n.$cellCss[e].replace(i,""),this.paint()):this.data.getItem(e)&&(n.$cellCss[e]=""));},t.prototype.showColumn=function(e){var t=this._getColumn(e);if(t&&t.hidden&&this.events.fire(m.GridEvents.beforeColumnShow,[t])){t.hidden=!1,this.config.$totalWidth+=t.$width;var i=this._hiddenFilters&&this._hiddenFilters[t.id];i&&(this._activeFilters[t.id]=i,delete this._hiddenFilters[t.id]),this.paint(),this._checkFilters(),this.events.fire(m.GridEvents.afterColumnShow,[t]);}},t.prototype.hideColumn=function(e){var t=this,i=this._getColumn(e);if(i&&!i.hidden&&this.events.fire(m.GridEvents.beforeColumnHide,[i])){i.hidden=!0,this.config.$totalWidth-=i.$width;var n=this._activeFilters&&this._activeFilters[i.id];n&&(this._hiddenFilters||(this._hiddenFilters={}),this._hiddenFilters[i.id]=n,delete this._activeFilters[i.id],this.data.filter()),this.paint();var o=this.content.comboFilter,r=function(){t._checkFilters(),t.events.fire(m.GridEvents.afterColumnHide,[i]);};Object.keys(o.element).length?a.awaitRedraw().then((function(){t.paint(),r();})):r();}},t.prototype.isColumnHidden=function(e){var t=this._getColumn(e);if(t)return !!t.hidden},t.prototype.showRow=function(e){if(c.isDefined(e)){var t=e.toString(),i=this.data.getItem(t);i&&i.hidden&&this.events.fire(m.GridEvents.beforeRowShow,[i])&&(this.data.update(t,{hidden:!1}),this.data.filter((function(e){return !e.hidden})),this.events.fire(m.GridEvents.afterRowShow,[i]));}},t.prototype.hideRow=function(e){if(c.isDefined(e)){var t=e.toString(),i=this.data.getItem(t);i&&this.events.fire(m.GridEvents.beforeRowHide,[i])&&(this.data.update(t,{hidden:!0}),this.data.filter((function(e){return !e.hidden})),this.events.fire(m.GridEvents.afterRowHide,[i]));}},t.prototype.isRowHidden=function(e){if(c.isDefined(e)){var t=this.data.getItem(e.toString());return t?!!t.hidden:void 0}},t.prototype.getScrollState=function(){return {x:this._scroll.left,y:this._scroll.top}},t.prototype.scroll=function(e,t){var i=this.getRootView().refs.grid_body.el.querySelector(".scroll-view")||this.getRootView().refs.grid_body.el;i.scrollLeft=!e&&0!==e||"number"!=typeof e?i.scrollLeft:e,i.scrollTop=!t&&0!==t||"number"!=typeof t?i.scrollTop:t,this.paint();},t.prototype.scrollTo=function(e,t){var i=this.selection.getCell(),n=this.config.columns.filter((function(e){return !e.hidden})),o=c.findIndex(n,(function(e){return e.id==t})),r=i?i.column:this.config.columns[0],a=c.findIndex(n,(function(e){return e.id==r.id})),s=this.config.leftSplit?g.getTotalWidth(n.slice(0,this.config.leftSplit)):0,l=g.getTotalWidth(n.slice(0,o))-(o-a<0?s:0),u=this.data.getRawData(0,-1),d=c.findIndex(u,(function(t){return t.id==e})),h=g.getTotalHeight(u.slice(0,d)),f=this.getScrollState(),p=this.config.width+f.x,v=this.config.height+f.y-this.config.headerRowHeight*this.config.$headerLevel,_=h-f.y-u[d].$height,m=l-f.x-n[o].$width,y=h+2*u[d].$height+18-v,b=l+2*n[o].$width+18-p,w=_>0&&y<0?0:_<0?_:y,x=m>0&&b<0?0:m<0?m:b;this.scroll(x+f.x,w+f.y);},t.prototype.adjustColumnWidth=function(e,t){void 0===t&&(t=!0);var i=this.config.columns.filter((function(e){return !e.hidden})),n=i.filter((function(t){return t.id===e})),o=this._adjustColumnsWidth(this.config.data,n,t);this.config.$totalWidth=i.reduce((function(e,t){if(o[t.id]){t.$fixed=!0;var i=t.maxWidth,n=t.minWidth,r=o[t.id];t.$width=r,i&&r>i&&(t.$width=i),n&&t.$width<n&&(t.$width=n);}return e+t.$width}),0),this.paint();},t.prototype.getCellRect=function(e,t){var i=this.config.columns.filter((function(e){return !e.hidden})),n=this.data.getRawData(0,-1),o=this.getSpan(e,t),r=c.findIndex(i,(function(e){return e.id==(o?o.column:t)})),a=c.findIndex(n,(function(t){return t.id==(o?o.row:e)}));return {x:g.getTotalWidth(i.slice(0,r)),y:g.getTotalHeight(n.slice(0,a)),height:(null==o?void 0:o.rowspan)?v.getHeight(n,o.rowspan,a):n[a]?n[a].$height:0,width:(null==o?void 0:o.colspan)?v.getWidth(i,o.colspan,r):i[r]?i[r].$width:0}},t.prototype.getColumn=function(e){var t=c.findIndex(this.config.columns,(function(t){return t.id==e}));if(t>=0)return this.config.columns[t]},t.prototype.addSpan=function(e){this.config.spans=this.config.spans||[];var t=c.findIndex(this.config.spans,(function(t){return ""+t.row==""+e.row&&""+t.column==""+e.column}));t>=0?this.config.spans[t]=e:(this.config.spans.push(I.normalizeSpan(e,this.config)),this._checkMarks(),this.paint());},t.prototype.getSpan=function(e,t){var i,n=this;if(this.config.spans){var o=this.data.getIndex(e.toString()),r=this.config.columns.findIndex((function(e){return e.id===t})),a=c.findIndex(this.config.spans,(function(e){var t=n.data.getIndex(e.row.toString()),i=n.config.columns.findIndex((function(t){return t.id===e.column})),a=t,s=e.rowspan?t+e.rowspan:t+1,l=i,c=e.colspan?i+e.colspan:i+1;return o>=a&&o<s&&r>=l&&r<c}));return null===(i=this.config)||void 0===i?void 0:i.spans[a]}},t.prototype.removeSpan=function(e,t){if(this.config.spans){var i=c.findIndex(this.config.spans,(function(i){return ""+i.row==""+e&&""+i.column==""+t}));this.config.spans.splice(i,1),this.paint();}},t.prototype.editCell=function(e,t,i){var n,o=this.data.getItem(e),r=this.getColumn(t);if(o&&r){var a=r.editorType;i||("date"===r.type&&(i="datePicker"),"boolean"===r.type&&(i="checkbox"),a&&(i=a)),this.events.fire(m.GridEvents.beforeEditStart,[o,r,i])&&((null===(n=this.config.$editable)||void 0===n?void 0:n.editor)||this.config.$editable&&this.config.$editable.row===e&&this.config.$editable.col===t&&this.config.$editable.editorType===i||(this.config.$editable={row:o.id,col:r.id,isSpan:!!this.getSpan(o.id,r.id),editorType:i},this.selection.config.disabled||this.selection.setCell(e.toString(),t.toString()),this.paint(),this.events.fire(m.GridEvents.afterEditStart,[o,r,i])));}else h.dhxWarning("item not found");},t.prototype.editEnd=function(e){this.config.$editable&&this.config.$editable.editor&&this.config.$editable.editor.endEdit(e);},t.prototype.getSortingState=function(){return {dir:this._sortDir,by:this._sortBy}},t.prototype.getHeaderFilter=function(e){var t=this,i=this.getColumn(e);if(i){var n=null;return i.header.forEach((function(i){if(i.content){var o=t.content[i.content].element[e];n="comboFilter"===i.content?o:t.getRootView().refs[e+"_filter"].el;}})),n}},t.prototype.edit=function(e,t,i){this.editCell(e,t,i);},t.prototype.paint=function(){var t=this.config.hotkeys?Object.keys(this.config.hotkeys).length:0;!this.keyManager||this.keyManager.getKeyStorageLength()-t||this._initHotKey(!0),e.prototype.paint.call(this);},t.prototype._createView=function(){var e=this;return a.create({render:function(t,i){return y.render(t,i,e._htmlEvents,e.selection,e._uid)}},this)},t.prototype._parseColumns=function(e){void 0===e&&(e=!1),p.normalizeColumns(this.config,e);var t=this.config.columns.filter((function(e){return !e.hidden}));p.countColumns(this.config,t);},t.prototype._parseData=function(){this.config.data=this._prepareData(this.data),this._detectColsTypes(),this._checkFilters(),this._checkMarks(),this.data.filter((function(e){return !e.hidden})),this._render();},t.prototype._createCollection=function(e){this.data=new h.DataCollection({prep:e},this.events);},t.prototype._getRowIndex=function(e){return this.data.getIndex(e)},t.prototype._setEventHandlers=function(){var e=this;this.data.events.on(h.DataEvents.load,(function(){e._parseData(),e._checkFilters();})),this.data.events.on(h.DataEvents.change,(function(t,i,n){if("setPage"!==i){if("add"===i||"update"===i||"remove"===i){if(t&&"remove"===i){var o=e.selection.getCells().find((function(e){return e.row.id===t}));o&&e.selection.removeCell(o.row.id,o.column.id);}e.config.data=e._prepareData(e.data);}else h.isTreeCollection(e.data)&&(e.config.data=e._prepareData(e.data)),e._adjustColumns();if(t&&(e._filterData=e.data.map((function(e){return e}))||[],e._checkFilters()),e._detectColsTypes(),e._removeMarks(),e._checkMarks(),e.config.autoEmptyRow&&(!e._activeFilters||c.isEmptyObj(e._activeFilters))){var r=e.data.find({by:"$emptyRow",match:!0});if(r){if(r.id===t)return;e.data.move(r.id,e.data.getLength()-1);}else e._addEmptyRow();}e._render();}else a.awaitRedraw().then((function(){var t=e.config.columns.find((function(e){return !0!==e.hidden}));e.scrollTo(e.data.getId(n[0]).toString(),t.id.toString()),e._render();}));})),this.data.events.on(h.DataEvents.removeAll,(function(){e.config.columns.map((function(e){e.header.map((function(t){!t.content||"selectFilter"!==t.content&&"comboFilter"!==t.content||(e.$uniqueData=[]);}));}));})),this.events.on(h.DragEvents.beforeDrag,(function(t,i){return e.data.getItem(t.start)?e.events.fire(m.GridEvents.beforeRowDrag,[t,i]):"column"===e.config.dragItem||"both"===e.config.dragItem?e.events.fire(m.GridEvents.beforeColumnDrag,[t,i]):void 0})),this.events.on(h.DragEvents.dragStart,(function(i,n){e.data.getItem(i.start)?e.events.fire(m.GridEvents.dragRowStart,[i,n]):"column"!==e.config.dragItem&&"both"!==e.config.dragItem||e.events.fire(m.GridEvents.dragColumnStart,[i,n]);})),this.events.on(h.DragEvents.dragIn,(function(t,i){e.data.getItem(t.start)?e.events.fire(m.GridEvents.dragRowIn,[t,i]):"column"!==e.config.dragItem&&"both"!==e.config.dragItem||e.events.fire(m.GridEvents.dragColumnIn,[t,i]);})),this.events.on(h.DragEvents.dragOut,(function(t,i){e.data.getItem(t.start)?e.events.fire(m.GridEvents.dragRowOut,[t,i]):"column"!==e.config.dragItem&&"both"!==e.config.dragItem||e.events.fire(m.GridEvents.dragColumnOut,[t,i]);})),this.events.on(h.DragEvents.canDrop,(function(i,n){e.data.getItem(i.start)||e.data.getItem(i.target)?e.events.fire(m.GridEvents.canRowDrop,[i,n]):"column"!==e.config.dragItem&&"both"!==e.config.dragItem||e.events.fire(m.GridEvents.canColumnDrop,[i,n]);})),this.events.on(h.DragEvents.cancelDrop,(function(i,n){e.data.getItem(i.start)?e.events.fire(m.GridEvents.cancelRowDrop,[i,n]):"column"!==e.config.dragItem&&"both"!==e.config.dragItem||e.events.fire(m.GridEvents.cancelColumnDrop,[i,n]);})),this.events.on(h.DragEvents.beforeDrop,(function(t,i){return "row"!==e.config.dragItem||"both"!==e.config.dragMode&&"target"!==e.config.dragMode?"column"===e.config.dragItem||"both"===e.config.dragItem?e.events.fire(m.GridEvents.beforeColumnDrop,[t,i]):void 0:e.events.fire(m.GridEvents.beforeRowDrop,[t,i])})),this.events.on(h.DragEvents.afterDrop,(function(t,i){var n;if(e.data.getItem(t.start)){e.events.fire(m.GridEvents.afterRowDrop,[t,i]);for(var o=e.data.getItem(t.start),r=0,a=e.config.columns;r<a.length;r++){var s=a[r];void 0===o[s.id]&&e.data.update(o.id,((n={})[s.id]=null,n),!0);}var l=e.data.getInitialData(),c=null==l?void 0:l.findIndex((function(e){return e.id.toString()===t.start})),u=null==l?void 0:l.findIndex((function(e){return e.id.toString()===t.target}));for(var d in c>-1&&u>-1&&(null==l||l.splice(u,0,null==l?void 0:l.splice(c,1)[0])),e.config.data=e._prepareData(l||e.data.map((function(e){return e}))),e.data.parse(e.config.data),e._activeFilters)e.data.filter(e._activeFilters[d],{add:!0});}else "column"!==e.config.dragItem&&"both"!==e.config.dragItem||e.events.fire(m.GridEvents.afterColumnDrop,[t,i]);})),this.events.on(h.DragEvents.afterDrag,(function(i,n){e.data.getItem(i.start)?e.events.fire(m.GridEvents.afterRowDrag,[i,n]):"column"!==e.config.dragItem&&"both"!==e.config.dragItem||e.events.fire(m.GridEvents.afterColumnDrag,[i,n]),e.config.data=e._prepareData(e.data instanceof Array?e.data.map((function(e){return e})):e.data.getInitialData()||e.data),e.data.parse(e.config.data);})),this.events.on(m.GridEvents.cellMouseDown,(function(t,i,n){if(n.targetTouches){if(e._touch.timer=setTimeout((function(){e._dragStart(n);}),e._touch.duration),e._touch.timeStamp)e._touch.dblDuration>=e._touch.timeStamp-+n.timeStamp.toFixed()&&((!1!==i.editable&&e.config.editable||i.editable)&&e.editCell(t.id,i.id,i.editorType),n.preventDefault(),e.events.fire(m.GridEvents.cellDblClick,[t,i,n])),e._touch.timeStamp=null;else e._touch.timeStamp=+n.timeStamp.toFixed();setTimeout((function(){e._touch.timeStamp=null;}),e._touch.dblDuration);}else e._dragStart(n);})),this._events.on(m.GridSystemEvents.cellTouchMove,(function(t,i,n){e._touch.start&&n.preventDefault(),e._clearTouchTimer();})),this._events.on(m.GridSystemEvents.cellTouchEnd,(function(){e._touch.start=!1,e._clearTouchTimer();})),this.events.on(m.GridEvents.filterChange,(function(t,i,n){var o,r,a;if(t=null!=t?t:"",e.config.autoEmptyRow){var s=e.data.find({by:"$emptyRow",match:!0});s&&e.data.remove(s.id);}e._activeFilters||(e._activeFilters={});var l=e._getColumn(i),c=l.header.filter((function(e){return e.content===n&&void 0!==e.customFilter}))[0];if(""!==t){"combobox"!==l.editorType&&"select"!==l.editorType&&"multiselect"!==l.editorType||!l.options||(t=Array.isArray(t)?t.map((function(e){var t;return (null===(t=l.options.find((function(t){return "string"==typeof t?t===e:t.value===e})))||void 0===t?void 0:t.id)||e})):null!==(r=null===(o=l.options.find((function(e){return "string"==typeof e?e===t:e.value===t})))||void 0===o?void 0:o.id)&&void 0!==r?r:t);e._activeFilters[i]={by:i,match:t,compare:null!==(a=null==c?void 0:c.customFilter)&&void 0!==a?a:function(t){var i=e._getColumn(t);return function(t,o,r,a){return e.content[n].match({val:t,match:o,obj:r,multi:a,col:i})}}(i),multi:"multiselect"===(null==l?void 0:l.editorType)};}else delete e._activeFilters[i];for(var u in e.data.filter((function(e){return !e.hidden})),e._activeFilters)e.data.filter(e._activeFilters[u],{add:!0});})),this.events.on(m.GridEvents.scroll,(function(t){e._scroll={top:t.y,left:t.x},e.editEnd(),e.paint();})),this.events.on(m.GridEvents.cellDblClick,(function(t,i,n){l.locateNodeByClassName(n,"dhx_boolean-cell")||(!1!==i.editable&&e.config.editable||i.editable)&&e.editCell(t.id,i.id,i.editorType);})),this.events.on(m.GridEvents.afterEditEnd,(function(t,i,n){var o,a;if(!(null===(a=e.config.$editable)||void 0===a?void 0:a.editor)||e.config.$editable.col===n.id&&e.config.$editable.row===i.id){var s,l;e.config.$editable?(s=e.config.$editable.row,l=e.config.$editable.col):(s=i.id,l=n.id);var c=e.getSpan(s,l);if(c&&"string"==typeof c.text)c.text=t;else {var u=e.data.getItem(s);delete u.$emptyRow,void 0!==t&&e.data.update(s,r(r({},u),((o={})[l]=t,o)));}e.config.$editable=null,e._checkFilters(),e.paint();}})),this.events.on(m.GridEvents.headerCellMouseDown,(function(t,i){var n=i.target.getAttribute("dhx_resized");if(n&&e.events.fire(m.GridEvents.beforeResizeStart,[t,i])&&x.startResize(e,n.toString(),i,(function(){e.paint(),e.config.$resizing=null,e.events.fire(m.GridEvents.afterResizeEnd,[t,i]);})),i.targetTouches){if(e._touch.timeStamp)e._touch.dblDuration>=e._touch.timeStamp-+i.timeStamp.toFixed()&&(i.preventDefault(),e.events.fire(m.GridEvents.headerCellDblClick,[t,i])),e._touch.timeStamp=null;else e._touch.timeStamp=+i.timeStamp.toFixed();setTimeout((function(){e._touch.timeStamp=null;}),e._touch.dblDuration);}})),this.events.on(m.GridEvents.footerCellDblClick,(function(t,i){if(i.targetTouches){if(e._touch.timeStamp)e._touch.dblDuration>=e._touch.timeStamp-+i.timeStamp.toFixed()&&(i.preventDefault(),e.events.fire(m.GridEvents.footerCellDblClick,[t,i])),e._touch.timeStamp=null;else e._touch.timeStamp=+i.timeStamp.toFixed();setTimeout((function(){e._touch.timeStamp=null;}),e._touch.dblDuration);}})),this.events.on(m.GridEvents.resize,(function(){e._parseColumns(),e._checkFilters();})),this.events.on(m.GridEvents.afterResizeEnd,(function(t){var i;e.config.columns=null===(i=e.config.columns)||void 0===i?void 0:i.map((function(e){return e.id==t.id&&(e.width=t.$width),e})),e._parseColumns(!0),e._checkFilters();}));},t.prototype._addEmptyRow=function(){var e=this.data.getId(this.data.getLength()-1),t=this.data.getItem(e),i=this.config.columns.filter((function(e){return !e.hidden}));g.isRowEmpty(t)||this.data.add(i.reduce((function(e,t){return e[t.id]="",e}),{$emptyRow:!0}));},t.prototype._sort=function(e,t,i){var n=this;t?this._sortDir=t:this._sortBy===e?this._sortDir="asc"===this._sortDir?"desc":"asc":this._sortDir="asc";this._sortBy=e,this.data.sort({by:e,dir:this._sortDir,as:null!=i?i:function(t){var i=n.getColumn(e);return t&&"date"===i.type?"string"==typeof t?b.stringToDate(t,i.format).getTime():t.getTime():t?""+t:""}}),this.events.fire(m.GridEvents.afterSort,[this.getColumn(e),this._sortDir]);},t.prototype._clearTouchTimer=function(){this._touch.timer&&(clearTimeout(this._touch.timer),this._touch.timer=null);},t.prototype._checkFilters=function(){var e=this,t=this._filterData;if(t){this.config.columns.forEach((function(e){e.header.forEach((function(i){var n;if(i.content&&("selectFilter"===i.content||"comboFilter"===i.content)){var o=e.header.find((function(e){return e.filterConfig})),r=[];"comboFilter"===i.content&&(null===(n=i.filterConfig)||void 0===n?void 0:n.readonly)&&r.push(""),r.push.apply(r,p.getUnique(t,e.id,o?o.filterConfig.multiselection:null)),e.$uniqueData&&e.$uniqueData.length>r.length?r.forEach((function(t){e.$uniqueData.includes(t)||e.$uniqueData.push(t);})):e.$uniqueData=r;}}));}));var i=function(t){var i=n.config.columns.find((function(e){return e.id===t})),o=i.header.find((function(e){return !!e.content})),r=!1;r=Array.isArray(n._activeFilters[t].match)?n._activeFilters[t].match.reduce((function(e,t){if(i.$uniqueData.find((function(e){return e.toString()===t})))return !0}),!1):i.$uniqueData.find((function(i){return i.toString()===e._activeFilters[t].match})),!o||"selectFilter"!==o.content&&"comboFilter"!==o.content||r?n.data.filter(n._activeFilters[t],{add:!0}):(delete n._activeFilters[t],n.data.filter());},n=this;for(var o in this._activeFilters)i(o);}},t.prototype._adjustColumns=function(){var e=this;if("boolean"==typeof this.config.adjust||"data"===this.config.adjust||"header"===this.config.adjust||"footer"===this.config.adjust){if(!(n=this.config.columns.filter((function(e){return !e.hidden}))).length)return;var t=this.config.data&&this.config.data.length?this.config.data:this.data.map((function(e){return e})),i=this._adjustColumnsWidth(t,n);this.config.$totalWidth=n.reduce((function(e,t){t.$fixed=!0;var n=t.maxWidth,o=t.minWidth,r=i[t.id];return t.$width=r,n&&r>n&&(t.$width=n),o&&t.$width<o&&(t.$width=o),e+t.$width}),0);}else {var n;if(!(n=this.config.columns.filter((function(e){return !e.hidden&&e.adjust}))).length)return;n.forEach((function(t){e.adjustColumnWidth(t.id,t.adjust);}));}},t.prototype._prepareData=function(e){var t=this;return this.config.autoHeight&&(this.config.autoHeight=!1),this._adjustColumns(),e.map((function(e){return e.$height=e.height||t.config.rowHeight,e}))},t.prototype._adjustColumnsWidth=function(e,t,i){var n,o,r;void 0===i&&(i=this.config.adjust);var a={};if("header"===i||!0===i){var s=t.filter((function(e){return e.header}));if(f=p.getMaxColsWidth(this._prepareColumnData(s,"header"),s,{font:"bold 14.4px Arial"},"header"))for(var l=0,c=Object.entries(f);l<c.length;l++){var u=c[l],d=u[0],h=u[1];a=Object.assign(a,((n={})[d]=+h+(g.isSortable(this.config,this.getColumn(d))?36:16),n));}}if("footer"===i||!0===i){var f;s=t.filter((function(e){return e.footer}));if(f=p.getMaxColsWidth(this._prepareColumnData(s,"footer"),s,{font:"bold 14.4px Arial"},"footer"))for(var v=0,_=Object.entries(f);v<_.length;v++){var m=_[v];d=m[0],h=m[1];(a[d]&&a[d]<+h+16||!a[d])&&(a=Object.assign(a,((o={})[d]=+h+16,o)));}}if(("data"===i||!0===i)&&(f=p.getMaxColsWidth(e,t,{font:"normal 14.4px Arial"},"data")))for(var y=0,b=Object.entries(f);y<b.length;y++){var w=b[y];d=w[0],h=w[1];(a[d]&&a[d]<+h+16||!a[d])&&(a=Object.assign(a,((r={})[d]=+h+16,r)));}return a},t.prototype._prepareColumnData=function(e,t){for(var i,n,o,a,s,l,c,u,d,h,f=[],p=0;p<e.length;p++){for(var v=[],g=0;g<(null===(n=e[p])||void 0===n?void 0:n[t].length);g++){var _={};(null===(a=null===(o=e[p])||void 0===o?void 0:o[t][g])||void 0===a?void 0:a.text)?(_[e[p].id]=(null===(l=null===(s=e[p])||void 0===s?void 0:s[t][g])||void 0===l?void 0:l.text)||"",v.push(_)):(null===(u=null===(c=e[p])||void 0===c?void 0:c[t][g])||void 0===u?void 0:u.content)&&(_[e[p].id]=this.content[null===(h=null===(d=e[p])||void 0===d?void 0:d[t][g])||void 0===h?void 0:h.content].toHtml(this.getColumn(e[p].id),this.config)||"",v.push(_));}for(var m=0;m<v.length;m++)for(var y=0,b=Object.entries(v[m]);y<b.length;y++){var w=b[y],x=w[0],E=w[1];f[m]=r({},f[m])||{},f[m]=Object.assign(f[m],((i={})[x]=E,i));}}return f},t.prototype._dragStart=function(e){if(this.config.dragMode&&("row"===this.config.dragItem||"both"===this.config.dragItem)&&!this.config.$editable){var t=this._getColumn(e.target.getAttribute("data-dhx-col-id"));if(!1===(null==t?void 0:t.draggable))return;var i=l.locateNode(e,"data-dhx-id"),n=i&&i.getAttribute("data-dhx-id");return e.targetTouches&&(this._touch.start=!0),h.dragManager.onMouseDown(e,[n])}},t.prototype._getColumn=function(e){for(var t=0,i=this.config.columns;t<i.length;t++){var n=i[t];if(n.id==e)return n}},t.prototype._init=function(){this.events=new s.EventSystem(this),this._events=new s.EventSystem(this),this._attachDataCollection(),this.export=new f.Exporter(this),this._setEventHandlers();},t.prototype._attachDataCollection=function(){var e=this;if(this.config.data instanceof h.DataCollection)return this.data=this.config.data,void(this.config.data=this.data.serialize());this._createCollection((function(t){return t.spans&&(e.config.spans=t.spans,t=t.data),t}));},t.prototype._setMarks=function(e,t){for(var i=this.data.map((function(t){return {id:t.id,data:t[e.id],row:t}})),n=this.data.map((function(t){return t[e.id]})),o=function(i){var o=t(i.data,n,i.row,e);if(o){e.$cellCss=e.$cellCss||{};var a=(e.$cellCss[i.id]||"").split(" ");o.split(" ").map((function(e){a.includes(e)||a.push(e);}));var s=a.join(" "),l=r.getSpan(i.id,e.id);e.$cellCss[i.id]=s,l&&(l.rowspan||l.colspan&&l.column===e.id)&&l.$markCss!==s&&(l.$markCss=s);}},r=this,a=0,s=i;a<s.length;a++){o(s[a]);}},t.prototype._checkMarks=function(){var e=this;this.config.columns.map((function(t){var i=t.mark;i&&("function"==typeof i?e._setMarks(t,i):e._setMarks(t,(function(e,t){var n=[];t.forEach((function(e){null!=e&&""!==e&&n.push(parseFloat(e));}));var o=c.getMinArrayNymber(n),r=c.getMaxArrayNymber(n);return i.max&&r===parseFloat(e)?i.max:!(!i.min||o!==parseFloat(e))&&i.min})));}));},t.prototype._removeMarks=function(){var e;this.config.columns.forEach((function(e){e.mark&&(e.$cellCss={});})),null===(e=this.config.spans)||void 0===e||e.forEach((function(e){e.$markCss&&delete e.$markCss;}));},t.prototype._detectColsTypes=function(){this.config.columns.forEach((function(e){return e.type?e:e.format?(e.type="number",e):void(e.type||(e.type="string"))}));},t.prototype._destroyContent=function(){for(var e in this.content)"comboFilter"===e&&this.content[e].destroy();},t.prototype._render=function(){this.paint();},t.prototype._initHotKey=function(e){void 0===e&&(e=!1);var t=C.getKeysHandlers(this);for(var i in t)this.keyManager.exist(i)||this.keyManager.addHotKey(i,t[i]);if(!e)for(var i in this.config.hotkeys)this.keyManager.addHotKey(i,this.config.hotkeys[i]);},t}(d.View);t.Grid=k;},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);});Object.defineProperty(t,"__esModule",{value:!0});var r=i(55),a=i(73),s=i(0),l=function(e){function t(t,i){var n=e.call(this,t,i)||this;if(n._root=n.config.parent||n,n._all={},n._parseConfig(),n.config.activeTab&&(n.config.activeView=n.config.activeTab),n.config.views&&(n.config.activeView=n.config.activeView||n._cells[0].id,n._isViewLayout=!0),!i.parent){var o=s.create({render:function(){return n.toVDOM()}},n);n.mount(t,o);}return n}return o(t,e),t.prototype.destructor=function(){for(var e=0,t=this._all;e<t.length;e++){var i=t[e];this._all[i].destructor();}this.config=this._cells=this._root=this._xLayout=this._isViewLayout=null,this._all={},this.unmount();},t.prototype.toVDOM=function(){if(this._isViewLayout){var t=[this.getCell(this.config.activeView).toVDOM()];return e.prototype.toVDOM.call(this,t)}var i=[];return this._inheritTypes(),this._cells.forEach((function(e){var t=e.toVDOM();Array.isArray(t)?i=i.concat(t):i.push(t);})),e.prototype.toVDOM.call(this,i)},t.prototype.removeCell=function(e){if(this.events.fire(r.LayoutEvents.beforeRemove,[e])){var t=this.config.parent||this;if(t!==this)return t.removeCell(e);var i=this.getCell(e);if(i){var n=i.getParent();delete this._all[e],n._cells=n._cells.filter((function(t){return t.id!=e})),n.paint();}this.events.fire(r.LayoutEvents.afterRemove,[e]);}},t.prototype.addCell=function(e,t){if(void 0===t&&(t=-1),this.events.fire(r.LayoutEvents.beforeAdd,[e.id])){var i=this._createCell(e);t<0&&(t=this._cells.length+t+1),this._cells.splice(t,0,i),this.paint(),this.events.fire(r.LayoutEvents.afterAdd,[e.id]);}},t.prototype.getId=function(e){return e<0&&(e=this._cells.length+e),this._cells[e]?this._cells[e].id:void 0},t.prototype.getRefs=function(e){return this._root.getRootView().refs[e]},t.prototype.getCell=function(e){var t;return null===(t=this._root)||void 0===t?void 0:t._all[e]},t.prototype.forEach=function(e,t,i){if(void 0===i&&(i=1/0),this._haveCells(t)&&!(i<1)){var n;n=t?this._root._all[t]._cells:this._root._cells;for(var o=0;o<n.length;o++){var r=n[o];e.call(this,r,o,n),this._haveCells(r.id)&&r.forEach(e,r.id,--i);}}},t.prototype.cell=function(e){return this.getCell(e)},t.prototype._getCss=function(t){var i=this._xLayout?"dhx_layout-columns":"dhx_layout-rows",n=this.config.align?" "+i+"--"+this.config.align:"";if(t)return i+" dhx_layout-cell"+(this.config.align?" dhx_layout-cell--"+this.config.align:"");var o=this.config.parent?e.prototype._getCss.call(this):"dhx_widget dhx_layout",r=this.config.parent?"":" dhx_layout-cell";return o+(this.config.full?r:" "+i)+n},t.prototype._parseConfig=function(){var e=this,t=this.config,i=t.rows||t.cols||t.views||[];this._xLayout=!t.rows,this._cells=i.map((function(t){return e._createCell(t)}));},t.prototype._createCell=function(e){var i;return e.rows||e.cols||e.views?(e.parent=this._root,i=new t(this,e)):i=new a.Cell(this,e),this._root._all[i.id]=i,e.init&&e.init(i,e),i},t.prototype._haveCells=function(e){if(e){var t=this._root._all[e];return t._cells&&t._cells.length>0}return Object.keys(this._all).length>0},t.prototype._inheritTypes=function(e){var t=this;if(void 0===e&&(e=this._cells),Array.isArray(e))e.forEach((function(e){return t._inheritTypes(e)}));else {var i=e.config;if(i.rows||i.cols){var n=e.getParent();!i.type&&n&&(n.config.type?i.type=n.config.type:this._inheritTypes(n));}}},t}(a.Cell);t.Layout=l;},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);}),r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=i(1),s=i(0),l=i(7),c=i(55),u=i(143),d=i(4),h=i(37),f=function(e){function t(t,i){var n=e.call(this,t,i)||this;n._disabled=[];var o=t;return o&&o.isVisible&&(n._parent=o),n._parent&&n._parent.events?n.events=n._parent.events:n.events=new d.EventSystem(n),n.config.full=void 0===n.config.full?Boolean(n.config.header||n.config.collapsable||n.config.headerHeight||n.config.headerIcon||n.config.headerImage):n.config.full,n._afterWindowResized=n._resizedWindow.bind(n),n._initHandlers(),n.id=n.config.id||a.uid(),n._isXDirection()&&!i.width&&(i.$autoWidth=!0),n._isXDirection()||i.height||(i.$autoHeight=!0),n}return o(t,e),t.prototype.paint=function(){var e;if(this.isVisible()){var t=this.getRootView();t?t.redraw():null===(e=this._parent)||void 0===e||e.paint();}},t.prototype.isVisible=function(){var e;if(!this._parent)return !(!this._container||!this._container.tagName)||Boolean(this.getRootNode());var t=null===(e=this._parent.config)||void 0===e?void 0:e.activeView;return (!t||t===this.id)&&(!this.config.hidden&&(!this._parent||this._parent.isVisible()))},t.prototype.hide=function(){this.events.fire(c.LayoutEvents.beforeHide,[this.id])&&(this.config.hidden=!0,this._resetCellsSize(),this._parent&&this._parent.paint&&this._parent.paint(),this.events.fire(c.LayoutEvents.afterHide,[this.id]));},t.prototype.show=function(){var e=this;this.events.fire(c.LayoutEvents.beforeShow,[this.id])&&(this._parent&&this._parent.config&&void 0!==this._parent.config.activeView?this._parent.config.activeView=this.id:this.config.hidden=!1,this._parent&&!this._parent.isVisible()&&this._parent.show(),this.paint(),this._ui instanceof h.Grid&&this._ui.config.keyNavigation&&s.awaitRedraw().then((function(){e._ui.setColumns(e._ui.config.columns),e.paint();})),this.events.fire(c.LayoutEvents.afterShow,[this.id]));},t.prototype.expand=function(){this.events.fire(c.LayoutEvents.beforeExpand,[this.id])&&(this.config.collapsed=!1,this._checkNextSize()||this._checkNextSize(this._getAnyFlexCell()),this.events.fire(c.LayoutEvents.afterExpand,[this.id]),this.paint());},t.prototype.collapse=function(){this.events.fire(c.LayoutEvents.beforeCollapse,[this.id])&&(this.config.collapsed=!0,this._checkNextSize()||this._checkNextSize(this._getAnyFlexCell()),this.events.fire(c.LayoutEvents.afterCollapse,[this.id]),this.paint());},t.prototype.toggle=function(){this.config.collapsed?this.expand():this.collapse();},t.prototype._checkNextSize=function(e){var t=null!=e?e:this._getNextCell();return !!t&&(this._isXDirection()&&t.config.$autoWidth&&t.config.width?(t.config.width=void 0,!0):!this._isXDirection()&&t.config.$autoHeight&&t.config.height?(t.config.height=void 0,!0):!e&&t._checkNextSize())},t.prototype.getParent=function(){return this._parent},t.prototype.destructor=function(){var e;this.events&&this.events.clear(),window.removeEventListener("resize",this._afterWindowResized),"function"==typeof(null===(e=this.getWidget())||void 0===e?void 0:e.destructor)&&this.getWidget().destructor(),this.config=this.events=this.id=this._parent=this._handlers=this._uid=this._disabled=this._resizerHandlers=null,this.unmount();},t.prototype.getWidget=function(){return this._ui},t.prototype.getCellView=function(){return this._parent&&this._parent.getRefs(this._uid)},t.prototype.attach=function(e,t){var i=this;return this.config.html=null,"object"==typeof e?this._ui=e:"string"==typeof e?this._ui=new window.dhx[e](null,t):"function"==typeof e&&(e.prototype instanceof l.View?this._ui=new e(null,t):this._ui={getRootView:function(){return e(t)}}),this.paint(),this._ui instanceof h.Grid&&this._ui.config.keyNavigation&&s.awaitRedraw().then((function(){i._ui.setColumns(i._ui.config.columns),i.paint();})),this._ui},t.prototype.attachHTML=function(e){this.config.html=e,this.paint();},t.prototype.toVDOM=function(e){var t;if(null===this.config&&(this.config={}),!this.config.hidden){var i,n=this._calculateStyle(),o=a.isDefined(this.config.padding)?isNaN(Number(this.config.padding))?{padding:this.config.padding}:{padding:this.config.padding+"px"}:"",l=this.config.full||this.config.html?n:r(r({},n),o);if(!this.config.html)if(this._ui){var c=this._ui.getRootView();c.render&&(c=s.inject(c)),i=[c];}else i=e||null;var u=this.config.resizable&&!this._isLastCell()&&this._getNextCell()&&!this.config.collapsed?s.el(".dhx_layout-resizer."+(this._isXDirection()?"dhx_layout-resizer--x":"dhx_layout-resizer--y"),r(r({},this._resizerHandlers),{_ref:"resizer_"+this._uid,tabindex:0}),[s.el("span.dhx_layout-resizer__icon",{class:"dxi "+(this._isXDirection()?"dxi-dots-vertical":"dxi-dots-horizontal")})]):null,d={};if(this.config.on)for(var h in this.config.on)d["on"+h]=this.config.on[h];var f="",p=this.config.cols||this.config.rows;if(this.config.type&&p)switch(this.config.type){case"line":f=" dhx_layout-line";break;case"wide":f=" dhx_layout-wide";break;case"space":f=" dhx_layout-space";}var v=s.el("div",r(r(((t={_key:this._uid,_ref:this._uid})["aria-label"]=this.config.id?"tab-content-"+this.config.id:null,t),d),{class:this._getCss(!1)+(this.config.css?" "+this.config.css:"")+(this.config.collapsed?" dhx_layout-cell--collapsed":"")+(this.config.resizable?" dhx_layout-cell--resizable":"")+(this.config.type&&!this.config.full?f:""),style:l}),this.config.full?[s.el("div",{tabindex:this.config.collapsable?"0":"-1",role:this.config.collapsable?"button":null,"aria-label":this.config.collapsable?"click to "+(this.config.collapsed?"expand":"collapse"):null,class:"dhx_layout-cell-header"+(this._isXDirection()?" dhx_layout-cell-header--col":" dhx_layout-cell-header--row")+(this.config.collapsable?" dhx_layout-cell-header--collapseble":"")+(this.config.collapsed?" dhx_layout-cell-header--collapsed":"")+(((this.getParent()||{}).config||{}).isAccordion?" dhx_layout-cell-header--accordion":""),style:{height:this.config.headerHeight},onclick:this._handlers.toggle,onkeydown:this._handlers.enterCollapse},[this.config.headerIcon&&s.el("span.dhx_layout-cell-header__icon",{class:this.config.headerIcon}),this.config.headerImage&&s.el(".dhx_layout-cell-header__image-wrapper",[s.el("img",{src:this.config.headerImage,class:"dhx_layout-cell-header__image"})]),this.config.header&&s.el("h3.dhx_layout-cell-header__title",this.config.header),this.config.collapsable?s.el("div.dhx_layout-cell-header__collapse-icon",{class:this._getCollapseIcon()}):s.el("div.dhx_layout-cell-header__collapse-icon",{class:"dxi dxi-empty"})]),this.config.collapsed?null:s.el("div",{style:r(r({},o),{height:"calc(100% - "+(this.config.headerHeight||37)+"px)"}),class:this._getCss(!0)+" dhx_layout-cell-content"+(this.config.type?f:"")},this.config.html?[s.el("div",{".innerHTML":this.config.html,class:"dhx_layout-cell dhx_layout-cell-inner_html"})]:i)]:!this.config.html||this.config.rows&&this.config.cols&&this.config.views?i:[this.config.collapsed?null:s.el(".dhx_layout-cell-content",{style:o},[s.el(".dhx_layout-cell-inner_html",{".innerHTML":this.config.html})])]);return u?[v,u]:v}},t.prototype._getCss=function(e){return "dhx_layout-cell"},t.prototype._initHandlers=function(){var e=this;window.addEventListener("resize",this._afterWindowResized),this._handlers={enterCollapse:function(t){13===t.keyCode&&e._handlers.toggle();},collapse:function(){e.config.collapsable&&e.collapse();},expand:function(){e.config.collapsable&&e.expand();},toggle:function(){e.config.collapsable&&e.toggle();}};var t={left:null,top:null,isActive:!1,range:null,xLayout:null,nextCell:null,size:null,resizerLength:null,margin:null,collapsedSize:null},i=function(i,n){if(void 0===n&&(n={x:0,y:0}),t.isActive){var o=t.xLayout,r=i.targetTouches?i.targetTouches[0].clientX:i.clientX+n.x,a=i.targetTouches?i.targetTouches[0].clientY:i.clientY+n.y,s=o?r-t.range.min+window.pageXOffset:a-t.range.min+window.pageYOffset,l=o?"width":"height";s<0?s=t.resizerLength/2:s>t.size&&(s=t.size-t.resizerLength);var u=function(t){var i;return parseInt(null===(i=e.config[t])||void 0===i?void 0:i.toString())},d=u(o?"maxWidth":"maxHeight"),h=u(o?"minWidth":"minHeight");(!d||s<d)&&(!h||s>h)&&(e.config[l]=s-t.resizerLength/2+"px",t.nextCell.config[l]=t.size-s-t.resizerLength/2+"px",t.nextCell._getAnyFlexCell()&&(t.nextCell._getAnyFlexCell().config[l]=void 0),e.paint(),e.events.fire(c.LayoutEvents.resize,[e.id]));}},n={},o=function(r){if(t.isActive=!1,document.body.classList.remove("dhx_no-select--resize"),r.targetTouches)for(var a in document.removeEventListener("touchend",o),document.removeEventListener("touchmove",i),n)n[a].node.contentWindow.document.removeEventListener("touchend",o),n[a].node.contentWindow.document.removeEventListener("touchmove",n[a].listener);else for(var a in document.removeEventListener("mouseup",o),document.removeEventListener("mousemove",i),n)n[a].node.contentWindow.document.removeEventListener("mouseup",o),n[a].node.contentWindow.document.removeEventListener("mousemove",n[a].listener);e.events.fire(c.LayoutEvents.afterResizeEnd,[e.id]);},r=function(i){if(i.targetTouches&&i.preventDefault(),3!==i.which&&(t.isActive&&o(i),e.events.fire(c.LayoutEvents.beforeResizeStart,[e.id]))){document.body.classList.add("dhx_no-select--resize");var n=e.getCellView(),r=e._getNextCell(),a=r.getCellView(),s=e._getResizerView(),l=n.el.getBoundingClientRect(),d=s.el.getBoundingClientRect(),h=a.el.getBoundingClientRect();t.xLayout=e._isXDirection(),t.left=l.left+window.pageXOffset,t.top=l.top+window.pageYOffset,t.collapsedSize=e._getCollapsedSize(e,r),t.margin=u.getMarginSize(e.getParent().config,t.xLayout),t.range=u.getBlockRange(l,h,t.xLayout),t.size=t.range.max-t.range.min-t.margin-t.collapsedSize,t.isActive=!0,t.nextCell=r,t.resizerLength=t.xLayout?d.width:d.height;}};this._resizerHandlers={onmousedown:function(e){r(e),document.addEventListener("mouseup",o),document.addEventListener("mousemove",i);var t=document.querySelectorAll("iframe");if(t.length)for(var a in t.forEach((function(e,t){var o={x:e.getBoundingClientRect().x,y:e.getBoundingClientRect().y};n[t]={node:e,listener:function(e){return i(e,o)}};})),n)n[a].node.contentWindow.document.addEventListener("mouseup",o),n[a].node.contentWindow.document.addEventListener("mousemove",n[a].listener);},ontouchstart:function(e){r(e),document.addEventListener("touchend",o),document.addEventListener("touchmove",i);var t=document.querySelectorAll("iframe");if(t.length)for(var a in t.forEach((function(e,t){var o={x:e.getBoundingClientRect().x,y:e.getBoundingClientRect().y};n[t]={node:e,listener:function(e){return i(e,o)}};})),n)n[a].node.contentWindow.document.addEventListener("touchend",o),n[a].node.contentWindow.document.addEventListener("touchmove",n[a].listener);},ondragstart:function(e){return e.preventDefault()}};},t.prototype._getCollapsedSize=function(e,t){var i=0,n=this._parent,o=n._cells.indexOf(e),r=n._cells.indexOf(t);if(r-o==1)return i;for(var a=o+1;a<r;a++)n._cells[a].config.collapsed&&(this._isXDirection()?i+=45:i+=Number(n._cells[a].config.headerHeight)||37);return i},t.prototype._getCollapseIcon=function(){return this._isXDirection()&&this.config.collapsed?"dxi dxi-chevron-right":this._isXDirection()&&!this.config.collapsed?"dxi dxi-chevron-left":!this._isXDirection()&&this.config.collapsed?"dxi dxi-chevron-up":this._isXDirection()||this.config.collapsed?void 0:"dxi dxi-chevron-down"},t.prototype._isLastCell=function(){var e=this._parent;return e&&e._cells.indexOf(this)===e._cells.length-1},t.prototype._getNextCell=function(){var e=this._parent,t=e._cells.indexOf(this),i=!this._isLastCell()&&e._cells[t+1];return !!i&&(i.config.hidden||i.config.collapsed?i._getNextCell():i)},t.prototype._getAnyFlexCell=function(e){var t,i=this;void 0===e&&(e=!1);var n=this._parent,o=this._isXDirection()?"$autoWidth":"$autoHeight",r=null===(t=null==n?void 0:n._cells)||void 0===t?void 0:t.filter((function(t){return !0===t.config[o]&&(!!e||t.id!==i.id)}));return !!(null==r?void 0:r.length)&&r[r.length-1]},t.prototype._getResizerView=function(){return this._parent.getRefs("resizer_"+this._uid)},t.prototype._isXDirection=function(){return this._parent&&this._parent._xLayout},t.prototype._calculateStyle=function(){var e=this.config;if(e){var t={},i=!1,n=!1;isNaN(Number(e.width))||(e.width=e.width+"px"),isNaN(Number(e.height))||(e.height=e.height+"px"),isNaN(Number(e.minWidth))||(e.minWidth=e.minWidth+"px"),isNaN(Number(e.minHeight))||(e.minHeight=e.minHeight+"px"),isNaN(Number(e.maxWidth))||(e.maxWidth=e.maxWidth+"px"),isNaN(Number(e.maxHeight))||(e.maxHeight=e.maxHeight+"px"),"content"===e.width&&(i=!0),"content"===e.height&&(n=!0);var o=e,r=o.width,a=o.height,s=o.cols,l=o.rows,c=o.minWidth,u=o.minHeight,d=o.maxWidth,h=o.maxHeight,f=o.gravity,p=o.collapsed,v=o.$fixed,g=-1===Math.sign(f)?0:f;"boolean"==typeof f&&(g=f?1:0);var _="boolean"==typeof f?!f:-1===Math.sign(f);this._isXDirection()?(v||r||void 0===f&&(c||d))&&(_=!0):(v||a||void 0===f&&(u||h))&&(_=!0);var m=_?0:g||1,y=this._isXDirection()?"x":"y";if(void 0===c||p||(t.minWidth=c),void 0===u||p||(t.minHeight=u),void 0!==d&&(t.maxWidth=d),void 0!==h&&(t.maxHeight=h),void 0===this._parent&&void 0!==!y&&(y=!0),void 0!==r&&"content"!==r)t.width=r;else if(!0===y)t.width="100%";else if("x"===y)if(i)t.flex="0 0 auto";else {var b=this._isXDirection()?"1px":"auto";t.flex=m+" "+(s||l?"0 "+b:"1 auto");}if(void 0!==a&&"content"!==a)t.height=a;else if(!0===y)t.height="100%";else if("y"===y)if(n)t.flex="0 0 auto";else {b=this._isXDirection()?"auto":"1px";t.flex=m+" "+(s||l?"0 "+b:"1 auto");}return !0===y&&void 0===e.width&&void 0===e.height&&(t.flex=m+" 1 auto"),p&&(this._isXDirection()?t.width="auto":t.height="auto",t.flex="0 0 auto"),t}},t.prototype._resizedWindow=function(){var e;if(void 0===this._isLastFlexCell?this._isLastFlexCell=(null===(e=this._getAnyFlexCell(!0))||void 0===e?void 0:e.id)===this.id:this._isLastFlexCell||window.removeEventListener("resize",this._afterWindowResized),this._isLastFlexCell){var t=this._isXDirection()?"width":"height";this.config[t]=void 0,this.paint();}},t.prototype._resetCellsSize=function(){var e=this,t=this._parent._cells.filter((function(t){return t!==e&&!t.config.hidden&&!t.config.collapsed})),i=this._isXDirection(),n=i?"$autoWidth":"$autoHeight",o=i?"width":"height";t.forEach((function(e){e.config[n]&&(e.config[o]=void 0);}));},t}(l.View);t.Cell=f;},function(e,t,i){function n(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i]);}Object.defineProperty(t,"__esModule",{value:!0}),n(i(146)),n(i(76));},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.beforeHide="beforeHide",e.beforeShow="beforeShow",e.afterHide="afterHide",e.afterShow="afterShow",e.click="click";}(t.PopupEvents||(t.PopupEvents={}));},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.change="change",e.focus="focus",e.blur="blur",e.keydown="keydown",e.mousedown="mousedown",e.mouseup="mouseup";}(t.SliderEvents||(t.SliderEvents={}));},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.change="change",e.beforeApply="beforeApply",e.afterApply="afterApply",e.beforeClose="beforeClose",e.afterClose="afterClose",e.apply="apply",e.close="close",e.save="save";}(t.TimepickerEvents||(t.TimepickerEvents={}));},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.change="change",e.beforeChange="beforechange",e.modeChange="modeChange",e.monthSelected="monthSelected",e.yearSelected="yearSelected",e.cancelClick="cancelClick",e.dateMouseOver="dateMouseOver",e.dateHover="dateHover";}(t.CalendarEvents||(t.CalendarEvents={}));},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);}),r=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var a=i(1),s=i(0),l=i(4),c=i(3),u=i(153),d=i(7),h=i(13),f=i(15),p=i(29),v=i(8),g=i(157),_=i(82),m=i(41),y=i(83),b=i(84);function w(e,t){return "function"==typeof t?t(e):e+" "+_.default.selectedItems}var x=function(e){return e.icon?'<span class="'+e.icon+' dhx_combobox-options__icon"></span> <span class="dhx_combobox-options__value">'+e.value+"</span>":e.src?'<img src="'+e.src+'" class="dhx_combobox-options__image" alt='+e.value+'></img> <span class="dhx_combobox-options__value">'+e.value+"</span>":'<span class="dhx_combobox-options__value">'+e.value+"</span>"},E=function(e){function t(t,i){var n=e.call(this,t,a.extend({template:x,listHeight:224,itemHeight:36,disabled:!1,readOnly:!1,newOptions:!1,htmlEnable:!0},i))||this;n.config.itemsCount=n.config.itemsCount||n.config.showItemsCount,n.config.helpMessage=n.config.helpMessage||n.config.help,n.config.cellHeight&&36===n.config.itemHeight&&(n.config.itemHeight=n.config.cellHeight),n.config.labelInline&&(n.config.labelPosition="left"),Array.isArray(n.config.data)?(n.events=new l.EventSystem(n),n.data=new h.DataCollection({}),n.data.parse(n.config.data)):n.config.data?(n.data=n.config.data,n.events=new l.EventSystem(n),n.events.context=n):(n.events=new l.EventSystem(n),n.data=new h.DataCollection({})),n.popup=new v.Popup,n.popup.events.on(v.PopupEvents.afterShow,(function(){n.paint();})),n.popup.events.on(v.PopupEvents.afterHide,(function(){n.config.multiselection&&(n._state.value=""),n.paint();})),n.popup.events.on(v.PopupEvents.beforeHide,(function(e){e&&n._hideOptions();})),(n.config.readonly||n.config.readOnly)&&(n.config.readOnly=n.config.readOnly||n.config.readonly,n._keyListener=new g.KeyListener),n._state={value:"",ignoreNext:!1,canDelete:!1,unselectActive:!1,currentState:b.ComboState.default,creatingState:!1},n._initHandlers(),n._createLayout(),n.config.value&&n._setValue(n.config.value,!0),n._initEvents();var o=s.create({render:function(){return n._draw()},hooks:{didRedraw:function(){n.popup.isVisible()&&(n.focus(),n._configurePopup());}}});return n.mount(t,o),n}return o(t,e),t.prototype.focus=function(){if(this.config.disabled)return !1;this.getRootView().refs.input.el.focus();},t.prototype.blur=function(){if(this.config.disabled)return !1;this.getRootView().refs.input.el.blur(),this.popup.hide();},t.prototype.enable=function(){this.config.disabled=!1,this.paint();},t.prototype.disable=function(){this.config.disabled=!0,this.paint();},t.prototype.isDisabled=function(){return this.config.disabled},t.prototype.clear=function(){this.list.selection.remove(),this._state.value="",this._filter(),this.paint();},t.prototype.getValue=function(e){var t=this.list.selection.getId();return e?a.wrapBox(t):Array.isArray(t)?t.join(","):t},t.prototype.setValue=function(e){return this._setValue(e,!1)},t.prototype.addOption=function(e,t){if(void 0===t&&(t=!0),e&&"string"==typeof e){var i=this.data.add({value:e}),n=this.config.multiselection&&t?r(this.list.selection.getId(),[i]):i;this.setValue(n);}},t.prototype.destructor=function(){this.popup&&this.popup.destructor(),this.events&&this.events.clear(),this.list&&this.list.destructor(),this._helper&&this._helper.destructor(),this._layout&&this._layout.destructor(),this.config=this.events=this.list=this.popup=null,this._helper=this._keyListener=this._handlers=this._state=this._uid=this._isPopupConfiqureted=null,this.unmount();},t.prototype.setState=function(e){switch(e){case"success":this._state.currentState=b.ComboState.success;break;case"error":this._state.currentState=b.ComboState.error;break;default:this._state.currentState=b.ComboState.default;}this.paint();},t.prototype._setValue=function(e,t){var i=this;if(void 0===t&&(t=!1),!this._exsistId(e))return !1;if(this._filter(),this.list.selection.remove(),this.config.multiselection)"string"==typeof e&&(e=e.split(",")),"number"==typeof e&&(e=[e]),e.forEach((function(e){i.list.selection.add(e,!1,!1,t);}));else {var n=a.unwrapBox(e);this.list.selection.add(n,!1,!1,t);var o=this.data.getItem(n);o&&(this._state.value=this._getItemText(o));}this.paint();},t.prototype._createLayout=function(){var e=this.list=new p.List(null,{template:this.config.template,htmlEnable:this.config.htmlEnable,virtual:this.config.virtual,keyNavigation:!1,multiselection:this.config.multiselection,itemHeight:this.config.itemHeight,height:this.config.listHeight,data:this.data}),t=this._layout=new f.Layout(this.popup.getContainer(),{css:"dhx_combobox-options dhx_combobox__options",rows:[{id:"select-unselect-all",hidden:!this.config.multiselection||!this.config.selectAllButton},{id:"list",height:"content"},{id:"not-found",hidden:!0}],on:{click:{".dhx_combobox__action-select-all":this._handlers.selectAll,".dhx_combobox-options__action-create-option":this._handlers.addOption}}});t.getCell("list").attach(e),this.config.multiselection&&this.config.selectAllButton&&t.getCell("select-unselect-all").attach(y.selectAllView);},t.prototype._initHandlers=function(){var e=this;this.config.helpMessage&&(this._helper=new v.Popup({css:"dhx_tooltip dhx_tooltip--forced dhx_tooltip--light"}),this._helper.attachHTML(this.config.helpMessage)),this._handlers={addOption:function(){return e.addOption(e._state.value)},showHelper:function(t){t.preventDefault(),t.stopPropagation(),e._helper.show(t.target,{mode:"left"===e.config.labelPosition?"bottom":"right"});},selectAll:function(){e._state.unselectActive?(e.list.selection.remove(),e.config.selectAllButton&&(e._layout.getCell("select-unselect-all").attach(y.selectAllView),e._state.unselectActive=!1)):(e.data.filter(),e.list.selection.add(),e.config.selectAllButton&&(e._layout.getCell("select-unselect-all").attach(y.unselectAllView),e._state.unselectActive=!0)),e._changePopupPosition(),e.paint();},onkeydown:function(t){if("Tab"===t.key&&e.popup.isVisible())e._hideOptions();else if(e.popup.isVisible()||t.which!==u.KEY_CODES.DOWN_ARROW||e._showOptions(),e.popup.isVisible()&&(t.which===u.KEY_CODES.RIGHT_ARROW&&e.config.readOnly&&!e.config.multiselection&&(e.list.moveFocus(p.MOVE_DOWN),t.preventDefault()),t.which===u.KEY_CODES.LEFT_ARROW&&e.config.readOnly&&!e.config.multiselection&&(e.list.moveFocus(p.MOVE_UP),t.preventDefault()),t.which===u.KEY_CODES.DOWN_ARROW&&(e.list.moveFocus(p.MOVE_DOWN),t.preventDefault()),t.which===u.KEY_CODES.UP_ARROW&&(e.list.moveFocus(p.MOVE_UP),t.preventDefault()),t.which===u.KEY_CODES.ESC&&e._hideOptions(),t.which===u.KEY_CODES.ENTER)){if(e.config.newOptions&&!e.data.getLength())e.addOption(e._state.value,!0);else {var i=e.list.getFocus(),n=e.config.multiselection?r(e.list.selection.getId(),[i]):i;e.setValue(n);}e.config.multiselection?e._updatePopup():e._hideOptions();}e.events.fire(b.ComboboxEvents.keydown,[t,e.list.getFocus()]);},onkeyup:function(t){if(e.config.multiselection&&!e.config.itemsCount)if(e._state.ignoreNext)e._state.ignoreNext=!1;else if(t.which===u.KEY_CODES.BACKSPACE&&!e._state.value&&e.config.multiselection&&e.list.selection.getId().length){var i=e.list.selection.getId(),n=i[i.length-1];e.list.selection.remove(n),e._changePopupPosition(),e.paint();}},oninput:function(t){if(!e.config.disabled){var i=t.target.value;e.events.fire(b.ComboboxEvents.input,[i]),e._state.value=i,e._filter(),i.length?e._state.canDelete=!1:(e._state.ignoreNext=!0,e._state.canDelete=!0),e.config.multiselection||(e.list.selection.remove(),e.paint()),e.popup.isVisible()||e._showOptions(),e._updatePopup();}},oninputclick:function(t){var i;if(!e.config.disabled){if(e.focus(),t.target.classList.contains("dhx_combobox__action-remove")){var n=null===(i=e.data.getItem(c.locate(t)))||void 0===i?void 0:i.id;if(!n)return;return e.list.selection.remove(n),e._changePopupPosition(),void e.paint()}if(t.target.classList.contains("dhx_combobox__action-clear-all"))return e.list.selection.getId().forEach((function(t){return e.list.selection.remove(t)})),e.config.selectAllButton&&e._state.unselectActive&&(e._layout.getCell("select-unselect-all").attach(y.selectAllView),e._state.unselectActive=!1),void e.paint();t.preventDefault(),e.popup.isVisible()?e.focus():e._showOptions();}},toggleIcon:function(){e.focus(),e.popup.isVisible()?e._hideOptions():e._showOptions();},onfocus:function(){var t;return null===(t=e.events)||void 0===t?void 0:t.fire(b.ComboboxEvents.focus,[])},onblur:function(){var t;return null===(t=e.events)||void 0===t?void 0:t.fire(b.ComboboxEvents.blur,[])}};},t.prototype._initEvents=function(){var e=this;this.data.events.on(h.DataEvents.load,(function(){e.config.value&&e._setValue(e.config.value,!0);})),this.data.events.on(h.DataEvents.afterAdd,(function(){e.config.multiselection?e._changePopupPosition():e._hideOptions();})),this.list.events.on(p.ListEvents.click,(function(){e.config.multiselection||e._hideOptions(),e._changePopupPosition();})),this.list.selection.events.on(m.SelectionEvents.afterSelect,(function(){var t=e.getValue(e.config.multiselection);e.events.fire(b.ComboboxEvents.change,[t]),e._updateSelectedItem(t);})),this.list.selection.events.on(m.SelectionEvents.afterUnSelect,(function(){var t=e.config.multiselection;if(!e.config.readOnly||t){var i=e.getValue(t);e.events.fire(b.ComboboxEvents.change,[i]),t&&e._updateSelectedItem(i);}})),this.popup.events.on(v.PopupEvents.beforeShow,(function(){if(!e.popup.isVisible()&&!e._isPopupConfiqureted)return e._configurePopup(),!1})),this.config.readOnly&&this.popup.events.on(v.PopupEvents.afterShow,(function(){if(e._state.value){var t=e.list.selection.getId();e.list.setFocus(t);}else e.list.setFocus(e.data.getId(0));e._keyListener.startNewListen((function(t){return e._findBest(t)}));}));},t.prototype._showOptions=function(){this.events.fire(b.ComboboxEvents.beforeOpen)&&(this._state.value.length&&(this._state.canDelete=!0),this._filter(),this._configurePopup()&&(this.events.fire(b.ComboboxEvents.open),this.events.fire(b.ComboboxEvents.afterOpen)));},t.prototype._configurePopup=function(){this._isPopupConfiqureted=!0;var e=this.getRootView();return !!(e&&e.refs&&e.refs.holder)&&(this.popup.isVisible()||this._updatePopup(),!0)},t.prototype._hideOptions=function(){var e=this;this.events.fire(b.ComboboxEvents.beforeClose)&&(this.config.readOnly&&this._keyListener.endListen(),this.list.setFocus(this.data.getId(0)),this.config.multiselection||this.config.readOnly||this.list.selection.contains()||(this._state.value=""),s.awaitRedraw().then((function(){return e.popup.isVisible()&&e.popup.hide()})),this.events.fire(b.ComboboxEvents.afterClose),this.events.fire(b.ComboboxEvents.close),this._filter(),this.paint());},t.prototype._filter=function(){var e=this;if(!this.config.readOnly){if(this.data.filter((function(t){return e.config.filter?e.config.filter(t,e._state.value):a.isEqualString(e._state.value,e._getItemText(t))})),this.config.multiselection)this.list.setFocus(this.data.getId(0));else {var t=this.data.getIndex(this.list.selection.getId());this.list.setFocus(this.data.getId(t>-1?t:0));}var i=this._layout.getCell("list"),n=this._layout.getCell("not-found");if(0===this.data.getLength()){this.config.multiselection&&this.config.selectAllButton&&this._layout.getCell("select-unselect-all").hide(),i.hide(),this._state.creatingState=!0;var o=this.config.newOptions?this._state.value:"";n.height=y.emptyListHeight(o,this.getRootView().refs.holder.el.offsetWidth),n.attach(y.emptyListView,o),n.show();}else {if(this.config.multiselection&&this.config.selectAllButton&&this._layout.getCell("select-unselect-all").show(),!(this._state.value&&this.data.find((function(t){return t.value===e._state.value})))&&this._state.value)if(this._state.creatingState=this.config.newOptions,i.show(),this.config.newOptions){o=this._state.value;n.height=y.emptyListHeight(o,this.getRootView().refs.holder.el.offsetWidth),n.attach(y.emptyListView,o),n.show();}else n.hide();else this._state.creatingState=!1,n.isVisible()&&(i.show(),n.hide());}}},t.prototype._findBest=function(e){var t=this,i=this.data.find((function(i){return a.isEqualString(e,t._getItemText(i))}));i&&this.list.selection.getId()!==i.id&&(this.list.setFocus(i.id),this.paint());},t.prototype._exsistId=function(e){var t=this;return e instanceof Array?e.every((function(e){return t.data.exists(e)})):this.data.exists(e)},t.prototype._draw=function(){if(!this.config)return s.el("div");var e=this.config,t=e.multiselection,i=e.labelPosition,n=e.hiddenLabel,o=e.required,a=e.disabled,l=e.css,u=e.helpMessage,d=e.readOnly,h=e.placeholder,f=t?null:this.data.getItem(this.list.selection.getId()),p=!this.list.selection.getId()||"object"==typeof this.list.selection.getId()&&0===this.list.selection.getId().length,v=c.getLabelStyle(this.config);return s.el("div",{"data-dhx-widget-id":this._uid,onkeydown:this._handlers.onkeydown,onkeyup:this._handlers.onkeyup,class:"dhx_widget dhx_combobox"+("left"===i?" dhx_combobox--label-inline":"")+(n?" dhx_combobox--sr_only":"")+(o?" dhx_combobox--required":"")+(a?" dhx_combobox--disabled":"")+(l?" "+l:"")},[v?s.el("label.dhx_label.dhx_combobox__label",{style:v.style,class:u?"dhx_label--with-help":"",onclick:this._handlers.oninputclick},u?[(v.label||o)&&s.el("span.dhx_label__holder",v.label),s.el("span.dhx_label-help.dxi.dxi-help-circle-outline",{tabindex:"0",role:"button",onclick:this._handlers.showHelper,id:"dhx_label__help_"+this._uid})]:v.label):null,s.el("div.dhx_combobox-input-box"+(a?".dhx_combobox-input-box--disabled":"")+(d?".dhx_combobox-input-box--readonly":"")+(this._state.currentState===b.ComboState.error?".dhx_combobox-input-box--state_error":"")+(this._state.currentState===b.ComboState.success?".dhx_combobox-input-box--state_success":""),{_ref:"holder"},[s.el("div.dhx_combobox-input__icon",{onclick:this._handlers.toggleIcon},[s.el("span"+(this.popup.isVisible()?".dxi.dxi-menu-up":".dxi.dxi-menu-down"))]),s.el("div.dhx_combobox-input-list-wrapper",{onclick:this._handlers.oninputclick},[s.el("ul.dhx_combobox-input-list",r(this._drawSelectedItems(),[s.el("li.dhx_combobox-input-list__item.dhx_combobox-input-list__item--input",[s.el("input.dhx_combobox-input",{oninput:this._handlers.oninput,onfocus:this._handlers.onfocus,onblur:this._handlers.onblur,_ref:"input",_key:this._uid,type:"text",placeHolder:p&&h?h:void 0,value:d&&f?this._getItemText(f):this._state.value,readOnly:d||a,required:o,"aria-label":d?"Select value":"Type or select value","aria-describedby":u?"dhx_label__help_"+this._uid:null,"aria-expanded":!0})])]))])])])},t.prototype._drawSelectedItems=function(){var e=this;if(!this.config.multiselection)return [];if(this.config.itemsCount){var t=this.list.selection.getId().length;return t?[s.el("li.dhx_combobox-input-list__item.dhx_combobox-tag",[s.el("span.dhx_combobox-tag__value",w(t,this.config.itemsCount)),s.el("button.dhx_button.dhx_combobox-tag__action.dhx_combobox__action-clear-all",{"aria-label":"clear all"},[s.el("span.dhx_button__icon.dxi.dxi-close-circle")])])]:[]}return this.list.selection.getId().map((function(t){var i=e.data.getItem(t);return i?s.el("li.dhx_combobox-input-list__item.dhx_combobox-tag",{"data-dhx-id":t},[e._drawImageOrIcon(i),s.el("span.dhx_combobox-tag__value",e._getItemText(i)),s.el("button.dhx_button.dhx_button--icon.dhx_combobox-tag__action.dhx_combobox__action-remove",{type:"button","aria-label":"remove"},[s.el("span.dhx_button__icon.dxi.dxi-close-circle")])]):null}))},t.prototype._drawImageOrIcon=function(e){return e.src?s.el("img.dhx_combobox-tag__image",{src:e.src,alt:""}):e.icon?s.el("span.dhx_combobox-tag__icon",{class:e.icon}):null},t.prototype._getItemText=function(e){return e?e.value:null},t.prototype._updateSelectedItem=function(e){var t;this.config.multiselection?(this.config.selectAllButton&&!this._state.unselectActive&&this.data.getLength()===e.length?(this._layout.getCell("select-unselect-all").attach(y.unselectAllView),this._state.unselectActive=!0):this.config.selectAllButton&&this._state.unselectActive&&(this._layout.getCell("select-unselect-all").attach(y.selectAllView),this._state.unselectActive=!1),this._state.value&&(this._state.value="",this._state.canDelete=0===e.length,this._filter())):this._state.value=null!==(t=this._getItemText(this.data.getItem(e)))&&void 0!==t?t:"",this.paint();},t.prototype._changePopupPosition=function(){var e=this;this.config.multiselection&&s.awaitRedraw().then((function(){e._updatePopup();}));},t.prototype._updatePopup=function(){var e=this.getRootView().refs.holder.el;this.popup.getContainer().style.width=e.offsetWidth+"px";var t=this.data.getLength()*(this.config.itemHeight||36);"string"==typeof this.config.listHeight&&this.config.listHeight.includes("px")&&(this.config.listHeight=this.config.listHeight.replace("px",""));var i=t<this.config.listHeight?t:this.config.listHeight;this.popup.getContainer().style.height=Number(i)+(this.config.selectAllButton&&this.config.multiselection&&this._layout.getCell("select-unselect-all").isVisible()?33:0)+(this._state.creatingState?this._layout.getCell("not-found").height:0)+"px",this.popup.show(e,{mode:"bottom"});},t}(d.View);t.Combobox=E;},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);}),r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},a=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),l=i(13),c=i(0),u=i(20),d=i(41),h=i(7),f=i(81),p=i(3),v=i(56),g=i(154);t.MOVE_UP=1,t.MOVE_DOWN=2;var _=function(e){function i(t,i){void 0===i&&(i={});var n=this,o=i.itemHeight||(i.virtual?37:null);o&&"number"==typeof o&&(o=o.toString()+"px"),(n=e.call(this,t,s.extend({itemHeight:o,keyNavigation:!0,editable:!1,selection:!0,htmlEnable:!0},i))||this)._touch={duration:350,dblDuration:300,timer:null,start:!1,timeStamp:null};var r=n.config.data;r instanceof l.DataCollection?(n.data=r,n.events=r.events):(n.data=new l.DataCollection({}),n.events=n.data.events,r&&n.data.parse(r)),n.selection=new f.Selection({disabled:!n.config.selection,multiselection:n.config.multiselection},n.data,n.events),n.config.keyNavigation&&(n.keyManager=new u.KeyManager((function(e,t){return t==n._uid&&(!n._edited||n._edited&&"escape"!==e.key)})),n._initHotKey()),n.events.on(l.DataEvents.change,(function(e,t,i){"setPage"===t&&n.showItem(n.data.getId(i[0])),n.paint();})),n.events.on(d.SelectionEvents.afterUnSelect,(function(){return n.paint()})),n.events.on(d.SelectionEvents.afterSelect,(function(e){e&&n.config.selection&&(n._focus=e),n.paint();})),n.events.on(v.ListEvents.afterEditEnd,n.editEnd.bind(n));var a=function(e){return function(t){n.data.setMeta(n.data.getItem(t.target),"drop",e),n.paint();}};n.events.on(l.DragEvents.canDrop,a(!0)),n.events.on(l.DragEvents.cancelDrop,a(!1));var h=function(e){return function(t){t.source.map((function(t){return n.data.setMeta(n.data.getItem(t),"drag",e)})),n.paint();}};n.events.on(l.DragEvents.dragStart,h(!0)),n.events.on(l.DragEvents.afterDrag,h(!1)),n._handlers={onmousedown:function(e){n._dragStart(e);},ontouchstart:function(e){(n._touch.timer=setTimeout((function(){n._dragStart(e);}),n._touch.duration),n._touch.timeStamp)?(n._touch.dblDuration>=n._touch.timeStamp-+e.timeStamp.toFixed()&&(e.preventDefault(),n._dblClick(e)),n._touch.timeStamp=null):n._touch.timeStamp=+e.timeStamp.toFixed();setTimeout((function(){n._touch.timeStamp=null;}),n._touch.dblDuration);},ontouchmove:function(e){n._touch.start&&e.preventDefault(),n._clearTouchTimer();},ontouchend:function(){n._touch.start=!1,n._clearTouchTimer();},ondragstart:function(){return !(n.config.dragMode&&!n._edited)&&null},oncontextmenu:function(e){var t,i=null===(t=n.data.getItem(p.locate(e)))||void 0===t?void 0:t.id;i&&n.events.fire(v.ListEvents.itemRightClick,[i,e]);},onclick:function(e){var t,i=null===(t=n.data.getItem(p.locate(e)))||void 0===t?void 0:t.id;i&&(n.selection.add(i,e.ctrlKey||e.metaKey,e.shiftKey),n.config.selection&&(n._focus=i),n.events.fire(v.ListEvents.click,[i,e]),n.paint());},ondblclick:function(e){n._dblClick(e);},onscroll:function(e){n.config.virtual&&(n._topOffset=e.target.scrollTop,n._visibleHeight=e.target.offsetHeight,n.paint());},onmouseover:function(e){var t,i=null===(t=n.data.getItem(p.locate(e)))||void 0===t?void 0:t.id;i&&(i!==p.locate(e.relatedTarget)&&n.events.fire(v.ListEvents.itemMouseOver,[i,e]));}};var g=n.config.eventHandlers;if(g)for(var _=0,m=Object.entries(g);_<m.length;_++){var y=m[_],b=y[0],w=y[1];n._handlers[b]=p.eventHandler((function(e){return p.locate(e)}),w,n._handlers[b]);}n.config.dragMode&&l.dragManager.setItem(n._uid,n),n._topOffset=n._visibleHeight=0;var x=c.create({render:function(){return n._renderList()},hooks:{didMount:function(e){n.config.virtual&&(n._visibleHeight=e.node.el.offsetHeight);},didRedraw:function(e){return n._didRedraw(e)}}});return n.mount(t,x),n}return o(i,e),i.prototype._didRedraw=function(e){},i.prototype._dblClick=function(e){var t=p.locate(e);t&&(t=this.data.getItem(t).id,this.config.editable&&this.editItem(t),this.events.fire(v.ListEvents.doubleClick,[t,e]));},i.prototype._clearTouchTimer=function(){this._touch.timer&&(clearTimeout(this._touch.timer),this._touch.timer=null);},i.prototype._dragStart=function(e){var t=this;this._touch.start=!0;var i=[],n=p.locateNode(e,"data-dhx-id"),o=n&&n.getAttribute("data-dhx-id"),r=this.selection.getId();return this.config.multiselection&&r instanceof Array&&(r.map((function(e){e!==o&&t.getRootView().refs[e]&&i.push(t.getRootView().refs[e].el);})),r=a(r)),"string"==typeof r&&(r=[r]),this.config.dragMode&&!this._edited?l.dragManager.onMouseDown(e,r||[o],i):null},i.prototype.disableSelection=function(){this.selection.disable();},i.prototype.enableSelection=function(){this.selection.enable();},i.prototype.editItem=function(e){this._edited=e,this.data.getItem(this._edited)&&this.events.fire(v.ListEvents.beforeEditStart,[e])?(this.paint(),this.events.fire(v.ListEvents.afterEditStart,[e])):this._edited=null;},i.prototype.editEnd=function(e,t){if(this._edited){if(null!==e){var i=this.data.getItem(t);this.data.update(t,r(r({},i),{value:e})),this._changed=!0;}this._edited=null,this.paint();}},i.prototype.getFocusItem=function(){return this.data.getItem(this._focus)},i.prototype.setFocus=function(e){this._focus!=e&&this.data.exists(e)&&(this._focus=e,this.showItem(e),this.events.fire(v.ListEvents.focusChange,[this.data.getIndex(this._focus),this._focus]),this.paint());},i.prototype.getFocus=function(){return this._focus},i.prototype.destructor=function(){this.events&&this.events.clear(),this.keyManager&&this.keyManager.destructor(),this.selection&&this.selection.destructor(),this.config=this.events=this.selection=this.keyManager=null,this._handlers=this._focus=this._edited=this._events=this._topOffset=this._visibleHeight=this._touch=null,this.unmount();},i.prototype.showItem=function(e){var t=this.getRootView();if(t&&t.node&&t.node.el&&void 0!==e){var i=this.getRootNode();if(i){var n=this.config.virtual,o=this.data.getIndex(e),r=Math.floor(o/i.children.length)||0,a=i.children[o-i.children.length*r];if(n||a){var s=n?parseInt(this.config.itemHeight):a.clientHeight,l=n?o*s:a.offsetTop;l>=i.scrollTop+i.clientHeight-s?i.scrollTo(0,l-i.clientHeight+s):l<i.scrollTop&&i.scrollTo(0,l);}}}},i.prototype._renderItem=function(e,t){var i=this.config.itemHeight;if(e.$empty)return c.el("li",{class:"dhx_list-item",style:{height:i}});var n=this.config.template&&this.config.template(e)||e.html,o=e.id==this._focus;if(e.id==this._edited)return g.getEditor(e,this).toHTML();var a=this.data.getMetaMap(e),s=r(r(r(r({},this._events),{class:"dhx_list-item"+(a&&a.selected?" dhx_list-item--selected":"")+(o?" dhx_list-item--focus":"")+(a&&a.drop&&!this._edited?" dhx_list-item--drophere":"")+(a&&a.drag&&!this._edited?" dhx_list-item--dragtarget":"")+(this.config.dragMode&&!this._edited?" dhx_list-item--drag":"")+(e.css?" "+e.css:""),"data-dhx-id":e.id,_ref:e.id.toString(),style:{height:i},_key:e.id}),this.getItemAriaAttrs(this,e)),{tabindex:o?0:-1});if(n)return n===e.html||this.config.htmlEnable?(s[".innerHTML"]=n,c.el("li",s)):c.el("li",s,n);var l=e.text||e.value;return this.config.htmlEnable?s[".innerHTML"]=l:s.class+=" dhx_list-item--text",this.config.htmlEnable?c.el("li",s):c.el("li",s,l)},i.prototype._renderList=function(){var e=this,t=this._getRange(),i=this.data.getRawData(t[0],t[1]).map((function(t,i){return e._renderItem(t,i)}));return this.config.virtual&&(i=a([c.el(".div",{style:{height:t[2]+"px"}})],i,[c.el(".div",{style:{height:t[3]+"px"}})])),c.el("ul.dhx_widget.dhx_list",r(r({style:{"max-height":this.config.height,position:"relative"},tabindex:0,class:(this.config.css?this.config.css:"")+(this.config.multiselection&&this.selection.getItem()?" dhx_no-select--pointer":""),"data-dhx-widget-id":this._uid},this._handlers),this._getListAriaAttrs(this.config,this.data.getLength())),i)},i.prototype.moveFocus=function(e,i){var n=this.data.getLength();if(n){var o=this._focus,r=o?this.data.getIndex(o):-1;i=i||1,e===t.MOVE_DOWN?o=this.data.getId(Math.min(r+i,n-1)):e===t.MOVE_UP&&(o=this.data.getId(Math.max(r-i,0))),this.setFocus(o);}},i.prototype._getRange=function(){if(this.config.virtual){var e=this._visibleHeight||parseInt(this.config.height),t=parseInt(this.config.itemHeight),i=this.data.getRawData(0,-1).length,n=i*t,o=this._topOffset;o=Math.max(0,Math.min(o,n-e));var r=Math.floor(o/t),a=Math.min(i-r,Math.floor(e/t)+5);return this._topOffset=o,[r,a+r,r*t,n-t*(a+r)]}return [0,-1,0,0]},i.prototype._getHotkeys=function(){var e=this;return {arrowDown:function(i){e.moveFocus(t.MOVE_DOWN),e._changed&&(e._changed=!1),i.preventDefault();},arrowUp:function(i){e.moveFocus(t.MOVE_UP),e._changed&&(e._changed=!1),i.preventDefault();},escape:function(){e.editEnd(null),e._changed&&(e._changed=!1);},enter:function(t){var i;if(e._changed)e._changed=!1;else {var n=e.selection.getItem(),o=n instanceof Array?null===(i=n[0])||void 0===i?void 0:i.id:null==n?void 0:n.id;e.config.editable&&!e._edited&&(n&&o===e._focus||!n)?e.editItem(e._focus):e.selection.add(e._focus),e.events.fire(v.ListEvents.click,[e._focus,t]);}},"shift+enter":function(t){e.selection.add(e._focus,!1,!0),e.events.fire(v.ListEvents.click,[e._focus,t]);},"ctrl+enter":function(t){e.selection.add(e._focus,!0,!1),e.events.fire(v.ListEvents.click,[e._focus,t]);},"ctrl+a":function(t){e.config.multiselection&&(t.preventDefault(),e.selection.remove(),e.data.map((function(e){return e.id})).forEach((function(t){"ctrlClick"===e.config.multiselection?e.selection.add(t,!0):e.selection.add(t);})));}}},i.prototype._initHotKey=function(){var e=this._getHotkeys();for(var t in e)this.keyManager.addHotKey(t,e[t]);for(var t in this.config.hotkeys)this.keyManager.addHotKey(t,this.config.hotkeys[t]);},i.prototype.getItemAriaAttrs=function(e,t){return r(r({role:"option","aria-selected":t.$selected?"true":"false"},function(e,t){return e.config.dragMode&&!e._edited?{"aria-grabbed":Boolean(t.$dragtarget&&!e._edited).toString()}:{}}(e,t)),function(e){return e.config.editable?{"aria-roledescription":e._edited?"Press Enter to stop editing":"Double click to edit content"}:{}}(e))},i.prototype._getListAriaAttrs=function(e,t){return {role:"listbox","aria-label":"Listbox "+(e.title||"")+", count of options = "+t+"."+(e.editable?" Content is editable.":""),"aria-multiselectable":e.selection&&e.multiselection?"true":"false","aria-readonly":e.editable?"false":"true"}},i}(h.View);t.List=_;},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(41),o=i(13),r=function(){function e(e,t,i){var n=this;if(this.config=e,this.events=i,this._data=t,this._selected=[],this._data.events.on(o.DataEvents.removeAll,(function(){n._selected=[];})),"string"==typeof this.config.multiselection){["click","ctrlClick"].includes(this.config.multiselection)||(this.config.multiselection=!1);}this._data.events.on(o.DataEvents.beforeRemove,(function(e){if(n._nextSelection=null,1===n._selected.length){var t=n._data.getIndex(e.id),i=n._data.getLength();if(i>1){var o=i==t-1?t-1:t+1;n._nextSelection=n._data.getId(o);}}})),this._data.events.on(o.DataEvents.afterRemove,(function(e){var t=n._selected.indexOf(e.id);-1!==t&&n._selected.splice(t,1),n._nextSelection&&(n.add(n._nextSelection),n._nextSelection=null);}));}return e.prototype.enable=function(){this.config.disabled=!1;},e.prototype.disable=function(){this.remove(),this.config.disabled=!0;},e.prototype.getId=function(){return this.config.multiselection?this._selected:this._selected[0]},e.prototype.getItem=function(){var e=this;return this.config.multiselection?this._selected.map((function(t){return e._data.getItem(t)})):this._selected.length?this._data.getItem(this._selected[0]):null},e.prototype.contains=function(e){return e?this._selected.includes(e):this._selected.length>0},e.prototype.remove=function(e){var t=this;e?this._unselectItem(e):(this._selected.forEach((function(e){return t._unselectItem(e)})),this._selected=[]);},e.prototype.add=function(e,t,i,n){var o=this;if(!this.config.disabled)if(void 0!==e){var r=this.config.multiselection;i&&this._selected.length&&r?this._addMulti(e,n):this._addSingle(e,r&&("ctrlClick"!==r||t),n);}else {var a=this._data.serialize().filter((function(e){var t=e.id;return !o._selected.includes(t)}));a.forEach((function(e){var t=e.id;o._addMulti(t,n);}));}},e.prototype.destructor=function(){var e=this;this._selected.forEach((function(t){return e._unselectItem(t,!0)}));},e.prototype._addMulti=function(e,t){var i,n=this._selected[this._selected.length-1],o=this._data.getIndex(n),r=this._data.getIndex(e);for(o>r&&(o=(i=[r,o])[0],r=i[1]);o<=r;o++){var a=this._data.getId(o);this._selectItem(a,t);}},e.prototype._addSingle=function(e,t,i){var n=this;t||this._selected.forEach((function(t){t!=e&&n._unselectItem(t);})),t&&this._selected.includes(e)?this._unselectItem(e,i):this._selectItem(e,i);},e.prototype._selectItem=function(e,t){var i=this._data.getItem(e);i&&!this._data.getMeta(i,"selected")&&(t||this.events.fire(n.SelectionEvents.beforeSelect,[e]))&&(this._selected.push(e),this._data.setMeta(i,"selected",!0),t||this.events.fire(n.SelectionEvents.afterSelect,[e]));},e.prototype._unselectItem=function(e,t){(t||this.events.fire(n.SelectionEvents.beforeUnSelect,[e]))&&(this._selected=this._selected.filter((function(t){return t!==e})),this._data.setMeta(this._data.getItem(e),"selected",!1),t||this.events.fire(n.SelectionEvents.afterUnSelect,[e]));},e}();t.Selection=r;},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.default={notFound:"Not Found",selectAll:"Select All",unselectAll:"Unselect All",selectedItems:"selected items",createItem:"Create"};},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),o=i(82);t.selectAllView=function(){return n.el(".dhx_list-item.dhx_combobox-options__item.dhx_combobox-options__item--select-all.dhx_combobox__action-select-all",o.default.selectAll)},t.unselectAllView=function(){return n.el(".dhx_list-item.dhx_combobox-options__item.dhx_combobox-options__item--select-all.dhx_combobox__action-select-all",o.default.unselectAll)},t.emptyListView=function(e){return n.el("ul.dhx_list",[n.el("li.dhx_list-item.dhx_combobox-options__item"+(e?".dhx_combobox-options__action-create-option":""),{},e?o.default.createItem+' "'+e+'"':o.default.notFound)])},t.emptyListHeight=function(e,t){var i=document.createElement("canvas").getContext("2d",{alpha:!1});i.font="normal 14px Roboto";var n=e?o.default.createItem+' "'+e+'"':o.default.notFound;return 13+20*Math.ceil(i.measureText(n).width/(t-16))};},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.change="change",e.focus="focus",e.blur="blur",e.keydown="keydown",e.input="input",e.beforeOpen="beforeOpen",e.afterOpen="afterOpen",e.beforeClose="beforeClose",e.afterClose="afterClose",e.open="open",e.close="close";}(t.ComboboxEvents||(t.ComboboxEvents={})),function(e){e[e.default=0]="default",e[e.error=1]="error",e[e.success=2]="success";}(t.ComboState||(t.ComboState={}));},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)},o=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),a=i(3),s=i(28),l=i(86),c=i(21),u=i(33);t.getFixedColsHeader=function(e,t){if("number"==typeof e.leftSplit){for(var i=0,o=0;o<e.leftSplit;o++)e.columns[o].hidden&&i++;if(i!==e.leftSplit){for(var a=e.columns.slice(0,e.leftSplit-i),s=0,u=0,d=a;u<d.length;u++){s+=d[u].$width;}var h=e.leftSplit>=0&&l.getFixedRows(n(n({},e),{currentColumns:a,$positions:n(n({},e.$positions),{xStart:0,xEnd:e.leftSplit}),scroll:{top:0,left:0},columns:a}),n(n({},t),{name:"header",position:"top",shifts:{x:0,y:0}})),f=n(n({},t),{name:"header",position:"top"});return h&&r.el(".dhx_"+f.name+"-fixed-cols",n({onwheel:c.scrollFixedColsAndRows,style:{position:"absolute",top:0,left:0,maxWidth:s,overflow:"hidden"}},{role:"rowgroup","aria-rowcount":h.length}),h.body)}}},t.getFixedCols=function(e,t){var i=e.leftSplit,d=e.$totalWidth,h=e.columns,f=e.$totalHeight,p=e.headerHeight,v=e.footerHeight,g=e.$positions,_=e.scroll,m=e.data;if("number"==typeof i){for(var y=0,b=0;b<i;b++)h[b].hidden&&y++;if(y!==i){var w,x=f+p+v+u.BORDERS<=t.wrapper.height?0:a.getScrollbarWidth(),E=d+u.BORDERS+x<=t.wrapper.width?0:a.getScrollbarWidth(),C=f+p+v;w=C>t.gridBodyHeight?e.$footer?C-E:t.gridBodyHeight:C<t.gridBodyHeight-E?C:e.$footer?t.gridBodyHeight:t.gridBodyHeight-E;var S=h.slice(0,i-y);e.fixedColumnsWidth=c.getTotalWidth(S);var I="fixedCols",k=s.getCells(n(n({},e),{columns:S,$renderFrom:I,$positions:n(n({},g),{xStart:0,xEnd:i})})),M=t.sticky,P=n(n({},t),{name:"footer",position:"bottom"}),O=i>=0&&l.getRows(n(n({},e),{currentColumns:S,$positions:n(n({},g),{xStart:0,xEnd:i})}),n(n({},t),{name:"footer",position:"bottom"})),A=0;O&&O.forEach((function(e){return A+=e.attrs.style.height}));var D=function(e){return {role:"rowgroup","aria-rowcount":e}},F=M?O&&r.el(".dhx_"+P.name+"-fixed-cols",n({onwheel:c.scrollFixedColsAndRows,style:{position:"absolute",top:w<t.gridBodyHeight?w-A:null,left:0,bottom:w>=t.gridBodyHeight?0+(M?E:0)+"px":null}},D(O.length)),O):null,V=g,R=u.getEvents(e,"leftSplit"),T=s.getSpans(n(n({},e),{$renderFrom:I}),!0);return [r.el(".dhx_grid-fixed-cols-wrap",n(n({style:{height:w>=t.gridBodyHeight?(M?t.gridBodyHeight:t.gridBodyHeight+p)-E:w,paddingTop:p,overflow:"hidden",width:e.fixedColumnsWidth}},R),{role:"presentation","aria-label":"Fixed column"}),[r.el(".dhx_grid-fixed-cols",n(n({onwheel:c.scrollFixedColsAndRows,style:{top:-_.top+p-1+"px",paddingTop:t.shifts.y,height:f,position:"absolute"},_flags:r.KEYED_LIST},s.getHandlers(V.yStart,V.xStart,e)),D(m.length)),o(k,[T&&r.el("span.dhx_span-spans",{role:"presentation"},[T])])),r.el(".dhx_frozen-cols-border",{role:"presentation"})]),e.$footer?F:null]}}};},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)},o=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),a=i(3),s=i(38),l=i(21),c=i(11),u=i(28),d=i(85),h=i(33),f=2;function p(e,t,i,n){i&&(i.toLocaleLowerCase().includes("touch")?t._events.fire(i,[e,n]):t.events.fire(i,[e,n]));}function v(e,t,i){return {onclick:[p,e,i,c.GridEvents[t+"CellClick"]],onmouseover:[p,e,i,c.GridEvents[t+"CellMouseOver"]],onmousedown:[p,e,i,c.GridEvents[t+"CellMouseDown"]],ontouchstart:[p,e,i,c.GridEvents[t+"CellMouseDown"]],ondblclick:[p,e,i,c.GridEvents[t+"CellDblClick"]],oncontextmenu:[p,e,i,c.GridEvents[t+"CellRightClick"]],ontouchmove:[p,e,i,c.GridSystemEvents[t+"CellTouchMove"]],ontouchend:[p,e,i,c.GridSystemEvents[t+"CelltouchEnd"]]}}function g(e,t,i,n,o,a){void 0===o&&(o="");var s=t.type?"dhx_"+t.type+"-cell":"dhx_string-cell",l=i.content[e.content]&&i.content[e.content].toHtml(t,i),c={};return i.columns.forEach((function(e){var t=!!i.content[e[n][a].content];c[e.id]=t&&i.content[e[n][a].content].toHtml(e,i)||e[n][a].text;})),r.el("."+s,{style:{class:o.trim(),padding:0}},[l&&("string"==typeof l||"number"==typeof l?r.el("div",{class:"dhx_grid-footer-cell-text",role:"presentation",".innerHTML":t.template&&"string"==typeof l?t.template(l,c,t):l}):l)])}function _(e,t){if(!e.data||!e.columns)return [];var i,o=e.$positions,a=t.name,s=e.currentColumns,c=e[a+"RowHeight"]||40,u=function(e,t){var i=e.map((function(e){return e[t]||[{}]}));return l.transpose(i)}(s,a),d=1;return u.map((function(t,h){return r.el(".dhx_"+a+"-row",n({style:{height:c}},{role:"row","aria-rowindex":h+1}),t.map((function(t,p){var _,m=t.css||"",y=s[p],b=o.xStart+p+1,w="dxi dxi-sort-variant dhx_grid-sort-icon",x="none";if(e.sortBy&&""+y.id===e.sortBy&&!t.content){var E=e.sortDir||"asc";w+=" dhx_grid-sort-icon--"+E,m+=" dhx_grid-"+a+"-cell--sorted ",x="asc"===E?"ascending":"descending";}var C=l.isSortable(e,y)&&t.text&&"footer"!==a&&!1!==t.headerSort;C&&(m+=" dhx_grid-header-cell--sortable");var S=0===p?"dhx_first-column-cell":"",I=p===s.length-1?"dhx_last-column-cell":"";t.content||(t.align?m+=" dhx_grid-header-cell--align_"+t.align+" ":m+=" dhx_grid-header-cell--"+("number"===y.type||"percent"===y.type||"date"===y.type?"align_right":"align_left")+" "),m+=S+" "+I;var k=void 0!==y.resizable?y.resizable:e.resizable;if(k){k=r.el("div",{class:"dhx_resizer_grip_wrap","aria-hidden":"true"},[r.el("div",{class:"dhx_resizer_grip",dhx_resized:y.id,style:{height:100*u.length+"%"}},[r.el("div",{class:"dhx_resizer_grip_line"})])]);var M=y.header&&(null===(_=y.header[0])||void 0===_?void 0:_.colspan);M&&(i=M,d=1),i&&d!==i&&(0===h&&(k=null),d++),"footer"===a&&(k=null);}t.align&&(m+=" dhx_align-"+t.align);var P=function(e,i,n){var o={"aria-colindex":i};return "footer"===e||t.content?o.role="gridcell":(o.role="columnheader",o["aria-sort"]=n),o};if(t.content)return r.el(".dhx_grid-"+a+"-cell.dhx_grid-custom-content-cell",n(n({class:m.trim(),"data-dhx-id":y.id,_key:p,style:{width:y.$width,height:"footer"===a?c+f/2+"px":c+"px"}},v(y,a,e)),P(a,b,x)),[g(t,y,e,a,"",h),k||null]);var O,A="dhx_grid-header-cell-text_content";return e.autoHeight&&(A+=" dhx_grid-header-cell-text_content-auto-height"),r.el(".dhx_grid-"+a+"-cell",n(n({class:m.trim(),"data-dhx-id":y.id,_key:p,style:{width:y.$width,height:"footer"===a?c+f/2+"px":c+"px"}},v(y,a,e)),P(a,b,x)),[r.el("div.dhx_grid-header-cell-text",{role:"presentation"},[r.el("span",n(n({class:A},(O=t.text,C?{role:"button","aria-label":"Sort by "+O}:{})),{".innerHTML":t.text})),k||null]),C&&r.el("div",{class:w,"aria-hidden":"true"})])})))}))}function m(e,t){var i=e.columns,o=l.transpose(i.map((function(e){return e[t.name]||[]}))),a=e[t.name+"RowHeight"]||40,c=t.name,u=0;return o.map((function(o,d){return u=0,r.el(".dhx_span-row",{style:{top:a*d+"px",height:a},class:"dhx_header-row","aria-hidden":"true"},o.map((function(o,h){var p=i[h];u+=p.hidden?0:p.$width;var _=0===h?"dhx_first-column-cell":"",m=h===i.length-1||(o.colspan||0)+(h-1)>=i.length-1?"dhx_last-column-cell":"",y=a;o.rowspan&&(y=y*o.rowspan-1);var b=l.isSortable(e,p)&&o.rowspan&&o.text&&"footer"!==t.name&&!1!==o.headerSort,w="dxi dxi-sort-variant dhx_grid-sort-icon";e.sortBy&&""+p.id===e.sortBy&&!o.content&&(w+=" dhx_grid-sort-icon--"+(e.sortDir||"asc"));var x=p.align?"dhx_align-"+p.align:"number"!==p.type&&"percent"!==p.type&&"date"!==p.type||o.colspan?"dhx_align-left":"dhx_align-right",E="dhx_grid-header-cell "+_+" "+m+" "+(o.rowspan?"dhx_span-cell__rowspan":"")+" "+(o.align?"dhx_align-"+o.align:x)+" "+(o.css?o.css:"");b&&(E+=" dhx_grid-header-cell--sortable"),o.content||(o.align?E+=" dhx_grid-header-cell--align_"+o.align+" ":E+=" dhx_grid-header-cell--"+("number"===p.type||"percent"===p.type||"date"===p.type?"align_right":"align_left")+" ");var C=null;o.content&&((C=g(o,p,e,c,E,d)).attrs.style=n(n({},C.attrs.style),{width:"100%",borderRight:"0"}));var S="";u-p.$width>0&&(S="1px solid #e4e4e4");var I="dhx_grid-header-cell-text_content";return e.autoHeight&&(I+=" dhx_grid-header-cell-text_content-auto-height"),o.colspan||o.rowspan?r.el(".dhx_span-cell",n({style:{width:s.getWidth(i,o.colspan,h),height:"footer"===c?y+f/2:y,left:u-p.$width,borderLeft:S,top:a*d},class:E.trim(),"data-dhx-id":p.id},v(p,c,e)),[C||o.rowspan?r.el("div.dhx_grid-header-cell-text",{role:"presentation"},[r.el("span",{class:I,".innerHTML":o.text})]):r.el("span",{class:I,".innerHTML":o.text}),b&&r.el("div",{class:w})]):null})).filter((function(e){return e})))}))}function y(e){return {role:"rowgroup","aria-rowcount":e}}t.getRows=_,t.getFixedSpans=m,t.getFixedRows=function(e,t){var i,a=_(e,t),s=m(e,t),l=null;"footer"!==t.name||t.sticky||(l=e.leftSplit>=0&&_(n(n({},e),{currentColumns:e.columns.slice(0,e.leftSplit),$positions:n(n({},e.$positions),{xStart:0,xEnd:e.leftSplit})}),t));var c,u=((i={position:"sticky"})[t.position]=0,i);return t.sticky||(u.left=-e.scroll.left,c=-e.scroll.left,u.position="relative"),r.el(".dhx_"+t.name+"-wrapper",{class:t.sticky?"":"dhx_compatible-"+t.name,style:n(n({},u),{left:t.sticky?c:0,height:"footer"===t.name?e[t.name+"Height"]+f/2:e[t.name+"Height"],width:t.sticky?e.$totalWidth:t.wrapper.width-f}),role:"presentation"},[r.el(".dhx_grid-"+t.name+(e.leftSplit?".dhx_grid_fixed_left":""),{style:{height:"footer"===t.name?e[t.name+"Height"]+f/2:e[t.name+"Height"],left:c,paddingLeft:t.shifts.x,width:e.$totalWidth},role:"presentation"},[r.el(".dhx_"+t.name+"-rows",n({},y(o(a).length)),o(a)),r.el(".dhx_"+t.name+"-spans",{style:{marginLeft:-t.shifts.x},class:"dhx_"+t.name+"-rows",role:"presentation"},s),l&&r.el(".dhx_"+t.name+"-fixed-cols",{style:{position:"absolute",top:0,left:e.scroll.left+"px",height:"100%"}},l)]),r.el("div",{style:{width:e.$totalWidth},role:"presentation"})])},t.getFixedDataRows=function(e,t){if("number"==typeof e.topSplit){var i=e.$totalWidth,s=e.topSplit,c=e.$positions,f=e.data,p=e.$totalHeight,v=e.width,g=f.slice(0,s),_="fixedRows",m=u.getCells(n(n({},e),{data:g,$renderFrom:_,$positions:n(n({},c),{yStart:0,yEnd:s})})),b=h.getEvents(e,"topSplit"),w=g.reduce((function(e,t){return e+t.$height}),0),x=u.getSpans(n(n({},e),{$renderFrom:_,data:f}),!0),E=d.getFixedCols(n(n({},e),{headerHeight:0,data:g,$renderFrom:_,scroll:n(n({},e.scroll),{top:-1}),$positions:n(n({},c),{yStart:0,yEnd:s}),$totalHeight:w}),n(n({},t),{shifts:n(n({},t.shifts),{y:0})}))||[];return [r.el(".dhx_grid-fixed-data-rows-wrap",{style:{top:e.headerHeight,overflow:"hidden",height:w>t.wrapper.height?t.wrapper.height:w,width:i<v?i:p>=t.gridBodyHeight?v-a.getScrollbarWidth()-2:v-2}},o([r.el(".dhx_grid-fixed-cols",n(n({onwheel:l.scrollFixedColsAndRows,style:{left:-e.scroll.left+"px",paddingLeft:t.shifts.x,position:"absolute",width:i},_flags:r.KEYED_LIST},u.getHandlers(0,c.xStart,e)),y(f.length)),[r.el(".dhx_grid-fixed-rows",n({},b),o(m,[x&&r.el(".dhx_span-spans",{role:"presentation"},[x])]))])],E))]}};},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);}),r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=i(1),s=i(0),l=i(3),c=i(16),u=i(22),d=function(e){function t(t,i){var n=e.call(this,t,a.extend({navigationType:"click"},i))||this;n._currentRoot=null;return n.mount(t,s.create({render:function(){return n._draw(t)}})),n}return o(t,e),t.prototype.getState=function(e){if(!a.isDefined(e)||this.data.getItem(e)){var t={};for(var i in this.data.eachChild(this.data.getRoot(),(function(e){e.twoState&&!e.group?t[e.id]=e.active:"input"!==e.type&&"selectButton"!==e.type&&"datePicker"!==e.type||(t[e.id]=e.value);}),!1),this._groups)this._groups[i].active&&(t[i]=this._groups[i].active);return e?t[e]:t}},t.prototype.setState=function(e){var t,i=function(i){if(n._groups&&n._groups[i])n._groups[i].active&&(n.data.update(n._groups[i].active,{active:!1}),n._groups[i].active=e[i],n.data.update(e[i],{active:!0}));else {var o=n.data.getItem(i);switch(o.type){case"input":n.data.update(i,{value:e[i]});break;case"selectButton":var r=null===(t=o.items)||void 0===t?void 0:t.find((function(t){return t.value===e[i]}));n.data.update(i,{value:e[i],icon:null==r?void 0:r.icon});break;default:n.data.update(i,{active:e[i]});}}},n=this;for(var o in e)i(o);},t.prototype._customHandlers=function(){var e=this;return {input:function(t){var i=l.locate(t);e.data.update(i,{value:t.target.value});},tooltip:function(t){var i=l.locateNode(t);if(i){var n=i.getAttribute("data-dhx-id"),o=e.data.getItem(n);(null==o?void 0:o.tooltip)&&c.tooltip(o.tooltip,{node:i,position:c.Position.bottom});}}}},t.prototype._getFactory=function(){return u.createFactory({widget:this,defaultType:"navItem",allowedTypes:["button","imageButton","selectButton","navItem","menuItem","separator","spacer","title","input","customHTML","datePicker","customHTMLButton"],widgetName:"toolbar"})},t.prototype._draw=function(e){var t=this,i=this.data.getLength()?this.data.reduce((function(e,t){switch(t.type){case"title":return e||20;case"button":return "small"===t.size&&(!e||e<=28)?28:e||32;default:return 32}}),0)+24:null;return s.el("nav.dhx_widget.dhx_toolbar",{style:{height:i},class:this.config.css?this.config.css:""},[s.el("ul.dhx_navbar.dhx_navbar--horizontal",r(r({"data-dhx-widget-id":this._uid,tabindex:0},function(e){return {role:"toolbar","aria-label":e||""}}(e)),{onclick:this._handlers.onclick,onmousedown:this._handlers.onmousedown,oninput:this._handlers.input,onmouseover:this._handlers.tooltip,_hooks:{didInsert:function(e){e.el.addEventListener("keyup",(function(e){if(9===e.which){var i=l.locateNode(document.activeElement);if(i){var n=i.getAttribute("data-dhx-id"),o=t.data.getItem(n);(null==o?void 0:o.tooltip)&&c.tooltip(o.tooltip,{node:i,position:c.Position.bottom,force:!0});}}}),!0);}}}),this.data.map((function(e){return t._factory(e)}),this.data.getRoot(),!1))])},t.prototype._getMode=function(e,t){return e.id===t?"bottom":"right"},t.prototype._close=function(t){this._activePosition=null,this._currentRoot=null,e.prototype._close.call(this,t);},t.prototype._setRoot=function(e){this.data.getParent(e)===this.data.getRoot()&&(this._currentRoot=e);},t}(u.Navbar);t.Toolbar=d;},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(1),o=i(0),r=i(4),a=i(20),s=i(17),l=i(15),c=i(30),u=i(223),d=i(45),h=i(224),f=i(22),p=function(){function e(e){var t=this;this.config=n.extend({movable:!1,resizable:!1,closable:e.modal},e),this.config.node&&"string"==typeof this.config.node?this.config.node=document.getElementById(this.config.node):this.config.node||(this.config.node=document.body),this._uid=n.uid(),this.events=new r.EventSystem(this);var i=this._popup=document.createElement("div");i.tabIndex=1,i.setAttribute("role","dialog"),i.setAttribute("aria-modal",""+(this.config.modal||!1)),this.config.modal||h.default.add(this._uid,this._popup),this._fullScreen=!1,this._isActive=!1,this._keyManager=new a.KeyManager((function(e,i){return i===t._uid})),this._initHandlers(),this._initUI(),this.config.html&&this.attachHTML(this.config.html);}return e.prototype.paint=function(){this._layout.paint();},e.prototype.isFullScreen=function(){return this._fullScreen},e.prototype.setFullScreen=function(){this._fullScreen||(this._fullScreen=!0,this.setSize(window.innerWidth,window.innerHeight),this.setPosition(window.pageXOffset,window.pageYOffset));},e.prototype.unsetFullScreen=function(){this._fullScreen&&(this._fullScreen=!1,this.setSize(this._oldSizes.width,this._oldSizes.height),this.setPosition(this._oldPosition.left,this._oldPosition.top));},e.prototype.setSize=function(e,t){this._oldSizes={width:this._popup.offsetWidth,height:this._popup.offsetHeight};var i={width:this._oldSizes.width,height:this._oldSizes.height};n.isDefined(e)&&(this.config.width=i.width=e),n.isDefined(t)&&(this.config.height=i.height=t),this._popup.style.width=i.width+"px",this._popup.style.height=i.height+"px",this.events.fire(d.WindowEvents.resize,[i,this._oldSizes,{left:!0,top:!0,bottom:!0,right:!0}]);},e.prototype.getSize=function(){return {width:this._popup.offsetWidth,height:this._popup.offsetHeight}},e.prototype.setPosition=function(e,t){this._oldPosition={left:this._popup.offsetLeft,top:this._popup.offsetTop};var i={left:this._oldPosition.left,top:this._oldPosition.top};n.isDefined(e)&&(this.config.left=i.left=e),n.isDefined(t)&&(this.config.top=i.top=t),this._popup.style.left=i.left+"px",this._popup.style.top=i.top+"px",this.events.fire(d.WindowEvents.resize,[i,this._oldPosition,{left:!0,top:!0,bottom:!0,right:!0}]);},e.prototype.getPosition=function(){return {left:this._popup.offsetLeft,top:this._popup.offsetTop}},e.prototype.show=function(e,t){if(void 0===e&&(e=this.config.left),void 0===t&&(t=this.config.top),this.events.fire(d.WindowEvents.beforeShow,[{left:e,top:t}])){this.isVisible()&&this.hide(),h.default.setActive(this._uid),this._popup.className+=" dhx_popup dhx_widget"+(this.config.modal?" dhx_popup--window_modal":" dhx_popup--window")+(this.config.css?" "+this.config.css:""),this._popup.style.position=this.config.modal?"fixed":"absolute",this._popup.setAttribute("data-dhx-widget-id",this._uid);var i=this._getContainerParams(),o=i.containerInnerWidth,r=i.containerInnerHeight,a=i.containerXOffset,l=i.containerYOffset,c=this.config.width="number"==typeof this.config.width&&this.config.width||"number"==typeof this.config.minWidth&&this.config.minWidth||o/2,u=this.config.height="number"==typeof this.config.height&&this.config.height||"number"==typeof this.config.minHeight&&this.config.minHeight||r/2;if(this.config.left=e=n.isDefined(e)?e:(o-c)/(this.config.modal?2:2+a),this.config.top=t=n.isDefined(t)?t:(r-u)/(this.config.modal?2:2+l),this._isActive)return this._popup.style.left=e+"px",void(this._popup.style.top=t+"px");this.config.viewportOverflow&&h.default.openFreeWindow(this.config.node),this.config.modal&&this._blockScreen(),this._popup.style.width=c+"px",this._popup.style.height=u+"px",this._popup.style.left=e+"px",this._popup.style.top=t+"px",this.config.node.appendChild(this._popup),this._popup.focus(),this._isActive=!0,this.events.fire(d.WindowEvents.afterShow,[{left:e,top:t}]),s.focusManager.setFocusId(this._uid);}},e.prototype.hide=function(){this._hide();},e.prototype._hide=function(e){this._isActive&&this.events.fire(d.WindowEvents.beforeHide,[{left:this.config.left,top:this.config.top},e])&&(this.config.viewportOverflow&&h.default.closeFreeWindow(this.config.node),this._blocker&&(this.config.node.removeChild(this._blocker),this.config.closable&&this._keyManager.removeHotKey(null,this),this._blocker=null),this.config.node.removeChild(this._popup),this._isActive=!1,this.events.fire(d.WindowEvents.afterHide,[{left:this.config.left,top:this.config.top},e]));},e.prototype.isVisible=function(){return this._isActive},e.prototype.getWidget=function(){return this._layout.getCell("content").getWidget()},e.prototype.getContainer=function(){return this.getRootView().data._container},e.prototype.attach=function(e,t){this._layout.getCell("content").attach(e,t);},e.prototype.attachHTML=function(e){this._layout.getCell("content").attachHTML(e);},e.prototype.getRootView=function(){return this._layout.getRootView()},e.prototype.destructor=function(){this._isActive&&this.hide(),this.header&&this.header.destructor(),this.footer&&this.footer.destructor(),this.events&&this.events.clear(),this._keyManager&&this._keyManager.destructor(),this._layout&&this._layout.destructor(),this.config=this.header=this.footer=this.events=null,this._popup=this._uid=this._handlers=this._isActive=this._keyManager=this._fullScreen=this._oldSizes=this._oldPosition=null;},e.prototype.fullScreen=function(){this.setFullScreen();},e.prototype._initHandlers=function(){var e=this;this._handlers={headerDblClick:function(t){return e.events.fire(d.WindowEvents.headerDoubleClick,[t])},move:function(t){3!==t.which&&(t.preventDefault(),u.detectDrag(t).then((function(t){t&&e._startDrag(t.x,t.y);})));},resize:{".dhx_window-resizer":function(t){3!==t.which&&(t.preventDefault(),h.default.setActive(e._uid),u.detectDrag(t).then((function(i){if(i){var n=t.target.classList;n.contains("dhx_window-resizer--left")?e._startResize({left:!0}):n.contains("dhx_window-resizer--right")?e._startResize({right:!0}):n.contains("dhx_window-resizer--top")?e._startResize({top:!0}):n.contains("dhx_window-resizer--bottom")?e._startResize({bottom:!0}):n.contains("dhx_window-resizer--bottom_left")?e._startResize({left:!0,bottom:!0}):n.contains("dhx_window-resizer--bottom_right")?e._startResize({bottom:!0,right:!0}):n.contains("dhx_window-resizer--top_left")?e._startResize({top:!0,left:!0}):n.contains("dhx_window-resizer--top_right")&&e._startResize({top:!0,right:!0});}})));}},setActive:function(){h.default.setActive(e._uid);}};},e.prototype._initUI=function(){var e=this,t=[],i=(this.config.header||this.config.title||this.config.closable||this.config.movable)&&!1!==this.config.header;i&&t.push({id:"header",height:"content",css:"dhx_window-header "+(this.config.movable?"dhx_window-header--movable":""),on:{mousedown:this.config.movable&&this._handlers.move,dblclick:this._handlers.headerDblClick}}),t.push({id:"content",css:i?"dhx_window-content":"dhx_window-content-without-header"}),this.config.footer&&t.push({id:"footer",height:"content",css:"dhx_window-footer"}),this.config.resizable&&t.push({id:"resizers",height:"content",css:"resizers"});var n=this._layout=new l.Layout(this._popup,{css:"dhx_window"+(this.config.modal?" dhx_window--modal":""),rows:t,on:{mousedown:this._handlers.setActive},id:this._uid});if(i){var o=this.header=new c.Toolbar;this.config.title&&(this.header.data.add({type:"title",value:this.config.title,id:"title",css:"title_max"}),this._popup.setAttribute("aria-label",this.config.title)),this.config.closable&&(this.header.data.add({type:"spacer"}),this.header.data.add({id:"close",type:"button",view:"link",size:"medium",color:"secondary",circle:!0,icon:"dxi dxi-close"}),o.events.on(f.NavigationBarEvents.click,(function(t,i){"close"===t&&e._hide(i);}))),n.getCell("header").attach(o);}if(this.config.footer){var r=this.footer=new c.Toolbar;n.getCell("footer").attach(r);}this.config.resizable&&n.getCell("resizers").attach((function(){return e._drawResizers()}));},e.prototype._drawResizers=function(){return o.el(".dhx-resizers",{onmousedown:this._handlers.resize},[o.el(".dhx_window-resizer.dhx_window-resizer--left",{_ref:"left"}),o.el(".dhx_window-resizer.dhx_window-resizer--right",{_ref:"right"}),o.el(".dhx_window-resizer.dhx_window-resizer--bottom",{_ref:"bottom"}),o.el(".dhx_window-resizer.dhx_window-resizer--top",{_ref:"top"}),o.el(".dhx_window-resizer.dhx_window-resizer--bottom_right",{_ref:"bottomRight"}),o.el(".dhx_window-resizer.dhx_window-resizer--bottom_left",{_ref:"bottomLeft"}),o.el(".dhx_window-resizer.dhx_window-resizer--top_right",{_ref:"topRight"}),o.el(".dhx_window-resizer.dhx_window-resizer--top_left",{_ref:"topLeft"})])},e.prototype._startDrag=function(e,t){var i=this;this.config.node.classList.add("dhx_window--stop_selection");var n=e-this._popup.offsetLeft,o=t-this._popup.offsetTop,r=this._popup.offsetWidth,a=this._popup.offsetHeight,s=function(e){var t={left:i._popup.offsetLeft,top:i._popup.offsetTop},s=e.pageX-n,l=e.pageY-o;if(!i.config.viewportOverflow){var c=i._getContainerParams(),u=c.containerXOffset,h=c.containerYOffset,f=c.containerInnerWidth,p=c.containerInnerHeight;s<u?s=u:s>u+f-r&&(s=u+f-r),l<h?l=h:l>h+p-a&&(l=h+p-a);}i.config.left=s,i.config.top=l,i._popup.style.left=s+"px",i._popup.style.top=l+"px";var v={left:s,top:l};i.events.fire(d.WindowEvents.move,[v,t,{left:!0,top:!0,bottom:!0,right:!0}]);},l=function(){document.removeEventListener("mouseup",l),document.removeEventListener("mousemove",s),i.config.node.classList.remove("dhx_window--stop_selection");};document.addEventListener("mouseup",l),document.addEventListener("mousemove",s);},e.prototype._startResize=function(e){var t,i,n=this,o=100|this.config.minWidth,r=100|this.config.minHeight,a=this._popup.offsetLeft,s=this._popup.offsetTop,l=this._popup.offsetWidth,c=this._popup.offsetHeight,u=this.getRootView().refs;switch(!0){case e.bottom&&e.left:i="dhx_window-body-pointer--bottom_left",t=u.bottomLeft;break;case e.bottom&&e.right:i="dhx_window-body-pointer--bottom_right",t=u.bottomLeft;break;case e.top&&e.left:i="dhx_window-body-pointer--top_left",t=u.bottomLeft;break;case e.top&&e.right:i="dhx_window-body-pointer--top-right",t=u.right;break;case e.top:i="dhx_window-body-pointer--top",t=u.bottomLeft;break;case e.bottom:i="dhx_window-body-pointer--bottom",t=u.bottomLeft;break;case e.left:i="dhx_window-body-pointer--left",t=u.bottomLeft;break;case e.right:i="dhx_window-body-pointer--right",t=u.right;}t.el.classList.add("dhx_window-resizer--active"),this.config.node.classList.add("dhx_window--stop_selection"),this.config.node.classList.add(i);var h=function(t){var i=n._getContainerParams(),u=i.containerInnerWidth,h=i.containerInnerHeight,f=i.containerXOffset,p=i.containerYOffset,v={width:n._notInNode()?t.pageX-a:t.pageX-n.config.node.offsetLeft-a,height:n._notInNode()?t.pageY-s:t.pageY-n.config.node.offsetTop-s,left:n._notInNode()?t.pageX:t.pageX-n.config.node.offsetLeft,top:n._notInNode()?t.pageY:t.pageY-n.config.node.offsetTop};e.right&&(v.width<o?v.width=o:v.width>f+u-a&&(v.width=f+u-a),n._popup.style.width=v.width+"px"),e.bottom&&(v.height<r?v.height=r:v.height>p+h-s&&(v.height=p+h-s),n._popup.style.height=v.height+"px"),e.left&&(a+l-v.left<o&&(v.left=a+l-o),v.width=a+l-v.left,n.config.left=v.left,n._popup.style.left=v.left+"px",n._popup.style.width=v.width+"px"),e.top&&(v.top<p?v.top=p:s+c-v.top<r&&(v.top=s+c-r),v.height=s+c-v.top,n.config.top=v.top,n._popup.style.top=v.top+"px",n._popup.style.height=v.height+"px"),n.config.width=n._popup.offsetWidth,n.config.height=n._popup.offsetHeight,n.events.fire(d.WindowEvents.resize,[v,{left:a,top:s,height:c,width:l},e]);},f=function(){document.removeEventListener("mouseup",f),document.removeEventListener("mousemove",h),n.config.node.classList.remove("dhx_window--stop_selection"),n.config.node.classList.remove(i),t.el.classList.remove("dhx_window-resizer--active");};document.addEventListener("mouseup",f),document.addEventListener("mousemove",h);},e.prototype._blockScreen=function(){var e=this,t=document.createElement("div");t.className="dhx_window__overlay",this.config.node.appendChild(t),this._blocker=t,this.config.closable&&(t.addEventListener("click",(function(t){return e._hide(t)})),this._keyManager.addHotKey("escape",(function(t){var i=Array.prototype.slice.call(document.querySelectorAll(".dhx_popup--window_modal")),n=Array.prototype.slice.call(document.querySelectorAll(".dhx_popup--window")),o=i.concat(n);1!==o.length?(o.sort((function(e,t){return +window.getComputedStyle(t).zIndex-+window.getComputedStyle(e).zIndex})),o[o.length-1]===e._popup&&e._hide(t)):e._hide(t);})));},e.prototype._notInNode=function(){return this.config.node===document.body||this.config.modal},e.prototype._getContainerParams=function(){var e=this._notInNode();return {containerInnerWidth:e?window.innerWidth:this.config.node.offsetWidth,containerInnerHeight:e?window.innerHeight:this.config.node.offsetHeight,containerXOffset:e?window.pageXOffset:this.config.node.scrollLeft,containerYOffset:e?window.pageYOffset:this.config.node.scrollTop}},e}();t.Window=p;},function(e,t,i){(function(e){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);}),r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},a=this&&this.__rest||function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(i[n[o]]=e[n[o]]);}return i},s=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var l=i(4),c=i(7),u=i(15),d=i(1),h=i(90),f=i(91),p=i(59),v=i(92),g=i(47),_=i(93),m=i(94),y=i(95),b=i(96),w=i(97),x=i(98),E=i(9),C=i(99),S=i(104),I=i(105),k=i(106),M=i(6),P=i(0),O=function(t){function i(e,i){var n=t.call(this,null,d.extend({disabled:!1,hidden:!1},i))||this;return n._isValid=!0,n._state={},n.events=new l.EventSystem(n),n.container=e,n._initUI(e),n.config.hidden&&n.hide(!0),n.config.disabled&&n.disable(),n.events.on(M.FormEvents.afterShow,(function(){n._formContainerShow();})),n.events.on(M.FormEvents.afterHide,(function(){Object.values(n._attachments).some((function(e){return !e.config.hidden}))||n._formContainerHide();})),n.events.on(M.FormEvents.change,(function(){return n.paint()})),P.awaitRedraw().then((function(){var e=n.layout.getRootNode();e&&(e.setAttribute("role","form"),n.config.title&&e.setAttribute("aria-label",n.config.title));})),n}return o(i,t),i.prototype.paint=function(){t.prototype.paint.call(this),this.layout.paint();},i.prototype.send=function(t,i,n){var o=this;if(void 0===i&&(i="POST"),this.events.fire(M.FormEvents.beforeSend))return new e((function(e,r){var a=new XMLHttpRequest;switch(a.onload=function(){a.status>=200&&a.status<300?e(a.response||a.responseText):r({status:a.status,statusText:a.statusText});},a.onloadend=function(){a.readyState===XMLHttpRequest.DONE&&200===a.status&&o.events.fire(M.FormEvents.afterSend);},a.onerror=function(){r({status:a.status,statusText:a.statusText});},"GET"===i&&(t+="?"+encodeURIComponent(JSON.stringify(o.getValue()))),a.open(i,t),n||a.setRequestHeader("Content-Type","application/json"),i){case"POST":o._send(),a.send(n?o.getValue(!0):JSON.stringify(o.getValue()));break;case"DELETE":case"PUT":a.send(n?o.getValue(!0):JSON.stringify(o.getValue()));break;default:a.send();}}))},i.prototype.clear=function(e){switch(e){case M.ClearMethod.value:this._clear();break;case M.ClearMethod.validation:this._clearValidate();break;default:this._clear(),this._clearValidate();}this.paint();},i.prototype.setValue=function(e){for(var t in e)for(var i in this._attachments)"function"==typeof this._attachments[i].setValue&&this._attachments[i].config.name===t&&this._attachments[i].setValue(e[t]);},i.prototype.getValue=function(e){if(e){var t=new FormData,i=function(e){Array.isArray(n._state[e])?n._state[e].forEach((function(i,n){return t.append(e+"["+n+"]",i)})):t.append(e,n._state[e]);},n=this;for(var o in this._state)i(o);return t}return r({},this._state)},i.prototype.getItem=function(e){for(var t in this._attachments)if(t==e)return this._attachments[t]},i.prototype.validate=function(e){for(var t in void 0===e&&(e=!1),this._isValid=!0,this._attachments)"function"==typeof this._attachments[t].validate&&E.isVerify(this._attachments[t].config)&&!this._attachments[t].validate(e)&&(this._isValid=!1,!e&&this.events.fire(M.FormEvents.validationFail,[t,this._attachments[t]]));return this._isValid},i.prototype.setProperties=function(e,t){if("string"==typeof e&&t&&!d.isEmptyObj(t))for(var i in this._attachments)"function"==typeof this._attachments[i].setProperties&&i===e&&this._attachments[i].setProperties(t);if("object"==typeof e&&!d.isEmptyObj(e))for(var i in this._attachments)"function"!=typeof this._attachments[i].setProperties||d.isEmptyObj(e[i])||this._attachments[i].setProperties(e[i]);},i.prototype.getProperties=function(e){if(e)for(var t in this._attachments)if("function"==typeof this._attachments[t].getProperties&&t===e)return this._attachments[t].getProperties();var i={};for(var t in this._attachments)"function"==typeof this._attachments[t].getProperties&&(i[t]=this._attachments[t].getProperties());return i},i.prototype.show=function(){if(this.config.hidden||Object.values(this._attachments).some((function(e){return !e.config.hidden})))for(var e in this._formContainerShow(),this._attachments)"function"==typeof this._attachments[e].show&&this._attachments[e].show();},i.prototype.hide=function(e){if(!this.config.hidden||e)for(var t in this._formContainerHide(),this._attachments)"function"==typeof this._attachments[t].hide&&this._attachments[t].hide(e);},i.prototype.setFocus=function(e){for(var t in this._attachments){var i=this._attachments[t];"radiogroup"!==i.config.type&&"checkboxgroup"!==i.config.type||i.focus(e),i.config.name===e&&i.focus();}},i.prototype.blur=function(e){for(var t in e||this.forEach((function(e){"function"==typeof e.blur&&e.blur();})),this._attachments){var i=this._attachments[t];"radiogroup"!==i.config.type&&"checkboxgroup"!==i.config.type||i.blur(e),i.config.name===e&&i.blur();}},i.prototype.isVisible=function(e){if(!e)return !this.config.hidden;for(var t in this._attachments)if(t===e)return !this._attachments[t].config.hidden},i.prototype.disable=function(){for(var e in this.config.disabled=!0,this._attachments)"function"==typeof this._attachments[e].disable&&this._attachments[e].disable();},i.prototype.enable=function(){for(var e in this.config.disabled=!1,this._attachments)"function"==typeof this._attachments[e].enable&&this._attachments[e].enable();},i.prototype.isDisabled=function(e){if(!e)return this.config.disabled;for(var t in this._attachments)if(t===e)return this._attachments[t].config.disabled},i.prototype.forEach=function(e){for(var t=Object.values(this._attachments),i=0;i<t.length;i++)e.call(this,t[i],i,t);},i.prototype.destructor=function(){this.events&&this.events.clear(),this.layout&&this.layout.destructor(),this.config=this._attachments=this._state=this._uid=this.container=this.events=this._isValid=null,this.unmount();},i.prototype.getRootView=function(){return this.layout.getRootView()},i.prototype._addLayoutItem=function(e){var t=this,i=e.id=e.id||d.uid(),n=e.name=e.name||i.toString();e.type=e.type&&e.type.toLowerCase();var o=e.width,r=e.height,l=e.css,c=e.padding,u=a(e,["css","padding"]),E=l?l+" dhx_form-element":"dhx_form-element",P=!("spacer"===e.type||void 0===e.type);switch(P&&!o&&(o="content"),P&&!r&&(r="content"),u.type){case"button":u.full&&(E+=" dhx_button--full-gravity");var O=this._attachments[n]=new f.Button(null,e);O.events.on(M.ItemEvent.beforeChangeProperties,(function(e){return t.events.fire(M.FormEvents.beforeChangeProperties,[n,e])})),O.events.on(M.ItemEvent.afterChangeProperties,(function(e){t._changeProps(n,e),t.events.fire(M.FormEvents.afterChangeProperties,[n,e]),t.paint();})),O.events.on(M.ItemEvent.click,(function(e){e.preventDefault(),t.events.fire(M.FormEvents.click,[n,e]),t.events.fire(M.FormEvents.buttonClick,[n,e]),O.config.submit&&t.validate()&&O.config.url&&t.send(O.config.url);})),O.events.on(M.ItemEvent.beforeHide,(function(e,i){if(!i)return t.events.fire(M.FormEvents.beforeHide,[n,e])})),O.events.on(M.ItemEvent.beforeShow,(function(e){return t.events.fire(M.FormEvents.beforeShow,[n,e])})),O.events.on(M.ItemEvent.afterHide,(function(e,i){t.layout.getCell(n).hide(),!i&&t.events.fire(M.FormEvents.afterHide,[n,e]);})),O.events.on(M.ItemEvent.afterShow,(function(e){t.layout.getCell(n).show(),t.events.fire(M.FormEvents.afterShow,[n,e]);})),O.events.on(M.ItemEvent.focus,(function(e){t.events.fire(M.FormEvents.focus,[n,e]);})),O.events.on(M.ItemEvent.blur,(function(e){t.events.fire(M.FormEvents.blur,[n,e]);})),O.events.on(M.ItemEvent.keydown,(function(e){t.events.fire(M.FormEvents.keydown,[e,n]);}));break;case"datepicker":var A=this._attachments[n]=new h.DatePicker(null,e);this._state[n]=A.getValue("Date"===u.valueFormat),A.events.on(M.ItemEvent.beforeChangeProperties,(function(e){return t.events.fire(M.FormEvents.beforeChangeProperties,[n,e])})),A.events.on(M.ItemEvent.afterChangeProperties,(function(e){t._changeProps(n,e),t._state[n]=A.getValue("Date"===u.valueFormat),t.events.fire(M.FormEvents.afterChangeProperties,[n,e]),t.paint();})),A.events.on(M.ItemEvent.change,(function(e){t._state[n]=e,t.events.fire(M.FormEvents.change,[n,e]);})),A.events.on(M.ItemEvent.beforeHide,(function(e,i){if(!i)return t.events.fire(M.FormEvents.beforeHide,[n,e])})),A.events.on(M.ItemEvent.beforeShow,(function(e){return t.events.fire(M.FormEvents.beforeShow,[n,e])})),A.events.on(M.ItemEvent.afterHide,(function(e,i){t.layout.getCell(n).hide(),!i&&t.events.fire(M.FormEvents.afterHide,[n,e]);})),A.events.on(M.ItemEvent.afterShow,(function(e){t.layout.getCell(n).show(),t.events.fire(M.FormEvents.afterShow,[n,e]);})),A.events.on(M.ItemEvent.beforeValidate,(function(e){return t.events.fire(M.FormEvents.beforeValidate,[n,e])})),A.events.on(M.ItemEvent.afterValidate,(function(e,i){t.events.fire(M.FormEvents.afterValidate,[n,e,i]);})),A.events.on(M.ItemEvent.focus,(function(e){t.events.fire(M.FormEvents.focus,[n,e]);})),A.events.on(M.ItemEvent.blur,(function(e){t.events.fire(M.FormEvents.blur,[n,e]);})),A.events.on(M.ItemEvent.keydown,(function(e){t.events.fire(M.FormEvents.keydown,[e,n]);}));break;case"checkbox":var D=this._attachments[n]=new p.Checkbox(null,e);this._state[n]=D.getValue(),D.events.on(M.ItemEvent.beforeChangeProperties,(function(e){return t.events.fire(M.FormEvents.beforeChangeProperties,[n,e])})),D.events.on(M.ItemEvent.afterChangeProperties,(function(e){t._changeProps(n,e),t._state[n]=D.getValue(),t.events.fire(M.FormEvents.afterChangeProperties,[n,e]),t.paint();})),D.events.on(M.ItemEvent.change,(function(e){t._state[n]=e,t.events.fire(M.FormEvents.change,[n,e]);})),D.events.on(M.ItemEvent.beforeHide,(function(e,i){if(!i)return t.events.fire(M.FormEvents.beforeHide,[n,e])})),D.events.on(M.ItemEvent.beforeShow,(function(e){return t.events.fire(M.FormEvents.beforeShow,[n,e])})),D.events.on(M.ItemEvent.afterHide,(function(e,i){t.layout.getCell(n).hide(),!i&&t.events.fire(M.FormEvents.afterHide,[n,e]);})),D.events.on(M.ItemEvent.afterShow,(function(e){t.layout.getCell(n).show(),t.events.fire(M.FormEvents.afterShow,[n,e]);})),D.events.on(M.ItemEvent.beforeValidate,(function(e){return t.events.fire(M.FormEvents.beforeValidate,[n,e])})),D.events.on(M.ItemEvent.afterValidate,(function(e,i){t.events.fire(M.FormEvents.afterValidate,[n,e,i]);})),D.events.on(M.ItemEvent.focus,(function(e){t.events.fire(M.FormEvents.focus,[n,e]);})),D.events.on(M.ItemEvent.blur,(function(e){t.events.fire(M.FormEvents.blur,[n,e]);})),D.events.on(M.ItemEvent.keydown,(function(e){t.events.fire(M.FormEvents.keydown,[e,n]);}));break;case"checkboxgroup":var F=this._attachments[n]=new v.CheckboxGroup(null,e);this._state[n]=F.getValue(),F.events.on(M.ItemEvent.beforeChangeProperties,(function(e){return t.events.fire(M.FormEvents.beforeChangeProperties,[n,e])})),F.events.on(M.ItemEvent.afterChangeProperties,(function(e){t._changeProps(n,e),t._state[n]=F.getValue(),t.events.fire(M.FormEvents.afterChangeProperties,[n,e]),t.paint();})),F.events.on(M.ItemEvent.change,(function(e){t._state[n]=e,t.events.fire(M.FormEvents.change,[n,e]);})),F.events.on(M.ItemEvent.beforeHide,(function(e,i){if(!i)return t.events.fire(M.FormEvents.beforeHide,[n,e])})),F.events.on(M.ItemEvent.beforeShow,(function(e){return t.events.fire(M.FormEvents.beforeShow,[n,e])})),F.events.on(M.ItemEvent.afterHide,(function(e,i){t.layout.getCell(n).hide(),!i&&t.events.fire(M.FormEvents.afterHide,[n,e]);})),F.events.on(M.ItemEvent.afterShow,(function(e){t.layout.getCell(n).show(),t.events.fire(M.FormEvents.afterShow,[n,e]);})),F.events.on(M.ItemEvent.beforeValidate,(function(e){return t.events.fire(M.FormEvents.beforeValidate,[n,e])})),F.events.on(M.ItemEvent.afterValidate,(function(e,i){t.events.fire(M.FormEvents.afterValidate,[n,e,i]);})),F.events.on(M.ItemEvent.focus,(function(e,i){t.events.fire(M.FormEvents.focus,[n,e,i]);})),F.events.on(M.ItemEvent.blur,(function(e,i){t.events.fire(M.FormEvents.blur,[n,e,i]);})),F.events.on(M.ItemEvent.keydown,(function(e,i){t.events.fire(M.FormEvents.keydown,[e,n,i]);})),F.events.on(M.ItemEvent.afterShow,(function(e){t.layout.getCell(n).show(),t.events.fire(M.FormEvents.afterShow,[n,e]);})),F.events.on(M.ItemEvent.beforeValidate,(function(e){return t.events.fire(M.FormEvents.beforeValidate,[n,e])})),F.events.on(M.ItemEvent.afterValidate,(function(e,i){t.events.fire(M.FormEvents.afterValidate,[n,e,i]);}));break;case"combo":var V=this._attachments[n]=new w.Combo(null,e);this._state[n]=V.getValue(),V.events.on(M.ItemEvent.beforeChangeProperties,(function(e){return t.events.fire(M.FormEvents.beforeChangeProperties,[n,e])})),V.events.on(M.ItemEvent.afterChangeProperties,(function(e){t._changeProps(n,e),t._state[n]=V.getValue(),t.events.fire(M.FormEvents.afterChangeProperties,[n,e]),t.paint();})),V.events.on(M.ItemEvent.change,(function(e){t._state[n]=e,t.events.fire(M.FormEvents.change,[n,e]);})),V.events.on(M.ItemEvent.beforeHide,(function(e,i){if(!i)return t.events.fire(M.FormEvents.beforeHide,[n,e])})),V.events.on(M.ItemEvent.beforeShow,(function(e){return t.events.fire(M.FormEvents.beforeShow,[n,e])})),V.events.on(M.ItemEvent.afterHide,(function(e,i){t.layout.getCell(n).hide(),!i&&t.events.fire(M.FormEvents.afterHide,[n,e]);})),V.events.on(M.ItemEvent.afterShow,(function(e){t.layout.getCell(n).show(),t.events.fire(M.FormEvents.afterShow,[n,e]);})),V.events.on(M.ItemEvent.beforeValidate,(function(e){return t.events.fire(M.FormEvents.beforeValidate,[n,e])})),V.events.on(M.ItemEvent.afterValidate,(function(e,i){t.events.fire(M.FormEvents.afterValidate,[n,e,i]);})),V.events.on(M.ItemEvent.focus,(function(e){t.events.fire(M.FormEvents.focus,[n,e]);})),V.events.on(M.ItemEvent.blur,(function(e){t.events.fire(M.FormEvents.blur,[n,e]);})),V.events.on(M.ItemEvent.keydown,(function(e,i){t.events.fire(M.FormEvents.keydown,[e,n,i]);}));break;case"input":var R=this._attachments[n]=new g.Input(null,e);this._state[n]=R.getValue(),R.events.on(M.ItemEvent.beforeChangeProperties,(function(e){return t.events.fire(M.FormEvents.beforeChangeProperties,[n,e])})),R.events.on(M.ItemEvent.afterChangeProperties,(function(e){t._changeProps(n,e),t._state[n]=R.getValue(),t.events.fire(M.FormEvents.afterChangeProperties,[n,e]),t.paint();})),R.events.on(M.ItemEvent.change,(function(e){t._state[n]=e,t.events.fire(M.FormEvents.change,[n,e]);})),R.events.on(M.ItemEvent.beforeHide,(function(e,i){if(!i)return t.events.fire(M.FormEvents.beforeHide,[n,e])})),R.events.on(M.ItemEvent.beforeShow,(function(e){return t.events.fire(M.FormEvents.beforeShow,[n,e])})),R.events.on(M.ItemEvent.afterHide,(function(e,i){t.layout.getCell(n).hide(),!i&&t.events.fire(M.FormEvents.afterHide,[n,e]);})),R.events.on(M.ItemEvent.afterShow,(function(e){t.layout.getCell(n).show(),t.events.fire(M.FormEvents.afterShow,[n,e]);})),R.events.on(M.ItemEvent.beforeValidate,(function(e){return t.events.fire(M.FormEvents.beforeValidate,[n,e])})),R.events.on(M.ItemEvent.afterValidate,(function(e,i){t.events.fire(M.FormEvents.afterValidate,[n,e,i]);})),R.events.on(M.ItemEvent.focus,(function(e){t.events.fire(M.FormEvents.focus,[n,e]);})),R.events.on(M.ItemEvent.blur,(function(e){t.events.fire(M.FormEvents.blur,[n,e]);})),R.events.on(M.ItemEvent.keydown,(function(e){t.events.fire(M.FormEvents.keydown,[e,n]);}));break;case"radiogroup":var T=this._attachments[n]=new _.RadioGroup(null,e);this._state[n]=T.getValue(),T.events.on(M.ItemEvent.beforeChangeProperties,(function(e){return t.events.fire(M.FormEvents.beforeChangeProperties,[n,e])})),T.events.on(M.ItemEvent.afterChangeProperties,(function(e){t._changeProps(n,e),t._state[n]=T.getValue(),t.events.fire(M.FormEvents.afterChangeProperties,[n,e]),t.paint();})),T.events.on(M.ItemEvent.change,(function(e){t._state[n]=e,t.events.fire(M.FormEvents.change,[n,e]);})),T.events.on(M.ItemEvent.beforeHide,(function(e,i){if(!i)return t.events.fire(M.FormEvents.beforeHide,[n,e])})),T.events.on(M.ItemEvent.beforeShow,(function(e){return t.events.fire(M.FormEvents.beforeShow,[n,e])})),T.events.on(M.ItemEvent.afterHide,(function(e,i){t.layout.getCell(n).hide(),!i&&t.events.fire(M.FormEvents.afterHide,[n,e]);})),T.events.on(M.ItemEvent.afterShow,(function(e){t.layout.getCell(n).show(),t.events.fire(M.FormEvents.afterShow,[n,e]);})),T.events.on(M.ItemEvent.beforeValidate,(function(e){return t.events.fire(M.FormEvents.beforeValidate,[n,e])})),T.events.on(M.ItemEvent.afterValidate,(function(e,i){t.events.fire(M.FormEvents.afterValidate,[n,e,i]);})),T.events.on(M.ItemEvent.focus,(function(e,i){t.events.fire(M.FormEvents.focus,[n,e,i]);})),T.events.on(M.ItemEvent.blur,(function(e,i){t.events.fire(M.FormEvents.blur,[n,e,i]);})),T.events.on(M.ItemEvent.keydown,(function(e,i){t.events.fire(M.FormEvents.keydown,[e,n,i]);}));break;case"select":var L=this._attachments[n]=new m.Select(null,e);this._state[n]=L.getValue(),L.events.on(M.ItemEvent.beforeChangeProperties,(function(e){return t.events.fire(M.FormEvents.beforeChangeProperties,[n,e])})),L.events.on(M.ItemEvent.afterChangeProperties,(function(e){t._changeProps(n,e),t._state[n]=L.getValue(),t.events.fire(M.FormEvents.afterChangeProperties,[n,e]),t.paint();})),L.events.on(M.ItemEvent.changeOptions,(function(e){t.layout.getCell(n).config.options=s(e);})),L.events.on(M.ItemEvent.change,(function(e){t._state[n]=e,t.events.fire(M.FormEvents.change,[n,e]);})),L.events.on(M.ItemEvent.beforeHide,(function(e,i){if(!i)return t.events.fire(M.FormEvents.beforeHide,[n,e])})),L.events.on(M.ItemEvent.beforeShow,(function(e){return t.events.fire(M.FormEvents.beforeShow,[n,e])})),L.events.on(M.ItemEvent.afterHide,(function(e,i){t.layout.getCell(n).hide(),!i&&t.events.fire(M.FormEvents.afterHide,[n,e]);})),L.events.on(M.ItemEvent.afterShow,(function(e){t.layout.getCell(n).show(),t.events.fire(M.FormEvents.afterShow,[n,e]);})),L.events.on(M.ItemEvent.beforeValidate,(function(e){return t.events.fire(M.FormEvents.beforeValidate,[n,e])})),L.events.on(M.ItemEvent.afterValidate,(function(e,i){t.events.fire(M.FormEvents.afterValidate,[n,e,i]);})),L.events.on(M.ItemEvent.focus,(function(e){t.events.fire(M.FormEvents.focus,[n,e]);})),L.events.on(M.ItemEvent.blur,(function(e){t.events.fire(M.FormEvents.blur,[n,e]);})),L.events.on(M.ItemEvent.keydown,(function(e){t.events.fire(M.FormEvents.keydown,[e,n]);}));break;case"simplevault":u.$vaultHeight=r;var H=this._attachments[n]=new C.SimpleVault(null,e);this._state[n]=H.getValue(),H.events.on(M.ItemEvent.beforeChangeProperties,(function(e){return t.events.fire(M.FormEvents.beforeChangeProperties,[n,e])})),H.events.on(M.ItemEvent.afterChangeProperties,(function(e){t._changeProps(n,e),t._state[n]=H.getValue(),t.events.fire(M.FormEvents.afterChangeProperties,[n,e]),t.paint();})),H.events.on(M.ItemEvent.change,(function(e){t._state[n]=e,t.events.fire(M.FormEvents.change,[n,e]);})),H.events.on(M.ItemEvent.beforeHide,(function(e,i){if(!i)return t.events.fire(M.FormEvents.beforeHide,[n,e])})),H.events.on(M.ItemEvent.beforeShow,(function(e){return t.events.fire(M.FormEvents.beforeShow,[n,e])})),H.events.on(M.ItemEvent.afterHide,(function(e,i){t.layout.getCell(n).hide(),!i&&t.events.fire(M.FormEvents.afterHide,[n,e]);})),H.events.on(M.ItemEvent.afterShow,(function(e){t.layout.getCell(n).show(),t.events.fire(M.FormEvents.afterShow,[n,e]);})),H.events.on(M.ItemEvent.beforeValidate,(function(e){return t.events.fire(M.FormEvents.beforeValidate,[n,e])})),H.events.on(M.ItemEvent.afterValidate,(function(e,i){t.events.fire(M.FormEvents.afterValidate,[n,e,i]);}));break;case"slider":var N=this._attachments[n]=new x.SliderForm(null,e);this._state[n]=N.getValue(),N.events.on(M.ItemEvent.change,(function(e){t._state[n]=e,t.events.fire(M.FormEvents.change,[n,e]);})),N.events.on(M.ItemEvent.beforeHide,(function(e,i){if(!i)return t.events.fire(M.FormEvents.beforeHide,[n,e])})),N.events.on(M.ItemEvent.beforeShow,(function(e){return t.events.fire(M.FormEvents.beforeShow,[n,e])})),N.events.on(M.ItemEvent.afterHide,(function(e,i){t.layout.getCell(n).hide(),!i&&t.events.fire(M.FormEvents.afterHide,[n,e]);})),N.events.on(M.ItemEvent.afterShow,(function(e){t.layout.getCell(n).show(),t.events.fire(M.FormEvents.afterShow,[n,e]);})),N.events.on(M.ItemEvent.focus,(function(e){t.events.fire(M.FormEvents.focus,[n,e]);})),N.events.on(M.ItemEvent.blur,(function(e){t.events.fire(M.FormEvents.blur,[n,e]);})),N.events.on(M.ItemEvent.keydown,(function(e){t.events.fire(M.FormEvents.keydown,[e,n]);}));break;case"textarea":var j=this._attachments[n]=new y.Textarea(null,e);this._state[n]=j.getValue(),j.events.on(M.ItemEvent.beforeChangeProperties,(function(e){return t.events.fire(M.FormEvents.beforeChangeProperties,[n,e])})),j.events.on(M.ItemEvent.afterChangeProperties,(function(e){t._changeProps(n,e),t._state[n]=j.getValue(),t.events.fire(M.FormEvents.afterChangeProperties,[n,e]),t.paint();})),j.events.on(M.ItemEvent.change,(function(e){t._state[n]=e,t.events.fire(M.FormEvents.change,[n,e]);})),j.events.on(M.ItemEvent.beforeHide,(function(e,i){if(!i)return t.events.fire(M.FormEvents.beforeHide,[n,e])})),j.events.on(M.ItemEvent.beforeShow,(function(e){return t.events.fire(M.FormEvents.beforeShow,[n,e])})),j.events.on(M.ItemEvent.afterHide,(function(e,i){t.layout.getCell(n).hide(),!i&&t.events.fire(M.FormEvents.afterHide,[n,e]);})),j.events.on(M.ItemEvent.afterShow,(function(e){t.layout.getCell(n).show(),t.events.fire(M.FormEvents.afterShow,[n,e]);})),j.events.on(M.ItemEvent.beforeValidate,(function(e){return t.events.fire(M.FormEvents.beforeValidate,[n,e])})),j.events.on(M.ItemEvent.afterValidate,(function(e,i){t.events.fire(M.FormEvents.afterValidate,[n,e,i]);})),j.events.on(M.ItemEvent.focus,(function(e){t.events.fire(M.FormEvents.focus,[n,e]);})),j.events.on(M.ItemEvent.blur,(function(e){t.events.fire(M.FormEvents.blur,[n,e]);})),j.events.on(M.ItemEvent.keydown,(function(e){t.events.fire(M.FormEvents.keydown,[e,n]);}));break;case"text":"content"===o&&(E+=" dhx_form-element--fit-content");var $=this._attachments[n]=new b.Text(null,e);this._state[n]=$.getValue(),$.events.on(M.ItemEvent.beforeChangeProperties,(function(e){return t.events.fire(M.FormEvents.beforeChangeProperties,[n,e])})),$.events.on(M.ItemEvent.afterChangeProperties,(function(e){t._changeProps(n,e),t._state[n]=$.getValue(),t.events.fire(M.FormEvents.afterChangeProperties,[n,e]),t.paint();})),$.events.on(M.ItemEvent.change,(function(e){t._state[n]=e,t.events.fire(M.FormEvents.change,[n,e]);})),$.events.on(M.ItemEvent.beforeHide,(function(e,i){if(!i)return t.events.fire(M.FormEvents.beforeHide,[n,e])})),$.events.on(M.ItemEvent.beforeShow,(function(e){return t.events.fire(M.FormEvents.beforeShow,[n,e])})),$.events.on(M.ItemEvent.afterHide,(function(e,i){t.layout.getCell(n).hide(),!i&&t.events.fire(M.FormEvents.afterHide,[n,e]);})),$.events.on(M.ItemEvent.afterShow,(function(e){t.layout.getCell(n).show(),t.events.fire(M.FormEvents.afterShow,[n,e]);})),$.events.on(M.ItemEvent.beforeValidate,(function(e){return t.events.fire(M.FormEvents.beforeValidate,[n,e])})),$.events.on(M.ItemEvent.afterValidate,(function(e,i){t.events.fire(M.FormEvents.afterValidate,[n,e,i]);}));break;case"timepicker":var z=this._attachments[n]=new S.TimePicker(null,e);this._state[n]=u.value&&z.getValue("timeObject"===u.valueFormat)||"",z.events.on(M.ItemEvent.beforeChangeProperties,(function(e){return t.events.fire(M.FormEvents.beforeChangeProperties,[n,e])})),z.events.on(M.ItemEvent.afterChangeProperties,(function(e){t._changeProps(n,e),t._state[n]=z.getValue("timeObject"===u.valueFormat),t.events.fire(M.FormEvents.afterChangeProperties,[n,e]),t.paint();})),z.events.on(M.ItemEvent.change,(function(e){t._state[n]=e,t.events.fire(M.FormEvents.change,[n,e]);})),z.events.on(M.ItemEvent.beforeHide,(function(e,i){if(!i)return t.events.fire(M.FormEvents.beforeHide,[n,e])})),z.events.on(M.ItemEvent.beforeShow,(function(e){return t.events.fire(M.FormEvents.beforeShow,[n,e])})),z.events.on(M.ItemEvent.afterHide,(function(e,i){t.layout.getCell(n).hide(),!i&&t.events.fire(M.FormEvents.afterHide,[n,e]);})),z.events.on(M.ItemEvent.afterShow,(function(e){t.layout.getCell(n).show(),t.events.fire(M.FormEvents.afterShow,[n,e]);})),z.events.on(M.ItemEvent.beforeValidate,(function(e){return t.events.fire(M.FormEvents.beforeValidate,[n,e])})),z.events.on(M.ItemEvent.afterValidate,(function(e,i){t.events.fire(M.FormEvents.afterValidate,[n,e,i]);})),z.events.on(M.ItemEvent.focus,(function(e){t.events.fire(M.FormEvents.focus,[n,e]);})),z.events.on(M.ItemEvent.blur,(function(e){t.events.fire(M.FormEvents.blur,[n,e]);})),z.events.on(M.ItemEvent.keydown,(function(e){t.events.fire(M.FormEvents.keydown,[e,n]);})),z.events.on(M.ItemEvent.afterShow,(function(e){t.layout.getCell(n).show(),t.events.fire(M.FormEvents.afterShow,[n,e]);})),z.events.on(M.ItemEvent.beforeValidate,(function(e){return t.events.fire(M.FormEvents.beforeValidate,[n,e])})),z.events.on(M.ItemEvent.afterValidate,(function(e,i){t.events.fire(M.FormEvents.afterValidate,[n,e,i]);}));break;case"colorpicker":var B=this._attachments[n]=new I.ColorPicker(null,e);this._state[n]=B.getValue(),B.events.on(M.ItemEvent.beforeChangeProperties,(function(e){return t.events.fire(M.FormEvents.beforeChangeProperties,[n,e])})),B.events.on(M.ItemEvent.afterChangeProperties,(function(e){t._changeProps(n,e),t._state[n]=B.getValue(),t.events.fire(M.FormEvents.afterChangeProperties,[n,e]),t.paint();})),B.events.on(M.ItemEvent.change,(function(e){t._state[n]=e,t.events.fire(M.FormEvents.change,[n,e]);})),B.events.on(M.ItemEvent.beforeHide,(function(e,i){if(!i)return t.events.fire(M.FormEvents.beforeHide,[n,e])})),B.events.on(M.ItemEvent.beforeShow,(function(e){return t.events.fire(M.FormEvents.beforeShow,[n,e])})),B.events.on(M.ItemEvent.afterHide,(function(e,i){t.layout.getCell(n).hide(),!i&&t.events.fire(M.FormEvents.afterHide,[n,e]);})),B.events.on(M.ItemEvent.afterShow,(function(e){t.layout.getCell(n).show(),t.events.fire(M.FormEvents.afterShow,[n,e]);})),B.events.on(M.ItemEvent.beforeValidate,(function(e){return t.events.fire(M.FormEvents.beforeValidate,[n,e])})),B.events.on(M.ItemEvent.afterValidate,(function(e,i){t.events.fire(M.FormEvents.afterValidate,[n,e,i]);})),B.events.on(M.ItemEvent.focus,(function(e){t.events.fire(M.FormEvents.focus,[n,e]);})),B.events.on(M.ItemEvent.blur,(function(e){t.events.fire(M.FormEvents.blur,[n,e]);})),B.events.on(M.ItemEvent.keydown,(function(e){t.events.fire(M.FormEvents.keydown,[e,n]);}));break;default:var W=this._attachments[n]=new k.Spacer(null,e);W.events.on(M.ItemEvent.beforeChangeProperties,(function(e){return t.events.fire(M.FormEvents.beforeChangeProperties,[n,e])})),W.events.on(M.ItemEvent.afterChangeProperties,(function(e){t._changeProps(n,e),t.events.fire(M.FormEvents.afterChangeProperties,[n,e]),t.paint();})),W.events.on(M.ItemEvent.beforeHide,(function(e,i){if(!i)return t.events.fire(M.FormEvents.beforeHide,[n,e])})),W.events.on(M.ItemEvent.beforeShow,(function(e){return t.events.fire(M.FormEvents.beforeShow,[n,e])})),W.events.on(M.ItemEvent.afterHide,(function(e,i){t.layout.getCell(n).hide(),!i&&t.events.fire(M.FormEvents.afterHide,[n,e]);})),W.events.on(M.ItemEvent.afterShow,(function(e){t.layout.getCell(n).show(),t.events.fire(M.FormEvents.afterShow,[n,e]);}));}var U={id:n,width:o,height:r,padding:c,css:E};return "gravity"in e&&(U.gravity=e.gravity),U},i.prototype._changeProps=function(e,t){var i=["width","height","css","padding"];for(var n in t)i.includes(n)&&(this.layout.getCell(e).config[n]=t[n]);},i.prototype._addLayoutItems=function(e){var t=this;return e.map((function(e){if(E.isBlock(e)){var i={width:"content",height:"content"};return t._createLayoutConfig(e,i),i}return t._addLayoutItem(e)}))},i.prototype._checkLayoutConfig=function(e,t){return d.isDefined(e.css)&&(t.css=e.css),d.isDefined(e.title)&&(t.header=e.title),d.isDefined(e.padding)&&(t.padding=e.padding),d.isDefined(e.gravity)&&(t.gravity=e.gravity),d.isDefined(e.width)&&(t.width=e.width),d.isDefined(e.height)&&(t.height=e.height),d.isDefined(e.align)&&(t.align=e.align),t},i.prototype._createLayoutConfig=function(e,t){t=this._checkLayoutConfig(e,t),d.isDefined(e.rows)?t.rows=this._addLayoutItems(e.rows):d.isDefined(e.cols)&&(t.cols=this._addLayoutItems(e.cols));},i.prototype._initUI=function(e){var t=this._attachments={},i={padding:"8px"};this.config.css+=" dhx_form",this._createLayoutConfig(this.config,i);var n=this.layout=new u.Layout(e,i);for(var o in t)n.getCell(o).attach(t[o]);},i.prototype._initHandlers=function(){var e=this;this.events.on(M.FormEvents.afterShow,(function(){e._formContainerShow();})),this.events.on(M.FormEvents.afterHide,(function(){Object.values(e._attachments).some((function(e){return !e.config.hidden}))||e._formContainerHide();}));},i.prototype._clear=function(){for(var e in this._state={},this._attachments){var t=this._attachments[e].config.name;"function"==typeof this._attachments[e].clear&&(this._attachments[e].clear(),t?this._state[t]=this._attachments[e].getValue():this._state[e]=this._attachments[e].getValue());}},i.prototype._clearValidate=function(){for(var e in this._attachments)"function"==typeof this._attachments[e].clearValidate&&this._attachments[e].clearValidate();},i.prototype._formContainerShow=function(){(this.config.hidden=!1,this.getRootView().node)&&(this.getRootView().node.el.style.display="flex");},i.prototype._formContainerHide=function(){(this.config.hidden=!0,this.getRootView().node)&&(this.getRootView().node.el.style.display="none");},i.prototype._send=function(){for(var e in this._attachments)"function"==typeof this._attachments[e].send&&this._attachments[e].send();},i}(c.View);t.Form=O;}).call(this,i(14));},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);}),r=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var a=i(39),s=i(18),l=i(4),c=i(0),u=i(1),d=i(19),h=i(8),f=i(6),p=i(9),v=i(20),g=function(e){function t(t,i){var n=e.call(this,null,i)||this;n.events=new l.EventSystem,n._isValid=!0,n._popupIsFocus=!1,n._propsItem=["required","validation","valueFormat","icon","placeholder","editable","label","labelWidth","labelPosition","hiddenLabel","helpMessage","preMessage","successMessage","errorMessage"],n._propsCalendar=["mode","mark","disabledDates","weekStart","weekNumbers","timePicker","dateFormat","timeFormat","thisMonthOnly"],n._props=r(p.baseProps,n._propsItem,n._propsCalendar),n._keyManager=new v.KeyManager((function(){var e,t,i,o=document.activeElement;return (null===(i=null===(t=null===(e=n.getRootView())||void 0===e?void 0:e.refs)||void 0===t?void 0:t.input)||void 0===i?void 0:i.el)===o||n._popup.isVisible()})),n._initView(i),n._initHandlers(),n._initHotkeys();return n.mount(t,c.create({render:function(){return n._draw()}})),n}return o(t,e),t.prototype.destructor=function(){this.events&&this.events.clear(),this.calendar&&this.calendar.destructor(),this._popup&&this._popup.destructor(),this.events=this._uid=this._propsCalendar=this._propsItem=this._props=this._isValid=null,e.prototype._destructor.call(this),this.unmount();},t.prototype.setProperties=function(e){if(e&&!u.isEmptyObj(e)&&this.events.fire(f.ItemEvent.beforeChangeProperties,[this.getProperties()])){for(var t in e)this._props.includes(t)&&(this.config[t]=e[t],this._propsCalendar.includes(t)&&(this.calendar.config[t]=e[t]));this.events.fire(f.ItemEvent.afterChangeProperties,[this.getProperties()]),this.calendar.paint(),this.paint();}},t.prototype.getProperties=function(){for(var e={},t=0,i=this._props;t<i.length;t++){var n=i[t];e[n]=this.config[n];}return e},t.prototype.show=function(){var e=this.config,t=e.value;e.hidden&&this.events.fire(f.ItemEvent.beforeShow,[t])&&(this.config.hidden=!1,this.events.fire(f.ItemEvent.afterShow,[t]));},t.prototype.hide=function(e){var t=this.config,i=t.value;t.hidden&&!e||!this.events.fire(f.ItemEvent.beforeHide,[i,e])||(this.config.hidden=!0,this.events.fire(f.ItemEvent.afterHide,[i,e]));},t.prototype.isVisible=function(){return !this.config.hidden},t.prototype.disable=function(){this.config.disabled=!0,this.paint();},t.prototype.enable=function(){this.config.disabled=!1,this.paint();},t.prototype.isDisabled=function(){return this.config.disabled},t.prototype.validate=function(e,t){void 0===e&&(e=!1);var i=void 0===t?this.getValue():t,n="Date"===this.config.valueFormat?i instanceof Date:s.stringToDate(i,this.calendar.config.dateFormat,!0);if(e||this.events.fire(f.ItemEvent.beforeValidate,[i]))return this._isValid=this.config.validation?this.config.validation(i):!!n,!e&&this.events.fire(f.ItemEvent.afterValidate,[i,this._isValid]),this._isValid},t.prototype.clearValidate=function(){this.config.$validationStatus=f.ValidationStatus.pre,this.paint();},t.prototype.setValue=function(e){void 0!==e&&e!==this.config.value&&(this.calendar.setValue(e),p.isVerify(this.config)&&this.validate());},t.prototype.getValue=function(e){var t=this.config,i=t.value,n=t.valueFormat;return (i instanceof Date||!e||""===i)&&(i instanceof Date||"Date"!==n||""===i)?i||"":s.stringToDate(i,this.calendar.config.dateFormat)||""},t.prototype.focus=function(){var e=this;c.awaitRedraw().then((function(){e.getRootView().refs.input.el.focus();}));},t.prototype.blur=function(){var e=this;c.awaitRedraw().then((function(){e._popup.hide(),e.getRootView().refs.input.el.blur();}));},t.prototype.clear=function(){""!==this.config.value&&(this.config.value="",this.calendar.clear(),this.events.fire(f.ItemEvent.change,[this.getValue()]));},t.prototype.getWidget=function(){return this.calendar},t.prototype._initView=function(e){var t=this;if(u.isEmptyObj(e))throw new Error("Check the configuration is correct");for(var i in this.calendar&&this.calendar.destructor(),this._popup&&this._popup.destructor(),this.config={type:e.type,id:e.id,name:e.name,disabled:!1,editable:!1,hidden:!1,value:"",mode:"calendar",weekStart:"sunday",weekNumbers:!1,timePicker:!1,dateFormat:"%d/%m/%y",timeFormat:24,thisMonthOnly:!1,valueFormat:"string",required:!1,icon:"",placeholder:"",label:"",labelWidth:"",labelPosition:"top",hiddenLabel:!1,helpMessage:"",preMessage:"",successMessage:"",errorMessage:"",width:"content",height:"content"},e)"id"!==i&&"type"!==i&&"name"!==i&&(this.config[i]=e[i]);this._popup=new h.Popup,this.calendar=new a.Calendar(null,p.widgetConfig(e)),this._popup.attach(this.calendar),this.config.hidden&&c.awaitRedraw().then((function(){t.hide(!0);}));},t.prototype._initHandlers=function(){var e=this;this.calendar.events.on(a.CalendarEvents.change,(function(){var t=e.calendar.getValue("Date"===e.config.valueFormat);e.config.value!==t&&(e.config.value=t,e.events.fire(f.ItemEvent.change,[t]),e._popup.hide(),e.paint());})),this.events.on(f.ItemEvent.afterValidate,(function(){e.config.$validationStatus=e._isValid?f.ValidationStatus.success:f.ValidationStatus.error,e.paint();})),this.events.on(f.ItemEvent.blur,(function(){e._popupIsFocus=!1,e.paint();})),this._popup.events.on(h.PopupEvents.afterHide,(function(){document.activeElement!==e.getRootView().refs.input.el&&e.events.fire(f.ItemEvent.blur,[e.getValue()]),e.paint();})),document.addEventListener("keydown",(function(t){var i,n,o,r=document.activeElement;((null===(o=null===(n=null===(i=e.getRootView())||void 0===i?void 0:i.refs)||void 0===n?void 0:n.input)||void 0===o?void 0:o.el)===r||e._popup.isVisible())&&e.events.fire(f.ItemEvent.keydown,[t]);})),document.addEventListener("mousedown",(function(){e._popup.getContainer()!==document.activeElement&&(e._popupIsFocus=!1);}));},t.prototype._getHandlers=function(){var e=this;return {onblur:function(){e._popup.isVisible()||e.events.fire(f.ItemEvent.blur,[e.getValue()]),e.paint();},onfocus:function(){if(!e._popup.isVisible()){var t=e.getRootView().refs.input.el;e._popup.show(t),e.events.fire(f.ItemEvent.focus,[e.getValue()]),e.paint();}},oninput:function(t){var i=t.target.value;e.events.fire(f.ItemEvent.input,[i]);},onchange:function(t){var i=t.target.value;e.config.editable&&s.stringToDate(i,e.calendar.config.dateFormat,!0)?e.setValue(i):""===i?(e.clear(),p.isVerify(e.config)&&e.validate(),e.paint()):(p.isVerify(e.config)&&e.validate(),e.paint());}}},t.prototype._initHotkeys=function(){var e=this,t={"shift+tab":function(){e._applyTab();},tab:function(){e._applyTab();},escape:function(){e._popup.isVisible()&&e.getRootView().refs.input.el.focus(),e._popup.hide();},enter:function(t){if(t.preventDefault(),!e._popup.isVisible()){var i=e.getRootView().refs.input.el;e._popup.show(i);}},arrowRight:function(t){var i=e._popup.getContainer();e._popup.isVisible()&&!e._popupIsFocus&&(t.preventDefault(),i.focus(),e._popupIsFocus=!0);}};for(var i in t)this._keyManager.addHotKey(i,t[i]);},t.prototype._draw=function(){var e,t,i,n=this.config,o=n.icon,r=n.required,a=n.disabled,s=n.placeholder,l=n.name,u=n.id,d=n.editable,h=n.label,f=n.helpMessage,v=this.config.value instanceof Date?this.calendar.getValue():this.config.value,g=this._popup.isVisible()||(null===(i=null===(t=null===(e=this.getRootView())||void 0===e?void 0:e.refs)||void 0===t?void 0:t.input)||void 0===i?void 0:i.el)===document.activeElement;return c.el("div.dhx_form-group",{class:p.getFormItemCss(this.config,p.isVerify(this.config),g)},[this._drawLabel(),c.el(".dhx_input__wrapper",[c.el("div.dhx_input__container",{},[c.el(".dhx_input__icon",{class:o||"dxi dxi-calendar-today"}),c.el("input.dhx_input.dhx_input--icon-padding",{tabindex:0,"data-dhx-id":l||u,_key:this._uid,_ref:"input",value:v,type:"text",required:r,disabled:a,class:g&&"dhx_input--focus",placeholder:s||"",name:l||"",id:u||this._uid,onfocus:this._handlers.onfocus,oninput:this._handlers.oninput,onchange:this._handlers.onchange,onblur:this._handlers.onblur,autocomplete:"off",readOnly:!d,"aria-label":h||(d?"type or":"")+" select date","aria-describedby":f?"dhx_label__help_"+(u||this._uid):null})]),p.getValidationMessage(this.config)&&c.el("span.dhx_input__caption",{},p.getValidationMessage(this.config))])])},t.prototype._applyTab=function(){var e,t,i;document.activeElement===(null===(i=null===(t=null===(e=this._popup.getRootView())||void 0===e?void 0:e.refs)||void 0===t?void 0:t.content)||void 0===i?void 0:i.el)||this._popupIsFocus||this._popup.hide();},t}(d.Label);t.DatePicker=g;},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);}),r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},a=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var s=i(0),l=i(7),c=i(6),u=i(4),d=i(1),h=i(9),f=function(e){function t(t,i){var n=e.call(this,t,r({disabled:!1,hidden:!1,submit:!1,full:!1,circle:!1,loading:!1,view:"flat",size:"medium",color:"primary",width:"content",height:"content",url:"",text:"",icon:""},i))||this;n._propsItem=["submit","url","text","icon","view","size","color","full","circle","loading"],n._props=a(h.baseProps,n._propsItem),n.config.text=n.config.text||n.config.value||"",n.events=new u.EventSystem,n._handlers={onclick:function(e){return n.events.fire(c.ItemEvent.click,[e])},onblur:function(){return n.events.fire(c.ItemEvent.blur,[n.config.text])},onfocus:function(){return n.events.fire(c.ItemEvent.focus,[n.config.text])},onkeydown:function(e){return n.events.fire(c.ItemEvent.keydown,[e])}},n.config.hidden&&s.awaitRedraw().then((function(){n.hide(!0);}));return n.mount(t,s.create({render:function(){return n._draw()}})),n}return o(t,e),t.prototype.destructor=function(){this.events&&this.events.clear(),this.config=this._propsItem=this._props=this.events=this._handlers=this._uid=null,this.unmount();},t.prototype.setProperties=function(e){if(e&&!d.isEmptyObj(e)&&this.events.fire(c.ItemEvent.beforeChangeProperties,[this.getProperties()])){for(var t in e)this._props.includes(t)&&(this.config[t]=e[t]);this.config.text=this.config.text||this.config.value,this.events.fire(c.ItemEvent.afterChangeProperties,[this.getProperties()]),this.paint();}},t.prototype.getProperties=function(){for(var e={},t=0,i=this._props;t<i.length;t++){var n=i[t];e[n]=this.config[n];}return e},t.prototype.show=function(){var e=this.config,t=e.text;e.hidden&&this.events.fire(c.ItemEvent.beforeShow,[t])&&(this.config.hidden=!1,this.events.fire(c.ItemEvent.afterShow,[t]));},t.prototype.hide=function(e){var t=this.config,i=t.text;t.hidden&&!e||!this.events.fire(c.ItemEvent.beforeHide,[i,e])||(this.config.hidden=!0,this.events.fire(c.ItemEvent.afterHide,[i,e]));},t.prototype.isVisible=function(){return !this.config.hidden},t.prototype.disable=function(){this.config.disabled=!0,this.paint();},t.prototype.enable=function(){this.config.disabled=!1,this.paint();},t.prototype.isDisabled=function(){return this.config.disabled},t.prototype.focus=function(){var e=this;s.awaitRedraw().then((function(){e.getRootView().refs.button.el.focus();}));},t.prototype.blur=function(){var e=this;s.awaitRedraw().then((function(){e.getRootView().refs.button.el.blur();}));},t.prototype._draw=function(){var e=this.config,t=e.color,i=e.size,n=e.view,o=e.full,r=e.loading,a=e.circle,l=e.icon,c=e.text,u=e.disabled,d=e.submit,h=e.id,f=e.name,p={danger:" dhx_button--color_danger",secondary:" dhx_button--color_secondary",primary:" dhx_button--color_primary",success:" dhx_button--color_success"}[t]||" dhx_button--color_primary",v={small:" dhx_button--size_small",medium:" dhx_button--size_medium"}[i]||" dhx_button--size_medium",g={flat:" dhx_button--view_flat",link:" dhx_button--view_link"}[n]||" dhx_button--view_flat",_=o?" dhx_button--width_full":"",m=a?" dhx_button--circle":"",y=r?" dhx_button--loading":"",b=l&&!c?" dhx_button--icon":"";return s.el("button",{disabled:u,id:h,"data-dhx-id":f||h,onclick:this._handlers.onclick,onfocus:this._handlers.onfocus,onblur:this._handlers.onblur,onkeydown:this._handlers.onkeydown,type:d?"submit":"button",class:"dhx_button"+p+v+g+_+m+y+b,_ref:"button"},[l&&s.el("span.dhx_button__icon",{class:l}),c&&s.el("span.dhx_button__text",c),r&&s.el("span.dhx_button__loading",[s.el("span.dhx_button__loading-icon.dxi.dxi-loading")])])},t}(l.View);t.Button=f;},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);}),r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},a=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var s=i(0),l=i(15),c=i(4),u=i(59),d=i(19),h=i(6),f=i(1),p=i(9),v=i(8),g=function(e){function t(t,i){var n=e.call(this,null,i)||this;n.events=new c.EventSystem,n._buttons=[],n._isValid=!0,n._propsItem=["required","label","labelWidth","labelPosition","hiddenLabel","helpMessage","preMessage","successMessage","errorMessage","options"],n._props=a(p.baseProps,n._propsItem),n._initView(i),n._initHandlers();return n.mount(t,s.create({render:function(){return n._draw()}})),n}return o(t,e),t.prototype.destructor=function(){this.events&&this.events.clear(),this.layout&&this.layout.destructor(),this.events=this._uid=this._propsItem=this._props=this._isValid=this._buttons=null,e.prototype._destructor.call(this),this.unmount();},t.prototype.setProperties=function(e,t){if(void 0!==e&&this.events.fire(h.ItemEvent.beforeChangeProperties,[this.getProperties()])){if("object"==typeof e&&!f.isEmptyObj(e)){for(var i in e)this._props.includes(i)&&(this.config[i]=e[i]);e.hasOwnProperty("options")&&(this._initView(this.config),this._initHandlers());}if("string"==typeof e&&t&&!f.isEmptyObj(t)){var n=this._buttons.find((function(t){return t.config.id===e}));n&&n.setProperties(t,!0);}this.events.fire(h.ItemEvent.afterChangeProperties,[this.getProperties()]),this.paint();}},t.prototype.getProperties=function(e){if(void 0===e){var t={};for(var i in this.config)this._props.includes(i)&&(t[i]=this.config[i]);return t}return this._buttons.find((function(t){return t.config.id===e})).getProperties()},t.prototype.getValue=function(e){if(void 0===e){var t={};return this._buttons.forEach((function(e){t[e.config.id]=e.getValue();})),t}var i=this._buttons.find((function(t){return t.config.id===e}));if(e&&i)return i.getValue()},t.prototype.setValue=function(e){if(void 0!==e&&!f.isEmptyObj(e)){for(var t=!1,i=function(e,i){var o=n._buttons.find((function(t){return t.config.id===e}));o&&(o.setValue(!!i,!0),t=!0);},n=this,o=0,r=Object.entries(e);o<r.length;o++){var a=r[o];i(a[0],a[1]);}t&&(this.events.fire(h.ItemEvent.change,[this.getValue()]),p.isVerify(this.config)&&this.validate());}},t.prototype.isChecked=function(e){if(void 0===e){var t={};return this._buttons.forEach((function(e){t[e.config.id]=e.isChecked();})),t}var i=this._buttons.find((function(t){return t.config.id===e}));if(e&&i)return i.isChecked()},t.prototype.focus=function(e){var t=this;s.awaitRedraw().then((function(){if(t._buttons.length){if(!e)return t._buttons[0].focus();var i=t._buttons.find((function(t){return t.config.id===e}));i&&i.focus();}}));},t.prototype.blur=function(){var e=this;s.awaitRedraw().then((function(){e._buttons.length&&e._buttons.forEach((function(e){e.blur();}));}));},t.prototype.show=function(){this.config.hidden&&this.events.fire(h.ItemEvent.beforeShow,[this.getValue()])&&(this.config.hidden=!1,this.events.fire(h.ItemEvent.afterShow,[this.getValue()]));},t.prototype.hide=function(e){this.config.hidden&&!e||!this.events.fire(h.ItemEvent.beforeHide,[this.getValue(),e])||(this.config.hidden=!0,this.events.fire(h.ItemEvent.afterHide,[this.getValue(),e]));},t.prototype.isVisible=function(){return !this.config.hidden},t.prototype.disable=function(){this.config.disabled=!0,this.paint();},t.prototype.enable=function(){this.config.disabled=!1,this._buttons.length&&this._buttons.forEach((function(e){e.enable();})),this.paint();},t.prototype.isDisabled=function(){return this.config.disabled},t.prototype.clear=function(){this._buttons.some((function(e){return e.isChecked()}))&&(this._buttons.forEach((function(e){e.clear(!0);})),this.events.fire(h.ItemEvent.change,[this.getValue()]));},t.prototype.validate=function(e){var t=this;if(void 0===e&&(e=!1),e||this.events.fire(h.ItemEvent.beforeValidate,[this.getValue()]))return this.config.required&&(this._isValid=this._buttons.some((function(e){return e.config.$required&&!!e.config.checked}))),e||(this._buttons.forEach((function(e){e.config.$validationStatus=t._isValid?h.ValidationStatus.success:h.ValidationStatus.error;})),this.config.$validationStatus=this._isValid?h.ValidationStatus.success:h.ValidationStatus.error,this.events.fire(h.ItemEvent.afterValidate,[this.getValue(),this._isValid])),this._isValid},t.prototype.clearValidate=function(){this.config.$validationStatus=h.ValidationStatus.pre,this._buttons.forEach((function(e){e.clearValidate();})),this.paint();},t.prototype._initView=function(e){var t=this;if(f.isEmptyObj(e)||!e.options||f.isEmptyObj(e.options))throw new Error("Check the configuration is correct");for(var i in this.layout&&this.layout.destructor(),this._buttons.length&&(this._buttons.forEach((function(e){e.destructor();})),this._buttons=[]),this.config={type:e.type,id:e.id,name:e.name,disabled:!1,hidden:!1,options:{},required:!1,label:"",labelWidth:"",labelPosition:"top",hiddenLabel:!1,helpMessage:"",preMessage:"",successMessage:"",errorMessage:"",width:"content",height:"content"},e)"id"!==i&&"type"!==i&&"name"!==i&&(this.config[i]=e[i]);this.config.helpMessage&&(this._helper=new v.Popup({css:"dhx_tooltip dhx_tooltip--forced dhx_tooltip--light"}),this._helper.attachHTML(this.config.helpMessage));var n=this.config.options.rows||this.config.options.cols;n.forEach((function(e){e.id=e.id||f.uid(),e.$group=!0;})),this.layout=new l.Layout(null,this.config.options),n.forEach((function(i){var n=new u.Checkbox(null,r(r({},i),{disabled:e.disabled,name:e.name,$required:e.required}));t._buttons.push(n),t.layout.getCell(i.id).attach(n),n.events.on(h.ItemEvent.change,(function(){t.events.fire(h.ItemEvent.change,[t.getValue()]),p.isVerify(t.config)&&t.validate();})),n.events.on(h.ItemEvent.focus,(function(e,i){t.events.fire(h.ItemEvent.focus,[t.getValue(),i]);})),n.events.on(h.ItemEvent.blur,(function(e,i){t.events.fire(h.ItemEvent.blur,[t.getValue(),i]);})),n.events.on(h.ItemEvent.keydown,(function(e,i){t.events.fire(h.ItemEvent.keydown,[e,i]);}));})),this.config.value&&this.setValue(this.config.value),this.clearValidate(),this.config.hidden&&s.awaitRedraw().then((function(){t.hide(!0);}));},t.prototype._initHandlers=function(){var e=this;this.events.on(h.ItemEvent.change,(function(){e.config.value=e.getValue(),e.paint();})),this.events.on(h.ItemEvent.afterValidate,(function(){e.config.$validationStatus=e._isValid?h.ValidationStatus.success:h.ValidationStatus.error,e.paint();}));},t.prototype._draw=function(){var e=this.config.hidden?" dhx_form-group--hidden":"",t=this.config,i=t.label,n=t.labelWidth,o=t.helpMessage,r=t.required,a=t.name,l=t.id;return s.el("fieldset.dhx_form-group-fieldset",{},[s.el("div.dhx_form-group.dhx_form-group--checkbox-group",{class:p.getFormItemCss(this.config,p.isVerify(this.config))+e,"data-dhx-id":a||l,role:"radiogroup"},[i||n||o||r?this._drawLabel():null,s.el("div.dhx_checkbox-group--container",{},[this.layout&&s.inject(this.layout.getRootView()),r&&p.getValidationMessage(this.config)&&s.el("span.dhx_input__caption",p.getValidationMessage(this.config))])])])},t}(d.Label);t.CheckboxGroup=g;},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);}),r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},a=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var s=i(0),l=i(1),c=i(15),u=i(8),d=i(4),h=i(230),f=i(9),p=i(19),v=i(6),g=function(e){function t(t,i){var n=e.call(this,null,i)||this;n.events=new d.EventSystem,n._buttons=[],n._isValid=!0,n._propsItem=["required","label","labelWidth","labelPosition","hiddenLabel","helpMessage","preMessage","successMessage","errorMessage","options"],n._props=a(f.baseProps,n._propsItem),n._initView(i),n._initHandlers(),n.config.value&&n._setValue(n.config.value),n.clearValidate(),n.config.helpMessage&&(n._helper=new u.Popup({css:"dhx_tooltip dhx_tooltip--forced dhx_tooltip--light"}),n._helper.attachHTML(n.config.helpMessage));return n.mount(t,s.create({render:function(){return n._draw()}})),n}return o(t,e),t.prototype.destructor=function(){this.events&&this.events.clear(),this.layout&&this.layout.destructor(),this.events=this._uid=this._propsItem=this._props=this._isValid=this._buttons=null,e.prototype._destructor.call(this),this.unmount();},t.prototype.setProperties=function(e,t){if(void 0!==e&&this.events.fire(v.ItemEvent.beforeChangeProperties,[this.getProperties()])){if("object"==typeof e&&!l.isEmptyObj(e)){for(var i in e)this._props.includes(i)&&(this.config[i]=e[i]);e.hasOwnProperty("options")&&(this._initView(this.config),this._initHandlers());}if("string"==typeof e&&t&&!l.isEmptyObj(t)){var n=this._buttons.find((function(t){return t.config.id===e}));n&&n.setProperties(t);}this.events.fire(v.ItemEvent.afterChangeProperties,[this.getProperties()]),this.paint();}},t.prototype.getProperties=function(e){if(void 0===e){var t={};for(var i in this.config)this._props.includes(i)&&(t[i]=this.config[i]);return t}return this._buttons.find((function(t){return t.config.id===e})).getProperties()},t.prototype.getValue=function(){var e=this;return this._buttons.forEach((function(t){t.getValue()&&(e.config.value=t.getValue()||"");})),this.config.value||""},t.prototype.setValue=function(e){e!==this.config.value&&(this._setValue(e),this.events.fire(v.ItemEvent.change,[e]),f.isVerify(this.config)&&this.validate());},t.prototype.focus=function(e){var t=this;s.awaitRedraw().then((function(){if(t._buttons.length){if(!e)return t._buttons[0].focus();var i=t._buttons.find((function(t){return t.config.id===e}));if(i)return i.focus()}}));},t.prototype.blur=function(){var e=this;s.awaitRedraw().then((function(){e._buttons.length&&e._buttons.forEach((function(e){return e.blur()}));}));},t.prototype.show=function(){this.config.hidden&&this.events.fire(v.ItemEvent.beforeShow,[this.getValue()])&&(this.config.hidden=!1,this.events.fire(v.ItemEvent.afterShow,[this.getValue()]));},t.prototype.hide=function(e){this.config.hidden&&!e||!this.events.fire(v.ItemEvent.beforeHide,[this.getValue(),e])||(this.config.hidden=!0,this.events.fire(v.ItemEvent.afterHide,[this.getValue(),e]));},t.prototype.isVisible=function(){return !this.config.hidden},t.prototype.disable=function(){this.config.disabled=!0,this.paint();},t.prototype.enable=function(){this.config.disabled=!1,this._buttons.length&&this._buttons.forEach((function(e){e.enable();})),this.paint();},t.prototype.isDisabled=function(){return this.config.disabled},t.prototype.clear=function(){""!==this.config.value&&(this._buttons.forEach((function(e){e.clear();})),this.config.value="",this.events.fire(v.ItemEvent.change,[this.config.value]));},t.prototype.validate=function(e){var t=this;if(void 0===e&&(e=!1),e||this.events.fire(v.ItemEvent.beforeValidate,[this.getValue()]))return this.config.required&&(this._isValid=this._buttons.some((function(e){return t.config.required&&!!e.config.checked}))),e||(this._buttons.forEach((function(e){e.config.$validationStatus=t._isValid?v.ValidationStatus.success:v.ValidationStatus.error;})),this.config.$validationStatus=this._isValid?v.ValidationStatus.success:v.ValidationStatus.error,this.events.fire(v.ItemEvent.afterValidate,[this.getValue(),this._isValid])),this._isValid},t.prototype.clearValidate=function(){this.config.$validationStatus=v.ValidationStatus.pre,this._buttons.map((function(e){e.clearValidate();})),this.paint();},t.prototype._initView=function(e){var t=this;if(l.isEmptyObj(e)||!e.options||l.isEmptyObj(e.options))throw new Error("Check the configuration is correct");for(var i in this.layout&&this.layout.destructor(),this._buttons.length&&(this._buttons.forEach((function(e){e.destructor();})),this._buttons=[]),this.config={type:e.type,id:e.id,name:e.name,disabled:!1,hidden:!1,options:{},required:!1,label:"",labelWidth:"",labelPosition:"top",hiddenLabel:!1,helpMessage:"",preMessage:"",successMessage:"",errorMessage:"",width:"content",height:"content"},e)"id"!==i&&"type"!==i&&"name"!==i&&(this.config[i]=e[i]);this.config.hidden&&s.awaitRedraw().then((function(){t.hide(!0);}));var n=this.config.options.rows||this.config.options.cols;n.map((function(e){e.id=e.id||l.uid();})),this.layout=new c.Layout(null,this.config.options),n.map((function(i){var n=new h.RadioButton(null,r(r({},i),{$disabled:e.disabled,$name:e.name,$required:e.required}));t._buttons.push(n),t.layout.getCell(i.id).attach(n),n.events.on(h.RadioButtonEvents.change,(function(){t._buttons.map((function(e){e.config.id!==n.config.id&&e.setValue(!1);})),t.events.fire(v.ItemEvent.change,[t.getValue()]),f.isVerify(t.config)&&t.validate();})),n.events.on(h.RadioButtonEvents.focus,(function(e,i){t.events.fire(v.ItemEvent.focus,[e,i]);})),n.events.on(h.RadioButtonEvents.blur,(function(e,i){t.events.fire(v.ItemEvent.blur,[e,i]);})),n.events.on(h.RadioButtonEvents.keydown,(function(e,i){t.events.fire(v.ItemEvent.keydown,[e,i]);}));}));},t.prototype._initHandlers=function(){var e=this;this.events.on(v.ItemEvent.change,(function(){e.config.value=e.getValue(),e.paint();})),this.events.on(v.ItemEvent.afterValidate,(function(){e.config.$validationStatus=e._isValid?v.ValidationStatus.success:v.ValidationStatus.error,e.paint();}));},t.prototype._draw=function(){var e=this.config,t=e.label,i=e.labelWidth,n=e.helpMessage,o=e.required,r=e.hidden,a=e.name,l=e.id,c=r?" dhx_form-group--hidden":"";return s.el("fieldset.dhx_form-group-fieldset",{},[s.el("div.dhx_form-group.dhx_form-group--radio-group",{class:f.getFormItemCss(this.config,f.isVerify(this.config))+c,"data-dhx-id":a||l},[t||i||n||o?[this._drawLabel()]:null,s.el("div.dhx_radio-group--container",{},[this.layout&&s.inject(this.layout.getRootView()),o&&f.getValidationMessage(this.config)&&s.el("span.dhx_input__caption",f.getValidationMessage(this.config))])])])},t.prototype._setValue=function(e){void 0!==e&&-1!==this._buttons.findIndex((function(t){return t.config.value===e}))&&this._buttons.forEach((function(t){e===t.config.value?t.setValue(!0):t.setValue(!1);}));},t}(p.Label);t.RadioGroup=g;},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);}),r=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var a=i(0),s=i(1),l=i(19),c=i(9),u=i(4),d=i(6),h=function(e){function t(t,i){var n=e.call(this,null,i)||this;return n.events=new u.EventSystem,n._isValid=!0,n._propsItem=["required","validation","icon","label","labelWidth","labelPosition","hiddenLabel","helpMessage","preMessage","successMessage","errorMessage"],n._props=r(c.baseProps,n._propsItem),n._initView(i),n._initHandlers(),n}return o(t,e),t.prototype.destructor=function(){this.events&&this.events.clear(),this.events=this._uid=this._propsItem=this._props=this._isValid=null,e.prototype._destructor.call(this),this.unmount();},t.prototype.setProperties=function(e){if(e&&!s.isEmptyObj(e)&&this.events.fire(d.ItemEvent.beforeChangeProperties,[this.getProperties()])){for(var t in e)this._props.includes(t)&&(this.config[t]=e[t]);this.events.fire(d.ItemEvent.afterChangeProperties,[this.getProperties()]),this.paint();}},t.prototype.getProperties=function(){for(var e={},t=0,i=this._props;t<i.length;t++){var n=i[t];e[n]=this.config[n];}return e},t.prototype.show=function(){var e=this.config,t=e.value;e.hidden&&this.events.fire(d.ItemEvent.beforeShow,[t])&&(this.config.hidden=!1,this.events.fire(d.ItemEvent.afterShow,[t]));},t.prototype.hide=function(e){var t=this.config,i=t.value;t.hidden&&!e||!this.events.fire(d.ItemEvent.beforeHide,[i,e])||(this.config.hidden=!0,this.events.fire(d.ItemEvent.afterHide,[i,e]));},t.prototype.isVisible=function(){return !this.config.hidden},t.prototype.disable=function(){this.config.disabled=!0,this.paint();},t.prototype.enable=function(){this.config.disabled=!1,this.paint();},t.prototype.isDisabled=function(){return this.config.disabled},t.prototype.validate=function(e){void 0===e&&(e=!1);var t=this.config,i=t.value,n=t.validation;if(e||this.events.fire(d.ItemEvent.beforeValidate,[i]))return this._isValid=n?this.config.validation(i):void 0!==i&&!!String(i).length,!e&&this.events.fire(d.ItemEvent.afterValidate,[i,this._isValid]),this._isValid},t.prototype.clearValidate=function(){this.config.$validationStatus=d.ValidationStatus.pre,this.paint();},t.prototype.clear=function(){this.config.value!==this.config.options[0].value&&(this.config.value=this.config.options[0].value,this.events.fire(d.ItemEvent.change,[this.getValue()]));},t.prototype.setValue=function(e){void 0!==e&&e!==this.config.value&&-1!==this.config.options.findIndex((function(t){return t.value===e}))&&(this.config.value=e,this.events.fire(d.ItemEvent.change,[e]),c.isVerify(this.config)&&this.validate());},t.prototype.focus=function(){var e=this;a.awaitRedraw().then((function(){e.getRootView().refs.select.el.focus();}));},t.prototype.blur=function(){var e=this;a.awaitRedraw().then((function(){e.getRootView().refs.select.el.blur();}));},t.prototype.getValue=function(){return this.config.value},t.prototype.setOptions=function(e){if(!e||!e.length)throw new Error("Function argument cannot be empty, for more info check documentation https://docs.dhtmlx.com/suite/form__select.html#addingselect");this._checkOptions(e),this.config.options=r(e),this.config.value=this.config.options[0].value,this.events.fire(d.ItemEvent.changeOptions,[r(e)]),this.paint();},t.prototype.getOptions=function(){return this.config.options},t.prototype._initView=function(e){var t=this;if(s.isEmptyObj(e))throw new Error("Check the configuration is correct");for(var i in this._checkOptions(e.options),this.config={type:e.type,id:e.id,name:e.name,disabled:!1,hidden:!1,required:!1,icon:"",label:"",labelWidth:"",labelPosition:"top",hiddenLabel:!1,helpMessage:"",preMessage:"",successMessage:"",errorMessage:"",width:"content",height:"content",options:e.options,value:e.options[0].value},e)"id"!==i&&"type"!==i&&"name"!==i&&(this.config[i]=e[i]);this.config.hidden&&a.awaitRedraw().then((function(){t.hide(!0);})),this.paint();},t.prototype._initHandlers=function(){var e=this;this.events.on(d.ItemEvent.afterValidate,(function(){e.config.$validationStatus=e._isValid?d.ValidationStatus.success:d.ValidationStatus.error,e.paint();})),this.events.on(d.ItemEvent.changeOptions,(function(){e.events.fire(d.ItemEvent.change,[e.getValue()]),c.isVerify(e.config)&&e.validate();})),this.events.on(d.ItemEvent.change,(function(){return e.paint()}));},t.prototype._getHandlers=function(){var e=this;return {onchange:function(t){var i=e.config.options.map((function(e){return e.value})).find((function(e){return e==t.target.value}));e.config.value=i,e.events.fire(d.ItemEvent.change,[i]),c.isVerify(e.config)&&e.validate();},onblur:function(){e._uid&&(e.events.fire(d.ItemEvent.blur,[e.getValue()]),e.paint());},onfocus:function(){e.events.fire(d.ItemEvent.focus,[e.getValue()]),e.paint();}}},t.prototype._draw=function(){var e,t,i,n=this.config,o=n.id,r=n.options,s=n.icon,l=n.value,u=n.label,d=n.labelWidth,h=n.helpMessage,f=n.required,p=n.name,v=(null===(i=null===(t=null===(e=this.getRootView())||void 0===e?void 0:e.refs)||void 0===t?void 0:t.select)||void 0===i?void 0:i.el)===document.activeElement;return a.el(".dhx_form-group",{class:c.getFormItemCss(this.config,c.isVerify(this.config),v)},[(u||d||h)&&this._drawLabel(),a.el(".dhx_input__wrapper",{},[a.el("div.dhx_input__container",{},[a.el(".dhx_input__icon",{class:s||"dxi dxi-menu-down"}),a.el("select.dhx_select.dhx_input",{id:o,"data-dhx-id":p||o,tabindex:0,class:v&&"dhx_input--focus",onchange:this._handlers.onchange,onfocus:this._handlers.onfocus,onblur:this._handlers.onblur,onkeydown:this._handlers.onkeydown,_ref:"select",required:f},r.length&&r.map((function(e){return a.el("option",{value:e.value,disabled:e.disabled,selected:l===e.value},e.content)})))]),c.getValidationMessage(this.config)&&a.el("span.dhx_input__caption",c.getValidationMessage(this.config))])])},t.prototype._checkOptions=function(e){if(0===e.length)throw new Error("Property options* cannot be empty, for more info check documentation https://docs.dhtmlx.com/suite/form__select.html#addingselect");e.forEach((function(e){if(!e.hasOwnProperty("value")||!e.hasOwnProperty("content"))throw new Error("The object must contain two required properties value and content, for more info check documentation https://docs.dhtmlx.com/suite/form__select.html#addingselect")}));},t}(l.Label);t.Select=h;},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);}),r=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var a=i(0),s=i(9),l=i(47),c=i(6),u=i(1),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._propsItem=["required","validation","placeholder","readOnly","maxlength","minlength","label","labelWidth","labelPosition","hiddenLabel","helpMessage","preMessage","successMessage","errorMessage"],t._props=r(s.baseProps,t._propsItem),t}return o(t,e),t.prototype.setValue=function(e){void 0!==e&&this.config.value!==e&&(this.config.value=e,this.events.fire(c.ItemEvent.change,[this.getValue()]),s.isVerify(this.config)&&this.validate());},t.prototype.getValue=function(){var e;return String(null!==(e=this.config.value)&&void 0!==e?e:"")},t.prototype.focus=function(){var e=this;a.awaitRedraw().then((function(){e.getRootView().refs.textarea.el.focus();}));},t.prototype.blur=function(){var e=this;a.awaitRedraw().then((function(){e.getRootView().refs.textarea.el.blur();}));},t.prototype.setProperties=function(e){if(e&&!u.isEmptyObj(e)&&this.events.fire(c.ItemEvent.beforeChangeProperties,[this.getProperties()])){for(var t in e)this._props.includes(t)&&(this.config[t]=e[t]);this.events.fire(c.ItemEvent.afterChangeProperties,[this.getProperties()]),this.paint();}},t.prototype.getProperties=function(){for(var e={},t=0,i=this._props;t<i.length;t++){var n=i[t];e[n]=this.config[n];}return e},t.prototype._initView=function(e){var t=this;if(u.isEmptyObj(e))throw new Error("Check the configuration is correct");for(var i in this.config={type:e.type,id:e.id,name:e.name,disabled:!1,hidden:!1,required:!1,validation:void 0,placeholder:"",readOnly:!1,label:"",labelWidth:"",labelPosition:"top",hiddenLabel:!1,helpMessage:"",preMessage:"",successMessage:"",errorMessage:"",width:"content",height:"content"},e)"id"!==i&&"type"!==i&&"name"!==i&&(this.config[i]=e[i]);this.config.hidden&&a.awaitRedraw().then((function(){t.hide(!0);})),this.paint();},t.prototype._draw=function(){var e,t,i,n=this.config,o=n.id,r=n.value,l=n.disabled,c=n.name,d=n.placeholder,h=n.required,f=n.resizable,p=n.readOnly,v=n.maxlength,g=n.minlength,_=n.label,m=n.helpMessage,y=n.height,b=(null===(i=null===(t=null===(e=this.getRootView())||void 0===e?void 0:e.refs)||void 0===t?void 0:t.textarea)||void 0===i?void 0:i.el)===document.activeElement;return a.el("div.dhx_form-group.dhx_form-group--textarea",{class:s.getFormItemCss(this.config,s.isVerify(this.config),b)},[this._drawLabel(),a.el(".dhx_input__wrapper",[a.el("textarea.dhx_input.dhx_input--textarea",{type:"text",id:o,"data-dhx-id":c||o,placeholder:d||"",value:u.isDefined(r)?r:"",name:c||"",disabled:l,required:h,readOnly:p,maxlength:v,minlength:g,onblur:this._handlers.onblur,oninput:this._handlers.oninput,onchange:this._handlers.onchange,onfocus:this._handlers.onfocus,onkeydown:this._handlers.onkeydown,_hooks:{didInsert:function(e){if("content"===y){var t=e.el;t.style.height=t.scrollHeight+"px";}}},style:{resize:f?"both":"none"},_ref:"textarea","aria-label":_||(p?r:"")+" type text","aria-describedby":m?"dhx_label__help_"+(o||this._uid):null}),s.getValidationMessage(this.config)&&a.el("span.dhx_input__caption",{},s.getValidationMessage(this.config))])])},t}(l.Input);t.Textarea=d;},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);}),r=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var a=i(0),s=i(1),l=i(9),c=i(47),u=i(6),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._propsItem=["inputType","label","labelWidth","labelPosition","hiddenLabel","helpMessage"],t._props=r(l.baseProps,t._propsItem),t}return o(t,e),t.prototype.setProperties=function(e){if(e&&!s.isEmptyObj(e)&&this.events.fire(u.ItemEvent.beforeChangeProperties,[this.getProperties()])){for(var t in e)this._props.includes(t)&&(this.config[t]=e[t]);this.events.fire(u.ItemEvent.afterChangeProperties,[this.getProperties()]),this.paint();}},t.prototype.getProperties=function(){for(var e={},t=0,i=this._props;t<i.length;t++){var n=i[t];e[n]=this.config[n];}return e},t.prototype._initView=function(e){var t=this;if(s.isEmptyObj(e))throw new Error("Check the configuration is correct");for(var i in this.config={type:e.type,id:e.id,name:e.name,disabled:!1,hidden:!1,value:"",inputType:"text",label:"",labelWidth:"",labelPosition:"top",hiddenLabel:!1,helpMessage:"",width:"content",height:"content"},e)"id"!==i&&"type"!==i&&"name"!==i&&(this.config[i]=e[i]);this.config.hidden&&a.awaitRedraw().then((function(){t.hide(!0);})),this.paint();},t.prototype._draw=function(){var e=this.config,t=e.id,i=e.value,n=e.name,o=e.inputType,r=e.label,s=(null!=i?i:"").toString().length;return a.el("div.dhx_form-group.dhx_form-group--textinput",{class:l.getFormItemCss(this.config)},[this._drawLabel(),a.el(".dhx_input__wrapper",[a.el("input.dhx_input.dhx_input--textinput",{type:["text","number","password"].includes(o)?o:"text",readOnly:!0,id:t,"data-dhx-id":n||t,value:null!=i?i:"",name:n,_ref:"input",tabindex:-1,role:"presentation","aria-label":r||i,size:s>20?s:20,onkeydown:this._handlers.onkeydown})])])},t}(c.Input);t.Text=d;},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);}),r=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var a=i(0),s=i(1),l=i(9),c=i(40),u=i(4),d=i(19),h=i(6),f=function(e){function t(t,i){var n=e.call(this,null,i)||this;return n.events=new u.EventSystem,n._isValid=!0,n._propsItem=["required","validation","placeholder","label","labelWidth","labelPosition","hiddenLabel","helpMessage","preMessage","successMessage","errorMessage","readonly","readOnly"],n._propsCombo=["template","filter","multiselection","selectAllButton","itemsCount","itemHeight","virtual","listHeight"],n._props=r(l.baseProps,n._propsItem,n._propsCombo),n._initView(i),n._initHandlers(),n}return o(t,e),t.prototype.destructor=function(){this.events&&this.events.clear(),this.combobox&&this.combobox.destructor(),this.events=this._uid=this._propsCombo=this._propsItem=this._props=this._isValid=null,e.prototype._destructor.call(this),this.unmount();},t.prototype.setProperties=function(e){var t=this;a.awaitRedraw().then((function(){if(e&&!s.isEmptyObj(e)&&t.events.fire(h.ItemEvent.beforeChangeProperties,[t.getProperties()])){for(var i in e)t._props.includes(i)&&(t.config[i]=e[i]);var n=[];t.getWidget().data.forEach((function(e){return n.push(e)})),t.config.data=n,t._initView(t.config),t._initHandlers(),t.events.fire(h.ItemEvent.afterChangeProperties,[t.getProperties()]),t.combobox.paint(),t.paint();}}));},t.prototype.getProperties=function(){for(var e={},t=0,i=this._props;t<i.length;t++){var n=i[t];e[n]=this.config[n];}return e},t.prototype.show=function(){var e=this.config,t=e.value;e.hidden&&this.events.fire(h.ItemEvent.beforeShow,[t])&&(this.config.hidden=!1,this.events.fire(h.ItemEvent.afterShow,[t]));},t.prototype.hide=function(e){var t=this.config,i=t.value;t.hidden&&!e||!this.events.fire(h.ItemEvent.beforeHide,[i,e])||(this.config.hidden=!0,this.events.fire(h.ItemEvent.afterHide,[i,e]));},t.prototype.isVisible=function(){return !this.config.hidden},t.prototype.disable=function(){this.config.disabled=!0,this.combobox.disable(),this.paint();},t.prototype.enable=function(){this.config.disabled=!1,this.combobox.enable(),this.paint();},t.prototype.isDisabled=function(){return !!this.config.disabled},t.prototype.clear=function(){this.config.value&&(this.config.value="",this.combobox.clear());},t.prototype.getValue=function(){return this.config.multiselection?this.combobox.getValue(!0)||[]:this.combobox.getValue()||""},t.prototype.setValue=function(e){void 0!==e&&e!==this.config.value&&e&&this.combobox.setValue(e);},t.prototype.validate=function(e,t){var i=this;void 0===e&&(e=!1);var n,o=void 0===t?this.getValue():t;return !(!e&&!this.events.fire(h.ItemEvent.beforeValidate,[o]))&&(n=Array.isArray(o)?o.map((function(e){return i._getItemText(e)})):this._getItemText(o)||"",this._isValid=this.config.validation?this.config.validation(o,n):this._exsistData(o),e||(this.config.$validationStatus=this._isValid?h.ValidationStatus.success:h.ValidationStatus.error,this.config.required&&this._validationStatus(),this.events.fire(h.ItemEvent.afterValidate,[o,this._isValid])),this._isValid)},t.prototype.clearValidate=function(){this.config.$validationStatus=h.ValidationStatus.pre,this._validationStatus(),this.paint();},t.prototype.getWidget=function(){return this.combobox},t.prototype.focus=function(){var e=this;a.awaitRedraw().then((function(){e.combobox.focus();}));},t.prototype.blur=function(){var e=this;a.awaitRedraw().then((function(){e.combobox.blur();}));},t.prototype._initView=function(e){var t=this;if(s.isEmptyObj(e))throw new Error("Check the configuration is correct");this.combobox&&this.combobox.destructor(),this.config={type:e.type,id:e.id,name:e.name,disabled:!1,hidden:!1,value:"",readOnly:!1,multiselection:!1,selectAllButton:!1,itemHeight:32,virtual:!1,listHeight:224,required:!1,placeholder:"",label:"",labelWidth:"",labelPosition:"top",hiddenLabel:!1,helpMessage:"",preMessage:"",successMessage:"",errorMessage:"",width:"content",height:"content"};var i={};for(var n in e)"id"!==n&&"type"!==n&&"name"!==n&&(this.config[n]=e[n],"validation"!==n&&(i[n]=e[n]));this.combobox=new c.Combobox(null,i),this.config.hidden&&a.awaitRedraw().then((function(){t.hide(!0);})),this.paint();},t.prototype._initHandlers=function(){var e=this;this.combobox.events.on(c.ComboboxEvents.change,(function(){var t=e.config.value=e.getValue();e.events.fire(h.ItemEvent.change,[t]),l.isVerify(e.config)&&e.validate(),e.paint();})),this.combobox.events.on(c.ComboboxEvents.focus,(function(){e.events.fire(h.ItemEvent.focus,[e.getValue()]),e.paint();})),this.combobox.events.on(c.ComboboxEvents.blur,(function(){e.events.fire(h.ItemEvent.blur,[e.getValue()]),e.paint();})),this.combobox.events.on(c.ComboboxEvents.keydown,(function(t,i){"Enter"===t.code&&t.preventDefault(),e.events.fire(h.ItemEvent.keydown,[t,i]);})),this.events.on(h.ItemEvent.afterValidate,(function(){e.config.$validationStatus=e._isValid?h.ValidationStatus.success:h.ValidationStatus.error,e.paint();}));},t.prototype._validationStatus=function(){var e,t,i;if(!(this.combobox.popup.isVisible()||(null===(i=null===(t=null===(e=this.combobox.getRootView())||void 0===e?void 0:e.refs)||void 0===t?void 0:t.input)||void 0===i?void 0:i.el)===document.activeElement))switch(this.config.$validationStatus){case h.ValidationStatus.success:return this.combobox.config.css=(this.config.css||"")+"dhx_form-group--state_success";case h.ValidationStatus.error:return this.combobox.config.css=(this.config.css||"")+"dhx_form-group--state_error";case h.ValidationStatus.pre:default:return this.combobox.config.css=this.config.css||""}return this.combobox.config.css=this.config.css||""},t.prototype._getRootView=function(){return this.combobox.getRootView()},t.prototype._draw=function(){var e=this.config,t=e.labelWidth,i=e.labelPosition,n=e.name,o=e.id;return a.el(".dhx_form-group",{"data-dhx-id":n||o},[a.inject(this._getRootView()),a.el("div",{style:{"margin-left":t&&"left"===i?"calc("+t+" + 16px)":""},class:this._validationStatus()},[a.el("span.dhx_input__caption",l.getValidationMessage(this.config))])])},t.prototype._exsistData=function(e){var t=this;return !!s.isDefined(e)&&(e instanceof Array?!!e.length&&e.every((function(e){return t.combobox.data.exists(e)})):this.combobox.data.exists(e))},t.prototype._getItemText=function(e){var t;return null===(t=this.combobox.data.getItem(e))||void 0===t?void 0:t.value},t}(d.Label);t.Combo=f;},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);}),r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},a=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var s=i(0),l=i(1),c=i(74),u=i(4),d=i(19),h=i(6),f=i(9),p=function(e){function t(t,i){var n=e.call(this,null,i)||this;n.events=new u.EventSystem,n._propsItem=["label","labelWidth","labelPosition","hiddenLabel","helpMessage"],n._propsSlider=["min","max","step","mode","range","inverse","tooltip","tick","tickTemplate","majorTick"],n._props=a(f.baseProps,n._propsItem,n._propsSlider),n._initView(i),n._initHandlers();return n.mount(t,s.create({render:function(){return n._drawSlider()}})),n}return o(t,e),t.prototype.destructor=function(){this.events&&this.events.clear(),this.slider&&this.slider.destructor(),this.events=this._uid=this._propsSlider=this._propsItem=this._props=null,e.prototype._destructor.call(this),this.unmount();},t.prototype.setProperties=function(e){if(e&&!l.isEmptyObj(e)&&this.events.fire(h.ItemEvent.beforeChangeProperties,[this.getProperties()])){for(var t in e)this._props.includes(t)&&(this.config[t]=e[t]);this._initView(this.config),this._initHandlers(),this.events.fire(h.ItemEvent.afterChangeProperties,[this.getProperties()]),this.slider.paint(),this.paint();}},t.prototype.getProperties=function(){for(var e={},t=0,i=this._props;t<i.length;t++){var n=i[t];e[n]=this.config[n];}return e},t.prototype.show=function(){var e=this.config,t=e.value;e.hidden&&this.events.fire(h.ItemEvent.beforeShow,[t])&&(this.config.hidden=!1,this.events.fire(h.ItemEvent.afterShow,[t]));},t.prototype.hide=function(e){var t=this.config,i=t.value;t.hidden&&!e||!this.events.fire(h.ItemEvent.beforeHide,[i,e])||(this.config.hidden=!0,this.events.fire(h.ItemEvent.afterHide,[i,e]));},t.prototype.isVisible=function(){return !this.config.hidden},t.prototype.disable=function(){this.config.disabled=!0,this.slider.disable(),this.paint();},t.prototype.enable=function(){this.config.disabled=!1,this.slider.enable(),this.paint();},t.prototype.isDisabled=function(){return this.config.disabled},t.prototype.clear=function(){var e=this.config,t=e.value,i=e.min;t[0]!==i&&this.slider.setValue(i);},t.prototype.getValue=function(){return this.slider.getValue()},t.prototype.setValue=function(e){void 0!==e&&e!==this.config.value&&this.slider.setValue(e);},t.prototype.getWidget=function(){return this.slider},t.prototype.focus=function(e){var t=this;s.awaitRedraw().then((function(){t.slider.focus(e);}));},t.prototype.blur=function(){var e=this;s.awaitRedraw().then((function(){e.slider.blur();}));},t.prototype._initView=function(e){var t=this;if(l.isEmptyObj(e))throw new Error("Check the configuration is correct");this.slider&&this.slider.destructor();var i={type:e.type,id:e.id,name:e.name,mode:"horizontal",min:0,max:100,step:1,range:!1,inverse:!1,tooltip:!0,disabled:!1,hidden:!1,label:"",labelWidth:"",labelPosition:"top",hiddenLabel:!1,helpMessage:"",width:"content",height:"content"};for(var n in e)"id"!==n&&"type"!==n&&"name"!==n&&(i[n]=e[n]);this.config=r({type:this.config.type},i),this.slider=new c.Slider(null,i),this.config.disabled&&this.slider.disable(),this.config.value=this.slider.getValue(),this.config.hidden&&s.awaitRedraw().then((function(){t.hide(!0);}));},t.prototype._initHandlers=function(){var e=this;this.slider.events.on(c.SliderEvents.change,(function(){if(e._uid){var t=e.config.value=e.slider.getValue();e.events.fire(h.ItemEvent.change,[t]),e.paint();}})),this.slider.events.on(c.SliderEvents.focus,(function(){e.events.fire(h.ItemEvent.focus,[e.getValue()]);})),this.slider.events.on(c.SliderEvents.blur,(function(){e.events.fire(h.ItemEvent.blur,[e.getValue()]);})),this.slider.events.on(c.SliderEvents.keydown,(function(t){e.events.fire(h.ItemEvent.keydown,[t]);}));},t.prototype._getRootView=function(){return this.slider.paint(),this.slider.getRootView()},t.prototype._drawSlider=function(){var e=this.config,t=e.name,i=e.id;return s.el("div.dhx_form-group",{"data-dhx-id":t||i},[s.inject(this._getRootView())])},t}(d.Label);t.SliderForm=p;},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);}),r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},a=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var s=i(0),l=i(4),c=i(3),u=i(7),d=i(1),h=i(13),f=i(231),p=i(8),v=i(9),g=i(240),_=i(6),m=function(e){function t(t,i){var n=e.call(this,t,i)||this;n._isValid=!0,n._propsItem=["required","label","labelWidth","labelPosition","hiddenLabel","helpMessage","preMessage","successMessage","errorMessage"],n._propsSimpleVault=["target","singleRequest","fieldName","params"],n._props=a(v.baseProps,n._propsItem,n._propsSimpleVault),n.events=new l.EventSystem(n),n.data=new h.DataCollection,n._uploader=new f.Uploader(r(r({},i),{autosend:!1,fieldName:i.fieldName||i.name||i.id}),n.data,n.data.events),n._initView(i),n._initHandlers(),n._handlers={add:function(e){n.config.disabled||(e.preventDefault(),n._uploader.selectFile());},remove:function(e){if(!n.config.disabled){var t=c.locate(e);t&&n.data.remove(t);}},ondragover:function(e){for(var t=0,i=e.dataTransfer.types;t<i.length;t++){var o=i[t];if("Files"!==o&&"application/x-moz-file"!==o)return}n._dragoverTimeout?clearTimeout(n._dragoverTimeout):n.paint(),n._dragover=!0,n._dragoverTimeout=setTimeout((function(){n._dragover=!1,n._dragoverTimeout=null,n.paint();}),150);},showHelper:function(e){e.stopPropagation(),e.preventDefault(),n._helper.show(e.target,{mode:"left"===n.config.labelPosition?"bottom":"right"});},hideHelper:function(e){e.preventDefault(),e.stopPropagation(),n._helper.hide();}};return n.mount(t,s.create({render:function(){return n._draw()}})),n}return o(t,e),t.prototype.destructor=function(){this.events&&this.events.clear(),this._helper&&this._helper.destructor(),this.config=this.events=this._uid=this._helper=this._handlers=this._uploader=this.data=null,this._propsItem=this._propsSimpleVault=this._props=this._isValid=this._dragover=this._dragoverTimeout=null,this.unmount();},t.prototype.setProperties=function(e){if(e&&!d.isEmptyObj(e)&&this.events.fire(_.ItemEvent.beforeChangeProperties,[this.getProperties()])){for(var t in e)this._props.includes(t)&&(this.config[t]=e[t],this._propsSimpleVault.includes(t)&&(this._uploader.config[t]=e[t]));this.events.fire(_.ItemEvent.afterChangeProperties,[this.getProperties()]),this.paint();}},t.prototype.getProperties=function(){for(var e={},t=0,i=this._props;t<i.length;t++){var n=i[t];e[n]=this.config[n];}return e},t.prototype.show=function(){var e=this.config,t=e.value;e.hidden&&this.events.fire(_.ItemEvent.beforeShow,[t])&&(this.config.hidden=!1,this.events.fire(_.ItemEvent.afterShow,[t]));},t.prototype.hide=function(e){var t=this.config,i=t.value;t.hidden&&!e||!this.events.fire(_.ItemEvent.beforeHide,[i,e])||(this.config.hidden=!0,this.events.fire(_.ItemEvent.afterHide,[i,e]));},t.prototype.isVisible=function(){return !this.config.hidden},t.prototype.disable=function(){this.config.disabled=!0,this.paint();},t.prototype.enable=function(){this.config.disabled=!1,this.paint();},t.prototype.isDisabled=function(){return this.config.disabled},t.prototype.validate=function(e){void 0===e&&(e=!1);var t=this.config,i=t.required,n=t.value;if(e||this.events.fire(_.ItemEvent.beforeValidate,[n]))return this._isValid=!i||this.data.getLength()>0,!e&&this.events.fire(_.ItemEvent.afterValidate,[n,this._isValid]),this._isValid},t.prototype.clearValidate=function(){this.config.$validationStatus=_.ValidationStatus.pre,this.paint();},t.prototype.clear=function(){0!==this.getValue().length&&(this.data.removeAll(),this.paint());},t.prototype.getValue=function(){return this.data.serialize()},t.prototype.selectFile=function(){this._uploader.selectFile();},t.prototype.send=function(e){v.isVerify(this.config)&&!this.validate(!0)||this._uploader.send(e);},t.prototype.setValue=function(e){e.length&&(this.data.parse(e),v.isVerify(this.config)&&this.validate());},t.prototype._initView=function(e){var t=this;if(d.isEmptyObj(e))throw new Error("Check the configuration is correct");for(var i in this.config={type:e.type,id:e.id,name:e.name,fieldName:e.fieldName||e.name||e.id,disabled:!1,hidden:!1,singleRequest:!1,target:"",value:[],label:"",labelWidth:"",labelPosition:"top",hiddenLabel:!1,helpMessage:"",preMessage:"",successMessage:"",errorMessage:"",width:"content",height:"content"},e)"id"!==i&&"type"!==i&&"name"!==i&&(this.config[i]=e[i]);this.config.hidden&&s.awaitRedraw().then((function(){t.hide(!0);})),this.config.value.length&&this.setValue(this.config.value),this.paint();},t.prototype._initHandlers=function(){var e=this;this.data.events.on(_.ItemEvent.change,(function(t,i){var n=e.config.value=e.getValue();e.events.fire(_.ItemEvent.change,[n]),i&&v.isVerify(e.config)&&e.validate(),e.paint();})),this.events.on(_.ItemEvent.afterValidate,(function(){e.config.$validationStatus=e._isValid?_.ValidationStatus.success:_.ValidationStatus.error,e.paint();})),this._uploader.events.on("beforeUploadFile",(function(t){return e.events.fire(_.ItemEvent.beforeUploadFile,[t,e.config.value])})),this._uploader.events.on("uploadBegin",(function(t){e.events.fire(_.ItemEvent.uploadBegin,[t,e.config.value]);})),this._uploader.events.on("uploadComplete",(function(t){e.events.fire(_.ItemEvent.uploadComplete,[t,e.config.value]);})),this._uploader.events.on("uploadFail",(function(t){e.events.fire(_.ItemEvent.uploadFail,[t,e.config.value]);})),this._uploader.events.on("uploadFile",(function(t,i){e.events.fire(_.ItemEvent.uploadFile,[t,e.config.value,i]);})),this._uploader.events.on("uploadProgress",(function(t){e.events.fire(_.ItemEvent.uploadProgress,[t,e.config.value]);}));},t.prototype._draw=function(){var e=this;this.config.helpMessage&&(this._helper||(this._helper=new p.Popup({css:"dhx_tooltip dhx_tooltip--forced dhx_tooltip--light"})),this._helper.attachHTML(this.config.helpMessage));var t=this.data.getLength()?s.el("ul.dhx_simplevault__files.dhx_simplevault-files",{class:this.config.$vaultHeight?"":"dhx_simplevault-files__fixed"},this.data.map((function(t){return s.el("li.dhx_simplevault-files__item",[s.el("span.dhx_simplevault-files__item-name",t.file&&t.file.name||t.name),s.el(".dhx_button.dhx_simplevault-files__delete.dhx_button--icon.dhx_button--view_link.dhx_button--size_small.dhx_button--color_secondary.dhx_button--circle",{"data-dhx-id":t.id,onclick:e._handlers.remove},[s.el("span.dxi.dxi-delete-forever")])])}))):null,i=this.config,n=i.id,o=i.helpMessage,r=i.disabled,a=i.required,l=i.label,u=c.getLabelStyle(this.config);return s.el(".dhx_form-group.dhx_form-group--simplevault",{class:v.getFormItemCss(this.config,v.isVerify(this.config))},[u&&s.el("legend.dhx_label",{class:o?"dhx_label--with-help":"",style:u.style,onclick:this._handlers.add,"aria-label":l||"select files"},o?[(u.label||a)&&s.el("span.dhx_label__holder",u.label),s.el("span.dhx_label-help.dxi.dxi-help-circle-outline",{tabindex:"0",role:"button",onclick:this._handlers.showHelper,onfocus:this._handlers.showHelper,onblur:this._handlers.hideHelper})]:u.label),s.el(".dhx_input__wrapper",{id:this._uid},[s.el("div",{_hooks:{didInsert:function(t){e._uploader.linkDropArea(t.el);}},ondragover:this._handlers.ondragover,class:"dhx_simplevault"+(this._dragover?" dhx_simplevault--on-drag":"")},[s.el("div.dhx_simplevault-loader",[s.el("span.dhx_simplevault__icon.dxi.dxi-vault")]),s.el(".dhx_simplevault__drop-area",[s.el("input.dhx_simplevault__input",{type:"file",id:n,disabled:r}),s.el("span.dhx_simplevault__icon.dxi.dxi-vault"),s.el("span.dhx_simplevault__title",[s.el("span",g.default.simpleVaultText),s.el("br"),s.el("label.dhx_simplevault__label",{onclick:this._handlers.add,for:n}," "+g.default.simpleVaultLabel)])]),t]),v.getValidationMessage(this.config)&&s.el("span.dhx_input__caption",{},v.getValidationMessage(this.config))])])},t}(u.View);t.SimpleVault=m;},function(e,t,i){(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=i(1),o=i(3),r=i(13),a=i(36),s=function(){function t(e,t,i){void 0===e&&(e={}),this.config=n.extend({autosend:!0,updateFromResponse:!0,fieldName:"file"},e),this.data=t||new r.DataCollection,this.events=i||this.data.events,this.isActive=!1,this._fileInput=document.createElement("input"),this._fileInput.type="file",this._fileInput.multiple=!0,this._initEvents(),this._dropAreas=new Map;}return t.prototype.selectFile=function(){this._fileInput.click();},t.prototype.linkDropArea=function(e){var t=this,i=o.toNode(e),n=function(e){return e.preventDefault()},r=function(e){e.preventDefault(),t.parseFiles(e.dataTransfer);};i.addEventListener("dragover",n),i.addEventListener("drop",r),this._dropAreas.set(i,{dragover:n,drop:r});},t.prototype.unlinkDropArea=function(e){var t=this;if(e){var i=o.toNode(e);this._unlinkDropArea(i),this._dropAreas.delete(i);}else this._dropAreas.forEach((function(e,i){t._unlinkDropArea(i);})),this._dropAreas.clear();},t.prototype.parseFiles=function(e){if(e.items&&e.items[0]&&e.items[0].webkitGetAsEntry)this._parseAsWebkitEntry(e.items);else {for(var t=e.files,i=0;i<t.length;i++)this._addFile(t[i]);this.config.autosend&&this.send();}},t.prototype.send=function(e){var t=this;if(!this._uploadInfo||!this.isActive){var i=this.data.findAll((function(e){return e.status===a.FileStatus.queue||e.status===a.FileStatus.failed})).filter((function(e){return t.events.fire(a.UploaderEvents.beforeUploadFile,[e])}));if(i.length)if(this.isActive=!0,this._uploadInfo={files:i,count:i.length,size:i.reduce((function(e,t){return e+t.file.size}),0)},this.events.fire(a.UploaderEvents.uploadBegin,[i]),this.events.fire(a.UploaderEvents.uploadProgress,[0,0,this._uploadInfo.size]),this.config.singleRequest)this._xhrSend(i,e);else for(var n=0,o=i;n<o.length;n++){var r=o[n];this._xhrSend([r],e);}}},t.prototype.abort=function(e){if(e){var t=this.data.getItem(e);t&&t.request&&4!==t.request.readyState&&t.request.abort();}else {if(!this._uploadInfo||!this._uploadInfo.files)return;for(var i=0,n=this._uploadInfo.files;i<n.length;i++){var o=n[i];this.abort(o.id);}}},t.prototype._unlinkDropArea=function(e){var t=this._dropAreas.get(e);if(t){var i=t.dragover,n=t.drop;e.removeEventListener("dragover",i),e.removeEventListener("drop",n);}},t.prototype._initEvents=function(){var e=this;this._fileInput.addEventListener("change",(function(){for(var t=e._fileInput.files,i=0;i<t.length;i++)e._addFile(t[i]);e.config.autosend&&e.send(),e._fileInput.value=null;}));},t.prototype._xhrSend=function(e,t){for(var i=this,n=this._createFormData(e,t),o=new XMLHttpRequest,r=this.config.headerParams,s=0,l=e;s<l.length;s++){var c=l[s];this.data.update(c.id,{request:o,status:a.FileStatus.inprogress,progress:0});}if(o.open("POST",this.config.target),r)for(var u in r)o.setRequestHeader(u,r[u]);o.upload.onprogress=function(t){for(var n=0,o=e;n<o.length;n++){var r=o[n];i.data.update(r.id,{progress:t.loaded/t.total,status:a.FileStatus.inprogress});}var s=i._uploadInfo.files.reduce((function(e,t){return e+t.size*t.progress}),0)||0,l=i._uploadInfo.size,c=s/i._uploadInfo.size*100||0;i.events.fire(a.UploaderEvents.uploadProgress,[c,s,l]);},o.onloadend=function(){i._uploadInfo.count=i.config.singleRequest?0:i._uploadInfo.count-1;for(var t=200===o.status?a.FileStatus.uploaded:a.FileStatus.failed,n=200===o.status&&o.response?JSON.parse(o.response):null,r=0,s=e;r<s.length;r++){var l=s[r];i.data.update(l.id,{status:t}),t===a.FileStatus.uploaded?(i.config.updateFromResponse&&n&&(i.config.singleRequest&&n[l.id]?i.data.update(l.id,n[l.id]):i.config.singleRequest||i.data.update(l.id,n)),i.events.fire(a.UploaderEvents.uploadFile,[l,n])):i.events.fire(a.UploaderEvents.uploadFail,[l]);}0===i._uploadInfo.count&&(i.isActive=!1,i.events.fire(a.UploaderEvents.uploadComplete,[i._uploadInfo.files]));},o.send(n);},t.prototype._parseAsWebkitEntry=function(t){for(var i=this,n=[],o=0;o<t.length;o++){var r=t[o].webkitGetAsEntry();n.push(this._traverseFileTree(r));}e.all(n).then((function(){i.config.autosend&&i.send();}));},t.prototype._createFormData=function(e,t){var i=this.config.fieldName,n=new FormData,o=this.config.params;if(t)for(var r in t)n.append(r,t[r]);if(o)for(var r in o)n.append(r,o[r]);for(var a=e.length>1?"[]":"",s=0,l=e;s<l.length;s++){var c=l[s];n.append(i+a,c.file,c.file.name),n.append(i+"_fullname"+a,c.path+c.file.name);var u="object"==typeof c.id?c.id:c.id.toString();n.append(i+"_id"+a,u);}return n},t.prototype._addFile=function(e,t){void 0===t&&(t="");var i={id:n.uid(),file:e,progress:0,status:a.FileStatus.queue,src:null,path:t};this.data.add(i);},t.prototype._traverseFileTree=function(t){var i=this;return new e((function(e){var n=0,o=function(t,r){if(t.isFile)n++,t.file((function(t){n--,i._addFile(t,r),0===n&&e();}));else if(t.isDirectory){!function(t,i){n++,t.readEntries((function(t){n--;for(var r=0,a=t;r<a.length;r++){var s=a[r];o(s,i);}0===n&&e();}));}(t.createReader(),r+t.name+"/");}};o(t,"");}))},t}();t.Uploader=s;}).call(this,i(14));},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(48),o=["byte","kilobyte","megabyte","gigabyte"];t.getBasis=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=0),e<1024?e+" "+n.default[o[t]]:this.getBasis(Math.round(e/1024),t+1)};var r;function a(e){return {extension:e.name.split(".").pop()||"none",mime:e.file?e.file.type:""}}function s(e,t){switch(e){case"jpg":case"jpeg":case"gif":case"png":case"bmp":case"tiff":case"pcx":case"svg":case"ico":return r.image;case"avi":case"mpg":case"mpeg":case"rm":case"move":case"mov":case"mkv":case"flv":case"f4v":case"mp4":case"3gp":case"wmv":case"webm":case"vob":return r.video;case"rar":case"zip":case"tar":case"tgz":case"arj":case"gzip":case"bzip2":case"7z":case"ace":case"apk":case"deb":case"zipx":case"cab":case"tar-gz":case"rpm":case"xar":return r.archive;case"xlr":case"xls":case"xlsm":case"xlsx":case"ods":case"csv":case"tsv":return r.table;case"doc":case"docx":case"docm":case"dot":case"dotx":case"odt":case"wpd":case"wps":case"pages":return r.document;case"wav":case"aiff":case"au":case"mp3":case"aac":case"wma":case"ogg":case"flac":case"ape":case"wv":case"m4a":case"mid":case"midi":return r.audio;case"pot":case"potm":case"potx":case"pps":case"ppsm":case"ppsx":case"ppt":case"pptx":case"pptm":case"odp":return r.presentation;case"html":case"htm":case"eml":return r.web;case"exe":return r.application;case"dmg":return r.apple;case"pdf":case"ps":case"eps":return r.pdf;case"psd":return r.psd;case"txt":case"djvu":case"nfo":case"xml":return r.text;default:switch(t.split("/")[0]){case"image":return r.image;case"audio":return r.audio;case"video":return r.video;default:return r.other}}}t.truncateWord=function(e,t){var i,n;if(void 0===t&&(t=13),e.length<=t)return e;var o=e.lastIndexOf(".");if(-1===o)n=e.substr(e.length-4),i=e.substr(0,t-7);else {var r=o-3;n=e.substr(r),i=e.substr(0,t-(e.length-r));}return i+"..."+n},t.calculateCover=function(e){var t,i,n,o,r=e.width,a=e.height,s=r/a;return s>1?(t=a,n=(r-(i=a))/2,o=0):s<1?(i=r,n=0,o=(a-(t=r))/2):(t=r,i=r,n=0,o=0),{sx:n,sy:o,sWidth:i,sHeight:t,dx:0,dy:0}},function(e){e.image="image",e.video="video",e.archive="archive",e.table="table",e.document="document",e.presentation="presentation",e.application="application",e.web="web",e.apple="apple",e.pdf="pdf",e.psd="psd",e.audio="audio",e.other="other",e.text="text";}(r=t.FileType||(t.FileType={})),t.getFileType=s,t.getFileClassName=function(e){var t=a(e),i=t.mime,n=t.extension;return s(n,i)+" extension-"+n},t.isImage=function(e){var t=a(e),i=t.mime;return s(t.extension,i)===r.image},t.removeItem=function(e,t){e.exists(t)&&(e.update(t,{$toRemove:!0}),setTimeout((function(){e.update(t,{$toRemove:!1},!0),e.remove(t);}),200));};},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);}),r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=i(1),s=i(0),l=i(29),c=i(237),u=function(e){function t(t,i){return void 0===i&&(i={}),e.call(this,t,a.extend({itemsInRow:1,gap:"0px"},i))||this}return o(t,e),t.prototype.showItem=function(e){var t=this.getRootView();if(t&&t.node&&t.node.el&&void 0!==e){var i=this.getRootNode();if(i){var n=this.config.virtual,o=this.data.getIndex(e),r=Math.floor(o/this.config.itemsInRow),a=Math.ceil(r/i.children.length)||0,s=i.children[r-i.children.length*a];if(n||s){var l=s.children[o%this.config.itemsInRow],c=parseInt(this.config.gap.toString().replace("px",""),null);l.offsetTop>=i.clientHeight+i.scrollTop-l.clientHeight?i.scrollTop=l.offsetTop-i.clientHeight+l.clientHeight+c:l.offsetTop<i.scrollTop-c&&(i.scrollTop=l.offsetTop-c);}}}},t.prototype._didRedraw=function(e){var t=e.node.el,i=t.scrollHeight>t.offsetHeight,n=e.node.attrs.class.replace(" dhx_dataview--has-scroll",""),o=i?n+" dhx_dataview--has-scroll":n;e.node.patch({class:o});},t.prototype._renderItem=function(e,t){var i=this.config,n=i.itemsInRow,o=i.gap,a=i.template,l=i.itemHeight,u=a?a(e):e.htmlContent,d=e.id==this._focus,h=(t+1)%this.config.itemsInRow==0,f=function(e){return parseFloat(e)};if(e.id==this._edited)return c.getEditor(e,this).toHTML(h);var p=e.id.toString(),v=this.data.getMetaMap(e);return s.el("div",r(r({class:"dhx_dataview-item"+(v&&v.selected?" dhx_dataview-item--selected":"")+(d?" dhx_dataview-item--focus":"")+(v&&v.drop&&!this._edited?" dhx_dataview-item--drophere":"")+(v&&v.drag&&!this._edited?" dhx_dataview-item--dragtarget":"")+(this.config.dragMode&&!this._edited?" dhx_dataview-item--drag":"")+(f(o)?" dhx_dataview-item--with-gap":"")+(e.css?" "+e.css:"")+(h?" dhx_dataview-item--last-item-in-row":""),style:{width:"calc("+100/n+"% - "+f(o)+" * "+(n-1)/n+"px)","margin-right":h?"":o,height:a?null:l},_key:p,"data-dhx-id":p,_ref:p},this.getDataViewItemAriaAttrs(this,e)),{tabindex:d?0:-1}),u?[s.el(".dhx_dataview-item__inner-html",{".innerHTML":u,role:"presentation"})]:e.value||e.text||e.value)},t.prototype._renderList=function(){var e=this,t=this.data.getRawData(0,-1),i=this.config,n=i.itemsInRow,o=i.css,a=i.gap,l=0,c=t.reduce((function(t,i,o){return 0===l&&t.push([]),t[t.length-1].push(e._renderItem(i,o)),l=(l+1)%n,t}),[]);return s.el("",r(r(r(r({},this._handlers),{"data-dhx-widget-id":this._uid,class:(o||"")+" dhx_widget dhx_dataview"+(this.config.multiselection&&this.selection.getItem()?" dhx_no-select--pointer":""),style:{height:this.config.height}}),this.getDataViewAriaAttrs(this.config,this.data.getLength(),c.length,n)),{tabindex:0}),c.map((function(e,t){return s.el(".dhx_dataview-row",{style:{margin:a},"aria-label":"Row "+(t+1)},e)})))},t.prototype._getHotkeys=function(){var t=this,i=e.prototype._getHotkeys.call(this);return i.arrowUp=function(e){t.moveFocus(l.MOVE_UP,t.config.itemsInRow),t._changed&&(t._changed=!1),e.preventDefault();},i.arrowDown=function(e){t.moveFocus(l.MOVE_DOWN,t.config.itemsInRow),t._changed&&(t._changed=!1),e.preventDefault();},i.arrowLeft=function(e){t.moveFocus(l.MOVE_UP),t._changed&&(t._changed=!1),e.preventDefault();},i.arrowRight=function(e){t.moveFocus(l.MOVE_DOWN),t._changed&&(t._changed=!1),e.preventDefault();},i},t.prototype.getDataViewItemAriaAttrs=function(e,t){return r(r({role:"option","aria-selected":t.$selected?"true":"false"},function(e,t){return e.config.dragMode&&!e._edited?{"aria-grabbed":Boolean(t.$dragtarget&&!e._edited).toString()}:{}}(e,t)),function(e){return e.config.editable?{"aria-roledescription":e._edited?"Press Enter to stop editing":"Double click to edit content"}:{}}(e))},t.prototype.getDataViewAriaAttrs=function(e,t,i,n){return {role:"listbox","aria-label":"Dataview, "+t+" options on "+i+" rows, "+n+" options per row."+(e.editable?" Content is editable.":""),"aria-multiselectable":e.selection&&e.multiselection?"true":"false","aria-readonly":e.editable?"false":"true"}},t}(l.List);t.DataView=u;},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.click="click",e.doubleClick="doubleclick",e.focusChange="focuschange",e.beforeEditStart="beforeEditStart",e.afterEditStart="afterEditStart",e.beforeEditEnd="beforeEditEnd",e.afterEditEnd="afterEditEnd",e.itemRightClick="itemRightClick",e.itemMouseOver="itemMouseOver",e.contextmenu="contextmenu";}(t.DataViewEvents||(t.DataViewEvents={}));},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);}),r=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var a=i(54),s=i(0),l=i(1),c=i(19),u=i(8),d=i(4),h=i(6),f=i(9),p=i(20),v=function(e){function t(t,i){var n=e.call(this,null,i)||this;n.events=new d.EventSystem,n._isValid=!0,n._popupIsFocus=!1,n._propsItem=["required","validation","icon","placeholder","editable","label","labelWidth","labelPosition","hiddenLabel","helpMessage","preMessage","successMessage","errorMessage"],n._propsTimepicker=["timeFormat","controls","valueFormat"],n._props=r(f.baseProps,n._propsItem,n._propsTimepicker),n._keyManager=new p.KeyManager((function(){var e,t,i,o=document.activeElement;return (null===(i=null===(t=null===(e=n.getRootView())||void 0===e?void 0:e.refs)||void 0===t?void 0:t.input)||void 0===i?void 0:i.el)===o||n._popup.isVisible()})),n._initView(i),n._initHandlers(),n._initHotkeys();return n.mount(t,s.create({render:function(){return n._draw()}})),n}return o(t,e),t.prototype.destructor=function(){this.events&&this.events.clear(),this.timepicker&&this.timepicker.destructor(),this._popup&&this._popup.destructor(),this.events=this._uid=this._propsItem=this._propsTimepicker=this._props=this._isValid=null,e.prototype._destructor.call(this),this.unmount();},t.prototype.setProperties=function(e){var t=this;s.awaitRedraw().then((function(){if(e&&!l.isEmptyObj(e)&&t.events.fire(h.ItemEvent.beforeChangeProperties,[t.getProperties()])){for(var i in e)t._props.includes(i)&&(t.config[i]=e[i]);t._initView(t.config),t._initHandlers(),t.events.fire(h.ItemEvent.afterChangeProperties,[t.getProperties()]),t.paint();}}));},t.prototype.getProperties=function(){for(var e={},t=0,i=this._props;t<i.length;t++){var n=i[t];e[n]=this.config[n];}return e},t.prototype.show=function(){this.config.hidden&&this.events.fire(h.ItemEvent.beforeShow,[this.getValue("timeObject"===this.config.valueFormat)])&&(this.config.hidden=!1,this.events.fire(h.ItemEvent.afterShow,[this.getValue("timeObject"===this.config.valueFormat)]));},t.prototype.hide=function(e){this.config.hidden&&!e||!this.events.fire(h.ItemEvent.beforeHide,[this.getValue("timeObject"===this.config.valueFormat),e])||(this.config.hidden=!0,this.events.fire(h.ItemEvent.afterHide,[this.getValue("timeObject"===this.config.valueFormat),e]));},t.prototype.isVisible=function(){return !this.config.hidden},t.prototype.disable=function(){this.config.disabled=!0,this.paint();},t.prototype.enable=function(){this.config.disabled=!1,this.paint();},t.prototype.isDisabled=function(){return this.config.disabled},t.prototype.validate=function(e,t){void 0===e&&(e=!1);var i=void 0===t?this.getValue("timeObject"===this.config.valueFormat):t;if(e||this.events.fire(h.ItemEvent.beforeValidate,[i]))return this._isValid=this.config.validation?this.config.validation(i):f.isTimeFormat(this.getValue(),this.config.timeFormat),!e&&this.events.fire(h.ItemEvent.afterValidate,[i,this._isValid]),this._isValid},t.prototype.clearValidate=function(){this.config.$validationStatus=h.ValidationStatus.pre,this.paint();},t.prototype.setValue=function(e){void 0!==e&&e!==this.config.value&&(this.timepicker.setValue(e),this.config.controls&&(this.config.value=this.timepicker.getValue(),this.events.fire(h.ItemEvent.change,[this.getValue("timeObject"===this.config.valueFormat)]),f.isVerify(this.config)&&this.validate(),this.paint()));},t.prototype.getValue=function(e){return e?this.timepicker.getValue(e):this.config.value||""},t.prototype.focus=function(){var e=this;s.awaitRedraw().then((function(){e.getRootView().refs.input.el.focus();}));},t.prototype.blur=function(){var e=this;s.awaitRedraw().then((function(){e._popup.hide(),e.getRootView().refs.input.el.blur();}));},t.prototype.clear=function(){""!==this.config.value&&this._clear();},t.prototype.getWidget=function(){return this.timepicker},t.prototype._initView=function(e){var t=this;if(l.isEmptyObj(e))throw new Error("Check the configuration is correct");for(var i in this.timepicker&&this.timepicker.destructor(),this._popup&&this._popup.destructor(),this.config={type:e.type,id:e.id,name:e.name,disabled:!1,editable:!1,hidden:!1,timeFormat:24,controls:!1,valueFormat:"string",required:!1,icon:"",placeholder:"",label:"",labelWidth:"",labelPosition:"top",hiddenLabel:!1,helpMessage:"",preMessage:"",successMessage:"",errorMessage:"",width:"content",height:"content"},e)"id"!==i&&"type"!==i&&"name"!==i&&(this.config[i]=e[i]);this._popup=new u.Popup,this.timepicker=new a.Timepicker(null,f.widgetConfig(e)),this._popup.attach(this.timepicker),this.config.hasOwnProperty("value")&&(this.config.value=this.timepicker.getValue()),this.config.hidden&&s.awaitRedraw().then((function(){t.hide(!0);}));},t.prototype._initHandlers=function(){var e=this;this.events.on(h.ItemEvent.afterValidate,(function(){e.config.$validationStatus=e._isValid?h.ValidationStatus.success:h.ValidationStatus.error,e.paint();})),this.config.controls?(this.timepicker.events.on(a.TimepickerEvents.afterClose,(function(){e._popup.hide();})),this.timepicker.events.on(a.TimepickerEvents.afterApply,(function(){e._afterApply();})),this._popup.events.on(u.PopupEvents.afterHide,(function(){e.config.value&&e.config.value!==e.timepicker.getValue()?e.timepicker.setValue(e.config.value):""!==e.config.value&&void 0!==e.config.value||e._clear(!0);}))):this.timepicker.events.on(a.TimepickerEvents.change,(function(){e.config.value=e.timepicker.getValue(),e.events.fire(h.ItemEvent.change,[e.getValue("timeObject"===e.config.valueFormat)]),e.paint();})),this._popup.events.on(u.PopupEvents.afterHide,(function(){document.activeElement!==e.getRootView().refs.input.el&&e.events.fire(h.ItemEvent.blur,[e.getValue()]),e.paint();})),this.events.on(h.ItemEvent.input,(function(t){var i=12===e.config.timeFormat?7:5;t.length>=i&&f.isTimeFormat(t,e.config.timeFormat)?e.timepicker.setValue(t):""!==t||e.config.controls||e.clear();})),this.events.on(h.ItemEvent.afterChangeProperties,(function(){e.config.value=e.timepicker.getValue(),e.paint();})),this.events.on(h.ItemEvent.blur,(function(){e._popupIsFocus=!1,e.paint();})),document.addEventListener("keydown",(function(t){var i,n,o,r=document.activeElement;((null===(o=null===(n=null===(i=e.getRootView())||void 0===i?void 0:i.refs)||void 0===n?void 0:n.input)||void 0===o?void 0:o.el)===r||e._popup.isVisible())&&e.events.fire(h.ItemEvent.keydown,[t]);})),document.addEventListener("mousedown",(function(){e._popup.getContainer()!==document.activeElement&&(e._popupIsFocus=!1);}));},t.prototype._getHandlers=function(){var e=this;return {onfocus:function(){if(!e._popup.isVisible()){var t=e.getRootView().refs.input.el;e._popup.show(t),e.events.fire(h.ItemEvent.focus,[e.getValue()]),e.paint();}},onblur:function(){e._popup.isVisible()||e.events.fire(h.ItemEvent.blur,[e.getValue()]),e.paint();},oninput:function(t){var i=t.target.value;e.events.fire(h.ItemEvent.input,[i]);}}},t.prototype._initHotkeys=function(){var e=this,t={"shift+tab":function(){e._applyTab();},tab:function(){e._applyTab();},escape:function(){e._popup.isVisible()&&e.getRootView().refs.input.el.focus(),e._popup.hide();},enter:function(t){t.preventDefault();var i=e.getRootView().refs.input.el;e._popup.isVisible()?e._popupIsFocus&&e.config.controls||(e.config.value&&""===i.value?e.clear():i.value!==e.config.value&&(e.config.value=e.timepicker.getValue(),e.events.fire(h.ItemEvent.change,[e.getValue("timeObject"===e.config.valueFormat)])),f.isVerify(e.config)&&e.validate(),e._popup.hide()):e._popup.show(i);},arrowRight:function(t){var i=e._popup.getContainer();e._popup.isVisible()&&!e._popupIsFocus&&(t.preventDefault(),i.focus(),e._popupIsFocus=!0);}};for(var i in t)this._keyManager.addHotKey(i,t[i]);},t.prototype._draw=function(){var e,t,i,n=this.config,o=n.value,r=n.required,a=n.disabled,l=n.placeholder,c=n.name,u=n.id,d=n.editable,h=n.label,p=n.helpMessage,v=this._popup.isVisible()||(null===(i=null===(t=null===(e=this.getRootView())||void 0===e?void 0:e.refs)||void 0===t?void 0:t.input)||void 0===i?void 0:i.el)===document.activeElement;return s.el("div.dhx_form-group",{class:f.getFormItemCss(this.config,f.isVerify(this.config),v)},[this._drawLabel(),s.el(".dhx_input__wrapper",[s.el("div.dhx_input__container",{},[s.el(".dhx_input__icon.dxi.dxi-clock-outline"),s.el("input.dhx_input.dhx_input--icon-padding",{tabindex:0,"data-dhx-id":c||u,_key:this._uid,_ref:"input",value:o,type:"text",required:r,disabled:a,class:v&&"dhx_input--focus",placeholder:l||"",name:c||"",id:u||this._uid,onfocus:this._handlers.onfocus,onblur:this._handlers.onblur,oninput:this._handlers.oninput,autocomplete:"off",readOnly:!d,"aria-label":h||(d?"type or":"")+" select date","aria-describedby":p?"dhx_label__help_"+(u||this._uid):null})]),f.getValidationMessage(this.config)&&s.el("span.dhx_input__caption",{},f.getValidationMessage(this.config))])])},t.prototype._clear=function(e){this.timepicker.clear(),this.config.value="",!e&&this.events.fire(h.ItemEvent.change,[this.config.value]);},t.prototype._afterApply=function(){var e=this.getRootView().refs.input.el.value;this.config.value&&""===e?this.clear():(this.config.value=this.timepicker.getValue(),this.events.fire(h.ItemEvent.change,[this.getValue("timeObject"===this.config.valueFormat)])),f.isVerify(this.config)&&this.validate(),this._popup.hide(),this.paint();},t.prototype._applyTab=function(){var e,t,i;document.activeElement===(null===(i=null===(t=null===(e=this._popup.getRootView())||void 0===e?void 0:e.refs)||void 0===t?void 0:t.content)||void 0===i?void 0:i.el)||this._popupIsFocus||this._popup.hide();},t}(c.Label);t.TimePicker=v;},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);}),r=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var a=i(64),s=i(4),l=i(0),c=i(1),u=i(19),d=i(8),h=i(6),f=i(9),p=i(20),v=function(e){function t(t,i){var n=e.call(this,null,i)||this;n.events=new s.EventSystem,n._isValid=!0,n._popupIsFocus=!1,n._propsItem=["required","validation","icon","placeholder","editable","label","labelWidth","labelPosition","hiddenLabel","helpMessage","preMessage","successMessage","errorMessage"],n._propsColorpicker=["mode","grayShades","customColors","palette"],n._props=r(f.baseProps,n._propsItem,n._propsColorpicker),n._keyManager=new p.KeyManager((function(){var e,t,i,o=document.activeElement;return (null===(i=null===(t=null===(e=n.getRootView())||void 0===e?void 0:e.refs)||void 0===t?void 0:t.input)||void 0===i?void 0:i.el)===o||n._popup.isVisible()})),n._initView(i),n._initHandlers(),n._initHotkeys();return n.mount(t,l.create({render:function(){return n._draw()}})),n}return o(t,e),t.prototype.destructor=function(){this.events&&this.events.clear(),this._popup&&this._popup.destructor(),this.colorpicker&&this.colorpicker.destructor(),this.events=this._uid=this._propsColorpicker=this._propsItem=this._props=this._isValid=null,e.prototype._destructor.call(this),this.unmount();},t.prototype.setProperties=function(e){if(e&&!c.isEmptyObj(e)&&this.events.fire(h.ItemEvent.beforeChangeProperties,[this.getProperties()])){for(var t in e)this._props.includes(t)&&(this.config[t]=e[t],this._propsColorpicker.includes(t)&&(this.colorpicker.config[t]=e[t]));this.events.fire(h.ItemEvent.afterChangeProperties,[this.getProperties()]),this.colorpicker.paint(),this.paint();}},t.prototype.getProperties=function(){for(var e={},t=0,i=this._props;t<i.length;t++){var n=i[t];e[n]=this.config[n];}return e},t.prototype.show=function(){var e=this.config,t=e.value;e.hidden&&this.events.fire(h.ItemEvent.beforeShow,[t])&&(this.config.hidden=!1,this.events.fire(h.ItemEvent.afterShow,[t]));},t.prototype.hide=function(e){var t=this.config,i=t.value;t.hidden&&!e||!this.events.fire(h.ItemEvent.beforeHide,[i,e])||(this.config.hidden=!0,this.events.fire(h.ItemEvent.afterHide,[i,e]));},t.prototype.isVisible=function(){return !this.config.hidden},t.prototype.disable=function(){this.config.disabled=!0,this.paint();},t.prototype.enable=function(){this.config.disabled=!1,this.paint();},t.prototype.isDisabled=function(){return this.config.disabled},t.prototype.validate=function(e,t){void 0===e&&(e=!1);var i=void 0===t?this.getValue():t;if(e||this.events.fire(h.ItemEvent.beforeValidate,[i]))return this._isValid=this.config.validation?this.config.validation(i):a.isHex(i),!e&&this.events.fire(h.ItemEvent.afterValidate,[i,this._isValid]),this._isValid},t.prototype.clearValidate=function(){this.config.$validationStatus=h.ValidationStatus.pre,this.paint();},t.prototype.setValue=function(e){void 0!==e&&e!==this.config.value&&(this.colorpicker.setValue(e),f.isVerify(this.config)&&this.validate());},t.prototype.getValue=function(){return this.config.value||""},t.prototype.clear=function(){""!==this.config.value&&(this.config.value="",this.colorpicker.clear());},t.prototype.getWidget=function(){return this.colorpicker},t.prototype.focus=function(){var e=this;l.awaitRedraw().then((function(){e.getRootView().refs.input.el.focus();}));},t.prototype.blur=function(){var e=this;l.awaitRedraw().then((function(){e._popup.hide(),e.getRootView().refs.input.el.blur();}));},t.prototype._initView=function(e){var t=this;if(c.isEmptyObj(e))throw new Error("Check the configuration is correct");for(var i in this.colorpicker&&this.colorpicker.destructor(),this._popup&&this._popup.destructor(),this.config={type:e.type,id:e.id,name:e.name,disabled:!1,editable:!1,hidden:!1,value:"",grayShades:!0,pickerOnly:!1,paletteOnly:!1,customColors:[],palette:a.palette,mode:"palette",required:!1,icon:"",placeholder:"",label:"",labelWidth:"",labelPosition:"top",hiddenLabel:!1,helpMessage:"",preMessage:"",successMessage:"",errorMessage:"",width:"content",height:"content"},e)"id"!==i&&"type"!==i&&"name"!==i&&(this.config[i]=e[i]);this._popup=new d.Popup,this.colorpicker=new a.Colorpicker(null,f.widgetConfig(e)),this._popup.attach(this.colorpicker),this.config.hidden&&l.awaitRedraw().then((function(){t.hide(!0);}));},t.prototype._initHandlers=function(){var e=this;this.colorpicker.events.on(a.ColorpickerEvents.change,(function(){var t=e.config.value=e.colorpicker.getValue();e.events.fire(h.ItemEvent.change,[t]),e._popup.hide(),e.paint();})),this.events.on(h.ItemEvent.afterValidate,(function(){e.config.$validationStatus=e._isValid?h.ValidationStatus.success:h.ValidationStatus.error,e.paint();})),this._popup.events.on(d.PopupEvents.afterHide,(function(){document.activeElement!==e.getRootView().refs.input.el&&e.events.fire(h.ItemEvent.blur,[e.getValue()]),e.paint();})),this.events.on(h.ItemEvent.blur,(function(){e._popupIsFocus=!1,e.paint();})),document.addEventListener("keydown",(function(t){var i,n,o,r=document.activeElement;((null===(o=null===(n=null===(i=e.getRootView())||void 0===i?void 0:i.refs)||void 0===n?void 0:n.input)||void 0===o?void 0:o.el)===r||e._popup.isVisible())&&e.events.fire(h.ItemEvent.keydown,[t]);})),document.addEventListener("mousedown",(function(){e._popup.getContainer()!==document.activeElement&&(e._popupIsFocus=!1);}));},t.prototype._getHandlers=function(){var e=this;return {onblur:function(){e._popup.isVisible()||e.events.fire(h.ItemEvent.blur,[e.getValue()]),e.paint();},onfocus:function(){if(!e._popup.isVisible()){""!==e.config.value&&e.clearValidate();var t=e.getRootView().refs.input.el;e._popup.show(t),e.events.fire(h.ItemEvent.focus,[e.getValue()]),e.paint();}},oninput:function(t){var i=t.target.value;e.events.fire(h.ItemEvent.input,[i]);},onchange:function(t){var i=t.target.value;e.config.editable&&a.isHex(i)?e.setValue(i):""===i?(e.clear(),f.isVerify(e.config)&&e.validate(),e.paint()):(f.isVerify(e.config)&&e.validate(),e.paint());}}},t.prototype._initHotkeys=function(){var e=this,t={"shift+tab":function(){e._applyTab();},tab:function(){e._applyTab();},escape:function(){e._popup.isVisible()&&e.getRootView().refs.input.el.focus(),e._popup.hide();},enter:function(t){if(t.preventDefault(),!e._popup.isVisible()){var i=e.getRootView().refs.input.el;e._popup.show(i);}},arrowRight:function(t){var i=e._popup.getContainer();e._popup.isVisible()&&!e._popupIsFocus&&(t.preventDefault(),i.focus(),e._popupIsFocus=!0);},onkeydown:function(t){"Tab"===t.key&&e._popup.hide();}};for(var i in t)this._keyManager.addHotKey(i,t[i]);},t.prototype._draw=function(){var e,t,i,n=this.config,o=n.required,r=n.value,a=n.icon,s=n.disabled,c=n.placeholder,u=n.name,d=n.id,h=n.editable,p=n.label,v=n.helpMessage,g=this._popup.isVisible()||(null===(i=null===(t=null===(e=this.getRootView())||void 0===e?void 0:e.refs)||void 0===t?void 0:t.input)||void 0===i?void 0:i.el)===document.activeElement;return l.el("div.dhx_form-group",{class:f.getFormItemCss(this.config,f.isVerify(this.config),g)},[this._drawLabel(),l.el(".dhx_input__wrapper",[l.el("div.dhx_input__container",{},[l.el(".dhx_input__icon",{class:a||"dxi dxi-eyedropper-variant"+(r?" dhx_input__icon--color-selected":""),style:{"background-color":r||"transparent"}}),l.el("input.dhx_input.dhx_input--icon-padding",{tabindex:0,"data-dhx-id":u||d,_key:this._uid,_ref:"input",value:r,type:"text",required:o,disabled:s,class:g&&"dhx_input--focus",placeholder:c||"",name:u||"",id:d||this._uid,onfocus:this._handlers.onfocus,oninput:this._handlers.oninput,onchange:this._handlers.onchange,onblur:this._handlers.onblur,autocomplete:"off",readOnly:!h,"aria-label":p||(h?"type or":"")+" select color","aria-describedby":v?"dhx_label__help_"+(d||this._uid):null})]),f.getValidationMessage(this.config)&&l.el("span.dhx_input__caption",{},f.getValidationMessage(this.config))])])},t.prototype._applyTab=function(){var e,t,i;document.activeElement===(null===(i=null===(t=null===(e=this._popup.getRootView())||void 0===e?void 0:e.refs)||void 0===t?void 0:t.content)||void 0===i?void 0:i.el)||this._popupIsFocus||this._popup.hide();},t}(u.Label);t.ColorPicker=v;},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);}),r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=i(0),s=i(7),l=i(6),c=i(4),u=i(1),d=i(9),h=function(e){function t(t,i){var n=e.call(this,t,r({disabled:!1,hidden:!1,width:"content",height:"content"},i))||this;n.events=new c.EventSystem,n.config.hidden&&a.awaitRedraw().then((function(){n.hide(!0);}));return n.mount(t,a.create({render:function(){return n._draw()}})),n}return o(t,e),t.prototype.destructor=function(){this.events&&this.events.clear(),this.config=this.events=null,this.unmount();},t.prototype.setProperties=function(e){if(e&&!u.isEmptyObj(e)&&this.events.fire(l.ItemEvent.beforeChangeProperties,[this.getProperties()])){for(var t in e)d.baseProps.includes(t)&&(this.config[t]=e[t]);this.events.fire(l.ItemEvent.afterChangeProperties,[this.getProperties()]),this.paint();}},t.prototype.getProperties=function(){for(var e={},t=0,i=d.baseProps;t<i.length;t++){var n=i[t];e[n]=this.config[n];}return e},t.prototype.show=function(){this.config.hidden&&this.events.fire(l.ItemEvent.beforeShow,[void 0])&&(this.config.hidden=!1,this.events.fire(l.ItemEvent.afterShow,[void 0]));},t.prototype.hide=function(e){this.config.hidden&&!e||!this.events.fire(l.ItemEvent.beforeHide,[void 0,e])||(this.config.hidden=!0,this.events.fire(l.ItemEvent.afterHide,[void 0,e]));},t.prototype.isVisible=function(){return !this.config.hidden},t.prototype._draw=function(){return a.el("div")},t}(s.View);t.Spacer=h;},function(e,t,i){	/*! @license DOMPurify 2.4.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.7/LICENSE */function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){return o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},o(e,t)}function r(e,t,i){return r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return !1;if(Reflect.construct.sham)return !1;if("function"==typeof Proxy)return !0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return !1}}()?Reflect.construct:function(e,t,i){var n=[null];n.push.apply(n,t);var r=new(Function.bind.apply(e,n));return i&&o(r,i.prototype),r},r.apply(null,arguments)}function a(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return s(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var l=Object.hasOwnProperty,c=Object.setPrototypeOf,u=Object.isFrozen,d=Object.getPrototypeOf,h=Object.getOwnPropertyDescriptor,f=Object.freeze,p=Object.seal,v=Object.create,g="undefined"!=typeof Reflect&&Reflect,_=g.apply,m=g.construct;_||(_=function(e,t,i){return e.apply(t,i)}),f||(f=function(e){return e}),p||(p=function(e){return e}),m||(m=function(e,t){return r(e,a(t))});var y,b=A(Array.prototype.forEach),w=A(Array.prototype.pop),x=A(Array.prototype.push),E=A(String.prototype.toLowerCase),C=A(String.prototype.toString),S=A(String.prototype.match),I=A(String.prototype.replace),k=A(String.prototype.indexOf),M=A(String.prototype.trim),P=A(RegExp.prototype.test),O=(y=TypeError,function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return m(y,t)});function A(e){return function(t){for(var i=arguments.length,n=new Array(i>1?i-1:0),o=1;o<i;o++)n[o-1]=arguments[o];return _(e,t,n)}}function D(e,t,i){var n;i=null!==(n=i)&&void 0!==n?n:E,c&&c(e,null);for(var o=t.length;o--;){var r=t[o];if("string"==typeof r){var a=i(r);a!==r&&(u(t)||(t[o]=a),r=a);}e[r]=!0;}return e}function F(e){var t,i=v(null);for(t in e)!0===_(l,e,[t])&&(i[t]=e[t]);return i}function V(e,t){for(;null!==e;){var i=h(e,t);if(i){if(i.get)return A(i.get);if("function"==typeof i.value)return A(i.value)}e=d(e);}return function(e){return console.warn("fallback value for",e),null}}var R=f(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),T=f(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),L=f(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),H=f(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),N=f(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),j=f(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),$=f(["#text"]),z=f(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),B=f(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),W=f(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),U=f(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),G=p(/\{\{[\w\W]*|[\w\W]*\}\}/gm),q=p(/<%[\w\W]*|[\w\W]*%>/gm),Y=p(/\${[\w\W]*}/gm),X=p(/^data-[\-\w.\u00B7-\uFFFF]/),K=p(/^aria-[\-\w]+$/),J=p(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Z=p(/^(?:\w+script|data):/i),Q=p(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),ee=p(/^html$/i),te=function(){return "undefined"==typeof window?null:window};var ie=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:te(),i=function(t){return e(t)};if(i.version="2.4.7",i.removed=[],!t||!t.document||9!==t.document.nodeType)return i.isSupported=!1,i;var o=t.document,r=t.document,s=t.DocumentFragment,l=t.HTMLTemplateElement,c=t.Node,u=t.Element,d=t.NodeFilter,h=t.NamedNodeMap,p=void 0===h?t.NamedNodeMap||t.MozNamedAttrMap:h,v=t.HTMLFormElement,g=t.DOMParser,_=t.trustedTypes,m=u.prototype,y=V(m,"cloneNode"),A=V(m,"nextSibling"),ie=V(m,"childNodes"),ne=V(m,"parentNode");if("function"==typeof l){var oe=r.createElement("template");oe.content&&oe.content.ownerDocument&&(r=oe.content.ownerDocument);}var re=function(e,t){if("object"!==n(e)||"function"!=typeof e.createPolicy)return null;var i=null,o="data-tt-policy-suffix";t.currentScript&&t.currentScript.hasAttribute(o)&&(i=t.currentScript.getAttribute(o));var r="dompurify"+(i?"#"+i:"");try{return e.createPolicy(r,{createHTML:function(e){return e},createScriptURL:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+r+" could not be created."),null}}(_,o),ae=re?re.createHTML(""):"",se=r,le=se.implementation,ce=se.createNodeIterator,ue=se.createDocumentFragment,de=se.getElementsByTagName,he=o.importNode,fe={};try{fe=F(r).documentMode?r.documentMode:{};}catch(e){}var pe={};i.isSupported="function"==typeof ne&&le&&void 0!==le.createHTMLDocument&&9!==fe;var ve,ge,_e=G,me=q,ye=Y,be=X,we=K,xe=Z,Ee=Q,Ce=J,Se=null,Ie=D({},[].concat(a(R),a(T),a(L),a(N),a($))),ke=null,Me=D({},[].concat(a(z),a(B),a(W),a(U))),Pe=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Oe=null,Ae=null,De=!0,Fe=!0,Ve=!1,Re=!0,Te=!1,Le=!1,He=!1,Ne=!1,je=!1,$e=!1,ze=!1,Be=!0,We=!1,Ue=!0,Ge=!1,qe={},Ye=null,Xe=D({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Ke=null,Je=D({},["audio","video","img","source","image","track"]),Ze=null,Qe=D({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),et="http://www.w3.org/1998/Math/MathML",tt="http://www.w3.org/2000/svg",it="http://www.w3.org/1999/xhtml",nt=it,ot=!1,rt=null,at=D({},[et,tt,it],C),st=["application/xhtml+xml","text/html"],lt=null,ct=r.createElement("form"),ut=function(e){return e instanceof RegExp||e instanceof Function},dt=function(e){lt&&lt===e||(e&&"object"===n(e)||(e={}),e=F(e),ve=ve=-1===st.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE,ge="application/xhtml+xml"===ve?C:E,Se="ALLOWED_TAGS"in e?D({},e.ALLOWED_TAGS,ge):Ie,ke="ALLOWED_ATTR"in e?D({},e.ALLOWED_ATTR,ge):Me,rt="ALLOWED_NAMESPACES"in e?D({},e.ALLOWED_NAMESPACES,C):at,Ze="ADD_URI_SAFE_ATTR"in e?D(F(Qe),e.ADD_URI_SAFE_ATTR,ge):Qe,Ke="ADD_DATA_URI_TAGS"in e?D(F(Je),e.ADD_DATA_URI_TAGS,ge):Je,Ye="FORBID_CONTENTS"in e?D({},e.FORBID_CONTENTS,ge):Xe,Oe="FORBID_TAGS"in e?D({},e.FORBID_TAGS,ge):{},Ae="FORBID_ATTR"in e?D({},e.FORBID_ATTR,ge):{},qe="USE_PROFILES"in e&&e.USE_PROFILES,De=!1!==e.ALLOW_ARIA_ATTR,Fe=!1!==e.ALLOW_DATA_ATTR,Ve=e.ALLOW_UNKNOWN_PROTOCOLS||!1,Re=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,Te=e.SAFE_FOR_TEMPLATES||!1,Le=e.WHOLE_DOCUMENT||!1,je=e.RETURN_DOM||!1,$e=e.RETURN_DOM_FRAGMENT||!1,ze=e.RETURN_TRUSTED_TYPE||!1,Ne=e.FORCE_BODY||!1,Be=!1!==e.SANITIZE_DOM,We=e.SANITIZE_NAMED_PROPS||!1,Ue=!1!==e.KEEP_CONTENT,Ge=e.IN_PLACE||!1,Ce=e.ALLOWED_URI_REGEXP||Ce,nt=e.NAMESPACE||it,Pe=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&ut(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Pe.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&ut(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Pe.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(Pe.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Te&&(Fe=!1),$e&&(je=!0),qe&&(Se=D({},a($)),ke=[],!0===qe.html&&(D(Se,R),D(ke,z)),!0===qe.svg&&(D(Se,T),D(ke,B),D(ke,U)),!0===qe.svgFilters&&(D(Se,L),D(ke,B),D(ke,U)),!0===qe.mathMl&&(D(Se,N),D(ke,W),D(ke,U))),e.ADD_TAGS&&(Se===Ie&&(Se=F(Se)),D(Se,e.ADD_TAGS,ge)),e.ADD_ATTR&&(ke===Me&&(ke=F(ke)),D(ke,e.ADD_ATTR,ge)),e.ADD_URI_SAFE_ATTR&&D(Ze,e.ADD_URI_SAFE_ATTR,ge),e.FORBID_CONTENTS&&(Ye===Xe&&(Ye=F(Ye)),D(Ye,e.FORBID_CONTENTS,ge)),Ue&&(Se["#text"]=!0),Le&&D(Se,["html","head","body"]),Se.table&&(D(Se,["tbody"]),delete Oe.tbody),f&&f(e),lt=e);},ht=D({},["mi","mo","mn","ms","mtext"]),ft=D({},["foreignobject","desc","title","annotation-xml"]),pt=D({},["title","style","font","a","script"]),vt=D({},T);D(vt,L),D(vt,H);var gt=D({},N);D(gt,j);var _t=function(e){x(i.removed,{element:e});try{e.parentNode.removeChild(e);}catch(t){try{e.outerHTML=ae;}catch(t){e.remove();}}},mt=function(e,t){try{x(i.removed,{attribute:t.getAttributeNode(e),from:t});}catch(e){x(i.removed,{attribute:null,from:t});}if(t.removeAttribute(e),"is"===e&&!ke[e])if(je||$e)try{_t(t);}catch(e){}else try{t.setAttribute(e,"");}catch(e){}},yt=function(e){var t,i;if(Ne)e="<remove></remove>"+e;else {var n=S(e,/^[\r\n\t ]+/);i=n&&n[0];}"application/xhtml+xml"===ve&&nt===it&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");var o=re?re.createHTML(e):e;if(nt===it)try{t=(new g).parseFromString(o,ve);}catch(e){}if(!t||!t.documentElement){t=le.createDocument(nt,"template",null);try{t.documentElement.innerHTML=ot?ae:o;}catch(e){}}var a=t.body||t.documentElement;return e&&i&&a.insertBefore(r.createTextNode(i),a.childNodes[0]||null),nt===it?de.call(t,Le?"html":"body")[0]:Le?t.documentElement:a},bt=function(e){return ce.call(e.ownerDocument||e,e,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT,null,!1)},wt=function(e){return "object"===n(c)?e instanceof c:e&&"object"===n(e)&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},xt=function(e,t,n){pe[e]&&b(pe[e],(function(e){e.call(i,t,n,lt);}));},Et=function(e){var t,n;if(xt("beforeSanitizeElements",e,null),(n=e)instanceof v&&("string"!=typeof n.nodeName||"string"!=typeof n.textContent||"function"!=typeof n.removeChild||!(n.attributes instanceof p)||"function"!=typeof n.removeAttribute||"function"!=typeof n.setAttribute||"string"!=typeof n.namespaceURI||"function"!=typeof n.insertBefore||"function"!=typeof n.hasChildNodes))return _t(e),!0;if(P(/[\u0080-\uFFFF]/,e.nodeName))return _t(e),!0;var o=ge(e.nodeName);if(xt("uponSanitizeElement",e,{tagName:o,allowedTags:Se}),e.hasChildNodes()&&!wt(e.firstElementChild)&&(!wt(e.content)||!wt(e.content.firstElementChild))&&P(/<[/\w]/g,e.innerHTML)&&P(/<[/\w]/g,e.textContent))return _t(e),!0;if("select"===o&&P(/<template/i,e.innerHTML))return _t(e),!0;if(!Se[o]||Oe[o]){if(!Oe[o]&&St(o)){if(Pe.tagNameCheck instanceof RegExp&&P(Pe.tagNameCheck,o))return !1;if(Pe.tagNameCheck instanceof Function&&Pe.tagNameCheck(o))return !1}if(Ue&&!Ye[o]){var r=ne(e)||e.parentNode,a=ie(e)||e.childNodes;if(a&&r)for(var s=a.length-1;s>=0;--s)r.insertBefore(y(a[s],!0),A(e));}return _t(e),!0}return e instanceof u&&!function(e){var t=ne(e);t&&t.tagName||(t={namespaceURI:nt,tagName:"template"});var i=E(e.tagName),n=E(t.tagName);return !!rt[e.namespaceURI]&&(e.namespaceURI===tt?t.namespaceURI===it?"svg"===i:t.namespaceURI===et?"svg"===i&&("annotation-xml"===n||ht[n]):Boolean(vt[i]):e.namespaceURI===et?t.namespaceURI===it?"math"===i:t.namespaceURI===tt?"math"===i&&ft[n]:Boolean(gt[i]):e.namespaceURI===it?!(t.namespaceURI===tt&&!ft[n])&&!(t.namespaceURI===et&&!ht[n])&&!gt[i]&&(pt[i]||!vt[i]):!("application/xhtml+xml"!==ve||!rt[e.namespaceURI]))}(e)?(_t(e),!0):"noscript"!==o&&"noembed"!==o&&"noframes"!==o||!P(/<\/no(script|embed|frames)/i,e.innerHTML)?(Te&&3===e.nodeType&&(t=e.textContent,t=I(t,_e," "),t=I(t,me," "),t=I(t,ye," "),e.textContent!==t&&(x(i.removed,{element:e.cloneNode()}),e.textContent=t)),xt("afterSanitizeElements",e,null),!1):(_t(e),!0)},Ct=function(e,t,i){if(Be&&("id"===t||"name"===t)&&(i in r||i in ct))return !1;if(Fe&&!Ae[t]&&P(be,t));else if(De&&P(we,t));else if(!ke[t]||Ae[t]){if(!(St(e)&&(Pe.tagNameCheck instanceof RegExp&&P(Pe.tagNameCheck,e)||Pe.tagNameCheck instanceof Function&&Pe.tagNameCheck(e))&&(Pe.attributeNameCheck instanceof RegExp&&P(Pe.attributeNameCheck,t)||Pe.attributeNameCheck instanceof Function&&Pe.attributeNameCheck(t))||"is"===t&&Pe.allowCustomizedBuiltInElements&&(Pe.tagNameCheck instanceof RegExp&&P(Pe.tagNameCheck,i)||Pe.tagNameCheck instanceof Function&&Pe.tagNameCheck(i))))return !1}else if(Ze[t]);else if(P(Ce,I(i,Ee,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==k(i,"data:")||!Ke[e]){if(Ve&&!P(xe,I(i,Ee,"")));else if(i)return !1}else;return !0},St=function(e){return e.indexOf("-")>0},It=function(e){var t,o,r,a;xt("beforeSanitizeAttributes",e,null);var s=e.attributes;if(s){var l={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ke};for(a=s.length;a--;){var c=t=s[a],u=c.name,d=c.namespaceURI;if(o="value"===u?t.value:M(t.value),r=ge(u),l.attrName=r,l.attrValue=o,l.keepAttr=!0,l.forceKeepAttr=void 0,xt("uponSanitizeAttribute",e,l),o=l.attrValue,!l.forceKeepAttr&&(mt(u,e),l.keepAttr))if(Re||!P(/\/>/i,o)){Te&&(o=I(o,_e," "),o=I(o,me," "),o=I(o,ye," "));var h=ge(e.nodeName);if(Ct(h,r,o)){if(!We||"id"!==r&&"name"!==r||(mt(u,e),o="user-content-"+o),re&&"object"===n(_)&&"function"==typeof _.getAttributeType)if(d);else switch(_.getAttributeType(h,r)){case"TrustedHTML":o=re.createHTML(o);break;case"TrustedScriptURL":o=re.createScriptURL(o);}try{d?e.setAttributeNS(d,u,o):e.setAttribute(u,o),w(i.removed);}catch(e){}}}else mt(u,e);}xt("afterSanitizeAttributes",e,null);}},kt=function e(t){var i,n=bt(t);for(xt("beforeSanitizeShadowDOM",t,null);i=n.nextNode();)xt("uponSanitizeShadowNode",i,null),Et(i)||(i.content instanceof s&&e(i.content),It(i));xt("afterSanitizeShadowDOM",t,null);};return i.sanitize=function(e){var r,a,l,u,d,h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((ot=!e)&&(e="\x3c!--\x3e"),"string"!=typeof e&&!wt(e)){if("function"!=typeof e.toString)throw O("toString is not a function");if("string"!=typeof(e=e.toString()))throw O("dirty is not a string, aborting")}if(!i.isSupported){if("object"===n(t.toStaticHTML)||"function"==typeof t.toStaticHTML){if("string"==typeof e)return t.toStaticHTML(e);if(wt(e))return t.toStaticHTML(e.outerHTML)}return e}if(He||dt(h),i.removed=[],"string"==typeof e&&(Ge=!1),Ge){if(e.nodeName){var f=ge(e.nodeName);if(!Se[f]||Oe[f])throw O("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof c)1===(a=(r=yt("\x3c!----\x3e")).ownerDocument.importNode(e,!0)).nodeType&&"BODY"===a.nodeName||"HTML"===a.nodeName?r=a:r.appendChild(a);else {if(!je&&!Te&&!Le&&-1===e.indexOf("<"))return re&&ze?re.createHTML(e):e;if(!(r=yt(e)))return je?null:ze?ae:""}r&&Ne&&_t(r.firstChild);for(var p=bt(Ge?e:r);l=p.nextNode();)3===l.nodeType&&l===u||Et(l)||(l.content instanceof s&&kt(l.content),It(l),u=l);if(u=null,Ge)return e;if(je){if($e)for(d=ue.call(r.ownerDocument);r.firstChild;)d.appendChild(r.firstChild);else d=r;return (ke.shadowroot||ke.shadowrootmod)&&(d=he.call(o,d,!0)),d}var v=Le?r.outerHTML:r.innerHTML;return Le&&Se["!doctype"]&&r.ownerDocument&&r.ownerDocument.doctype&&r.ownerDocument.doctype.name&&P(ee,r.ownerDocument.doctype.name)&&(v="<!DOCTYPE "+r.ownerDocument.doctype.name+">\n"+v),Te&&(v=I(v,_e," "),v=I(v,me," "),v=I(v,ye," ")),re&&ze?re.createHTML(v):v},i.setConfig=function(e){dt(e),He=!0;},i.clearConfig=function(){lt=null,He=!1;},i.isValidAttribute=function(e,t,i){lt||dt({});var n=ge(e),o=ge(t);return Ct(n,o,i)},i.addHook=function(e,t){"function"==typeof t&&(pe[e]=pe[e]||[],x(pe[e],t));},i.removeHook=function(e){if(pe[e])return w(pe[e])},i.removeHooks=function(e){pe[e]&&(pe[e]=[]);},i.removeAllHooks=function(){pe={};},i}();e.exports=ie;},function(e,t,i){i(109),i(110),i(111),i(112),i(113),i(114),e.exports=i(116);},function(e,t){Object.values=Object.values?Object.values:function(e){var t=Object.prototype.toString.call(e);if(null==e)throw new TypeError("Cannot convert undefined or null to object");if(~["[object String]","[object Object]","[object Array]","[object Function]"].indexOf(t)){if(Object.keys)return Object.keys(e).map((function(t){return e[t]}));var i=[];for(var n in e)e.hasOwnProperty(n)&&i.push(e[n]);return i}return []},Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];if(null==e)throw new TypeError("Cannot convert first argument to object");for(var n=Object(e),o=0;o<t.length;o++){var r=t[o];if(null!=r)for(var a=Object.keys(Object(r)),s=0,l=a.length;s<l;s++){var c=a[s],u=Object.getOwnPropertyDescriptor(r,c);void 0!==u&&u.enumerable&&(n[c]=r[c]);}}return n}});},function(e,t){Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(null==this)throw new TypeError('"this" is null or not defined');var i=Object(this),n=i.length>>>0;if(0===n)return !1;var o,r,a=0|t,s=Math.max(a>=0?a:n-Math.abs(a),0);for(;s<n;){if((o=i[s])===(r=e)||"number"==typeof o&&"number"==typeof r&&isNaN(o)&&isNaN(r))return !0;s++;}return !1},configurable:!0,writable:!0}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),i=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var n=arguments[1],o=0;o<i;){var r=t[o];if(e.call(n,r,o,t))return r;o++;}},configurable:!0,writable:!0}),Array.prototype.findIndex||(Array.prototype.findIndex=function(e){if(null==this)throw new TypeError("Array.prototype.findIndex called on null or undefined");if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var t,i=Object(this),n=i.length>>>0,o=arguments[1],r=0;r<n;r++)if(t=i[r],e.call(o,t,r,i))return r;return -1});},function(e,t){String.prototype.includes||(String.prototype.includes=function(e,t){return "number"!=typeof t&&(t=0),!(t+e.length>this.length)&&-1!==this.indexOf(e,t)}),String.prototype.endsWith||Object.defineProperty(String.prototype,"endsWith",{value:function(e,t){var i=this.toString();(void 0===t||t>i.length)&&(t=i.length),t-=e.length;var n=i.indexOf(e,t);return -1!==n&&n===t}}),String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){return t=t||0,this.indexOf(e,t)===t}}),String.prototype.padStart||(String.prototype.padStart=function(e,t){return e>>=0,t=String(t||" "),this.length>e?String(this):((e-=this.length)>t.length&&(t+=t.repeat(e/t.length)),t.slice(0,e)+String(this))}),String.prototype.padEnd||(String.prototype.padEnd=function(e,t){return e>>=0,t=String(t||" "),this.length>e?String(this):((e-=this.length)>t.length&&(t+=t.repeat(e/t.length)),String(this)+t.slice(0,e))});},function(e,t){if(Element&&!Element.prototype.matches){var i=Element.prototype;i.matches=i.matchesSelector||i.mozMatchesSelector||i.msMatchesSelector||i.oMatchesSelector||i.webkitMatchesSelector;}if("classList"in SVGElement.prototype||Object.defineProperty(SVGElement.prototype,"classList",{get:function(){var e=this;return {contains:function(t){return -1!==e.className.baseVal.split(" ").indexOf(t)},add:function(t){return e.setAttribute("class",e.getAttribute("class")+" "+t)},remove:function(t){var i=e.getAttribute("class").replace(new RegExp("(\\s|^)".concat(t,"(\\s|$)"),"g"),"$2");e.classList.contains(t)&&e.setAttribute("class",i);},toggle:function(e){this.contains(e)?this.remove(e):this.add(e);}}},configurable:!0}),!Object.entries){var n=Function.bind.call(Function.call,Array.prototype.reduce),o=Function.bind.call(Function.call,Object.prototype.propertyIsEnumerable),r=Function.bind.call(Function.call,Array.prototype.concat);Object.entries=function(e){return n(Object.keys(e),(function(t,i){return r(t,"string"==typeof i&&o(e,i)?[[i,e[i]]]:[])}),[])};}Event.prototype.composedPath||(Event.prototype.composedPath=function(){if(this.path)return this.path;var e=this.target;for(this.path=[];null!==e.parentNode;)this.path.push(e),e=e.parentNode;return this.path.push(document,window),this.path});},function(e,t){Math.sign=Math.sign||function(e){return 0===(e=+e)||isNaN(e)?e:e>0?1:-1};},function(e,t,i){i.r(t);var n=i(60);i(115);location.hostname.includes("dhtmlx.com")||location.hostname.includes("dhtmlxcode.com")||location.hostname.includes("webixcode.com")||location.hostname.includes("webix.io/dev/dhtmlx")||location.origin.endsWith("csb.app")||(window.onload=function(){var e;function t(){(e=document.createElement("div")).addEventListener("click",(function(){document.body.removeChild(e),window.open("https://dhtmlx.com/docs/products/dhtmlxSpreadsheet/download.shtml","_blank");}));var t=new n.CssManager,i=t.add({display:"block !important",background:"#ff5252 !important",color:"white !important",padding:"12px",position:"absolute !important",maxWidth:"260px",top:"2% !important",right:"2% !important",fontSize:"14px !important",boxShadow:"0 1px 6px rgba(0,0,0,.1), 0 10px 20px rgba(0,0,0,.1)",cursor:"pointer",borderRadius:"2px",fontFamily:"Roboto",zIndex:2500});t.add({content:'"This version of DHTMLX Spreadsheet is intended for demonstration only. Download an official evaluation version to try DHTMLX Spreadsheet in your project." !important',fontSize:"14px !important",background:"#ff5252 !important",color:"white !important"},`${i}:after`),e.classList.add(i),document.body.appendChild(e);}setInterval((function(){var i=window.getComputedStyle(e,":after");i&&i.getPropertyValue("content")&&"none"!==i.getPropertyValue("content")||t();}),6e4),t();});},function(e,t,i){},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(60);t.css=n.cssManager;var o=i(10);i(117);var r=i(16);t.message=r.message;var a=window.dhx=window.dhx||{};t.i18n=a.i18n||{},t.i18n.setLocale=function(e,i){var n=t.i18n[e];for(var o in i)n[o]=i[o];},t.i18n.spreadsheet=t.i18n.spreadsheet||o.default,a.css=a.css||n.cssManager;var s=i(124);t.Spreadsheet=s.Spreadsheet;},function(e,t,i){},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(1),o=i(3),r=i(49),a=new WeakMap,s=new Map;function l(e,t){var i=document.createElement("div");return i.setAttribute("data-position",t),i.className="dhx_message-container dhx_message-container--"+t+(e===document.body?" dhx_message-container--in-body":""),i}function c(e,t){t&&clearTimeout(a.get(e));var i=e.parentNode,n=i.getAttribute("data-position"),o=i.parentNode,r=s.get(o);if(r){var l=r[n];if(l){var c=l.stack,u=c.indexOf(e);return -1!==u?(i.removeChild(e),c.splice(u,1),void(0===c.length&&o.removeChild(i))):void 0}}}t.message=function(e){var t;"string"==typeof e&&(e={text:e}),e.position=e.position||r.MessageContainerPosition.topRight;var i=document.createElement("div");i.className="dhx_widget dhx_message "+(e.css||""),i.setAttribute("role","alert");var u=e.text&&n.uid();u&&i.setAttribute("aria-describedby",u),e.html?i.innerHTML=e.html:(i.innerHTML='<span class="dhx_message__text" id='+u+"></span>\n\t\t"+(e.icon?'<span class="dhx_message__icon dxi '+e.icon+'"></span>':""),i.querySelector("#"+u).textContent=e.text);var d=e.node?o.toNode(e.node):document.body;"static"===getComputedStyle(d).position&&(d.style.position="relative");var h=s.get(d);h?h[e.position]||(h[e.position]={stack:[],container:l(d,e.position)}):s.set(d,((t={})[e.position]={stack:[],container:l(d,e.position)},t));var f=s.get(d)[e.position],p=f.stack,v=f.container;if(0===p.length&&d.appendChild(v),p.push(i),v.appendChild(i),e.expire){var g=setTimeout((function(){return c(i)}),e.expire);a.set(i,g);}i.onclick=function(){return c(i,!0)};};},function(e,t,i){(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=i(61),o=i(62),r=i(1);t.alert=function(t){var i=t.buttons&&t.buttons[0]?t.buttons[0]:n.default.apply,a=o.blockScreen(t.blockerCss);return new e((function(e){var n="dhx_alert__"+r.uid()+"_content",o="dhx_alert__"+r.uid()+"_header",s=document.createElement("div");s.setAttribute("role","alert"),s.setAttribute("aria-modal","true"),t.text&&s.setAttribute("aria-describedby",n),t.header&&s.setAttribute("aria-labelledby",o),s.className="dhx_widget dhx_alert "+(t.css||"");var l=function(t){"Escape"!==t.key&&"Esc"!==t.key||(c(t),e(!1));};function c(e){e.preventDefault(),a(),document.body.removeChild(s),document.removeEventListener("keydown",l);}s.innerHTML="\n\t\t\t"+(t.header?"<div id="+o+' class="dhx_alert__header"> '+(!1!==t.htmlEnable?t.header:"")+" </div>":"")+"\n\t\t\t"+(t.text?"<div id="+n+' class="dhx_alert__content">'+(!1!==t.htmlEnable?t.text:"")+"</div>":"")+'\n\t\t\t<div class="dhx_alert__footer '+(t.buttonsAlignment?"dhx_alert__footer--"+t.buttonsAlignment:"")+'">\n\t\t\t\t<button type="button" aria-label="confirm" class="dhx_alert__apply-button dhx_button dhx_button--view_flat dhx_button--color_primary dhx_button--size_medium">'+i+"</button>\n\t\t\t</div>",!1===t.htmlEnable&&(t.header&&(s.querySelector("#"+o).textContent=t.header),t.text&&(s.querySelector("#"+n).textContent=t.text)),document.body.appendChild(s),s.querySelector(".dhx_alert__apply-button").focus(),s.querySelector("button").addEventListener("click",(function(t){c(t),e(!0);})),document.addEventListener("keydown",l);}))};}).call(this,i(14));},function(e,t,i){(function(e){var n=void 0!==e&&e||"undefined"!=typeof self&&self||window,o=Function.prototype.apply;function r(e,t){this._id=e,this._clearFn=t;}t.setTimeout=function(){return new r(o.call(setTimeout,n,arguments),clearTimeout)},t.setInterval=function(){return new r(o.call(setInterval,n,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close();},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(n,this._id);},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t;},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1;},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout();}),t));},i(121),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate;}).call(this,i(50));},function(e,t,i){(function(e,t){!function(e,i){if(!e.setImmediate){var n,o,r,a,s,l=1,c={},u=!1,d=e.document,h=Object.getPrototypeOf&&Object.getPrototypeOf(e);h=h&&h.setTimeout?h:e,"[object process]"==={}.toString.call(e.process)?n=function(e){t.nextTick((function(){p(e);}));}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,i=e.onmessage;return e.onmessage=function(){t=!1;},e.postMessage("","*"),e.onmessage=i,t}}()?e.MessageChannel?((r=new MessageChannel).port1.onmessage=function(e){p(e.data);},n=function(e){r.port2.postMessage(e);}):d&&"onreadystatechange"in d.createElement("script")?(o=d.documentElement,n=function(e){var t=d.createElement("script");t.onreadystatechange=function(){p(e),t.onreadystatechange=null,o.removeChild(t),t=null;},o.appendChild(t);}):n=function(e){setTimeout(p,0,e);}:(a="setImmediate$"+Math.random()+"$",s=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(a)&&p(+t.data.slice(a.length));},e.addEventListener?e.addEventListener("message",s,!1):e.attachEvent("onmessage",s),n=function(t){e.postMessage(a+t,"*");}),h.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),i=0;i<t.length;i++)t[i]=arguments[i+1];var o={callback:e,args:t};return c[l]=o,n(l),l++},h.clearImmediate=f;}function f(e){delete c[e];}function p(e){if(u)setTimeout(p,0,e);else {var t=c[e];if(t){u=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(i,n);}}(t);}finally{f(e),u=!1;}}}}}("undefined"==typeof self?void 0===e?this:e:self);}).call(this,i(50),i(122));},function(e,t){var i,n,o=e.exports={};function r(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(i===setTimeout)return setTimeout(e,0);if((i===r||!i)&&setTimeout)return i=setTimeout,setTimeout(e,0);try{return i(e,0)}catch(t){try{return i.call(null,e,0)}catch(t){return i.call(this,e,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:r;}catch(e){i=r;}try{n="function"==typeof clearTimeout?clearTimeout:a;}catch(e){n=a;}}();var l,c=[],u=!1,d=-1;function h(){u&&l&&(u=!1,l.length?c=l.concat(c):d=-1,c.length&&f());}function f(){if(!u){var e=s(h);u=!0;for(var t=c.length;t;){for(l=c,c=[];++d<t;)l&&l[d].run();d=-1,t=c.length;}l=null,u=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{return n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e);}}function p(e,t){this.fun=e,this.array=t;}function v(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];c.push(new p(e,t)),1!==c.length||u||s(f);},p.prototype.run=function(){this.fun.apply(null,this.array);},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=v,o.addListener=v,o.once=v,o.off=v,o.removeListener=v,o.removeAllListeners=v,o.emit=v,o.prependListener=v,o.prependOnceListener=v,o.listeners=function(e){return []},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return "/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0};},function(e,t,i){(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=i(61),o=i(62),r=i(1);t.confirm=function(t){t.buttonsAlignment=t.buttonsAlignment||"right";var i=t.buttons&&t.buttons[1]?t.buttons[1]:n.default.apply,a=t.buttons&&t.buttons[0]?t.buttons[0]:n.default.reject,s=o.blockScreen("dhx_alert__overlay-confirm "+(t.blockerCss||""));return new e((function(e){var n=document.createElement("div");n.setAttribute("role","alertdialog"),n.setAttribute("aria-modal","true");var o,l=t.header&&r.uid(),c=t.header&&r.uid();c&&n.setAttribute("aria-describedby",c),l&&n.setAttribute("aria-labelledby",l);var u=function(t){s(),n.removeEventListener("click",d),document.removeEventListener("keydown",h),document.body.removeChild(n),e(t);},d=function(e){"BUTTON"===e.target.tagName&&u(e.target.classList.contains("dhx_alert__confirm-aply"));},h=function(e){"Escape"===e.key||"Esc"===e.key?(n.querySelector(".dhx_alert__confirm-aply").focus(),u(e.target.classList.contains("dhx_alert__confirm-reject"))):"Tab"===e.key&&("aply"===o?(o="reject",n.querySelector(".dhx_alert__confirm-reject").focus()):(o="aply",n.querySelector(".dhx_alert__confirm-aply").focus()),e.preventDefault());};n.className="dhx_widget dhx_alert dhx_alert--confirm"+(t.css?" "+t.css:""),n.innerHTML="\n\t\t"+(t.header?'<div class="dhx_alert__header" id='+l+"> "+(!1!==t.htmlEnable?t.header:"")+" </div>":"")+"\n\t\t"+(t.text?'<div class="dhx_alert__content" id='+c+">"+(!1!==t.htmlEnable?t.text:"")+"</div>":"")+'\n\t\t\t<div class="dhx_alert__footer '+(t.buttonsAlignment?"dhx_alert__footer--"+t.buttonsAlignment:"")+'">\n\t\t\t\t<button type="button" aria-label="reject" class="dhx_alert__confirm-reject dhx_button dhx_button--view_link dhx_button--color_primary dhx_button--size_medium">'+a+'</button>\n\t\t\t\t<button type="button"  aria-label="aply"class="dhx_alert__confirm-aply dhx_button dhx_button--view_flat dhx_button--color_primary dhx_button--size_medium">'+i+"</button>\n\t\t\t</div>",!1===t.htmlEnable&&(t.header&&(n.querySelector("#"+l).textContent=t.header),t.text&&(n.querySelector("#"+c).textContent=t.text)),document.body.appendChild(n),o="aply",n.querySelector(".dhx_alert__confirm-aply").focus(),n.addEventListener("click",d),document.addEventListener("keydown",h);}))};}).call(this,i(14));},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);}),r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},a=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var s=i(64),l=i(0),c=i(4),u=i(3),d=i(7),h=i(13),f=i(37),p=i(15),v=i(30),g=i(180),_=i(43),m=i(209),y=i(210),b=i(211),w=i(212),x=i(27),E=i(214),C=i(215),S=i(12),I=i(2),k=i(57),M=i(44),P=i(216),O=i(10),A=i(217),D=i(218),F=i(5),V=i(8),R=i(22),T=i(1),L=i(219),H=i(220),N=i(221),j=i(222),$=i(31),z=i(45),B=i(46),W=i(226),U=i(17),G=i(26),q=i(18),Y=i(227),X=i(228),K=i(229),J=i(244),Z=i(16),Q=i(245),ee=i(246),te=i(247),ie=i(28),ne=function(e){function t(t,i){var n=e.call(this,t,i)||this;n.container=null===t?t:u.toNode(t),n._sizes={rowsCount:1e3,colsCount:200},n._editors={},n.config=I.extendConfig({rowsCount:{validate:function(e){return e>=0},default:1e3},colsCount:{validate:function(e){return e>=0},default:26},menu:{validate:function(e){return "boolean"==typeof e},default:!1},editLine:{validate:function(e){return "boolean"==typeof e},default:!0},readonly:{validate:function(e){return "boolean"==typeof e},default:!1},autoFormat:{validate:function(e){return "boolean"==typeof e},default:!0},importModulePath:{validate:function(e){return "string"==typeof e},default:"https://cdn.dhtmlx.com/libs/excel2json/1.2/worker.js?vx"},exportModulePath:{validate:function(e){return "string"==typeof e},default:"https://cdn.dhtmlx.com/libs/json2excel/1.2/worker.js?vx"},multiSheets:{validate:function(e){return "boolean"==typeof e},default:!0},dateFormat:{validate:function(e){return "string"==typeof e},default:"%d/%m/%Y"},timeFormat:{validate:function(e){return "number"==typeof e},default:12},formats:{validate:function(e){return e instanceof Array},default:[]}},n.config),n._range={cell:"",mode:0,cursor:0,editor:null,inline:0},n.events=new c.EventSystem,S.initFormat(n,n.config.dateFormat,n.config.timeFormat),n._initLayout(),n._colorpicker=new s.Colorpicker(null),n._colorpickerPopup=new V.Popup,n._colorpickerPopup.attach(n._colorpicker),n._linkForm=new Q.LinkForm(n._grid,n.insertLink.bind(n),n.events),n._setEventsHandlers(),n._actionsManager=new _.ActionsManager({spreadsheet:n,editLine:n._editLine,grid:n._grid,dataStore:n._dataStore,events:n.events}),n._buffer=new E.BufferManager(n,n._grid,n._callAction,n._activePage,n._dataStore),dhx.css.add({textDecoration:"underline",color:"#163FA2"},"dhx_spreadsheet_link"),n.selection=new A.Selection(n,n._grid,n._buffer,n._activePage);var o=n._grid.getRootView();o.hooks=o.hooks||{},o.hooks.didMount=function(e){n._updateGridSizes();var t=n.selection.getFocusedCell(),i=n.getValue(t);n._editLine.setValue(i),n.config.readonly||e.node.el.addEventListener("contextmenu",(function(e){n.contextMenu.data.update("lock",{value:n.isLocked(n.selection.getSelectedCell())?O.default.unlockCell:O.default.lockCell}),n._contextMenuVisible=!0,n.contextMenu.showAt(e),e.preventDefault();})),n.container=n._layout.getRootView().node.el,o.hooks.didRedraw=function(e){n.events.fire(F.SpreadsheetEvents.gridRedraw,[e]);};},n._initHotkeys();var r=n._tabbar.getRootView();r.hooks=r.hooks||{};var a=function(e){e.node.el.addEventListener("contextmenu",(function(e){n.endEdit();var t=u.locate(e);if(t&&"add-sheet"!==t&&!n.config.readonly){var i=n._sheets.getLength(),o=n.sheetContextMenu.data;n.config.multiSheets&&2===i?o.update("delete",{disabled:!0}):n.config.multiSheets&&i>2&&o.getItem("delete").disabled&&o.update("delete",{disabled:!1}),n.sheetContextMenu.showAt(e.target,"right"),n._focusedSheet=t,e.preventDefault();}}));};r.hooks.didMount=function(e){e.node&&e.node.el&&e.node.el.addEventListener("dblclick",(function(e){var t=u.locate(e);t&&"add-sheet"!==t&&!n.config.readonly&&(e.preventDefault(),n._focusedSheet=t,n.sheetContextMenu.events.fire(R.NavigationBarEvents.click,["rename",e]),l.awaitRedraw().then((function(){U.focusManager.setFocusId(null);})));})),a(e);},r.hooks.didRedraw=function(e){return a(e)},n._generateGridStruct(),n.export=new L.Exporter(n,n._grid);var d=l.create({render:function(){return n._render()}});return n.mount(t,d),U.focusManager.setFocusId(n._uid),n._spanControl=new te.Merge(n._callAction.bind(n),n.config,n._grid,n.isLocked.bind(n)),n._filterForm=new ee.FilterForm(n._grid,n.setFilter.bind(n)),n}return o(t,e),t.prototype.destructor=function(){var e,t;this.unmount(),this._layout.unmount(),this.contextMenu.destructor(),this.menu.destructor(),this.toolbar.destructor(),this._editLine.destructor(),this._tabbar.destructor(),null===(e=this._searchForm)||void 0===e||e.destructor(),null===(t=this._linkForm)||void 0===t||t.destructor();},t.prototype.paint=function(){this.config.rowsCount===this._sizes.rowsCount&&this.config.colsCount===this._sizes.colsCount||this._generateGridStruct(),this._layout.paint(),this._grid.paint();},t.prototype.load=function(e,t){var i=this;if("xlsx"===t||"json"===t&&!e){if(!I.isWasmSupported())throw new Error("WebAssembly is not supported by your browser");return this._xlsxProxy=this._xlsxProxy||new N.FileProxy(this),this._xlsxProxy.load(t,e).then((function(e){i.parse(e,t);}))}return h.toProxy(e).load().then((function(e){i.parse(e,t);}))},t.prototype.parse=function(e,t){var i=this;"csv"===t&&(t=new C.CustomCsvDriver(this._grid)),"xlsx"===t&&(t=new H.XlsxDriver),this._sheets.forEach((function(e){"add-sheet"!==e.id&&(i._dataStore.removePage(e.value),i._sheets.remove(e.id));})),e=h.toDataDriver(t||"json").toJsonArray(e,this._grid),this._grid.config.columns.map((function(e){e.$cellCss={};}));var n={sheets:[]},o=this.config,s=o.multiSheets,l=o.leftSplit,c=void 0===l?-1:l,u=o.topSplit,d=void 0===u?-1:u,f=o.colsCount,p=o.rowsCount;if("sheets"in e)for(var v=0;v<(s?e.sheets.length:1);v++){(S=e.sheets[v]).name=S.name||this._generateNewSheetName(),n.sheets.push(S);}else "data"in e&&n.sheets.push(r({name:this._activeSheetName.name},e));var g=[];if("styles"in e){var _=e.styles;for(var m in _){var y=_[m],b=I.convertStyles(y),w=dhx.css.add(r({"white-space":"nowrap"},b),m);"wrap"===b.multiline&&g.push(w);}dhx.css.update();}Array.isArray(e)&&n.sheets.push({data:e,name:this._generateNewSheetName()});for(var x=0,E=n.sheets;x<E.length;x++){var S=E[x];this._dataStore.addPage(S.name),this._sheets.add({value:S.name,id:S.id});}for(var k=function(e){for(var t=M._dataStore.getPage(e.name),n=a(e.data),o=[];n.length;)o.push(n.splice(0,1e3));for(var s=M._grid.config.rowHeight,l=e.cols||[],u=e.rows||[];u.length<p;)u.push({height:s});for(;l.length<f;)l.push({width:120});var h=e.merged||[];(d||c)&&h&&(h=(h=h.filter((function(e){return I.checkSpan(e,c,d,i._grid)}))).map((function(e){var t=e.to,i=t.row,n=t.column;return r(r({},e),{to:{row:i>u.length?u.length:i,column:n>l.length?l.length:n}})}))),t.setMeta({cols:l,rows:u,merged:h}),o.forEach((function(e,n){n&&o.length-1!==n?setTimeout((function(){return i._parseCells(e,t,g)}),100):i._parseCells(e,t,g);}));},M=this,P=0,O=n.sheets;P<O.length;P++){k(S=O[P]);}this._grid.data.events.fire(h.DataEvents.change),this._changeSheet(this._sheets.getId(this.config.multiSheets&&!this.config.readonly?1:0)),this._grid.paint(),this.config&&!this.config.readonly&&this.selection.setSelectedCell("A1");},t.prototype._parseCells=function(e,t,i){void 0===i&&(i=[]);for(var n=this.config,o=n.formats,r=void 0===o?[]:o,a=(n.autoFormat,function(e){var n=I.getCellIds(e.cell.toUpperCase(),s._grid),o=n.row,a=n.col,l=void 0,c=void 0,u=e.css||"",d="General"===e.format?r.find((function(e){return "common"===e.id})):r.find((function(t){return t.id===e.format||t.mask===e.format})),h=S.detectFormat(e.value);c=d||h,!d&&e.format&&(c=S.addNewFormat(I.analyzeMSOFormat(e.format),s.toolbar.data,r)||h),e.format=c.mask;var f=T.isDefined(e.value)?S.getCleanValue(e.value,c):"";"object"==typeof e.css&&(e.css=e.css.join(" "));var p=I.getStylesObject(e.css),v=!!p["text-align"],g=S.isNumeric(f);!g&&(""+f).startsWith("http")&&1===(""+f).split(" ").length&&(u="dhx_spreadsheet_link "+u),e.css instanceof Array&&(e.css=e.css.join(" ")),g&&"@"!==(null==c?void 0:c.mask)?(l=f,v||(p["text-align"]="right",e.css=dhx.css.add(I.convertStyles(p)))):l=e.value;var _=c.id;(_.includes("date")||_.includes("time"))&&l&&(l=S.isNumeric(l)?+l:l instanceof Date?G.getExcelDateFromJs(l):G.getExcelDateFromString(l,c)),t.setValue(o,a,l,"@"===c.mask?1:0);var m=I.doesContainUrl(l),y=m?{href:m}:null,b=e.css;t.setCell(o,a,{format:c,css:b,editor:e.editor,link:y,$toolbarAlign:v}),i.includes(b)&&x.setAutoHeightToRow(e.cell.toUpperCase(),s._grid,t,"wrap");}),s=this,l=0,c=e;l<c.length;l++){a(c[l]);}},t.prototype.serialize=function(){var e=this,t={},i=[];return this._sheets.forEach((function(n){if("add-sheet"!==n.id){for(var o=n.value,r=e._dataStore.getPage(o),a=r.getMeta(),s=a.cols,l=void 0===s?[]:s,c=a.rows,u=void 0===c?[]:c,d=a.merged,h=void 0===d?[]:d,f=e._activePage.getSize(),p=f[0],v=f[1],g=r.serialize(!0),_={name:o,data:[],cols:l.slice(0,v),rows:u.slice(0,p).map((function(e){return {height:e.height}})),merged:h},m=0,y=g;m<y.length;m++){var b=y[m],w=I.getCellNameById(e._grid,(b[0]+1).toString(),(b[1]+1).toString()),x=b[2];if(x){var E=x.value,C=x.css,k=x.format,M=x.editor,P={cell:w};if(C&&(P.css=C,t[P.css]=dhx.css.get(P.css)),M&&(P.editor=M),void 0!==k){var O=S.getFormat(S.getDefaultFormatsMap()[k.mask]);P.format=(null==O?void 0:O.id)||k.id;}(E||"number"==typeof E)&&(P.value=E),w&&(P.value||"number"==typeof P.value||C||M)&&_.data.push(P);}}i.push(_);}})),{sheets:i,styles:t,formats:this.config.formats}},t.prototype.setValue=function(e,t){if(e&&(this._checkForMissedCells(e),this.events.fire(F.SpreadsheetEvents.beforeValueChange,[e,t]))){var i=this._parseCell(e),n=i.page,o=i.cleanCell;if(n){e=o.toUpperCase();var r=I.getCellIds(o,this._grid);this._callAction({row:r.row,col:r.col,cell:e,val:t,action:F.Actions.setCellValue,groupAction:F.Actions.groupAction,dataStore:this._dataStore,page:n}),this._grid.paint();}}},t.prototype.getValue=function(e){var t=this;if(e){var i=this._parseCell(e),n=i.page,o=i.cleanCell;if(n){if(e=o.toUpperCase(),I.isRangeId(e)){var r=[];return this.eachCell((function(e){var i=I.getCellIds(e,t._grid);r.push(n.getValue(i.row,i.col));}),e),r}var a=I.getCellIds(e,this._grid);return n.getValue(a.row,a.col)}}},t.prototype.getCellIndex=function(e){return I.getCellIds(e,this._grid)},t.prototype.getFormula=function(e){var t=this,i=this._parseCell(e),n=i.page,o=i.cleanCell;if(n){if(e=o.toUpperCase(),I.isRangeId(e)){var r=[];return this.eachCell((function(e){r.push(t._getMath(e,n)||"");}),e),r}var a=this._getMath(e,n);return a?a.source:""}},t.prototype.getSheets=function(){var e=[];return this._sheets.forEach((function(t){"add-sheet"!==t.id&&e.push({name:t.value,id:t.id});})),e},t.prototype._getMath=function(e,t){if(void 0===t&&(t=this._activePage),e){var i=I.getCellIds(e,this._grid),n=i.row,o=i.col,r=$.toId(n,o,t.getID());return this._math.getMath(r)||null}},t.prototype.eachCell=function(e,t){t=t||this.selection.getSelectedCell();for(var i=0,n=I.getCellsArray(t,this._grid);i<n.length;i++){var o=n[i],r=I.getCellIds(o,this._grid),a=r.row,s=r.col;e(o,this._activePage.getValue(a,s));}},t.prototype.getStyle=function(e,t){var i=this;if(void 0===t&&(t=!0),e){var n=this._parseCell(e),o=n.page,a=n.cleanCell;if(o){if(e=a.toUpperCase(),I.isRangeId(e)){var s=[];return this.eachCell((function(e){var n=I.getCellInfo(e,o,i._grid),a=[];n.css&&(a="string"==typeof n.css?n.css.split(t?" ":"dhx_spreadsheet_link"):[n.css]);for(var l={},c=0,u=a;c<u.length;c++){var d=u[c];l=r(r({},l),dhx.css.get(d));}s.push(l);}),e),s}var l=I.getCellInfo(e,this._activePage,this._grid),c=[];l.css&&(c="string"==typeof l.css?l.css.split(t?" ":"dhx_spreadsheet_link"):[l.css]);for(var u={},d=0,h=c;d<h.length;d++){var f=h[d];u=r(r({},u),dhx.css.get(f));}return u}}},t.prototype.setStyle=function(e,t){if(e&&t&&this.events.fire(F.SpreadsheetEvents.beforeStyleChange,[e,t])){var i=I.getCellIds(e,this._grid),n=i.row,o=i.col;Object.keys(t).length?this._callAction({val:t,row:n,col:o,cell:e,action:F.Actions.setCellStyle,groupAction:F.Actions.groupAction}):this._callAction({row:n,col:o,cell:e,action:F.Actions.removeCellStyles,groupAction:F.Actions.groupAction,dataStore:this._dataStore});}},t.prototype.setFilter=function(e,t){e&&I.isRangeId(e)&&e.includes(",")||this._callAction({val:t,cell:null!=e?e:"A1",action:F.Actions.filter});},t.prototype.getFilter=function(e){var t=this._getSheet(e)||this.getActiveSheet(),i=this._dataStore.getPage(t.name);if(i)return i.getMeta().filter},t.prototype.getFormat=function(e){var t,i=this;if(e){var n=this._parseCell(e),o=n.page,r=n.cleanCell;if(o){if(e=r.toUpperCase(),I.isRangeId(e)){var a=[];return this.eachCell((function(e){var t;a.push((null===(t=I.getCellInfo(e,o,i._grid).format)||void 0===t?void 0:t.id)||"common");}),e),a}var s=null===(t=I.getCellInfo(e,o,this._grid).format)||void 0===t?void 0:t.mask;return S.getDefaultFormatsMap()[s]||s}}},t.prototype.setFormat=function(e,t){if(e){var i=this._parseCell(e),n=i.page,o=i.cleanCell;n&&(e=o.toUpperCase(),this._callAction({val:t,cell:e,action:F.Actions.setCellFormat,groupAction:F.Actions.groupAction,dataStore:this._dataStore,page:n}));}},t.prototype.clearSheet=function(e){var t=this._getSheet(e)||this.getActiveSheet();this.events.fire(F.SpreadsheetEvents.beforeSheetClear,[t])&&(this._callAction({val:t.name,action:F.Actions.clearSheet,groupAction:F.Actions.groupAction,dataStore:this._dataStore}),this.events.fire(F.SpreadsheetEvents.afterSheetClear,[t]));},t.prototype.clear=function(){this.events.fire(F.SpreadsheetEvents.beforeClear,[])&&(this._callAction({action:F.Actions.clear,groupAction:F.Actions.groupAction,dataStore:this._dataStore}),this.events.fire(F.SpreadsheetEvents.afterClear,[]));},t.prototype.isLocked=function(e){var t=this;if(e){var i=this._parseCell(e),n=i.page,o=i.cleanCell;if(n){if(e=o.toUpperCase(),"start"in I.getCellIds(e,this._grid)){var r=!1;return this.eachCell((function(e){if(!r){var i=I.getCellInfo(e,n,t._grid).locked;r=i;}}),e),r}return !!I.getCellInfo(e,n,this._grid).locked}}},t.prototype.lock=function(e){if(e){var t=this._parseCell(e),i=t.page,n=t.cleanCell;if(i){e=n.toUpperCase();var o=I.getCellIds(e,this._grid);this._callAction({row:o.row,col:o.col,val:!0,cell:e,action:F.Actions.lockCell,groupAction:F.Actions.groupAction,dataStore:this._dataStore,page:i}),this._grid.paint();}}},t.prototype.unlock=function(e){if(e){var t=this._parseCell(e),i=t.page,n=t.cleanCell;if(i){e=n.toUpperCase();var o=I.getCellIds(e,this._grid);this._callAction({row:o.row,col:o.col,val:!1,cell:e,action:F.Actions.lockCell,groupAction:F.Actions.groupAction,dataStore:this._dataStore,page:i}),this._grid.paint();}}},t.prototype.addRow=function(e){this.events.fire(F.SpreadsheetEvents.beforeRowAdd,[e])&&(I.isRangeId(e)&&(e=e.split(":")[0]),this._callAction({cell:e,action:F.Actions.addRow,groupAction:F.Actions.groupRowAction,dataStore:this._dataStore}),this.events.fire(F.SpreadsheetEvents.afterRowAdd,[e]));},t.prototype.deleteRow=function(e){if(this.events.fire(F.SpreadsheetEvents.beforeRowDelete,[e])){var t=I.getCellIds(e,this._grid);this._callAction({row:t.row,col:t.col,cell:e,action:F.Actions.deleteRow,groupAction:F.Actions.groupRowAction,dataStore:this._dataStore}),this.events.fire(F.SpreadsheetEvents.afterRowDelete,[e]);}},t.prototype.addColumn=function(e){this.events.fire(F.SpreadsheetEvents.beforeColumnAdd,[e])&&(I.isRangeId(e)&&(e=e.split(":")[0]),this._callAction({cell:e,action:F.Actions.addColumn,groupAction:F.Actions.groupColAction,dataStore:this._dataStore}),this.events.fire(F.SpreadsheetEvents.afterColumnAdd,[e]));},t.prototype.deleteColumn=function(e){this.events.fire(F.SpreadsheetEvents.beforeColumnDelete,[e])&&(this._callAction({cell:e,action:F.Actions.deleteColumn,groupAction:F.Actions.groupColAction,dataStore:this._dataStore}),this.events.fire(F.SpreadsheetEvents.afterColumnDelete,[e]));},t.prototype.undo=function(){this._actionsManager.undo();},t.prototype.redo=function(){this._actionsManager.redo();},t.prototype.startEdit=function(e,t){if(!this.config.readonly&&!this._range.mode){if(this._editMode)return this._editLine.setValueAtRedactor(t);var i=this.selection.getFocusedCell();if(e||(e=i),e=e.toUpperCase(),this._checkForMissedCells(e),this.events.fire(F.SpreadsheetEvents.beforeEditStart,[e,t])&&!this.isLocked(e)){i!==e&&(this.endEdit(!0),this.selection.setSelectedCell(e));var n=I.getCellInfo(e,this._activePage,this._grid),o=n.edited,r=n.link;if(this.selection.getSelectedCell()||this.selection.setSelectedCell(e),r)return this._showLinkPopup(e);if(!o){var a=I.getCellIds(e,this._grid),s=a.row,l=a.col,c=$.toId(s,l,this._activePage.getID()),u=this._math.getMath(c);u&&!t&&(t="="+u.source),this._activePage.setCell(s,l,{edited:!0,nextValue:t,editorValue:t}),t&&this._editLine.setValue(t),this.events.fire(F.SpreadsheetEvents.afterEditStart,[e,t]);}}}},t.prototype.endEdit=function(e){var t=this.selection.getFocusedCell(),i=I.getCellInfo(t,this._activePage,this._grid),n=i.edited,o=i.nextValue,r=i.format,a=i.value;if(n){if(!this.events.fire(F.SpreadsheetEvents.beforeEditEnd,[t,o]))return;if(o&&this._activePage.setMeta({inserted:!0}),!e&&void 0!==o){if((null==r?void 0:r.id.includes("time"))&&S.isNumeric(a))if((s=G.timeStringToJS(o))instanceof Date)(l=G.excelDateToJSDate(a)).setHours(s.getHours(),s.getMinutes(),s.getSeconds()),o=G.getExcelDateFromJs(l);if("date"===(null==r?void 0:r.id)&&S.isNumeric(a)&&q.stringToDate(o,this.config.dateFormat,!0)){var s=q.stringToDate(o,this.config.dateFormat),l=G.excelDateToJSDate(a);s.setHours(l.getHours(),l.getMinutes(),l.getSeconds()),o=G.getExcelDateFromJs(s);}this.setValue(t,o);}var c=I.getCellIds(t,this._grid),u=c.row,d=c.col;this._activePage.setCell(u,d,{nextValue:void 0,edited:!1}),this._editLine.blur(),this.events.fire(F.SpreadsheetEvents.afterEditEnd,[t,o]);}},t.prototype.addSheet=function(e){if(this.config.multiSheets){var t=e;if(t||(t=this._generateNewSheetName()),this.events.fire(F.SpreadsheetEvents.beforeSheetAdd,[t]))return this._callAction({val:t,action:F.Actions.addSheet,groupAction:F.Actions.groupAction,dataStore:this._dataStore,sheets:this._sheets,prev:this._tabbar.getSelected()[0]}),this._sheets.find((function(e){return e.value===t})).id}},t.prototype.removeSheet=function(e){var t=this._getSheet(e);!t||!this.config.multiSheets||this.config.multiSheets&&2===this._sheets.getLength()||this.events.fire(F.SpreadsheetEvents.beforeSheetRemove,[t])&&(this._callAction({action:F.Actions.deleteSheet,groupAction:F.Actions.groupAction,dataStore:this._dataStore,sheets:this._sheets,prev:t.id,val:t.name}),this.events.fire(F.SpreadsheetEvents.afterSheetRemove,[t]));},t.prototype.getActiveSheet=function(){return this._activeSheetName},t.prototype.setActiveSheet=function(e){this.endEdit(),this._changeSheet(e);},t.prototype.setValidation=function(e,t){var i=this._parseCell(e),n=i.page,o=i.cleanCell;n&&(e=o.toUpperCase(),this._callAction({val:I.isRangeId(e)?[t]:t,cell:e,action:F.Actions.setValidation,groupAction:F.Actions.groupAction,dataStore:this._dataStore,page:n}));},t.prototype.search=function(e,t,i){void 0===e&&(e=""),void 0===t&&(t=!1),this._searchForm||(this._searchForm=new J.SearchForm(this));var n=this._activePage,o=this._getSheet(i);if(T.isDefined(i)){if(!o)return;n=this._dataStore.getPage(o.name);}return this._activePage!==n&&o&&t&&this._changeSheet(o.id),t&&this._searchForm.show(n),this._searchForm.search(e,n)},t.prototype.hideSearch=function(){var e;null===(e=this._searchForm)||void 0===e||e.hide();},t.prototype.insertLink=function(e,t){e&&this._callAction({val:t,cell:e,action:F.Actions.insertLink,dataStore:this._dataStore,page:this._activePage});},t.prototype.fitColumn=function(e){this._callAction({cell:e,action:F.Actions.fitColumn,dataStore:this._dataStore,page:this._activePage});},t.prototype.sortCells=function(e,t){void 0===t&&(t=1),this._callAction({action:F.Actions.sortCells,groupAction:F.Actions.sortCells,dataStore:this._dataStore,cell:e,dir:t,page:this._activePage});},t.prototype.mergeCells=function(e,t){void 0===t&&(t=!1),this._spanControl.doAction(e,t);},t.prototype._showLinkPopup=function(e){e&&!this._contextMenuVisible&&this._linkForm.show(e,I.getCellInfo(e,this._activePage,this._grid));},t.prototype._showFilter=function(e,t){t.stopPropagation();var i=this._activePage.getMeta().filter;this._filterForm.show(e,t,i,this._activePage);},t.prototype._checkValidation=function(e){var t=I.getCellInfo(e,this._activePage,this._grid),i=t.editor,n=t.value;if(!i)return !0;var o=i.options;if("string"==typeof o){var r=I.getCellIds(o,this._grid),a=r.start,s=r.end,l=r.row,c=r.col;o=(o=l?[this._activePage.getValue(l,c)]:this._activePage.getRange(a.row,a.col,s.row,s.col)).map((function(e){return ""+e}));}return "number"!=typeof n&&!n||o.includes(""+n)},t.prototype._renameSheet=function(e,t){var i=this._sheets.getItem(e);i&&t&&i.prevValue!==t&&this.events.fire(F.SpreadsheetEvents.beforeSheetRename,[{name:i.value,id:i.id},t])&&(this._callAction({val:t,action:F.Actions.renameSheet,groupAction:F.Actions.groupAction,dataStore:this._dataStore,sheets:this._sheets,prev:e}),this.events.fire(F.SpreadsheetEvents.afterSheetRename,[{name:i.value,id:i.id}]));},t.prototype._getSheet=function(e){return this.getSheets().find((function(t){return t.id===e}))},t.prototype._changeSheet=function(e){var t=this,i=this._sheets.getItem(e);if(i&&this.events.fire(F.SpreadsheetEvents.beforeSheetChange,[this._activeSheetName])){var n=this._activePage,o=this._grid.getScrollState();n&&n.setMeta({scroll:o});var r=this._activeSheetName?this._activeSheetName.name:null,a=this._editLine.isCellExpected("A1",!1,this._range.inline&&this._range.editor||null),s=this.selection&&this.selection.getFocusedCell(),c=I.getCellInfo(s,this._activePage,this._grid);c&&c.edited&&!a&&this.endEdit(),this._activePage=this._dataStore.getPage(i.value),this._activeSheetName={name:i.value,id:e},this._tabbar.select(e);var u=this._activePage.getMeta()&&this._activePage.getMeta();if(this._activePage&&!u.toolbarId&&this._activePage.setMeta({toolbarId:e}),a&&!this._editMode||a&&this._editMode.page!==this._activePage)this._activePage.setMeta({selectedCells:null,focusedCell:null}),this._editMode=this._editMode||{page:n,cell:s,pageName:r};else if(a&&this._editMode&&this._editMode.page===this._activePage){var d=this._editLine.getValue();this._editMode=null,this._editLine.setValue(d),l.awaitRedraw().then((function(){t._editLine.focus(),t.events.fire(F.SpreadsheetEvents.editLineInput,[d]),t._editLine.setCursor(a);}));}else this._editLine.setCellMath(),this._editMode=null;(null==n?void 0:n.getMeta().filter)!==u.filter&&this._filterForm.applyFilter(this._activePage),this.events.fire(F.SpreadsheetEvents.afterSheetChange,[this._activeSheetName]),this._grid.paint(),l.awaitRedraw().then((function(){t._updateGridSizes(),t._updateGridState(),t.selection.getSelectedCell()||t._editMode||t.selection.setSelectedCell("A1"),U.focusManager.setFocusId(t._uid);}));}},t.prototype._callAction=function(e){var t={dataStore:this._dataStore,page:this._activePage,cell:this.selection.getFocusedCell()};if(e&&!this.config.readonly)if(Array.isArray(e))this._actionsManager.execute(e);else {var i=e.page||this._activePage,n=e.cell;if(null==n?void 0:n.includes("!")){var o=n.split("!");if(n=o[1],!(i=this._dataStore.getPage(o[0])))return}(e=r(r({},e),{cell:n,page:i})).dataStore=this._dataStore,I.isRangeId(e.cell)&&e.groupAction?this._actionsManager.execute(e.groupAction,r(r({},t),e)):this._actionsManager.execute(e.action,r(r({},t),e));}},t.prototype._initLayout=function(){this._grid=new f.Grid(null,{rowHeight:32,headerRowHeight:32,headerSort:!1,tooltip:!1,leftSplit:1+(this.config.leftSplit||0),topSplit:this.config.topSplit||0}),this.menu=new g.Menu(null,{navigationType:"click"}),this.menu.data.parse(y.getMenuStruct(this.config)),this.toolbar=new v.Toolbar;var e=b.getToolbarStruct(this.config.toolbarBlocks,this.config);this.toolbar.data.parse(e),this.contextMenu=new g.ContextMenu,this.contextMenu.data.parse(m.getContextMenuStruct()),this.sheetContextMenu=new g.ContextMenu,this.sheetContextMenu.data.parse(m.getSheetsContextMenuStruct(this.config.multiSheets)),this._tabbar=new v.Toolbar(null,{css:"dhx-sheets-toolbar"}),this._sheets=this._tabbar.data,this._sheets.parse([{value:"sheet1"}]),this._dataStore=j.initMathStore(this._sheets),this._math=this._dataStore.getStore(),this._editLine=new w.EditLine(null,{events:this.events,grid:this._grid,store:this._activePage,spreadsheet:this,math:this._math}),this.config.multiSheets&&!this.config.readonly&&this._sheets.add({icon:"dxi dxi-plus",id:"add-sheet"},0);var t=this._layout=new p.Layout(null,{height:"100%",rows:[{id:"menu",css:"menu_wrapper",height:"content"},{id:"toolbar",css:"toolbar_wrapper",height:"content"},{id:"editLine",css:"editLine_wrapper",height:"content"},{id:"grid",css:"dhx-spreadsheet-grid dhx_layout-cell--gravity"},{id:"tabbar",css:"sheetbar_wrapper",height:"content"}]});t.getCell("menu").attach(this.menu,this),t.getCell("toolbar").attach(this.toolbar,this),t.getCell("grid").attach(this._grid,this),t.getCell("editLine").attach(this._editLine,this),t.getCell("tabbar").attach(this._tabbar,this);var i=this.config.multiSheets&&!this.config.readonly?1:0;this._dataStore.getPage(this._sheets.getItem(this._sheets.getId(i)).value).setMeta({leftSplit:this.config.leftSplit}),this._changeSheet(this._sheets.getId(i)),this.config.editLine&&!this.config.readonly||t.getCell("editLine").hide(),this.config.menu&&!this.config.readonly||t.getCell("menu").hide(),!this.config.readonly&&e&&e.length||t.getCell("toolbar").hide(),this.config.multiSheets||t.getCell("tabbar").hide();},t.prototype._generateGridStruct=function(){for(var e=this,t=this.serialize(),i=this.config,n=i.rowsCount,o=i.colsCount,s=[],c=1;c<=n;c++){for(var u={id:""+c,$index:c},d=1;d<=o;d++)u[d]="";s.push(u);}var h,f=[{id:"$index",width:40,header:[{text:""}],htmlEnable:!0,editable:!1,align:"right",template:function(e,t){return x.getIndexRowCell(t.$index)}}],p=!1,v=function(t){var i=t.el;e._range.editor=i,e._range.inline=1,i.focus(),i.setSelectionRange(i.value.length,i.value.length),e._range.cursor=i.value.length,i.addEventListener("blur",(function(t){e._range.cursor=i.selectionStart,function(t){requestAnimationFrame((function(){p&&setTimeout((function(){e._restoreFocus(t);}));}));}(t);})),i.addEventListener("focus",(function(){e._range.inline=1;})),p=!0;},g=function(){e._range.editor=null,p=!1;},_=function(t,i){p&&e.events.fire(F.SpreadsheetEvents.cellInput,[t,i.target.value]);};this.events.on(F.SpreadsheetEvents.gridRedraw,(function(){h=null;}));var m=function(t,i,n){var o,s;h||(h=e.selection.getFocusedCell());var c=n.$letter+i.$index,u=I.getCellIds(c,e._grid),d=e._activePage.getCell(u.row,u.col)||{},f=e._activePage.getMeta().filter,p=!1,m=!1;if(f){var y=f.cell,b=f.rules,w=I.getCellIds(y,e._grid),x=w.start,E=w.end;if(x.row===u.row&&u.col>=x.col&&u.col<=E.col){var C=I.getCellNameById(e._grid,x.row+1,E.col+1);p=!0;var k=b[I.getCellsArray(y.split(":")[0]+":"+C,e._grid).indexOf(c)]||{},M=k.condition,P=k.exclude;m=!(!M&&!P);}}var O=d,A=O.locked,F=O.edited,V=O.nextValue,R=O.editor,L=O.css,H=O.format,N=O.link,j=e._activePage.getValue(u.row,u.col,"@"===(null==H?void 0:H.mask)),$=F&&T.isDefined(V)?V:j;if(h&&F){var z=null==H?void 0:H.id;if((null==z?void 0:z.includes("date"))&&!e._editors[z]&&(e._editors[z]=new D.DateEditor(e.endEdit.bind(e),G.getDHXDateFormat(null==H?void 0:H.mask),e.events)),(null==z?void 0:z.includes("time"))&&!e._editors[z]&&(e._editors[z]=new X.TimeEditor(e.endEdit.bind(e),G.getDHXDateFormat(null==H?void 0:H.mask),e.events)),"select"===(null==R?void 0:R.type)){e._editors.select||(e._editors.select=new Y.SelectEditor(e.endEdit.bind(e),e.events));var B=R.options;e._editors.select.setValue("string"==typeof B?e.getValue(B.replace(/=|\$/g,"")):B);}var W={oninput:[_,c],_hooks:{didInsert:v.bind(e),didRemove:g.bind(e)},class:L,_key:"selection_input","data-dhx-id":"cell_input",value:null==V?H?S.getFormattedValue($,H):$:V};return e._editors[z]?e._editors[z].toHTML(r(r({},W),{format:H})):"select"===(null===(o=d.editor)||void 0===o?void 0:o.type)?e._editors.select.toHTML(W):l.el("input.dhx_cell_input",W)}var U=[],q=!R||e._checkValidation(c);if(N&&!N.text){var K=N.href;(""+$).split(" ").forEach((function(e){e===K?(U.push(l.el("span",{class:L||""},[K])),U.push(" ")):U.push(e+" ");}));}else if(N){var J=N.text,Z=N.href,Q=J||Z;U.push(l.el("span.dhx_spreadsheet_link",{class:L},[H?S.getFormattedValue(Q,H):Q]));}else U.push(H?S.getFormattedValue($,H):$);return l.el(".dhx_spreadsheet_cell",{class:L},a([A&&l.el(".dhx_lock_icon.dxi.dxi-key")],U,["select"===(null===(s=d.editor)||void 0===s?void 0:s.type)?[l.el(".dxi.dxi-menu-down.dhx_spreadsheet_cell_icon.drop-down",{onclick:function(){return e.startEdit(c)}}),l.el(".dhx_spreadsheet_cell-placeholder")]:null,p&&[l.el(".dxi.dxi-filter-variant.dhx_spreadsheet_cell_icon.filter"+(m?"-filtered":""),{onclick:function(t){return e._showFilter(c,t)},ondblclick:function(t){return e._showFilter(c,t)}}),l.el(".dhx_spreadsheet_cell-placeholder")],!q&&l.el(".dhx_spreadsheet_cell-not_valid")]))};for(c=1;c<=o;c++){var y=I.getLetterFromNumber(c);f.push({id:""+c,width:120,$letter:y,type:"string",header:[{text:x.getHeaderCell(y,c,!this.config.readonly),align:"center"}],htmlEnable:!0,template:m});}this._grid.setColumns(f),this._grid.data.parse(s),this.parse(t),this._sizes.rowsCount=this.config.rowsCount,this._sizes.colsCount=this.config.colsCount;},t.prototype._checkForMissedCells=function(e){e.includes("!")&&(e=e.split("!")[1]);var t=I.isRangeId(e)?I.getRangeIndexes(e,this._grid).end:I.getCellIndex(e,this._grid);(t.row>this.config.rowsCount||t.col>this.config.colsCount)&&(this.config.rowsCount=Math.max(this.config.rowsCount,t.row+1),this.config.colsCount=Math.max(this.config.colsCount,t.col),this._generateGridStruct());},t.prototype._generateNewSheetName=function(){var e=this._sheets.findAll((function(e){return e.value&&e.value.startsWith("sheet")}));return e.length?(e=e.map((function(e){return +e.value.split("sheet")[1]})).filter((function(e){return !!e})),"sheet"+(Math.max.apply(Math,e)+1)):"sheet1"},t.prototype._updateGridSizes=function(){var e=this._activePage.getSize(),t=e[0],i=e[1],n=this._grid.config.columns,o=this._grid.data.getLength(),a=this._activePage.getMeta(),s=a.cols,l=a.rows,c=this._grid.config.rowHeight,u=this._grid.data.getInitialData();if(i!==n.length||s.length!==i||t!==o||l!==o){for(;l.length<t;)l.push({height:c});for(var d=[],h=0;h<l.length;h++){for(var f=r(r({},u[h]),{id:""+(h+1),$index:h+1,height:l[h].height||c}),p=0;p<=i;p++)f[p]="";d.push(f);}for(;s.length<i;)s.push({width:120});var v=n[0],g=(n.slice(1),[v]),_=n[n.length-1];for(h=0;h<s.length;h++){var m=I.getLetterFromNumber(g.length);g.push({id:""+g.length,width:s[h].width||120,$letter:m,type:"string",header:[{text:x.getHeaderCell(m,g.length,!this.config.readonly),align:"center"}],htmlEnable:!0,template:_.template});}this._grid.setColumns(g),this._grid.data.parse(d);var y=this.selection.getFocusedCell();if(y){var b=I.getCellIds(y,this._grid),w=b.col,E=(f=b.row)>l.length-1,C=w>s.length-1;if(C||E){var S=I.getCellNameById(this._grid,E?l.length:f+1,C?s.length:w+1);this.selection.setSelectedCell(S);}}}},t.prototype._updateGridState=function(){var e=this;this._grid.config.spans=[];var t=this._activePage.getMeta(),i=t.scroll,n=void 0===i?{x:0,y:0}:i,o=t.cols,s=t.rows,l=t.merged,c=void 0===l?[]:l,u=this._grid.config.columns,d=u[0],h=u.slice(1),f=n.x,p=n.y;this._grid.scroll(f,p),h.forEach((function(e,t){e.width=o[t]?o[t].width:e.width;})),this._grid.setColumns(a([d],h)),this._grid.data.forEach((function(t,i){if(s[i]){var n=s[i].height;t.height!==n&&e._grid.data.update(t.id,{height:n});}})),this._grid.config.spans=c.map((function(t){var i=t.from,n=t.to,o=i.row,a=i.column,s=+n.row-+o+1,l=+n.column-+a+1;return ie.normalizeSpan({row:+o+1,column:+a+1,rowspan:s>1?s:void 0,colspan:l>1?l:void 0},r({},e._grid.config))})),this.selection._removeHeadersCss(),this.selection._setHeadersCss();},t.prototype._updateToolbar=function(e){e===this.selection.getFocusedCell()&&M.updateToolbar(this.toolbar,this.menu,this._activePage,this._grid);},t.prototype._setEventsHandlers=function(){var e=this;this.events.on(F.SpreadsheetEvents.editLineInput,(function(t){U.focusManager.setFocusId(e._uid);var i=e.selection.getFocusedCell();e.events.fire(F.SpreadsheetEvents.cellInput,[i,t]);})),this.events.on(F.SpreadsheetEvents.editLineFocus,(function(){var t=e.selection.getFocusedCell();e.startEdit(t),e._range.inline=0,requestAnimationFrame((function(){e._editLine.focus();}));})),this.events.on(F.SpreadsheetEvents.cellInput,(function(t,i){if(!e.isLocked(t)){var n=I.getCellIds(t,e._grid),o=n.row,r=n.col;e._activePage.setCell(o,r,{nextValue:i}),e._grid.paint();}})),this._grid.events.on(f.GridEvents.cellMouseDown,(function(){e.contextMenu._close(),e.sheetContextMenu._close();})),this._grid.events.on(f.GridEvents.scroll,(function(){e._linkForm.hideInfo();})),this.events.on(F.SpreadsheetEvents.afterPopupHide,(function(){U.focusManager.setFocusId(e._uid);})),this.events.on(F.SpreadsheetEvents.afterAction,(function(t,i){var n;switch(t){case F.Actions.resizeRow:var o=e._grid.data.map((function(t){return {height:t.$height||e._grid.config.rowHeight,changedByUser:t.changedByUser}}));e._activePage.setMeta({rows:o});break;case F.Actions.resizeCol:var r=e._grid.config.columns.slice(1).map((function(e){return {width:e.width}}));e._activePage.setMeta({cols:r});break;case F.Actions.insertLink:e.selection.setFocusedCell(e.selection.getFocusedCell());break;case F.Actions.filter:case F.Actions.merge:case F.Actions.unmerge:e._updateToolbar(e.selection.getFocusedCell());break;case F.Actions.sortCells:e._activePage.getMeta().filter&&(null===(n=e._filterForm)||void 0===n||n.applyFilter(e._activePage));}l.awaitRedraw().then((function(){e.selection.setSelectedCell(e.selection.getSelectedCell());}));})),this.events.on(F.SpreadsheetEvents.beforeAction,(function(t,i){var n=e._grid.getScrollState();switch(e._activePage.setMeta({scroll:n}),t){case F.Actions.sortCells:return e._spanControl.checkBeforeAction(i.cell,e._activePage,O.default.sort);case F.Actions.filter:return e._spanControl.checkBeforeAction(i.cell,e._activePage,O.default.filter);default:return !0}})),this.events.on(F.SpreadsheetEvents.beforeSelectionSet,(function(t){var i=e._range;if(i.mode)return !0;var n=e._editLine.isCellExpected(t,!1,i.inline&&i.editor||null);return n>0?(i.cursor=n,i.cell=e.selection.getFocusedCell(),i.mode=1,!0):!e.config.readonly&&(e._linkForm.hide(),e._linkForm.hideInfo(),void(!e._editMode&&e.endEdit()))})),this.events.on(F.SpreadsheetEvents.afterSelectionSet,(function(t){var i,n=e._range;!n.mode&&e._editMode&&e._editLine.setCellMath(),1===n.mode&&(n.mode=2,!e._editMode&&e.selection.setSelectedCell(n.cell),n.mode=0,n.cursor=e._editLine.isCellExpected(t,!0,n.inline?n.editor:null,n.cell),n.cell=""),e._grid.paint();var o=I.getCellIds(t,e._grid),r=o.row,a=o.col,s=e._activePage.getCell(r,a)||{},c=s.link;if((null==c?void 0:c.href)&&l.awaitRedraw().then((function(){var i;e._contextMenuVisible||(null===(i=e._linkForm)||void 0===i?void 0:i.isVisible())||e._linkForm.showInfo(t,s);})),!e._checkValidation(t)){if(I.isRangeId(t))return;var u=I.getCellIds(t,e._grid),d=u.row,h=u.col,f=null===(i=e.getRootNode())||void 0===i?void 0:i.querySelector('[aria-rowindex = "'+(d+1)+'"].dhx_grid-row [aria-colindex = "'+(h+2)+'"]');new Z.tooltip("Invalid value",{node:f,position:Z.Position.right,force:!0,margin:2,css:"dhx_spreadsheet-invalid-tooltip"});}})),this.events.on(F.SpreadsheetEvents.afterFocusSet,(function(t){if(!e._range.mode&&!e._editMode){var i=I.getCellIds(t,e._grid),n=i.row,o=i.col,r=e._activePage.getValue(n,o,!0);S.isNumeric(r)||r||(r="");var a=I.getCellInfo(t,e._activePage,e._grid);M.updateToolbar(e.toolbar,e.menu,e._activePage,e._grid),e._editLine.setValue(S.getFormattedValue(r,a.format)),a&&a.locked&&e._editLine.lock(),e._grid.paint();}})),this.events.on(F.SpreadsheetEvents.afterStyleChange,(function(t){e._updateToolbar(t);})),this.events.on(F.SpreadsheetEvents.afterFormatChange,(function(t){e._updateToolbar(t);})),this.events.on(F.SpreadsheetEvents.afterEditStart,(function(){e._grid.paint();})),this.events.on(F.SpreadsheetEvents.afterEditEnd,(function(t){var i;e._grid.paint();var n=I.getCellInfo(t,e._activePage,e._grid).format;null===(i=e._editors[null==n?void 0:n.id])||void 0===i||i.hidePopup();})),this._tabbar.events.on(R.NavigationBarEvents.click,(function(t){"add-sheet"===t?e.addSheet():e._changeSheet(t);})),this.sheetContextMenu.events.on(R.NavigationBarEvents.click,(function(t){if("delete"===t)e.removeSheet(e._focusedSheet);else {var i=e._tabbar.data.getItem(e._focusedSheet);e._tabbar.data.update(i.id,{type:"input"}),l.awaitRedraw().then((function(){var t=e._tabbar.getRootNode().querySelector("input");t.focus(),t.onkeyup=function(n){"Enter"===n.key&&t.blur(),"Escape"===n.key&&e._sheets.update(i.id,{type:"navItem",value:i.prevValue});};}));}})),this.sheetContextMenu.events.on(R.NavigationBarEvents.afterHide,(function(){e._focusedSheet=null;})),this._tabbar.events.on(R.NavigationBarEvents.inputFocus,(function(t){var i=e._sheets.getItem(t);e._sheets.update(t,{prevValue:i.value});})),this._tabbar.events.on(R.NavigationBarEvents.inputBlur,(function(t){var i=e._sheets.getItem(t),n=i.value;if(e._sheets.find((function(e){return e.value===n&&e.id!==i.id}))){e._getErrorWindow();var o=O.default.renameSheetAlert.split("$name"),r=o[0],a=o[1];return e._errorAlert.attachHTML("<p>"+r+"<b>"+n+"</b>"+a+"</p>"),e._errorAlert.show(),e._errorAlert.footer.events.on(R.NavigationBarEvents.click,(function(){return e._errorAlert.hide()})),e._errorAlert.events.on(z.WindowEvents.afterHide,(function(){e._sheets.update(i.id,{value:i.prevValue}),e._tabbar.getRootNode().querySelector("input").focus();})),!1}e._sheets.update(t,{type:"navItem",value:i.prevValue}),e._renameSheet(t,n);})),this.toolbar.events.on(R.NavigationBarEvents.click,(function(t,i){"format"!==t&&"valign"!==t&&"halign"!==t&&"multiline"!==t&&(e.endEdit(),e._handleAction(t,i));})),this.contextMenu.events.on(R.NavigationBarEvents.click,(function(t,i){e.endEdit(),e._handleAction(t,i);})),this.contextMenu.events.on(R.NavigationBarEvents.afterHide,(function(){e._contextMenuVisible=!1,e.contextMenu.hide("fit-col"),e.contextMenu.show("link");})),this._grid.events.on(f.GridEvents.headerCellMouseDown,(function(t,i){if(i.target.className.includes("dhx_header_icon"))return e.contextMenu.show("fit-col"),e.contextMenu.hide("link"),void e.contextMenu.showAt(i)})),this.menu.events.on(R.NavigationBarEvents.click,(function(t,i){"format"!==t&&"valign"!==t&&"halign"!==t&&(e.endEdit(),e._handleAction(t,i));})),this._colorpicker.events.on(s.ColorpickerEvents.change,(function(t){var i;e._colorpickerPopup.hide();var n=e.selection.getSelectedCell();e._silencedColorChange||e.setStyle(n,((i={})[e._colorpickerTarget]=t,i)),e._silencedColorChange=!1,requestAnimationFrame((function(){U.focusManager.setFocusId(e._uid),e._activeInput&&(e._activeInput.focus(),e._activeInput=null);}));})),this.events.on(F.SpreadsheetEvents.editLineBlur,(function(t,i){e._restoreFocus(i);})),this.events.on(F.SpreadsheetEvents.groupFill,(function(t,i){e._fillCells(t,i);}));},t.prototype._getErrorWindow=function(){return this._errorAlert||(this._errorAlert=new B.Window({footer:!0,modal:!0,closable:!0,width:350,height:240,title:O.default.alertTitle}),this._errorAlert.footer.data.parse([{type:"button",view:"flat",size:"medium",color:"primary",value:O.default.ok,id:"ok"}])),this._errorAlert},t.prototype._handleAction=function(e,t){var i,n=this.selection.getSelectedCell(),o=this.selection.getFocusedCell(),a="";-1!==T.findIndex(this.config.formats,(function(t){return t.id===e}))&&(a=e,e="format");var s="",l="",c="";if((""+e).includes("align")){var d=(""+e).split("-");e=d[0],s=d[1];}if((""+e).endsWith("sort")){d=(""+e).split("-");e=d[1],l=d[0];}if((""+e).includes("multiline")){d=(""+e).split("-");e=d[0],c=d[1];}switch(e){case"undo":this._actionsManager.undo();break;case"redo":this._actionsManager.redo();break;case"color":case"background":this._colorpickerTarget=e;var h=I.getCellInfo(n,this._activePage,this._grid),f=I.getStylesObject(h.css)[e]||{background:"#FFFFFF",color:"#4C4C4C"}[e];this._silencedColorChange=!0,this._colorpicker.setValue("white"===f?"#FFFFFF":T.rgbToHex(f));var p=u.locateNode(t,"data-dhx-id");this._colorpickerPopup.show(p);break;case"halign":this.setStyle(n,{"text-align":s});break;case"valign":this.setStyle(n,{"vertical-align":s});break;case"multiline":this.setStyle(n,{multiline:c});break;case"font-weight-bold":case"font-style-italic":case"text-decoration-line-through":case"text-decoration-underline":if(!n)return;for(var v=e.includes("line-through")?["text-decoration","line-through"]:e.split("-"),g=v.pop(),_=v.join("-"),m=0,y=n.split(",");m<y.length;m++){var b=y[m];g=M.getToggledValue(this._activePage,b,_,g,this._grid),this.setStyle(b,r(r({},this.getStyle(b)),((i={})[_]=g,i)));}break;case"clear-value":this.setValue(n,"");break;case"clear-styles":this.setStyle(n,{});break;case"clear-all":if(!n)return;this._callAction([{cell:n,action:F.Actions.setCellStyle,groupAction:I.isRangeId(n)?F.Actions.groupAction:null,val:"",dataStore:this._dataStore,page:this._activePage},{cell:n,action:F.Actions.setCellValue,groupAction:I.isRangeId(n)?F.Actions.groupAction:null,val:"",page:this._activePage,dataStore:this._dataStore},{cell:n,action:F.Actions.setValidation,groupAction:I.isRangeId(n)?F.Actions.groupAction:null,val:null,page:this._activePage,dataStore:this._dataStore}]);break;case"lock":if(!n)return;for(var w=0,x=n.split(",");w<x.length;w++){b=x[w];this.isLocked(b)?this.unlock(b):this.lock(b);}break;case"remove-row":this.deleteRow(o);break;case"add-row":this.addRow(o);break;case"remove-col":this.deleteColumn(o);break;case"add-col":this.addColumn(o);break;case"fit-col":this.fitColumn(n.split(":")[0]);break;case"help":window.open("https://docs.dhtmlx.com/spreadsheet/user_guide.html");break;case"format":this.setFormat(n,a),this.paint();break;case"export-xlsx":this.export.xlsx();break;case"import-xlsx":this.load("","xlsx");break;case"validation":this._validationForm||(this._validationForm=new K.ValidationForm(this.events,this.setValidation.bind(this),this._grid)),this._validationForm.show(n,I.getCellInfo(n,this._activePage,this._grid));break;case"sort":this.sortCells(n,"asc"===l?1:-1);break;case"search":this.search("",!0);break;case"link":this._contextMenuVisible=!1,this._showLinkPopup(o);break;case"filter":var E=this._activePage.getMeta().filter;this.setFilter(n,E?null:[]);break;case"merge":this.mergeCells(n,this.toolbar.data.getItem("merge").active);}},t.prototype._parseCell=function(e){var t=this._activePage,i=e;if(e.includes("!")){var n=e.split("!");i=n[1],t=this._dataStore.getPage(n[0]);}return {cleanCell:i,page:t}},t.prototype._fillCells=function(e,t){var i=this,n=[e],o=[t];if(I.isRangeId(e)){var s=k.getCellsDiff(e.split(":")[1],t.split(":")[1],this._grid).isLargerByX?"row":"col";n=I.getRangeMatrix(e,this._grid,s).map((function(e){return e.length>1?e[0]+":"+e[e.length-1]:e[0]})),o=I.getRangeMatrix(t,this._grid,s).map((function(e){return e.length>1?e[0]+":"+e[e.length-1]:e[0]}));}var l=this._activePage.getMeta().merged,c=[],u=[],d=n.reduce((function(e,t,n){var a,s,d=o[n];if(I.isRangeId(t))s=[],i.eachCell((function(e){var t,n=I.getCellIds(e,i._grid),o=n.row,a=n.col;if(!(null===(t=i._grid)||void 0===t?void 0:t.isRowHidden(o+1))){var c=r({},i._activePage.getCell(o,a)),u=i._activePage.getValue(o,a,!0);c.value=!T.isDefined(u)||I.doesContainUrl(u)?"":u;var d=I.isCellSpaned(e,l);d&&d.from.row===o&&d.from.column===a&&(c.span=I.isCellSpaned(e,l)),s.push(c);}}),t);else {var h=t,f=I.getCellIds(h,i._grid),p=r({},i._activePage.getCell(f.row,f.col)),v=i._activePage.getValue(f.row,f.col,!0);p.value=G.getExcelDateFromString(v,p.format)||"";var g=null===(a=p.format)||void 0===a?void 0:a.id,_=I.isCellSpaned(h,l);s=g.includes("date")||g.includes("time")||_?[p]:I.doesContainUrl(v)?"":v,_&&_.from.row===f.row&&_.from.column===f.col&&(p.span=I.isCellSpaned(h,l));}if(Array.isArray(s)){if(t===d)return e;var m=k.getAutoFilledCells(s,t,d,i._math,i._grid);d=m.cells,s=m.value,c.push.apply(c,m.spans);}var y=i.getStyle(t,!1),b=i.getFormat(t),w=[],x=[];if(i.eachCell((function(e){var t=I.getCellInfo(e,i._activePage,i._grid),n=t.editor,o=t.link;w.push(null==n?void 0:n.options),x.push(o||null);}),t),i.eachCell((function(e){u.push({cell:e,action:F.Actions.unmerge,groupAction:F.Actions.unmerge,page:i._activePage});}),d),e.push({cell:d,action:F.Actions.setCellFormat,groupAction:I.isRangeId(d)?F.Actions.groupAction:null,val:b,page:i._activePage},{cell:d,action:F.Actions.setCellStyle,groupAction:I.isRangeId(d)?F.Actions.groupAction:null,val:y,page:i._activePage,replace:!0},{cell:d,action:F.Actions.setValidation,groupAction:F.Actions.groupAction,val:w,page:i._activePage}),"string"==typeof s&&s.startsWith("=")){var E=I.getCellIds(t,i._grid);i.eachCell((function(t){var n=I.getCellIds(t,i._grid),o=i._math.transposeMath(s,n.row-E.row,n.col-E.col);e.push({cell:t,action:F.Actions.setCellValue,groupAction:null,val:o,page:i._activePage});}),d);}else e.push({cell:d,action:F.Actions.setCellValue,groupAction:I.isRangeId(d)?F.Actions.groupAction:null,val:s,page:i._activePage});return e.push({cell:d,action:F.Actions.insertLink,groupAction:F.Actions.groupAction,val:x,page:i._activePage}),e}),[]),h=[];c.forEach((function(e){h.push({cell:e,action:F.Actions.merge,groupAction:F.Actions.merge,page:i._activePage,$autofill:!0});})),this._callAction(a(u,d,h));},t.prototype._restoreFocus=function(e){var t,i,n=this,o=this._editLine.getRootView().node,r=o&&o.el,a=this._range.cell||this.selection.getFocusedCell(),s=I.getCellIds(a,this._grid).col<=this.config.leftSplit;if(!a||I.getCellInfo(a,this._activePage,this._grid).edited&&!s){var l=U.focusManager.getFocusId();if(l!==this._uid&&l!==this._grid._uid&&(null===(t=this._editLine._suggest)||void 0===t?void 0:t.isVisible())&&l!==(null===(i=this._editLine._suggest._list)||void 0===i?void 0:i._uid)&&l!==this._tabbar._uid)return this._colorpickerTarget?void(this._activeInput=e.target):void this.endEdit();var c=e.target,u=e.relatedTarget;if(!(r&&r.contains(u)||r&&r.contains(c)&&u&&"cell_input"===u.getAttribute("data-dhx-id")||"cell_input"===(null==u?void 0:u.getAttribute("data-dhx-id"))&&"cell_input"===c.getAttribute("data-dhx-id"))){var d=c;d.focus(),setTimeout((function(){var e=n._range.cursor||d.value.length;d.selectionStart>e&&d.setSelectionRange(e,e);}),100);}}},t.prototype._initHotkeys=function(){var e=this;if(!this.config.readonly){this.keyManager=new P.KeyManager((function(t,i){return i===e._uid||i===e._grid._uid||i===e.toolbar._uid}));var t=W.getKeysHandlers(this,this._grid,this._buffer,this._editLine);for(var i in t)this.keyManager.addHotKey(i,t[i]);for(var i in this.config.hotkeys)this.keyManager.addHotKey(i,this.config.hotkeys[i]);}},t.prototype._render=function(){return l.el(".dhx_widget.dhx-spreadsheet",{dhx_widget_id:this._uid,_key:this._uid},[l.inject(this._layout.getRootView())])},t}(d.View);t.Spreadsheet=ne;},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);}),r=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var a=i(0),s=i(4),l=i(3),c=i(7),u=i(1),d=i(51),h=i(65),f=i(52),p=i(66),v=i(63),g=i(16),_=i(127),m=i(128),y=i(20),b=i(17),w=i(1),x=function(e){function t(t,i){var n=e.call(this,t,i)||this;n._setPaletteGrip=function(e){var t=n.getRootView().refs.picker_palette.el.getBoundingClientRect(),i=e.targetTouches?e.targetTouches[0].clientX:e.clientX,o=(e.targetTouches?e.targetTouches[0].clientY:e.clientY)-t.top,r=i-t.left,a=m.calculatePaletteGrip(t,o,r),s=a.s,l=a.v;n._pickerState.hsv.s=s,n._pickerState.hsv.v=l,n.paint();},n._setRangeGrip=function(e){var t=n.getRootView().refs.hue_range.el.getBoundingClientRect(),i=(e.targetTouches?e.targetTouches[0].clientX:e.clientX)-t.left,o=m.calculateRangeGrip(t,i),r=o.h,a=o.rangeLeft;n._pickerState.hsv.h=r,n._pickerState.rangeLeft=a,n.paint();},n._onColorClick=function(e,t){n._selected=t.data.color.toUpperCase(),n.events.fire(p.ColorpickerEvents.change,[n._selected]),n.events.fire(p.ColorpickerEvents.colorChange,[n._selected]);},n._container=t,n.config=u.extend({css:"",grayShades:!0,pickerOnly:!1,paletteOnly:!1,customColors:[],palette:h.palette,width:"238px",mode:"palette"},n.config),n.config.palette||(n.config.palette=h.palette),n.config.customColors&&(n.config.customColors=n.config.customColors.map((function(e){return e.toUpperCase()}))),n._pickerState={hsv:{h:0,s:1,v:1},customHex:""},n.events=new s.EventSystem(n),n._setHandlers(),n._keyManager=new y.KeyManager((function(e,t){return t===n._uid})),n._initHotKey();var o=a.create({render:function(){return n._getContent()}});return n.mount(n._container,o),n}return o(t,e),t.prototype.destructor=function(){this.events&&this.events.clear(),this.config=this.events=this._selected=this._handlers=this._pickerState=this._inputTimeout=null,this.unmount();},t.prototype.clear=function(){this._selected="",this.events.fire(p.ColorpickerEvents.change,[this._selected]),this.paint();},t.prototype.setValue=function(e){(this._focusColor(e)||b.focusManager.getFocusId()===this._uid)&&(this.paint(),this.events.fire(p.ColorpickerEvents.change,[this._selected]),this.events.fire(p.ColorpickerEvents.colorChange,[this._selected]));},t.prototype.setFocus=function(e){this._focusColor(e)&&this.paint();},t.prototype.getValue=function(){return this._selected||""},t.prototype.getCustomColors=function(){return this.config.customColors},t.prototype.setCustomColors=function(e){this.config.customColors=e.map((function(e){return e.toUpperCase()})),this.paint();},t.prototype.setCurrentMode=function(e){"palette"!==e&&"picker"!==e||(this.config.mode=e,this.events.fire(p.ColorpickerEvents.modeChange,[e]),this.events.fire(p.ColorpickerEvents.viewChange,[e]),this.paint());},t.prototype.getCurrentMode=function(){return this.config.mode},t.prototype.getView=function(){return this.getCurrentMode()},t.prototype.setView=function(e){this.setCurrentMode(e);},t.prototype.focusValue=function(e){this.setFocus(e);},t.prototype._setHandlers=function(){var e=this;this._handlers={click:{".dhx_palette__cell":this._onColorClick},mousedown:function(t){e._pickerMove(t);},touchstart:function(t){e._pickerMove(t);},buttonsClick:function(t){e.setCurrentMode("palette"),"cancel"!==t?"apply"!==t||e.config.customColors.includes(e._pickerState.background)||(e.setValue(e._pickerState.background),e.events.fire(p.ColorpickerEvents.apply,[]),e.events.fire(p.ColorpickerEvents.selectClick,[])):e.events.fire(p.ColorpickerEvents.cancelClick,[]);},customColorClick:function(){e.setView("picker");},oninput:function(t){e._inputTimeout&&clearTimeout(e._inputTimeout),e._inputTimeout=setTimeout((function(){var i=t.target.value;-1===i.indexOf("#")&&(i="#"+i),e._pickerState.customHex=i,d.isHex(i)&&(e._pickerState.hsv=d.HexToHSV(i),e.paint());}),100);},contextmenu:{".dhx_palette__cell":function(t,i){t.preventDefault();var n=e.config.customColors.indexOf(i.data.color);-1!==n&&e._removeCustomColor(n),e.paint();}},mouseover:{".dhx_palette__cell":function(e){e.target&&v.tooltip(f.default.rightClickToDelete,{node:e.target,position:g.Position.bottom});},".dhx_colorpicker-custom-colors__picker":function(e){e.target&&v.tooltip(f.default.addNewColor,{node:e.target,position:g.Position.bottom});}}},this.events.on(p.ColorpickerEvents.change,(function(){e.paint();})),this.events.on(p.ColorpickerEvents.colorChange,(function(){e.paint();}));},t.prototype._pickerMove=function(e){var t=l.locate(e);this._pickerState.customHex="","picker_palette"===t?this._setPaletteGrip(e):this._setRangeGrip(e);var i="picker_palette"===t?this._setPaletteGrip:this._setRangeGrip,n=e.targetTouches?"touchmove":"mousemove",o=e.targetTouches?"touchend":"mouseup";document.addEventListener(n,i),document.addEventListener(o,(function(){document.removeEventListener(n,i);})),this.paint();},t.prototype._focusColor=function(e){if(void 0===e||e.length<4)return !1;var t=e.toUpperCase();if(!d.isHex(t))return !1;var i=this.config.palette.reduce((function(e,i){return e||(i.forEach((function(i){i.toUpperCase()!==t||(e=!0);})),e)}),!1),n=h.grayShades.includes(t);if(!i&&!n){var o=this.getCustomColors();o.includes(t.toUpperCase())||o.push(t.toUpperCase());}return this._selected=t||null,this._pickerState.hsv=d.HexToHSV(t),!0},t.prototype._removeCustomColor=function(e){this.config.customColors.splice(e,1);},t.prototype._getCells=function(e,t){var i=this;return void 0===t&&(t=""),e.reduce((function(e,n){var o=(i._selected||"").toUpperCase()===n.toUpperCase()?"dhx_palette__cell--selected":"";return e.push(a.el(".dhx_palette__cell",{class:o+" "+t,_data:{color:n},style:"background:"+n,tabindex:0})),e}),[])},t.prototype._getGrayShades=function(){return a.el(".dhx_palette__row",this._getCells(h.grayShades))},t.prototype._getPalette=function(){var e=this;return this.config.palette.reduce((function(t,i){return t.push(a.el(".dhx_palette__col",e._getCells(i))),t}),[])},t.prototype._getContent=function(){var e;return e=this.config.pickerOnly?[_.getPicker(this,this._pickerState,this._handlers)]:"palette"===this.config.mode?r([this.config.grayShades&&this._getGrayShades()],this._getPalette(),[!this.config.paletteOnly&&a.el(".dhx_colorpicker-custom-colors",{onmouseover:this._handlers.mouseover},[a.el(".dhx_colorpicker-custom-colors__header",[f.default.customColors]),a.el(".dhx_palette--custom.dhx_palette__row",r(this._getCells(this.config.customColors,"dhx_custom-color__cell"),[a.el(".dhx_colorpicker-custom-colors__picker",{class:"dxi dxi-plus",onclick:this._handlers.customColorClick,onmouseover:this._handlers.mouseover,tabindex:0})]))])]):[_.getPicker(this,this._pickerState,this._handlers)],a.el(".dhx_widget.dhx_colorpicker",{class:this.config.css,style:{width:this.config.width},"data-dhx-widget-id":this._uid},[a.el(".dhx_palette",{onclick:this._handlers.click,oncontextmenu:this._handlers.contextmenu},e)])},t.prototype._initHotKey=function(){var e=this,t={enter:function(t){l.locateNodeByClassName(t,"dhx_palette__cell")&&(e._selected=w.rgbToHex(t.target.style.background),e.events.fire(p.ColorpickerEvents.change,[e._selected]),e.events.fire(p.ColorpickerEvents.colorChange,[e._selected])),l.locateNodeByClassName(t,"dhx_colorpicker-custom-colors__picker")&&e.setCurrentMode("picker");}};for(var i in t)this._keyManager.addHotKey(i,t[i]);},t}(c.View);t.Colorpicker=x;},function(e,t,i){
    	/**
    	* Copyright (c) 2017, Leon Sorokin
    	* All rights reserved. (MIT Licensed)
    	*
    	* domvm.js (DOM ViewModel)
    	* A thin, fast, dependency-free vdom view layer
    	* @preserve https://github.com/leeoniya/domvm (v3.2.6, micro build)
    	*/
    	e.exports=function(){var e=1,t=2,i=3,n=4,o=5,r="undefined"!=typeof window,a=(r?window:{}).requestAnimationFrame,s={};function l(){}var c=Array.isArray;function u(e){return null!=e}function d(e){return null!=e&&e.constructor===Object}function h(e,t,i,n){e.splice.apply(e,[i,n].concat(t));}function f(e){var t=typeof e;return "string"===t||"number"===t}function p(e){return "function"==typeof e}function v(e){return "object"==typeof e&&p(e.then)}function g(e){for(var t=arguments,i=1;i<t.length;i++)for(var n in t[i])e[n]=t[i][n];return e}function _(e,t,i){for(var n;n=t.shift();)0===t.length?e[n]=i:e[n]=e=e[n]||{};}function m(e,t){for(var i=[],n=t;n<e.length;n++)i.push(e[n]);return i}function y(e,t){for(var i in e)if(e[i]!==t[i])return !1;return !0}function b(e,t){var i=e.length;if(t.length!==i)return !1;for(var n=0;n<i;n++)if(e[n]!==t[n])return !1;return !0}function w(e){if(!a)return e;var t,i,n;function o(){t=0,e.apply(i,n);}return function(){i=this,n=arguments,t||(t=a(o));}}function x(e,t,i){return function(){return e.apply(i,t)}}function E(e){var t,i,n=e.slice(),o=[];o.push(0);for(var r=0,a=e.length;r<a;++r){var s=o[o.length-1];if(e[s]<e[r])n[r]=s,o.push(r);else {for(t=0,i=o.length-1;t<i;){var l=(t+i)/2|0;e[o[l]]<e[r]?t=l+1:i=l;}e[r]<e[o[t]]&&(t>0&&(n[r]=o[t-1]),o[t]=r);}}for(i=o[(t=o.length)-1];t-- >0;)o[t]=i,i=n[i];return o}function C(e,t){var i,n=0,o=t.length-1;if(o<=2147483647)for(;n<=o;){if(t[i=n+o>>1]===e)return i;t[i]<e?n=i+1:o=i-1;}else for(;n<=o;){if(t[i=Math.floor((n+o)/2)]===e)return i;t[i]<e?n=i+1:o=i-1;}return n==t.length?null:n}function S(e){return "o"===e[0]&&"n"===e[1]}function I(e){return "_"===e[0]}function k(e){return "style"===e}function M(e){e&&e.el&&e.el.offsetHeight;}function P(e){return null!=e.node&&null!=e.node.el}function O(e,t){switch(t){case"value":case"checked":case"selected":return !0}return !1}function A(e){for(e=e||s;null==e.vm&&e.parent;)e=e.parent;return e.vm}function D(){}var F=D.prototype={constructor:D,type:null,vm:null,key:null,ref:null,data:null,hooks:null,ns:null,el:null,tag:null,attrs:null,body:null,flags:0,_class:null,_diff:null,_dead:!1,_lis:!1,idx:null,parent:null};function V(e){var i=new D;return i.type=t,i.body=e,i}var R={},T=/\[(\w+)(?:=(\w+))?\]/g;function L(e){var t,i,n,o,r=R[e];if(null==r)for(R[e]=r={tag:(t=e.match(/^[-\w]+/))?t[0]:"div",id:(i=e.match(/#([-\w]+)/))?i[1]:null,class:(n=e.match(/\.([-\w.]+)/))?n[1].replace(/\./g," "):null,attrs:null};o=T.exec(e);)null==r.attrs&&(r.attrs={}),r.attrs[o[1]]=o[2]||"";return r}var H=1,N=2,j=4,$=8;function z(t,i,n,o){var r=new D;r.type=e,u(o)&&(r.flags=o),r.attrs=i;var a=L(t);if(r.tag=a.tag,a.id||a.class||a.attrs){var s=r.attrs||{};if(a.id&&!u(s.id)&&(s.id=a.id),a.class&&(r._class=a.class,s.class=a.class+(u(s.class)?" "+s.class:"")),a.attrs)for(var l in a.attrs)u(s[l])||(s[l]=a.attrs[l]);r.attrs=s;}var c=r.attrs;return u(c)&&(u(c._key)&&(r.key=c._key),u(c._ref)&&(r.ref=c._ref),u(c._hooks)&&(r.hooks=c._hooks),u(c._data)&&(r.data=c._data),u(c._flags)&&(r.flags=c._flags),u(r.key)||(u(r.ref)?r.key=r.ref:u(c.id)?r.key=c.id:u(c.name)&&(r.key=c.name+("radio"===c.type||"checkbox"===c.type?c.value:"")))),null!=n&&(r.body=n),r}function B(e,t,i){_(e,["refs"].concat(t.split(".")),i);}function W(e){for(;e=e.parent;)e.flags|=H;}function U(e,t,i,r){if(e.type!==o&&e.type!==n){e.parent=t,e.idx=i,e.vm=r,null!=e.ref&&B(A(e),e.ref,e);var a=e.hooks,s=r&&r.hooks;(a&&(a.willRemove||a.didRemove)||s&&(s.willUnmount||s.didUnmount))&&W(e),c(e.body)&&G(e);}}function G(e){for(var i=e.body,n=0;n<i.length;n++){var o=i[n];!1===o||null==o?i.splice(n--,1):c(o)?h(i,o,n--,1):(null==o.type&&(i[n]=o=V(""+o)),o.type===t?null==o.body||""===o.body?i.splice(n--,1):n>0&&i[n-1].type===t?(i[n-1].body+=o.body,i.splice(n--,1)):U(o,e,n,null):U(o,e,n,null));}}var q={animationIterationCount:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridColumn:!0,order:!0,lineClamp:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0};function Y(e,t){return isNaN(t)||q[e]?t:t+"px"}function X(e,t){var i=(e.attrs||s).style,n=t?(t.attrs||s).style:null;if(null==i||f(i))e.el.style.cssText=i;else {for(var o in i){var r=i[o];(null==n||null!=r&&r!==n[o])&&(e.el.style[o]=Y(o,r));}if(n)for(var a in n)null==i[a]&&(e.el.style[a]="");}}var K=[];function J(e,t,i,n,o){if(null!=e){var r=i.hooks[t];if(r){if("d"!==t[0]||"i"!==t[1]||"d"!==t[2])return r(i,n);o?M(i.parent)&&r(i,n):K.push([r,i,n]);}}}function Z(e){var t;if(K.length)for(M(e.node);t=K.shift();)t[0](t[1],t[2]);}var Q=r?document:null;function ee(e){for(;null==e._node;)e=e.parentNode;return e._node}function te(e,t){return null!=t?Q.createElementNS(t,e):Q.createElement(e)}function ie(e){return Q.createTextNode(e)}function ne(e){return Q.createComment(e)}function oe(e){return e.nextSibling}function re(e){return e.previousSibling}function ae(e){var t=e.vm,i=null!=t&&J(t.hooks,"willUnmount",t,t.data),n=J(e.hooks,"willRemove",e);if((e.flags&H)===H&&c(e.body))for(var o=0;o<e.body.length;o++)ae(e.body[o]);return i||n}function se(e,t,i){var n=t._node,o=n.vm;if(c(n.body))if((n.flags&H)===H)for(var r=0;r<n.body.length;r++)se(t,n.body[r].el);else ce(n);delete t._node,e.removeChild(t),J(n.hooks,"didRemove",n,null,i),null!=o&&(J(o.hooks,"didUnmount",o,o.data,i),o.node=null);}function le(e,t){var i=t._node;if(!i._dead){var n=ae(i);null!=n&&v(n)?(i._dead=!0,n.then(x(se,[e,t,!0]))):se(e,t);}}function ce(e){for(var t=e.body,i=0;i<t.length;i++){var n=t[i];delete n.el._node,null!=n.vm&&(n.vm.node=null),c(n.body)&&ce(n);}}function ue(e){var t=e.el;if(0==(e.flags&H))c(e.body)&&ce(e),t.textContent=null;else {var i=t.firstChild;do{var n=oe(i);le(t,i);}while(i=n)}}function de(e,t,i){var n=t._node,o=null!=t.parentNode,r=t!==i&&o?null:n.vm;null!=r&&J(r.hooks,"willMount",r,r.data),J(n.hooks,o?"willReinsert":"willInsert",n),e.insertBefore(t,i),J(n.hooks,o?"didReinsert":"didInsert",n),null!=r&&J(r.hooks,"didMount",r,r.data);}function he(e,t,i){de(e,t,i?oe(i):null);}var fe={};function pe(e){g(fe,e);}function ve(e){var t=this,i=t,n=m(arguments,1).concat(i,i.data);do{var o=t.onemit,r=o?o[e]:null;if(r){r.apply(t,n);break}}while(t=t.parent());fe[e]&&fe[e].apply(t,n);}var ge=l;function _e(e){ge=e.onevent||ge,e.onemit&&pe(e.onemit);}function me(e,t,i){e[t]=i;}function ye(e,t,i,n,o){var r=e.apply(o,t.concat([i,n,o,o.data]));o.onevent(i,n,o,o.data,t),ge.call(null,i,n,o,o.data,t),!1===r&&(i.preventDefault(),i.stopPropagation());}function be(e){var t,i,n=ee(e.target),o=A(n),r=e.currentTarget._node.attrs["on"+e.type];if(c(r))ye(t=r[0],i=r.slice(1),e,n,o);else for(var a in r)if(e.target.matches(a)){var s=r[a];c(s)?(t=s[0],i=s.slice(1)):(t=s,i=[]),ye(t,i,e,n,o);}}function we(e,t,i,n){if(i!==n){var o=e.el;null==i||p(i)?me(o,t,i):null==n&&me(o,t,be);}}function xe(e,t,i){"."===t[0]&&(t=t.substr(1),i=!0),i?e.el[t]="":e.el.removeAttribute(t);}function Ee(e,t,i,n,o){var r=e.el;null==i?!o&&xe(e,t,!1):null!=e.ns?r.setAttribute(t,i):"class"===t?r.className=i:"id"===t||"boolean"==typeof i||n?r[t]=i:"."===t[0]?r[t.substr(1)]=i:r.setAttribute(t,i);}function Ce(e,t,i){var n=e.attrs||s,o=t.attrs||s;if(n===o);else {for(var r in n){var a=n[r],l=O(e.tag,r),c=l?e.el[r]:o[r];a===c||(k(r)?X(e,t):I(r)||(S(r)?we(e,r,a,c):Ee(e,r,a,l,i)));}for(var r in o)!(r in n)&&!I(r)&&xe(e,r,O(e.tag,r)||S(r));}}function Se(e,t,i,o){return e.type===n&&(t=e.data,i=e.key,o=e.opts,e=e.view),new Ue(e,t,i,o)}function Ie(e){for(var t=0;t<e.body.length;t++){var r=e.body[t],a=r.type;if(a<=i)de(e.el,ke(r));else if(a===n)a=(s=Se(r.view,r.data,r.key,r.opts)._redraw(e,t,!1)).node.type,de(e.el,ke(s.node));else if(a===o){var s;(s=r.vm)._redraw(e,t),a=s.node.type,de(e.el,s.node.el);}}}function ke(n,o){return null==n.el&&(n.type===e?(n.el=o||te(n.tag,n.ns),null!=n.attrs&&Ce(n,s,!0),(n.flags&$)===$&&n.body.body(n),c(n.body)?Ie(n):null!=n.body&&""!==n.body&&(n.el.textContent=n.body)):n.type===t?n.el=o||ie(n.body):n.type===i&&(n.el=o||ne(n.body))),n.el._node=n,n.el}function Me(e,t){return t[e.idx+1]}function Pe(e,t){return t[e.idx-1]}function Oe(e){return e.parent}window.lisMove=Ve;var Ae=1,De=2;function Fe(e,t,i,n,o,r,a,s){return function(l,c,u,d,h,f){var p,v;if(null!=d[n]){if(null==(p=d[n]._node))return void(d[n]=e(d[n]));if(Oe(p)!==l)return v=e(d[n]),null!=p.vm?p.vm.unmount(!0):le(c,d[n]),void(d[n]=v)}if(d[o]==h)return De;if(null==d[o].el)i(c,ke(d[o]),d[n]),d[o]=t(d[o],u);else if(d[o].el===d[n])d[o]=t(d[o],u),d[n]=e(d[n]);else {if(f||p!==d[a])return f&&null!=d[n]?Ve(e,t,i,n,o,c,u,p,d):Ae;v=d[n],d[n]=e(v),s(c,v,d[r]),d[r]=v;}}}function Ve(e,t,i,n,o,r,a,s,l){if(s._lis)i(r,l[o].el,l[n]),l[o]=t(l[o],a);else {var c=C(s.idx,l.tombs);s._lis=!0;var u=e(l[n]);i(r,l[n],null!=c?a[l.tombs[c]].el:c),null==c?l.tombs.push(s.idx):l.tombs.splice(c,0,s.idx),l[n]=u;}}var Re=Fe(oe,Me,de,"lftSib","lftNode","rgtSib","rgtNode",he),Te=Fe(re,Pe,he,"rgtSib","rgtNode","lftSib","lftNode",de);function Le(e,t){var i=t.body,n=e.el,o=e.body,r={lftNode:o[0],rgtNode:o[o.length-1],lftSib:(i[0]||s).el,rgtSib:(i[i.length-1]||s).el};e:for(;;){for(;;){var a=Re(e,n,o,r,null,!1);if(a===Ae)break;if(a===De)break e}for(;;){var l=Te(e,n,o,r,r.lftNode,!1);if(l===Ae)break;if(l===De)break e}He(e,n,o,r);break}}function He(e,t,i,n){for(var o=Array.prototype.slice.call(t.childNodes),r=[],a=0;a<o.length;a++){var s=o[a]._node;s.parent===e&&r.push(s.idx);}for(var l=E(r).map((function(e){return r[e]})),c=0;c<l.length;c++)i[l[c]]._lis=!0;for(n.tombs=l;Re(e,t,i,n,null,!0)!==De;);}function Ne(e){return e.el._node.parent!==e.parent}function je(e,t,i){return t[i]}function $e(e,t,i){for(;i<t.length;i++){var r=t[i];if(null!=r.vm){if(e.type===n&&r.vm.view===e.view&&r.vm.key===e.key||e.type===o&&r.vm===e.vm)return r}else if(!Ne(r)&&e.tag===r.tag&&e.type===r.type&&e.key===r.key&&(e.flags&~H)==(r.flags&~H))return r}return null}function ze(e,t,i){return t[t._keys[e.key]]}function Be(e,i){J(i.hooks,"willRecycle",i,e);var n=e.el=i.el,o=i.body,r=e.body;if(n._node=e,e.type!==t||r===o){null==e.attrs&&null==i.attrs||Ce(e,i,!1);var a=c(o),s=c(r),l=(e.flags&$)===$;a?s||l?We(e,i):r!==o&&(null!=r?n.textContent=r:ue(i)):s?(ue(i),Ie(e)):r!==o&&(n.firstChild?n.firstChild.nodeValue=r:n.textContent=r),J(i.hooks,"didRecycle",i,e);}else n.nodeValue=r;}function We(t,r){var a=t.body,s=a.length,l=r.body,c=l.length,u=(t.flags&$)===$,d=(t.flags&N)===N,h=(t.flags&j)===j,f=!d&&t.type===e,p=!0,v=h?ze:d||u?je:$e;if(h){for(var g={},_=0;_<l.length;_++)g[l[_].key]=_;l._keys=g;}if(f&&0===s)return ue(r),void(u&&(t.body=[]));var m,y,b=0,w=!1,x=0;if(u)var E={key:null},C=Array(s);for(_=0;_<s;_++){if(u){var S=!1,I=null;p&&(h&&(E.key=a.key(_)),m=v(E,l,x)),null!=m?(y=m.idx,!0===(I=a.diff(_,m))?((k=m).parent=t,k.idx=_,k._lis=!1):S=!0):S=!0,S&&(U(k=a.tpl(_),t,_),k._diff=null!=I?I:a.diff(_),null!=m&&Be(k,m)),C[_]=k;}else {var k,M=(k=a[_]).type;if(M<=i)(m=p&&v(k,l,x))&&(Be(k,m),y=m.idx);else if(M===n){if(m=p&&v(k,l,x)){y=m.idx;var O=m.vm._update(k.data,t,_);}else O=Se(k.view,k.data,k.key,k.opts)._redraw(t,_,!1);M=O.node.type;}else if(M===o){var A=P(k.vm);M=(O=k.vm._update(k.data,t,_,A)).node.type;}}if(!h&&null!=m&&(y===x?++x===c&&s>c&&(m=null,p=!1):w=!0,c>100&&w&&++b%10==0))for(;x<c&&Ne(l[x]);)x++;}u&&(t.body=C),f&&Le(t,r);}function Ue(e,t,i,n){var o=this;o.view=e,o.data=t,o.key=i,n&&(o.opts=n,o.config(n));var r=d(e)?e:e.call(o,o,t,i,n);p(r)?o.render=r:(o.render=r.render,o.config(r)),o._redrawAsync=w((function(e){return o.redraw(!0)})),o._updateAsync=w((function(e){return o.update(e,!0)})),o.init&&o.init.call(o,o,o.data,o.key,n);}var Ge=Ue.prototype={constructor:Ue,_diff:null,init:null,view:null,key:null,data:null,state:null,api:null,opts:null,node:null,hooks:null,onevent:l,refs:null,render:null,mount:qe,unmount:Ye,config:function(e){var t=this;e.init&&(t.init=e.init),e.diff&&(t.diff=e.diff),e.onevent&&(t.onevent=e.onevent),e.hooks&&(t.hooks=g(t.hooks||{},e.hooks)),e.onemit&&(t.onemit=g(t.onemit||{},e.onemit));},parent:function(){return A(this.node.parent)},root:function(){for(var e=this.node;e.parent;)e=e.parent;return e.vm},redraw:function(e){var t=this;return e?t._redraw(null,null,P(t)):t._redrawAsync(),t},update:function(e,t){var i=this;return t?i._update(e,null,null,P(i)):i._updateAsync(e),i},_update:Je,_redraw:Ke,_redrawAsync:null,_updateAsync:null};function qe(e,t){var i=this;return t?(ue({el:e,flags:0}),i._redraw(null,null,!1),e.nodeName.toLowerCase()!==i.node.tag?(ke(i.node),de(e.parentNode,i.node.el,e),e.parentNode.removeChild(e)):de(e.parentNode,ke(i.node,e),e)):(i._redraw(null,null),e&&de(e,i.node.el)),e&&Z(i),i}function Ye(e){var t=this,i=t.node;le(i.el.parentNode,i.el),e||Z(t);}function Xe(e,t,i,n){return null!=i&&(i.body[n]=t,t.idx=n,t.parent=i,t._lis=!1),e}function Ke(e,t,i){var n,o,r=null==e,a=this,s=a.node&&a.node.el&&a.node.el.parentNode,l=a.node;if(null!=a.diff&&(n=a._diff,a._diff=o=a.diff(a,a.data),null!=l)){var u=c(n)?b:y;if(n===o||u(n,o))return Xe(a,l,e,t)}s&&J(a.hooks,"willRedraw",a,a.data);var d=a.render.call(a,a,a.data,n,o);if(d===l)return Xe(a,l,e,t);if(a.refs=null,null!=a.key&&d.key!==a.key&&(d.key=a.key),a.node=d,e?(U(d,e,t,a),e.body[t]=d):l&&l.parent?(U(d,l.parent,l.idx,a),l.parent.body[l.idx]=d):U(d,null,null,a),!1!==i)if(l)if(l.tag!==d.tag||l.key!==d.key){l.vm=d.vm=null;var h=l.el.parentNode,f=oe(l.el);le(h,l.el),de(h,ke(d),f),l.el=d.el,d.vm=a;}else Be(d,l);else ke(d);return s&&J(a.hooks,"didRedraw",a,a.data),r&&s&&Z(a),a}function Je(e,t,i,n){var o=this;return null!=e&&o.data!==e&&(J(o.hooks,"willUpdate",o,e),o.data=e),o._redraw(t,i,n)}function Ze(e,t,i,n){var o,r;return null==i?d(t)?o=t:r=t:(o=t,r=i),z(e,o,r,n)}var Qe="http://www.w3.org/2000/svg";function et(e,t,i,n){var o=Ze(e,t,i,n);return o.ns=Qe,o}function tt(e){var t=new D;return t.type=i,t.body=e,t}function it(e,t,i,n){this.view=e,this.data=t,this.key=i,this.opts=n;}function nt(e,t,i,n){return new it(e,t,i,n)}function ot(e){this.vm=e;}function rt(e){return new ot(e)}function at(t){var i=new D;return i.type=e,i.el=i.key=t,i}function st(e,t){var i=e.length,n={items:e,length:i,key:function(i){return t.key(e[i],i)},diff:function(i,n){var o=t.diff(e[i],i);if(null==n)return o;var r=n._diff;return (o===r||c(r)?b(o,r):y(o,r))||o},tpl:function(i){return t.tpl(e[i],i)},map:function(e){return t.tpl=e,n},body:function(e){for(var t=Array(i),o=0;o<i;o++){var r=n.tpl(o);r._diff=n.diff(o),t[o]=r,U(r,e,o);}e.body=t;}};return n}it.prototype={constructor:it,type:n,view:null,data:null,key:null,opts:null},ot.prototype={constructor:ot,type:o,vm:null};var lt={config:_e,ViewModel:Ue,VNode:D,createView:Se,defineElement:Ze,defineSvgElement:et,defineText:V,defineComment:tt,defineView:nt,injectView:rt,injectElement:at,lazyList:st,FIXED_BODY:N,DEEP_REMOVE:H,KEYED_LIST:j,LAZY_LIST:$};function ct(e,t){ut(this,e,t);}function ut(e,t,i){if(null!=t.type){if(null!=e.vm)return;U(t,e.parent,e.idx,null),e.parent.body[e.idx]=t,Be(t,e),i&&M(t),Z(A(t));}else {var n=Object.create(e);n.attrs=g({},e.attrs);var o=g(e.attrs,t);if(null!=e._class){var r=o.class;o.class=null!=r&&""!==r?e._class+" "+r:e._class;}Ce(e,n),i&&M(e);}}function dt(e,t){var i=e.body;if(c(i))for(var n=0;n<i.length;n++){var o=i[n];null!=o.vm?t.push(o.vm):dt(o,t);}return t}function ht(e){var t,i,n=arguments,o=n.length;if(o>1){var r=1;d(n[1])&&(i=n[1],r=2),t=o===r+1&&(f(n[r])||c(n[r])||i&&(i._flags&$)===$)?n[r]:m(n,r);}return z(e,i,t)}function ft(){var e=ht.apply(null,arguments);return e.ns=Qe,e}return F.patch=ct,Ge.emit=ve,Ge.onemit=null,Ge.body=function(){return dt(this.node,[])},lt.defineElementSpread=ht,lt.defineSvgElementSpread=ft,lt}();},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(51),o=i(0),r=i(52);t.getPicker=function(e,t,i){var a=n.HSVtoRGB(t.hsv);t.background=n.RGBToHex(a);var s=n.RGBToHex(n.HSVtoRGB({h:t.hsv.h,s:1,v:1})),l=e.getRootView(),c=l.refs?l.refs.picker_palette.el.getBoundingClientRect():{height:200,width:218,x:0,y:0},u=c.height-2,d=c.width-2,h=u-t.hsv.v*u-4,f=t.hsv.s*d-4,p=c.width-6,v=p-(360-t.hsv.h)/360*p,g=n.isHex(t.customHex)?t.customHex.replace("#",""):t.background.replace("#","");return o.el(".dhx_colorpicker-picker",{},[o.el(".dhx_colorpicker-picker__palette",{style:{height:132,background:s},onmousedown:i.mousedown,ontouchstart:i.touchstart,"data-dhx-id":"picker_palette",_ref:"picker_palette"},[o.el(".dhx_palette_grip",{style:{top:h,left:f},tabindex:0})]),o.el(".dhx_colorpicker-hue-range",{style:{height:16},onmousedown:i.mousedown,ontouchstart:i.touchstart,"data-dhx-id":"hue_range",_key:"hue_range",_ref:"hue_range"},[o.el(".dhx_colorpicker-hue-range__grip",{style:{left:v},tabindex:0})]),o.el(".dhx_colorpicker-value",[o.el(".dhx_colorpicker-value__color",{style:{background:t.background}}),o.el(".dhx_colorpicker-value__input__wrapper",[o.el("input",{class:"dhx_colorpicker-value__input",value:g,oninput:i.oninput,maxlength:"7",_key:"hex_input","aria-label":"type color in HEX format"})])]),o.el(".dhx_colorpicker-picker__buttons",[!e.config.pickerOnly&&o.el("button",{class:"dhx_button dhx_button--size_medium dhx_button--view_link dhx_button--color_primary",onclick:[i.buttonsClick,"cancel"]},r.default.cancel),o.el("button",{class:"dhx_button dhx_button--size_medium dhx_button--view_flat dhx_button--color_primary",onclick:[i.buttonsClick,"apply"]},r.default.select)])])},t.calculatePaletteGrip=function(e,t,i){var n=e.refs.picker_palette.el.getBoundingClientRect(),o=n.height,r=n.width;t=t<0?0:t>o?o:t,i=i<0?0:i>r?r:i;var a=Math.round(i/(r/100)),s=100-Math.round(t/(o/100));this._pickerState.hsv.s=a/100,this._pickerState.hsv.v=s/100;};},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.calculatePaletteGrip=function(e,t,i){var n=e.height,o=e.width;return t=t<0?0:t>n?n:t,i=i<0?0:i>o?o:i,{s:Math.round(i/(o/100))/100,v:(100-Math.round(t/(n/100)))/100}},t.calculateRangeGrip=function(e,t){var i=e.width;return t=t<0?0:t>i?i:t,{h:Math.round(t/i*360),rangeLeft:t}};},function(e,t,i){(function(e){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=i(24),r=i(23),a=function(){function t(e,t){this._parent=e,this._changes=t;}return t.prototype.load=function(e,t){var i=this;if(!e.config||this._parent.events.fire(r.DataEvents.beforeLazyLoad,[]))return this._parent.loadData=e.load().then((function(e){return e?i.parse(e,t):[]})).catch((function(e){i._parent.events.fire(r.DataEvents.loadError,[e]);}))},t.prototype.parse=function(e,t){var i=this;if(void 0===t&&(t=r.DataDriver.json),"json"!==t||o.hasJsonOrArrayStructure(e)||this._parent.events.fire(r.DataEvents.loadError,["Uncaught SyntaxError: Unexpected end of input"]),!((e=(t=o.toDataDriver(t)).toJsonArray(e))instanceof Array)){var a=e.total_count-1,s=e.from;if(e=e.data,0!==this._parent.getLength())return e.forEach((function(e,t){var r=s+t,a=i._parent.getId(r);if(a){var l=i._parent.getItem(a);l&&l.$empty&&(i._parent.changeId(a,e.id,!0),i._parent.update(e.id,n(n({},e),{$empty:void 0}),!0));}else o.dhxWarning("item not found");})),this._parent.events.fire(r.DataEvents.afterLazyLoad,[s,e.length]),this._parent.events.fire(r.DataEvents.change),e;for(var l=[],c=0,u=0;c<=a;c++)c>=s&&c<=s+e.length-1?(l.push(e[u]),u++):l.push({$empty:!0});e=l;}return this._parent.getInitialData()&&this._parent.removeAll(),this._parent.$parse(e),e},t.prototype.save=function(t){for(var i=this,n=this._getUniqueOrder(),r=function(n){if(n.saving||n.pending)o.dhxWarning("item is saving");else {var r=a._findPrevState(n.id);if(r&&r.saving){var s=new e((function(e,a){r.promise.then((function(){n.pending=!1,e(i._setPromise(n,t));})).catch((function(e){i._removeFromOrder(r),i._setPromise(n,t),o.dhxWarning(e),a(e);}));}));a._addToChain(s),n.pending=!0;}else a._setPromise(n,t);}},a=this,s=0,l=n;s<l.length;s++){r(l[s]);}n.length&&this._parent.saveData.then((function(){i._saving=!1;}));},t.prototype.updateChanges=function(e){this._changes=e;},t.prototype._setPromise=function(e,t){var i,n=this;switch(e.status){case"remove":i="delete";break;case"add":i="insert";break;default:i=e.status;}return e.promise=t.save(e.obj,i),e.promise.then((function(){n._removeFromOrder(e);})).catch((function(t){e.saving=!1,e.error=!0,o.dhxError(t);})),e.saving=!0,this._saving=!0,this._addToChain(e.promise),e.promise},t.prototype._addToChain=function(e){this._parent.saveData&&this._saving?this._parent.saveData=this._parent.saveData.then((function(){return e})):this._parent.saveData=e;},t.prototype._findPrevState=function(e){for(var t=0,i=this._changes.order;t<i.length;t++){var n=i[t];if(n.id===e)return n}return null},t.prototype._removeFromOrder=function(e){this._changes.order=this._changes.order.filter((function(t){return !o.isEqualObj(t,e)}));},t.prototype._getUniqueOrder=function(){return this._changes.order.reduce((function(e,t){var i=e.findIndex((function(e){return e.id===t.id})),n=i>-1?e[i]:null;return n&&!1===n.saving&&"add"===n.status?"remove"===t.status?e.splice(i,1):n.obj=t.obj:n&&!1===n.saving&&"update"===n.status?e.splice(i,1,t):e.push(t),e}),[])},t}();t.Loader=a;}).call(this,i(14));},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(131);function o(e,t){t=t||{};var i=e.attributes;if(i&&i.length)for(var n=0;n<i.length;n++)t[i[n].name]=i[n].value;var r=e.childNodes;for(n=0;n<r.length;n++)if(1===r[n].nodeType){var a=r[n].tagName;t[a]?("function"!=typeof t[a].push&&(t[a]=[t[a]]),t[a].push(o(r[n],{}))):t[a]=o(r[n],{});}return t}var r=function(){function e(){}return e.prototype.toJsonArray=function(e){return this.getRows(e)},e.prototype.toJsonObject=function(e){var t;return "string"==typeof e&&(t=this._fromString(e)),o(t)},e.prototype.serialize=function(e){return n.jsonToXML(e)},e.prototype.getFields=function(e){return e},e.prototype.getRows=function(e){if("string"==typeof e&&(e=this._fromString(e)),e){var t=e.childNodes&&e.childNodes[0]&&e.childNodes[0].childNodes;return t&&t.length?this._getRows(t):null}return []},e.prototype._getRows=function(e){for(var t=[],i=0;i<e.length;i++)"item"===e[i].tagName&&t.push(this._nodeToJS(e[i]));return t},e.prototype._fromString=function(e){try{return (new DOMParser).parseFromString(e,"text/xml")}catch(e){return null}},e.prototype._nodeToJS=function(e){var t={};if(this._haveAttrs(e))for(var i=e.attributes,n=0;n<i.length;n++){var o=i[n],r=o.name,a=o.value;t[r]=this._toType(a);}if(3===e.nodeType)return t.value=t.value||this._toType(e.textContent),t;var s=e.childNodes;if(s)for(n=0;n<s.length;n++){var l=s[n],c=l.tagName;c&&("items"===c&&l.childNodes?t[c]=this._getRows(l.childNodes):this._haveAttrs(l)?t[c]=this._nodeToJS(l):t[c]=this._toType(l.textContent));}return t},e.prototype._toType=function(e){return "false"===e||"true"===e?"true"===e:e},e.prototype._haveAttrs=function(e){return e.attributes&&e.attributes.length},e}();t.XMLDriver=r;},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=4;function o(e){return " ".repeat(e)}function r(e,t){void 0===t&&(t=n);var i=o(t)+"<item>\n";for(var a in e)Array.isArray(e[a])?(i+=o(t+n)+"<"+a+">\n",i+=e[a].map((function(e){return r(e,t+2*n)})).join("\n")+"\n",i+=o(t+n)+"</"+a+">\n"):i+=o(t+n)+"<"+a+">"+e[a]+"</"+a+">\n";return i+=o(t)+"</item>"}t.jsonToXML=function(e,t){void 0===t&&(t="root");for(var i='<?xml version="1.0" encoding="iso-8859-1"?>\n<'+t+">",n=0;n<e.length;n++)i+="\n"+r(e[n]);return i+"\n</"+t+">"};},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(24),o=function(){function e(){}return e.prototype.sort=function(e,t,i){this._createSorter(t),i===t&&(t=null),(i||t)&&this._sort(e,i,t);},e.prototype._createSorter=function(e){var t=this;e&&!e.rule&&(e.rule=function(i,o){var r,a,s=null!==(r=t._checkVal(e.as,i[e.by]))&&void 0!==r?r:"",l=null!==(a=t._checkVal(e.as,o[e.by]))&&void 0!==a?a:"";return n.naturalCompare(s.toString(),l.toString())});},e.prototype._checkVal=function(e,t){return e?e.call(this,t):t},e.prototype._sort=function(e,t,i){var n=this,o={asc:1,desc:-1};return e.sort((function(e,r){var a=0;return t&&(a=t.rule.call(n,e,r)*(o[t.dir]||o.asc)),0===a&&i&&(a=i.rule.call(n,e,r)*(o[i.dir]||o.asc)),a}))},e}();t.Sort=o;},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);}),r=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var a=i(1),s=i(67),l=i(32),c=i(24),u=i(23);function d(e,t,i,n){void 0!==n&&-1!==n&&e[i]&&e[i][n]?e[i].splice(n,0,t):(e[i]||(e[i]=[]),e[i].push(t));}var h=function(e){function t(t,i){var n,o=e.call(this,t,i)||this;o._childs={};var r=o._root=t&&t.rootId||"_ROOT_"+a.uid();return o._childs=((n={})[r]=[],n),o._initChilds=null,o}return o(t,e),t.prototype.add=function(e,t,i){var n,o=this;if(void 0===t&&(t=-1),void 0===i&&(i=this._root),this.events.fire(u.DataEvents.beforeAdd,[e]))return "object"!=typeof e&&(e={value:e}),n=Array.isArray(e)?e.map((function(e,n){return o._add(e,t,i,n)})):this._add(e,t,i),this._applySmart(),n},t.prototype.getRoot=function(){return this._root},t.prototype.getParent=function(e,t){if(void 0===t&&(t=!1),!this._pull[e])return null;var i=this._pull[e].parent;return t?this._pull[i]:i},t.prototype.getItems=function(e){return this._childs&&this._childs[e]?this._childs[e]:[]},t.prototype.getLength=function(e){return void 0===e&&(e=this._root),this._childs[e]?this._childs[e].length:null},t.prototype.removeAll=function(t){var i;if(t){if(this._childs[t])for(var n=0,o=r(this._childs[t]);n<o.length;n++){var a=o[n];this.remove(a.id);}}else {e.prototype.removeAll.call(this);var s=this._root;this._initChilds=null,this._childs=((i={})[s]=[],i);}},t.prototype.getIndex=function(e){var t=this.getParent(e);return t&&this._childs[t]?a.findIndex(this._childs[t],(function(t){return t.id===e})):-1},t.prototype.sort=function(e){var t=this;if(e){for(var i in this._childs)this._sort.sort(this._childs[i],e);if(this._initChilds&&Object.keys(this._initChilds).length)for(var i in this._initChilds)this._sort.sort(this._initChilds[i],e);}else this._childs={},this._parse_data(Object.keys(this._pull).map((function(e){return t._pull[e]}))),this._filters&&this.filter(this._filters.filters,this._filters.config);this.events.fire(u.DataEvents.change);},t.prototype.filter=function(e,t){var i=this;if(void 0===t&&(t={}),e&&t.add||(this.restoreOrder(),e)){if(this._initOrder||(this._initOrder=this._order),this._initChilds||(this._initChilds=this._childs),t.type=t.type||u.TreeFilterType.all,this._filters={filters:{},config:t},"function"!=typeof e)if(e.by)this._filters.filters[e.by]=e;else for(var n in e)this._filters.filters[n]=e[n];else this._filters.filters=e;var o={};this._recursiveFilter(this._filters.filters,t,this._root,0,o),t&&!t.smartFilter&&(this._filters=null),Object.keys(o).forEach((function(e){for(var t=i.getParent(e),n=i.getItem(e);t;)o[t]||(o[t]=[]),n&&!o[t].find((function(e){return e.id===n.id}))&&o[t].push(n),n=i.getItem(t),t=i.getParent(t);})),this._childs=o,this.events.fire(u.DataEvents.change);}},t.prototype.restoreOrder=function(){this._initChilds&&(this._childs=this._initChilds,this._initChilds=null),this.events.fire(u.DataEvents.change);},t.prototype.copy=function(e,t,i,n){var o=this;return void 0===i&&(i=this),void 0===n&&(n=this._root),e instanceof Array?e.map((function(e,r){return o._copy(e,t,i,n,r)})):this._copy(e,t,i,n)},t.prototype.move=function(e,t,i,n){var o=this;return void 0===i&&(i=this),void 0===n&&(n=this._root),e instanceof Array?e.map((function(e,r){return o._move(e,t,i,n,r)})):this._move(e,t,i,n)},t.prototype.forEach=function(e,t,i){if(void 0===t&&(t=this._root),void 0===i&&(i=1/0),this.haveItems(t)&&!(i<1))for(var n=this._childs[t],o=0;o<n.length;o++)e.call(this,n[o],o,n),this.haveItems(n[o].id)&&this.forEach(e,n[o].id,--i);},t.prototype.eachChild=function(e,t,i,n){if(void 0===i&&(i=!0),void 0===n&&(n=function(){return !0}),this.haveItems(e))for(var o=0;o<this._childs[e].length;o++)t.call(this,this._childs[e][o],o),i&&n(this._childs[e][o])&&this.eachChild(this._childs[e][o].id,t,i,n);},t.prototype.getNearId=function(e){return e},t.prototype.loadItems=function(e,t){var i=this;void 0===t&&(t=u.DataDriver.json);var n=this.config.autoload.toString(),o=n+(n.includes("?")?"&id="+e:"?id="+e);new l.DataProxy(o).load().then((function(n){n=(t=c.toDataDriver(t)).toJsonArray(n),i._parse_data(n,e),i.events.fire(u.DataEvents.change);}));},t.prototype.refreshItems=function(e,t){void 0===t&&(t=u.DataDriver.json),this.removeAll(e),this.loadItems(e,t);},t.prototype.eachParent=function(e,t,i){void 0===i&&(i=!1);var n=this.getItem(e);if(n&&(i&&t.call(this,n),n.parent!==this._root)){var o=this.getItem(n.parent);t.call(this,o),this.eachParent(n.parent,t);}},t.prototype.haveItems=function(e){return e in this._childs},t.prototype.canCopy=function(e,t){if(e===t)return !1;var i=!0;return this.eachParent(t,(function(t){return t.id===e?i=!1:null})),i},t.prototype.serialize=function(e,t){void 0===e&&(e=u.DataDriver.json);var i=this._serialize(this._root,t),n=c.toDataDriver(e);if(n)return n.serialize(i)},t.prototype.getId=function(e,t){if(void 0===t&&(t=this._root),this._childs[t]&&this._childs[t][e])return this._childs[t][e].id},t.prototype.map=function(e,t,i){void 0===t&&(t=this._root),void 0===i&&(i=!0);var n=[];if(!this.haveItems(t))return n;for(var o=0;o<this._childs[t].length;o++)if(n.push(e.call(this,this._childs[t][o],o,this._childs)),i){var r=this.map(e,this._childs[t][o].id,i);n=n.concat(r);}return n},t.prototype.getRawData=function(t,i,n,o,r){var a;return r=r||this._root,this._childs[r]?(a=r===this._root?e.prototype.getRawData.call(this,t,i,this._childs[r]):this._childs[r],2===o?this.flatten(a):a):[]},t.prototype.flatten=function(e){var t=this,i=[];return e.forEach((function(e){i.push(e);var n=t._childs[e.id];n&&e.$opened&&(i=i.concat(t.flatten(n)));})),i},t.prototype._add=function(t,i,n,o){void 0===i&&(i=-1),void 0===n&&(n=this._root),t.parent=t.parent?t.parent.toString():n,o>0&&-1!==i&&(i+=1);var r=e.prototype._add.call(this,t,i);if(Array.isArray(t.items))for(var a=0,s=t.items;a<s.length;a++){var l=s[a];this.add(l,-1,t.id);}return r},t.prototype._copy=function(e,t,i,n,o){if(void 0===i&&(i=this),void 0===n&&(n=this._root),!this.exists(e))return null;var r=this._childs[e];if(o&&(t=-1===t?-1:t+o),i===this&&!this.canCopy(e,n))return null;var s=c.copyWithoutInner(this.getItem(e),{items:!0});if(i.exists(e)&&(s.id=a.uid()),c.isTreeCollection(i)){if(this.exists(e)&&(s.parent=n,i!==this&&n===this._root&&(s.parent=i.getRoot()),i.add(s,t),e=s.id),r)for(var l=0,u=r;l<u.length;l++){var d=u[l].id,h=this.getIndex(d);"string"==typeof e&&this.copy(d,h,i,e);}return e}i.add(s,t);},t.prototype._move=function(e,t,i,n,o){if(void 0===i&&(i=this),void 0===n&&(n=this._root),!this.exists(e))return null;if(o&&(t=-1===t?-1:t+o),i!==this){if(!c.isTreeCollection(i))return i.add(c.copyWithoutInner(this.getItem(e)),t),void this.remove(e);var r=this.copy(e,t,i,n);return this.remove(e),r}if(!this.canCopy(e,n))return null;var a=this.getParent(e),s=this.getIndex(e),l=this._childs[a].splice(s,1)[0];return l.parent=n,this._childs[a].length||delete this._childs[a],this.haveItems(n)||(this._childs[n]=[]),-1===t?t=this._childs[n].push(l):this._childs[n].splice(t,0,l),this.events.fire(u.DataEvents.change,[e,"update",this.getItem(e)]),e},t.prototype._reset=function(t){var i;if(t)for(var n=0,o=r(this._childs[t]);n<o.length;n++){var a=o[n];this.remove(a.id);}else {e.prototype._reset.call(this);var s=this._root;this._initChilds=null,this._childs=((i={})[s]=[],i);}},t.prototype._removeCore=function(e){if(this._pull[e]){var t=this.getParent(e);this._childs[t]=this._childs[t].filter((function(t){return t.id!==e})),t===this._root||this._childs[t].length||delete this._childs[t],this._initChilds&&this._initChilds[t]&&(this._initChilds[t]=this._initChilds[t].filter((function(t){return t.id!==e})),t===this._root||this._initChilds[t].length||delete this._initChilds[t]),this._initOrder&&this._initOrder.length&&(this._initOrder=this._initOrder.filter((function(t){return t.id!==e}))),this._fastDeleteChilds(this._childs,e),this._initChilds&&this._fastDeleteChilds(this._initChilds,e);}},t.prototype._addToOrder=function(t,i,n){var o=this._childs,r=this._initChilds,a=i.parent;this._pull[i.id]=i,i.parent&&this._pull[i.parent]&&this._pull[i.parent].items&&!this._pull[i.parent].items.find((function(e){return e.id===i.id}))&&this._pull[i.parent].items.push(i),e.prototype._addToOrder.call(this,t,i,n),d(o,i,a,n),r&&d(r,i,a,n);},t.prototype._parse_data=function(e,t){var i;void 0===t&&(t=this._root);for(var n=this._order.length,o=0,r=e;o<r.length;o++){var s=r[o];this.config.init&&(s=this.config.init(s)),s&&"object"!=typeof s&&(s={value:s}),s.id=null!==(i=s.id)&&void 0!==i?i:a.uid(),s.parent=void 0===s.parent||null===s.parent||s.parent&&s.$items?t:s.parent,this._pull[s.id]&&c.dhxError("Item "+s.id+" already exist"),this._pull[s.id]=s,this._order[n++]=s,this._childs[s.parent]||(this._childs[s.parent]=[]),this._childs[s.parent].push(s),s.items&&s.items instanceof Object&&this._parse_data(s.items,s.id);}},t.prototype._applySmart=function(){this._filters&&this.filter(this._filters.filters,this._filters.config);},t.prototype._fastDeleteChilds=function(e,t){if(this._pull[t]&&delete this._pull[t],e[t]){for(var i=0;i<e[t].length;i++)this._fastDeleteChilds(e,e[t][i].id);delete e[t];}},t.prototype._recursiveFilter=function(e,t,i,n,o){var r=this,a=this._childs[i];if(a){var s=function(e){switch(t.type){case u.TreeFilterType.all:return !0;case u.TreeFilterType.level:return n===t.level;case u.TreeFilterType.leafs:return !r.haveItems(e.id)}};if("function"==typeof e){var l=function(t){return s(t)&&e(t)};(c=a.filter(l)).length?o[i]=c:i===this._root&&(o[i]=[]);}else {var c;l=function(t){var i,n=!0;for(var o in e)if(e[o].by&&""!==e[o].match&&(n=e[o].compare?e[o].compare(t[e[o].by],e[o].match,t):-1!==(null===(i=t[e[o].by])||void 0===i?void 0:i.toString().toLocaleLowerCase().indexOf(e[o].match.toString().toLowerCase()))),!n)break;return s(t)&&n};(c=a.filter(l)).length?o[i]=c:i===this._root&&(o[i]=[]);}for(var d=0,h=a;d<h.length;d++){var f=h[d];this._recursiveFilter(e,t,f.id,n+1,o);}}},t.prototype._serialize=function(e,t){var i=this;return void 0===e&&(e=this._root),this.map((function(e){var n={};for(var o in e)"parent"===o||"items"===o||o.startsWith("$")||(n[o]=e[o]);return t&&(n=t(n)),i.haveItems(e.id)&&(n.items=i._serialize(e.id,t)),n}),e,!1)},t}(s.DataCollection);t.TreeCollection=h;},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)},o=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var r=i(3),a=i(37),s=i(164),l=i(23),c=i(24),u=i(1);var d=function(){function e(){var e=this;this._transferData={},this._canMove=!0,this._isDrag=!1,this._onMouseMove=function(t){if(e._transferData.start){var i=t.targetTouches?t.targetTouches[0].pageX:t.pageX,n=t.targetTouches?t.targetTouches[0].pageY:t.pageY,o=e._transferData,r=o.x,a=o.y,s=o.start,l=o.componentId;if(!e._transferData.ghost){if(Math.abs(r-i)<3&&Math.abs(a-n)<3)return;var c=e._onDragStart(s,l,t);if(!c)return void e._endDrop(t);e._transferData.ghost=c,document.body.appendChild(e._transferData.ghost);}e._moveGhost(i,n),e._onDrag(t);}},this._onMouseUp=function(t){e._transferData.x&&(e._transferData.ghost?(e._removeGhost(),e._onDrop(t)):e._endDrop(t),t.targetTouches?(document.removeEventListener("touchmove",e._onMouseMove),document.removeEventListener("touchend",e._onMouseUp)):(document.removeEventListener("mousemove",e._onMouseMove),document.removeEventListener("mouseup",e._onMouseUp)));};}return e.prototype.setItem=function(e,t){s.collectionStore.setItem(e,t);},e.prototype.onMouseDown=function(e,t,i){if(1===e.which||e.targetTouches){e.targetTouches?(document.addEventListener("touchmove",this._onMouseMove,!1),document.addEventListener("touchend",this._onMouseUp,!1)):(document.addEventListener("mousemove",this._onMouseMove),document.addEventListener("mouseup",this._onMouseUp));var n=r.locateNode(e,"data-dhx-id"),a=n&&n.getAttribute("data-dhx-id"),s=r.locate(e,"data-dhx-widget-id");if(Array.isArray(t)&&t.includes(a)?(this._transferData.source=o(t),this._itemsForGhost=i):(this._transferData.source=[a],this._itemsForGhost=null),a&&s){var l=r.getBox(n),c=l.left,u=l.top,d=e.targetTouches?e.targetTouches[0].pageX:e.pageX,h=e.targetTouches?e.targetTouches[0].pageY:e.pageY;this._transferData.initXOffset=d-c,this._transferData.initYOffset=h-u,this._transferData.x=d,this._transferData.y=h,this._transferData.componentId=s,this._transferData.start=a,this._transferData.item=n;}}},e.prototype.isDrag=function(){return this._isDrag},e.prototype.cancelCanDrop=function(e){this._canMove=!1,this._isDrag=!1;var t=this._transferData,i=t.start,n=t.source,o=t.target,r=t.dropComponentId,a={start:i,source:n,target:o},c=s.collectionStore.getItem(r);c&&o&&c.events.fire(l.DragEvents.cancelDrop,[a,e]),this._transferData.dropComponentId=null,this._transferData.target=null;},e.prototype._moveGhost=function(e,t){this._transferData.ghost&&(this._transferData.ghost.style.left=e-this._transferData.initXOffset+"px",this._transferData.ghost.style.top=t-this._transferData.initYOffset+"px");},e.prototype._removeGhost=function(){document.body.removeChild(this._transferData.ghost);},e.prototype._onDrop=function(e){if(this._canMove){var t=this._transferData,i=t.start,n=t.source,o=t.target,r=t.dropComponentId,a={start:i,source:n,target:o,dropPosition:t.dropPosition},c=s.collectionStore.getItem(r),u=c&&c.config;if(c&&"source"!==u.dragMode){if(c.events.fire(l.DragEvents.beforeDrop,[a,e])){var d={id:o,component:c},h={id:i,component:this._transferData.component,newId:null};this._move(h,d),h.newId&&h.component!==d.component&&(a.start=h.newId),d.component.events.fire(l.DragEvents.afterDrop,[a,e]);}this._endDrop(e);}else this._endDrop(e);}else this._endDrop(e);},e.prototype._onDragStart=function(e,t,i){var n=s.collectionStore.getItem(t),o=n.config,r=this._transferData,a={start:r.start,source:r.source,target:r.target};if("target"===o.dragMode||n._pregroupData)return null;var c=function(e,t,i){void 0===i&&(i=!1);var n=e.getBoundingClientRect(),o=document.createElement("div"),r=e.cloneNode(!0);return r.style.width=n.width+"px",r.style.height=n.height+"px",r.style.maxHeight=n.height+"px",r.style.fontSize=window.getComputedStyle(e.parentElement).fontSize,r.style.opacity="0.8",r.style.fontSize=window.getComputedStyle(e.parentElement).fontSize,i&&t&&t.length||o.appendChild(r),t&&t.length&&t.forEach((function(e,t){var i=e.cloneNode(!0);i.style.width=n.width+"px",i.style.height=n.height+"px",i.style.maxHeight=n.height+"px",i.style.top=12*(t+1)-n.height-n.height*t+"px",i.style.left=12*(t+1)+"px",i.style.opacity="0.6",i.style.zIndex=""+(-t-1),o.appendChild(i);})),o.className="dhx_drag-ghost",o}(this._transferData.item,this._itemsForGhost,"column"===o.dragItem||"both"===o.dragItem);return n.events.fire(l.DragEvents.beforeDrag,[a,i,c])&&e?(n.events.fire(l.DragEvents.dragStart,[a,i]),this._isDrag=!0,this._toggleTextSelection(!0),this._transferData.component=n,this._transferData.dragConfig=o,c):null},e.prototype._onDrag=function(e){var t=e.targetTouches?e.targetTouches[0].clientX:e.clientX,i=e.targetTouches?e.targetTouches[0].clientY:e.clientY,n=document.elementFromPoint(t,i),o=r.locate(n,"data-dhx-widget-id");if(o){var a=s.collectionStore.getItem(o),u=!!r.locateNodeByClassName(n,"dhx_grid-header")||!!r.locateNodeByClassName(n,"dhx_grid-footer"),d=a&&a.config.columns?a.config:void 0,h=d&&("both"===d.dragItem||"column"===d.dragItem);if(!u||h){var f=r.locate(n,"data-dhx-id"),p=r.locate(n,"data-dhx-root-id");if(!f&&!p)return this.cancelCanDrop(e),this._transferData.dropComponentId=o,this._transferData.target=null,void this._canDrop(e);var v=this._transferData,g=v.dropComponentId,_=v.start,m=v.source,y=v.target,b=v.componentId,w=v.dropPosition;if("complex"===a.config.dropBehaviour){var x=function(e){var t=e.clientY,i=r.locateNode(e);if(!i)return null;var n=i.childNodes[0];if(n){var o=n.getBoundingClientRect();return (t-o.top)/o.height}}(e);this._transferData.dropPosition=x<=.25?"top":x>=.75?"bottom":"in";}else if((y===f||!f&&y===p)&&g===o)return;var E={id:_,component:this._transferData.component};if("source"!==a.config.dragMode)if(E.component.events.fire(l.DragEvents.dragOut,[{start:_,source:m,target:y},e]),o!==b||!c.isTreeCollection(E.component.data)||c.isTreeCollection(E.component.data)&&E.component.data.canCopy(E.id,f))this.cancelCanDrop(e),this._transferData.target=f||p,this._transferData.dropComponentId=o,E.component.events.fire(l.DragEvents.dragIn,[{start:_,source:m,target:y,dropPosition:w},e])&&this._canDrop(e);else this.cancelCanDrop(e);}else this._canMove&&this.cancelCanDrop(e);}else this._canMove&&this.cancelCanDrop(e);},e.prototype._move=function(e,t){var i=e.component,r=t.component,s=e.component.data,l=t.component.data,d=0,h=t.id,f=c.isTreeCollection(l)?t.component.config.dropBehaviour:void 0,p=e.component.config.columns?e.component.config:void 0,v=p&&("both"===p.dragItem||"column"===p.dragItem)&&p.columns.map((function(e){return e.id})).filter((function(i){return i===e.id||i===t.id})).length;if(v&&e.component===t.component){if(e.id===t.id)return;var g=(_=i.config.columns.map((function(e){return n({},e)}))).findIndex((function(t){return t.id===e.id}));if(-1===(b=_.findIndex((function(e){return e.id===t.id}))))return;return _.splice(b,0,_.splice(g,1)[0]),i.setColumns(_),void i.paint()}if(v&&e.component instanceof a.ProGrid&&t.component instanceof a.ProGrid){g=(_=i.config.columns.map((function(e){return n({},e)}))).findIndex((function(t){return t.id===e.id}));var _,m=r.config.columns.map((function(e){return n({},e)})),y=r.data.getLength(),b=m.findIndex((function(e){return e.id===t.id})),w=[],x=e.id;i.data.forEach((function(t){var i;w.push(((i={id:t.id})[x]=t[e.id],i));})),y?i.data.forEach((function(e,t){var i=r.data.getItem(e.id);i?r.data.update(i.id,n(n({},i),w[t])):r.data.add(w[t]);})):r.data.parse(w);var E=_.splice(g,1)[0];return m.find((function(e){return e.id===x}))||m.splice(b,0,E),r.setColumns(m),r.paint(),i.setColumns(_),void i.paint()}var C=t.id===r.config.rootParent;switch(f){case"child":break;case"sibling":h=l.getParent(h),d=l.getIndex(t.id)+1;break;case"complex":var S=this._transferData.dropPosition;C?(h=t.id,d=l.getLength()):"top"===S?(h=l.getParent(h),d=l.getIndex(t.id)):"bottom"===S&&(h=l.getParent(h),d=l.getIndex(t.id)+1);break;default:t.id?e.component===t.component&&l.getIndex(e.id)<l.getIndex(t.id)?d=l.getIndex(t.id)-1:(l.getIndex(e.id)>-1&&(e.newId=u.uid()),d=l.getIndex(t.id)):d=-1;}if(this._transferData.dragConfig.dragCopy)this._transferData.source instanceof Array&&this._transferData.source.length>1?this._transferData.source.map((function(e){s.copy(e,d,l,h),d>-1&&d++;})):s.copy(e.id,d,l,h);else if(this._transferData.source instanceof Array&&this._transferData.source.length>1)this._transferData.source.map((function(e){s.move(e,d,l,h),d>-1&&d++;}));else if(r instanceof a.Grid&&!r.config.columns.length){var I=i.data.getItem(e.id);r.data.parse([n({},I)]),r.setColumns(o(i.config.columns)),r.paint(),i.data.remove(e.id),i.paint();}else s.move(e.id,d,l,h,e.newId);},e.prototype._endDrop=function(e){if(this._toggleTextSelection(!1),this._transferData.component){var t=this._transferData,i={start:t.start,source:t.source,target:t.target};this._transferData.component.events.fire(l.DragEvents.afterDrag,[i,e]);}this.cancelCanDrop(e),this._canMove=!0,this._transferData={},this._transferData.target=null,this._transferData.dropComponentId=null;},e.prototype._canDrop=function(e){this._canMove=!0;var t=this._transferData,i={start:t.start,source:t.source,target:t.target,dropPosition:t.dropPosition},n=s.collectionStore.getItem(this._transferData.dropComponentId);n&&this._transferData.target&&n.events.fire(l.DragEvents.canDrop,[i,e]);},e.prototype._toggleTextSelection=function(e){e?document.body.classList.add("dhx_no-select"):document.body.classList.remove("dhx_no-select");},e}(),h=window.dhxHelpers=window.dhxHelpers||{};h.dragManager=h.dragManager||new d,t.dragManager=h.dragManager;},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)},o=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var r=i(21),a=i(13),s=i(1),l=i(18);var c=function(){function e(e){this._view=e;}return e.prototype.xlsx=function(e){return this._export(e)},e.prototype.csv=function(e){var t;void 0===e&&(e={}),e=n({asFile:!0,rowDelimiter:"\n",columnDelimiter:",",skipHeader:0},e),t="getRoot"in this._view.data&&e.flat?this.getFlatCSV(e):this._getCSV(e);var i=e.name||"grid_export";return e.asFile&&s.downloadFile(t,i+".csv","text/csv"),t},e.prototype._export=function(e){void 0===e&&(e={});for(var t=this._view.config.columns.filter((function(e){return !e.hidden})),i={},n=r.transpose(t.map((function(e){return e.header.map((function(e){return e.text||" "}))}))),o=[],a={default:{color:"#000000",background:"#FFFFFF",fontSize:14}},s=[],c={},u=this._view.data.serialize().map((function(e,n){i[e.id]=n;var o=t.map((function(t,i){if(c[t.id]=i,e[t.id]instanceof Date){var n=t.format||"%M %d %Y";"string"==typeof e[t.id]?e[t.id]=l.getFormattedDate(n,l.stringToDate(e[t.id],n)):"object"==typeof e[t.id]&&(e[t.id]=l.getFormattedDate(n,e[t.id]));}return e[t.id]||i||!e.$groupName?r.removeHTMLTags(e[t.id]):"^ "+e.$groupName}));return o})),d=[],h=this._view.content,f=function(e){if(e.footer){var n=e.id,l=p._view.data.serialize().reduce((function(e,t){return void 0===t[n]||""===t[n]||isNaN(t[n])||e.push(parseFloat(t[n])),e}),[]),c=l;if("tree"===p._view.config.type){var u=p._view.data;c=u.serialize().reduce((function(e,t){if(0===t.$level)if(void 0===t[n]||""===t[n]||isNaN(t[n])){var i=0;u.eachChild(t.id,(function(e){u.haveItems(e.id)||(i+=parseFloat(e[n]));})),e.push(i);}else e.push(parseFloat(t[n])||0);return e}),[]);}if(e.footer[0].content){var f=h[e.footer[0].content].calculate(l,c);d.push(f.toString());}else d.push(e.footer[0].css||e.footer[0].text||" ");}for(var v in o.push({width:e.width}),e.$cellCss){var g=e.$cellCss[v],_=g.split("").reduce((function(e,t){var i=(e<<5)-e+t.charCodeAt(0);return Math.abs(i&i)}),0).toString();if(!a[_]){var m=document.body,y=r.getStyleByClass(g,m,"dhx_grid-row",a.default);y&&(a[_]=y);}a[_]&&s.push([i[v],t.indexOf(e),_]);}},p=this,v=0,g=t;v<g.length;v++){f(g[v]);}d.length&&u.push(d);var _={name:e.name||"data",columns:o,header:n,data:u,styles:{cells:s,css:a}};if(e.url){var m=document.createElement("form");m.setAttribute("target","_blank"),m.setAttribute("action",e.url),m.setAttribute("method","POST"),m.style.visibility="hidden";var y=document.createElement("textarea");y.setAttribute("name","data"),y.value=JSON.stringify(_),m.appendChild(y),document.body.appendChild(m),m.submit(),setTimeout((function(){m.parentNode.removeChild(m);}),100);}return _},e.prototype.getFlatCSV=function(e){var t=this._view.data,i=t.getRoot(),n=this._view.config.columns[0],r=t.getMaxLevel(),s="";t.eachChild(i,(function(i){var o=function(e,t){for(var i=[],o=0;o<=r;o++)if(e&&e[n.id]){i[e.$level]=e[n.id];var a=t.getParent(e.id,!0);e=a&&a.id?a:null;}else i[o]="";return i}(i,t).join(e.columnDelimiter);s+=o+Object.keys(i).reduce((function(t,n,o){return "id"===n||"parent"===n||n.startsWith("$")||0===o?t:t+e.columnDelimiter+(null===i[n]?"":i[n])}),""),s+=e.rowDelimiter;}));var l=this._export(e),c=function(e,t){for(var i=0;i<e.length;i++)e[i]=t;return e}(new Array(r+1),""),u=l.header.map((function(e){return e.splice.apply(e,o([0,1],c)),e}));return new a.CsvDriver(e).serialize(u,!0)+e.rowDelimiter+s},e.prototype._getCSV=function(e){var t=this._export(e),i=t.header,n=new a.CsvDriver(e);return n.serialize(i,!0)+"\n"+n.serialize(t.data,!0)},e}();t.Exporter=c;},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),o=i(1),r=i(13),a=i(4),s=i(11),l=i(17),c=function(){function e(e,t,i,n){this._grid=e,this.config=t,this._gridId=n,this._selectedCell=void 0,this._oldSelectedCell=void 0,this._selectedCells=[],this._type=["cell","row","complex"].includes(this._grid.config.selection)?this._grid.config.selection:"complex",this._multiselection=e.config.multiselection,this.events=i||new a.EventSystem(this),this._init();}return e.prototype.setCell=function(e,t,i,o){var r=this;if(void 0===i&&(i=!1),void 0===o&&(o=!1),this._gridId&&l.focusManager.getFocusId()!==this._gridId&&l.focusManager.setFocusId(this._gridId),!(this.config.disabled||this._grid.config.$editable||!this._multiselection&&this._oldSelectedCell&&this._oldSelectedCell.row.id===(e&&e.id||e)&&this._oldSelectedCell.column.id===(t&&t.id||t)||this._multiselection&&1===this._selectedCells.length&&this._selectedCells[0].row.id===(e&&e.id||e)&&this._selectedCells[0].column.id===(t&&t.id||t))){if((this._multiselection&&!i&&!o||!this._multiselection)&&(this._selectedCells.length&&this._removeCells(),"row"!==this._type&&this._selectedCells.length))return this._grid.paint(),void this._setBrowserFocus();if(!this._multiselection||"cell"!==this._type&&"complex"!==this._type||!this._selectedCells.find((function(i){return i.row.id===(e&&e.id||e)&&i.column.id===(t&&t.id||t)}))){var a=this._oldSelectedCell?this._oldSelectedCell:void 0;e=this._grid.data.getItem(e&&e.id||e);var c=this._grid.config.columns.filter((function(e){return !e.hidden}));if(t||(t=c[0]),(t=this._grid.getColumn(t.id||t))&&e&&(t=t.id?t:this._grid.getColumn(t),this.events.fire(s.GridSelectionEvents.beforeSelect,[e,t]))){if(this._selectedCell={row:e,column:t},this.events.fire(s.GridSelectionEvents.afterSelect,[e,t]),this._multiselection&&o&&a?this._oldSelectedCell=a:this._oldSelectedCell=this._selectedCell,this._multiselection)if(o&&!i&&this._selectedCells.length>0){var u=this._grid.data.getIndex(this._oldSelectedCell.row.id),d=this._grid.data.getIndex(e.id);if(u>d){var h=u;u=d,d=h;}if(this._selectedCells=[this._oldSelectedCell],"cell"===this._type||"complex"===this._type){var f=c.map((function(e){return e.id})),p=f.indexOf(a.column.id),v=f.indexOf(t.id);if(-1!==p&&-1!==v){if(p>v){h=p;p=v,v=h;}var g=c.slice(p,v+1);this._grid.data.mapRange(u,d,(function(e){g.forEach((function(t){var i={row:e,column:t};-1===r._findIndex(i)&&r._selectedCells.push(i);}));}));}}else this._grid.data.mapRange(u,d,(function(e){var i={row:e,column:t};-1===r._findIndex(i)&&r._selectedCells.push(i);}));}else if(i&&!o){var _=this._findIndex();-1===_?this._selectedCells.push({row:this._selectedCell.row,column:this._selectedCell.column}):this._selectedCells.length>1&&this._selectedCells.splice(_,1);}else this._selectedCells=[this._selectedCell];else this._selectedCells=[this._selectedCell];n.awaitRedraw().then((function(){r._grid.paint(),r._setBrowserFocus();}));}}else this.removeCell(e&&e.id||e,t&&t.id||t);}},e.prototype.getCell=function(){return this._selectedCell},e.prototype.getCells=function(){return this._selectedCells},e.prototype.toHTML=function(){var e=this;if(!this._isUnselected()){if(this._multiselection){var t=[],i={};return this._selectedCells.forEach((function(n,o,r){t.push(e._toHTML(n.row,n.column,o===r.length-1||"cell"===e._type||"complex"===e._type,i[n.row.id])),i[n.row.id]=!0;})),t}return this._toHTML(this._selectedCell.row,this._selectedCell.column,!0)}},e.prototype.disable=function(){this.removeCell(),this.config.disabled=!0,this._grid.paint();},e.prototype.enable=function(){this.config.disabled=!1,this._grid.paint();},e.prototype.removeCell=function(e,t){var i=this;if(e&&t&&("cell"===this._type||"complex"===this._type)){var o=this._selectedCells.find((function(i){var n=i.row,o=i.column;return n.id==e&&o.id==t}));o&&this._removeCell(o.row,o.column);}else if(e){this._selectedCells.filter((function(t){return t.row.id==e})).forEach((function(e){var t=e.row,n=e.column;i._removeCell(t,n);}));}else this._removeCells();n.awaitRedraw().then((function(){i._grid.paint();}));},e.prototype._removeCell=function(e,t){if(e&&t&&e.id&&t.id){var i=this._selectedCells.findIndex((function(i){return i.row.id===e.id&&i.column.id===t.id}));this.events.fire(s.GridSelectionEvents.beforeUnSelect,[e,t])?(this._selectedCells.splice(i,1),this._selectedCell&&t.id===this._selectedCell.column.id&&e.id===this._selectedCell.row.id&&(this._selectedCell=this._selectedCells[this._selectedCells.length-1]||void 0),this._oldSelectedCell&&this._oldSelectedCell.row.id===e.id&&this._oldSelectedCell.column.id===t.id&&(this._oldSelectedCell=void 0),this.events.fire(s.GridSelectionEvents.afterUnSelect,[e,t])):this._selectedCells[i].$preventedUnselect=!0;}},e.prototype._removeCells=function(){var e=this;this._selectedCells.forEach((function(t){e._removeCell(t&&t.row,t&&t.column);})),this._selectedCells.length&&!this._selectedCells.every((function(e){return e.$preventedUnselect}))&&this._removeCells();},e.prototype._init=function(){var e=this;this._grid.events.on(s.GridEvents.cellClick,(function(t,i,n){e.setCell(t,i,n.ctrlKey||n.metaKey,n.shiftKey);})),this._grid.data.events.on(r.DataEvents.beforeRemove,(function(t){if(t&&e._selectedCell&&e._selectedCell.row){var i=e._grid.data.getIndex(String(e._selectedCell.row.id)),n=e._grid.data.getId(i+1);if(n)e.setCell(n);else {var o=e._grid.data.getId(i-1);o&&e.setCell(o);}e._grid.paint();}}));},e.prototype._toHTML=function(e,t,i,r){var a,s,l;void 0===i&&(i=!1),void 0===r&&(r=!1);var c=this._grid.data.getRawData(0,-1,null,2);if(-1===o.findIndex(c,(function(t){return t.id==e.id})))return null;var u=this._grid.config.leftSplit,d=this._grid.config.topSplit,h=this._grid.config.columns.filter((function(e){return !e.hidden})),f=u?h.slice(0,u):[],p=this._grid.config.topSplit?this._grid.data.getRawData(0,this._grid.config.topSplit):[],v=f.map((function(e){return e.id})),g=p.map((function(e){return e.id})),_=f.reduce((function(e,t){return e+t.$width}),0),m=p.reduce((function(e,t){return e+t.$height}),0),y=this._grid.getCellRect(e.id,t.id),b=this._grid.getScrollState(),w=y.y,x=g.includes(e.id),E=v.includes(t.id),C=f.length&&_>y.x-b.x,S=p.length&&m>y.y-b.y,I=y.width,k=y.height-1,M=null,P=null,O=C?_+b.x:y.x;C&&(I-=(E?0:_)-(y.x-b.x)),S&&(k-=(x?0:m)-(y.y-b.y)-1,w+=y.height-k),x&&(w=y.y+b.y,(null===(a=this._grid.getSpan(e.id,t.id))||void 0===a?void 0:a.rowspan)?M=p.splice(this._grid.data.getIndex(e.id)).reduce((function(e,t){return e+t.$height}),0):k=d===g.indexOf(e.id)+1?y.height-1:y.height),E&&(O=y.x+b.x,(null===(s=this._grid.getSpan(e.id,t.id))||void 0===s?void 0:s.colspan)?P=f.splice(null===(l=this._grid.config.columns)||void 0===l?void 0:l.indexOf(t)).reduce((function(e,t){return e+t.$width}),0):I=u===v.indexOf(t.id)+1?y.width-1:y.width);var A=this._grid.config.$totalWidth,D=null;"row"!==this._type&&"complex"!==this._type||r||(D=n.el(".dhx_grid-selected-row",{style:{width:f.length?A-b.x:A,height:k,minHeight:M,minWidth:P,display:k<0&&!M?"none":"flex",top:w,left:f.length?b.x:0,position:"absolute"}}));var F=null;return "cell"!==this._type&&"complex"!==this._type||!i||(F=n.el(".dhx_grid-selected-cell",{style:{width:I,height:k,top:w,minHeight:M,minWidth:P,left:O,position:"absolute",display:I<0&&!P||k<0&&!M?"none":"flex",borderLeft:C&&!E?"none":null,borderTop:S&&!x?"none":null}})),n.el(".dhx_grid-selection",{style:{zIndex:20}},[D,F])},e.prototype._isUnselected=function(){return !this._selectedCell||!this._selectedCell.row||!this._selectedCell.column||0===this._selectedCells.length},e.prototype._findIndex=function(e){var t=this;void 0===e&&(e=this._selectedCell);var i=-1;return this._selectedCells.some((function(n,r){if("cell"===t._type){if(o.compare(n.row,e.row)&&o.compare(n.column,e.column))return i=r,!0}else if("row"===t._type&&o.compare(n.row,e.row))return i=r,!0})),i},e.prototype._setBrowserFocus=function(){var e=this._grid.getRootView().data.getRootNode();if(e){var t=e.querySelector(".dhx_grid_data");if(t&&this._selectedCell&&this._selectedCell.row&&this._selectedCell.column){var i=t.querySelector('[data-dhx-id="'+this._selectedCell.row.id+'"]'),n=this._grid.getSpan(this._selectedCell.row.id,this._selectedCell.column.id);if(i){var o=n?e.querySelector(".dhx_span-spans"):null,r=o?o.querySelector('[data-dhx-col-id="'+n.column+'"][data-dhx-id="'+n.row+'"]'):i.querySelector('[data-dhx-col-id="'+this._selectedCell.column.id+'"]');r&&(r.tabIndex=0,r.focus({preventScroll:!0}));}}}},e}();t.Selection=c;},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n,o=i(11),r=i(138),a=i(139),s=i(140),l=i(151),c=i(152),u=i(159),d={cell:{row:null,col:null},editor:null,gridId:null};t.getEditor=function(e,t,i){var h="boolean"===t.type?"checkbox":i.$editable.editorType;if(void 0===h&&(h=i.autoHeight?"textarea":"input"),d.cell.row===e.id&&d.cell.col===t.id&&d.gridId===i.gridId&&i.$editable.editor)return d.editor;switch("checkbox"!==h&&(d={cell:{row:e.id,col:t.id},editor:d.editor,gridId:i.gridId}),n||(n=function(){d={cell:{row:null,col:null},editor:null,gridId:null};},i.events.on(o.GridEvents.afterEditEnd,n)),h){case"input":default:return d.editor=new r.InputEditor(e,t,i);case"textarea":return d.editor=new u.TextAreaEditor(e,t,i);case"select":return d.editor=new a.SelectEditor(e,t,i);case"datePicker":return d.editor=new s.DateEditor(e,t,i);case"checkbox":return new l.CheckboxEditor(e,t,i);case"multiselect":case"combobox":return d.editor=new c.ComboboxEditor(e,t,i)}};},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),o=i(11),r=i(1),a=function(){function e(e,t,i){this._config=i,this._cell={row:e,col:t},this._initHandlers();}return e.prototype.endEdit=function(e){var t;e||(t=this._input.value),this._config.events.fire(o.GridEvents.beforeEditEnd,[t,this._cell.row,this._cell.col])?(this._input.removeEventListener("blur",this._handlers.onBlur),this._input.removeEventListener("change",this._handlers.onChange),"string"!==this._cell.col.type&&r.isNumeric(t)&&(t=parseFloat(t)),this._cell.row=this._config.datacollection.getItem(this._cell.row.id),this._config.events.fire(o.GridEvents.afterEditEnd,[t,this._cell.row,this._cell.col])):this._input.focus();},e.prototype.toHTML=function(e){var t=this._cell.row[this._cell.col.id];return this._input&&(t=this._input.value),this._config.$editable.editor=this,n.el("input.dhx_cell-editor.dhx_cell-editor__input",{_hooks:{didInsert:this._handlers.didInsert},_key:"cell_editor","data-dhx-id":"cell_editor",value:null!=e?e:t})},e.prototype._initHandlers=function(){var e=this;this._handlers={onBlur:function(){e.endEdit();},onChange:function(){e.endEdit();},didInsert:function(t){var i=t.el;e._input=i,i.focus(),i.setSelectionRange(0,i.value.length),i.addEventListener("change",e._handlers.onChange),i.addEventListener("blur",e._handlers.onBlur);}};},e}();t.InputEditor=a;},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),o=i(11),r=function(){function e(e,t,i){this._config=i,this._cell={row:e,col:t},this._initHandlers();}return e.prototype.endEdit=function(e){var t;e||(t=this._input.value),this._config.events.fire(o.GridEvents.beforeEditEnd,[t,this._cell.row,this._cell.col])?(this._input.removeEventListener("blur",this._handlers.onBlur),this._input.removeEventListener("keydown",this._handlers.onkeydown),this._cell.row=this._config.datacollection.getItem(this._cell.row.id),this._config.events.fire(o.GridEvents.afterEditEnd,[t,this._cell.row,this._cell.col])):this._input.focus();},e.prototype.toHTML=function(){var e=this._cell.col.options.map((function(e){return "string"==typeof e?{id:""+e,value:e}:e}))||[],t=this._cell.row[this._cell.col.id];this._input&&(t=this._input.options[this._input.selectedIndex].value);var i=e.map((function(e){return n.el("option",{selected:e.id.toString()===t.toString(),value:e.id},e.value)}));return this._config.$editable.editor=this,n.el("select.dhx_cell-editor.dhx_cell-editor__select",{_hooks:{didInsert:this._handlers.didInsert},_key:"cell_editor","data-dhx-id":"cell_editor"},i)},e.prototype._initHandlers=function(){var e=this;this._handlers={onBlur:function(){e.endEdit();},onkeydown:function(t){"Escape"===t.key&&e.endEdit();},didInsert:function(t){var i=t.el;e._input=i,i.focus(),i.addEventListener("blur",e._handlers.onBlur),i.addEventListener("keydown",e._handlers.onkeydown);}};},e}();t.SelectEditor=r;},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),o=i(11),r=i(39),a=i(18),s=i(8),l=function(){function e(e,t,i){var n=this;this._config=i,this._cell={row:e,col:t},this._calendar=new r.Calendar(null,{dateFormat:t.format});var o=this._cell.row[this._cell.col.id],l=this._calendar.config.dateFormat;(a.stringToDate(o,l,!0)||o instanceof Date)&&(this._calendar.setValue(o),this._value=this._calendar.getValue(),this._cell.row[this._cell.col.id]=this._value),this._popup=new s.Popup,this._popup.attach(this._calendar),this._calendar.events.on(r.CalendarEvents.change,(function(){n.endEdit(!1,!0);})),this._popup.events.on(s.PopupEvents.afterHide,(function(){n.endEdit();})),this._initHandlers();}return e.prototype.endEdit=function(e,t){var i=this;if(this._handlers){var r=this._calendar.config.dateFormat,s=this._cell.row[this._cell.col.id];if(!e){if(s instanceof Date||t)return this._value=this._calendar.getValue(),this._input.value=this._value,void this._popup.hide();a.stringToDate(this._input.value,r,!0)&&(s&&this._input.value.length===s.length||!s)&&(this._value=this._input.value);}this._config.events.fire(o.GridEvents.beforeEditEnd,[this._value,this._cell.row,this._cell.col])?(this._input.removeEventListener("focus",this._handlers.onFocus),this._input.removeEventListener("change",this._handlers.onChange),document.removeEventListener("mousedown",this._handlers.onOuterClick),n.awaitRedraw().then((function(){i._popup.destructor(),i._calendar.destructor();})),this._cell.row=this._config.datacollection.getItem(this._cell.row.id),this._config.events.fire(o.GridEvents.afterEditEnd,[this._value,this._cell.row,this._cell.col])):this._input.focus();}},e.prototype.toHTML=function(){var e=this._cell.row[this._cell.col.id];return this._config.$editable.editor=this,document.addEventListener("mousedown",this._handlers.onOuterClick),n.el("input.dhx_cell-editor.dhx_cell-editor__input.dhx_cell-editor__datepicker",{_hooks:{didInsert:this._handlers.didInsert},_key:"cell_editor","data-dhx-id":"cell_editor",value:e})},e.prototype._initHandlers=function(){var e=this;this._handlers={onFocus:function(){n.awaitRedraw().then((function(){e._popup.show(e._input,{centering:!0,mode:"bottom"});}));},onChange:function(){e.endEdit();},onOuterClick:function(t){if(t.target instanceof Node){var i=e._input&&e._input.contains(t.target),n=e._popup&&e._popup.getRootNode()&&e._popup.getRootNode().contains(t.target);i||n||e._popup.hide();}},didInsert:function(t){var i=t.el;e._input=i,e._input.addEventListener("focus",e._handlers.onFocus),e._input.addEventListener("change",e._handlers.onChange),i.focus(),i.setSelectionRange(i.value.length,i.value.length);}};},e}();t.DateEditor=l;},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);}),r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},a=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),l=i(0),c=i(4),u=i(7),d=i(54),h=i(150),f=i(18),p=i(78),v=i(3),g=function(e){function t(t,i){void 0===i&&(i={});var n=e.call(this,t,s.extend({weekStart:"sunday",thisMonthOnly:!1,dateFormat:window&&window.dhx&&window.dhx.dateFormat,width:"250px"},i))||this;switch(n._selected=[],n.events=new c.EventSystem,n.config.disabledDates=n.config.disabledDates||n.config.block,n.config.mode=n.config.mode||n.config.view,n.config.dateFormat||(n.config.timePicker?12===n.config.timeFormat?n.config.dateFormat="%d/%m/%y %h:%i %A":n.config.dateFormat="%d/%m/%y %H:%i":n.config.dateFormat="%d/%m/%y"),n.config.value&&n._setSelected(n.config.value),n.config.date?n._currentDate=f.DateHelper.toDateObject(n.config.date,n.config.dateFormat):n._getSelected()?n._currentDate=f.DateHelper.copy(n._getSelected()):n._currentDate=new Date,n.config.mode){case"month":n._currentViewMode="month";break;case"year":n._currentViewMode="year";break;case"timepicker":n._currentViewMode=n.config.timePicker?"timepicker":"calendar";break;default:n._currentViewMode="calendar";}if(n._initHandlers(),n.config.timePicker){n._timepicker=new d.Timepicker(null,{timeFormat:n.config.timeFormat,controls:!0});var o=n._getSelected()||new Date;n._timepicker.setValue(o),n._time=n._timepicker.getValue(),n._timepicker.events.on(d.TimepickerEvents.afterClose,(function(){n._timepicker.setValue(n._time),n.showDate(null,"calendar");})),n._timepicker.events.on(d.TimepickerEvents.afterApply,(function(){var e=n._timepicker.getValue(!0),t=e.hour,i=e.minute,o=e.AM,r=n._getSelected(),a=f.DateHelper.withHoursAndMinutes(n._getSelected()||new Date,t,i,o);n.events.fire(p.CalendarEvents.beforeChange,[a,r,!0])&&(n._selected[n._selected.length-1]=a,n.events.fire(p.CalendarEvents.change,[a,r,!0])),n._time=n._timepicker.getValue(),n.showDate(null,"calendar");}));}return n.mount(t,l.create({render:function(){return n._draw()}})),n}return o(t,e),t.prototype.setValue=function(e){if(!e||e instanceof Array&&0===e.length)return !1;this._selected=[];var t=e instanceof Array?e[0]:e,i=f.DateHelper.toDateObject(t,this.config.dateFormat),n=f.DateHelper.copy(this._getSelected());return !!this.events.fire(p.CalendarEvents.beforeChange,[i,n,!1])&&(this._setSelected(e),this._timepicker&&(this._timepicker.setValue(i),this._time=this._timepicker.getValue()),this.showDate(this._getSelected()),this.events.fire(p.CalendarEvents.change,[i,n,!1]),this.paint(),!0)},t.prototype.getValue=function(e){var t=this;return void 0===e&&(e=!1),this._selected[0]?this.config.range?e?this._selected.map((function(e){return f.DateHelper.copy(e)})):this._selected.map((function(e){return f.getFormattedDate(t.config.dateFormat,e)})):e?f.DateHelper.copy(this._selected[0]):f.getFormattedDate(this.config.dateFormat,this._selected[0]):""},t.prototype.getCurrentMode=function(){return this._currentViewMode},t.prototype.showDate=function(e,t){e&&(this._currentDate=f.DateHelper.copy(e)),t&&(this._currentViewMode=t),this.paint();},t.prototype.destructor=function(){this._linkedCalendar&&this._unlink(),this._timepicker&&this._timepicker.destructor(),this.events&&this.events.clear(),this.config=this.events=null,this._uid=this._selected=this._currentDate=this._currentViewMode=this._handlers=this._timepicker=this._time=null,this.unmount();},t.prototype.clear=function(){var e=this.getValue(!0);this.config.timePicker&&(this._timepicker.clear(),this._time=this._timepicker.getValue()),this._selected=[],this.showDate(null,this.config.mode),this.events.fire(p.CalendarEvents.change,[this.getValue(!0),e,!1]);},t.prototype.link=function(e){var t=this;this._linkedCalendar&&this._unlink(),this._linkedCalendar=e;var i=this.getValue(!0),n=e.getValue(!0),o=i&&f.DateHelper.dayStart(i),r=n&&f.DateHelper.dayStart(n);this.config.$rangeMark&&this._linkedCalendar.config.$rangeMark||(this.config.$rangeMark=this._linkedCalendar.config.$rangeMark=function(e){if(o&&r)return e>=o&&e<=r&&function(e){if(f.DateHelper.isSameDay(r,o))return null;var t="dhx_calendar-day--in-range";return f.DateHelper.isSameDay(e,o)&&(t+=" dhx_calendar-day--first-date"),f.DateHelper.isSameDay(e,r)&&(t+=" dhx_calendar-day--last-date"),t}(e)}),this.config.disabledDates&&this._linkedCalendar.config.disabledDates||(this.config.disabledDates=function(e){if(r)return e>r},this._linkedCalendar.config.disabledDates=function(e){if(o)return e<o}),this.config.thisMonthOnly=!0,e.config.thisMonthOnly=!0,this.events.on(p.CalendarEvents.change,(function(e){o=e?f.DateHelper.dayStart(e):null,t._linkedCalendar.paint();}),"link"),this._linkedCalendar.events.on(p.CalendarEvents.change,(function(e){r=e?f.DateHelper.dayStart(e):null,t.paint();}),"link"),this._linkedCalendar.paint(),this.paint();},t.prototype._unlink=function(){this._linkedCalendar&&(this.config.$rangeMark=this._linkedCalendar.config.$rangeMark=null,this.config.disabledDates=this._linkedCalendar.config.disabledDates=null,this.events.detach(p.CalendarEvents.change,"link"),this._linkedCalendar.events.detach(p.CalendarEvents.change,"link"),this._linkedCalendar.paint(),this._linkedCalendar=null);},t.prototype._setSelected=function(e){var t=this,i=e instanceof Array?e[0]:e,n=f.DateHelper.toDateObject(i,this.config.dateFormat);if(e instanceof Array&&this.config.range){var o=[];e.forEach((function(e,i){i<2&&o.push(f.DateHelper.toDateObject(e,t.config.dateFormat));})),2===o.length&&o[0]<o[1]?o.forEach((function(e){return t._selected.push(e)})):this._selected[0]=o[0];}else this._selected[0]=n;},t.prototype._getSelected=function(){return this._selected[this._selected.length-1]},t.prototype._draw=function(){switch(this._currentViewMode){case"calendar":return this.events.fire(p.CalendarEvents.modeChange,["calendar"]),this._drawCalendar();case"month":return this.events.fire(p.CalendarEvents.modeChange,["month"]),this._drawMonthSelector();case"year":return this.events.fire(p.CalendarEvents.modeChange,["year"]),this._drawYearSelector();case"timepicker":return this.events.fire(p.CalendarEvents.modeChange,["timepicker"]),this._drawTimepicker()}},t.prototype._initHandlers=function(){var e=this,t={Up:"ArrowUp",Down:"ArrowDown",Right:"ArrowRight",Left:"ArrowLeft",Esc:"Escape",Spacebar:"Space"},i=function(t){void 0===t&&(t=!1);var i=0;switch(e._currentViewMode){case"calendar":i=t?-7:7;break;case"month":case"year":i=t?-4:4;}return i};this._handlers={onkeydown:{".dhx_calendar-year, .dhx_calendar-month, .dhx_calendar-day":function(n,o){switch(function(e){var i;if(e.which>=48&&e.which<=57||e.which>=65&&e.which<=90)i=String.fromCharCode(e.which);else {var n=32===e.which?e.code:e.key;i=v.isIE()&&t[n]||n;}return i}(n)){case"Enter":e._selectDate(n,o);break;case"ArrowLeft":e._moveBrowseFocus(n,o,-1);break;case"ArrowRight":e._moveBrowseFocus(n,o,1);break;case"ArrowUp":e._moveBrowseFocus(n,o,i(!0));break;case"ArrowDown":e._moveBrowseFocus(n,o,i());}}},onclick:{".dhx_calendar-year, .dhx_calendar-month, .dhx_calendar-day":function(t,i){e._selectDate(t,i);},".dhx_calendar-action__cancel":function(){e.showDate(e._getSelected(),"calendar"),e.events.fire(p.CalendarEvents.cancelClick,[]);},".dhx_calendar-action__show-month":function(){return e.showDate(null,"month")},".dhx_calendar-action__show-year":function(){return e.showDate(null,"year")},".dhx_calendar-action__next":function(){var t;switch(e._currentViewMode){case"calendar":t=f.DateHelper.addMonth(e._currentDate,1);break;case"month":t=f.DateHelper.addYear(e._currentDate,1);break;case"year":t=f.DateHelper.addYear(e._currentDate,12);}e.showDate(t);},".dhx_calendar-action__prev":function(){var t;switch(e._currentViewMode){case"calendar":t=f.DateHelper.addMonth(e._currentDate,-1);break;case"month":t=f.DateHelper.addYear(e._currentDate,-1);break;case"year":t=f.DateHelper.addYear(e._currentDate,-12);}e.showDate(t);},".dhx_calendar-action__show-timepicker":function(){e._currentViewMode="timepicker",e.paint();}},onmouseover:{".dhx_calendar-day":function(t,i){e.events.fire(p.CalendarEvents.dateMouseOver,[new Date(i.attrs._date),t]),e.events.fire(p.CalendarEvents.dateHover,[new Date(i.attrs._date),t]);}}};},t.prototype._getData=function(e){var t,i=this;switch(this._isSelectedInCurrentRange=!1,this.config.weekStart){case"saturday":t=-1;break;case"monday":t=1;break;default:t=0;}for(var n=[],o=6,r=f.DateHelper.weekStart(f.DateHelper.monthStart(e),t);o--;){for(var a=f.DateHelper.getWeekNumber(r),s=0,l=7,c=[],u=function(){var t=f.DateHelper.isWeekEnd(r),n=e.getMonth()===r.getMonth(),o=d.config.disabledDates&&d.config.disabledDates(r),a=[];if(d.config.range&&d._selected[0]&&d._selected[1]){var l=function(){if(i._selected[0]&&i._selected[1]){var e=f.DateHelper.dayStart(i._selected[0]),t=f.DateHelper.dayStart(i._selected[1]);return r>=e&&r<=t&&(f.DateHelper.isSameDay(i._selected[0],i._selected[1])?null:"dhx_calendar-day--in-range")}};d.config.$rangeMark=l;}if(t&&n&&a.push("dhx_calendar-day--weekend"),n||(d.config.thisMonthOnly?(s++,a.push("dhx_calendar-day--hidden")):a.push("dhx_calendar-day--muffled")),d.config.mark){var u=d.config.mark(r);u&&a.push(u);}d.config.$rangeMark&&((l=d.config.$rangeMark(r))&&a.push(l));o&&(t?a.push("dhx_calendar-day--weekend-disabled"):a.push("dhx_calendar-day--disabled")),d._selected.forEach((function(e,t){if(e&&f.DateHelper.isSameDay(e,r)){i._isSelectedInCurrentRange=!0;var n="dhx_calendar-day--selected";i.config.range&&(n+=" dhx_calendar-day--selected-"+(0===t?"first ":"last")),a.push(n);}})),c.push({date:r,day:r.getDate(),css:a.join(" ")}),r=f.DateHelper.addDay(r);},d=this;l--;)u();n.push({weekNumber:a,days:c,disabledWeekNumber:7===s});}return n},t.prototype._drawCalendar=function(){var e,t=this,i=this._currentDate,n=this.config,o=n.weekStart,s=n.thisMonthOnly,c=n.css,u=n.timePicker,d=n.width;switch(o){case"saturday":e=a([f.locale.daysShort[6]],f.locale.daysShort.slice(0,-1));break;case"monday":e=a(f.locale.daysShort.slice(1),[f.locale.daysShort[0]]);break;default:e=f.locale.daysShort;}for(var h,p=e.map((function(e){return l.el(".dhx_calendar-weekday",e)})),v=this._getData(i),g=!0,_=this._getSelected(),m=function(e){var i={role:"button",tabindex:-1,"aria-pressed":"false"};return e&&(t._isSelectedInCurrentRange?function(e){return e&&_&&e.getTime()===_.getTime()}(e.date)&&(i.tabindex=0,i["aria-pressed"]="true"):g&&(i.tabindex=0),g=!1),i},y=[],b=[],w=0,x=v;w<x.length;w++){var E=x[w],C=E.days.map((function(e){return l.el("div.dhx_calendar-day",r({class:e.css,_date:e.date},m(e)),e.day)}));!this.config.weekNumbers||E.disabledWeekNumber&&s||b.push(l.el("div",{class:"dhx_calendar-week-number"},E.weekNumber)),y=y.concat(C);}this.config.weekNumbers&&(h=l.el(".dhx_calendar__week-numbers",b));var S="dhx_calendar dhx_widget"+(c?" "+c:"")+(u?" dhx_calendar--with_timepicker":"")+(this.config.weekNumbers?" dhx_calendar--with_week-numbers":"");return l.el("div",r({class:S,style:{width:this.config.weekNumbers?parseInt(d.toString())+48+"px":d}},this._handlers),[l.el(".dhx_calendar__wrapper",[this._drawHeader(l.el("button.dhx_calendar-action__show-month.dhx_button.dhx_button--view_link.dhx_button--size_small.dhx_button--color_secondary.dhx_button--circle",{"aria-live":"polite",type:"button"},f.locale.months[i.getMonth()]+" "+i.getFullYear())),this.config.weekNumbers&&l.el(".dhx_calendar__dates-wrapper",[l.el(".dhx_calendar__weekdays",p),l.el(".dhx_calendar__days",y),h]),!this.config.weekNumbers&&l.el(".dhx_calendar__weekdays",p),!this.config.weekNumbers&&l.el(".dhx_calendar__days",y),u?l.el(".dhx_timepicker__actions",[l.el("button.dhx_calendar__timepicker-button.dhx_button.dhx_button--view_link.dhx_button--size_small.dhx_button--color_secondary.dhx_button--width_full.dhx_button--circle.dhx_calendar-action__show-timepicker",{type:"button"},[l.el("span.dhx_button__icon.dxi.dxi-clock-outline"),l.el("span.dhx_button__text",this._time)])]):null])])},t.prototype._drawMonthSelector=function(){var e=this._currentDate,t=e.getMonth(),i=this._getSelected()?this._getSelected().getFullYear():null,n=this.config,o=n.css,a=n.timePicker,s=n.weekNumbers,c=n.width,u=n.mode,d="dhx_calendar dhx_widget"+(o?" "+o:"")+(a?" dhx_calendar--with_timepicker":"")+(s?" dhx_calendar--with_week-numbers":""),h=!0,p=i===e.getFullYear(),v=function(e){return p&&t===e};return l.el("div",r({class:d,style:{width:s?parseInt(c.toString())+48+"px":c}},this._handlers),[l.el(".dhx_calendar__wrapper",[this._drawHeader(l.el("button.dhx_calendar-action__show-year.dhx_button.dhx_button--view_link.dhx_button--size_small.dhx_button--color_secondary.dhx_button--circle",{"aria-live":"polite",type:"button"},e.getFullYear())),l.el(".dhx_calendar__months",f.locale.monthsShort.map((function(e,t){return l.el("div",r(r({class:"dhx_calendar-month"+(v(t)?" dhx_calendar-month--selected":"")},function(e,t){var i={role:"button",tabindex:-1,"aria-pressed":"false"};return e&&(p?v(t)&&(i.tabindex=0,i["aria-pressed"]="true"):h&&(i.tabindex=0),h=!1),i}(e,t)),{_date:t}),e)}))),"month"!==u?l.el(".dhx_calendar__actions",[l.el("button.dhx_button.dhx_button--color_primary.dhx_button--view_link.dhx_button--size_small.dhx_button--width_full.dhx_button--circle.dhx_calendar-action__cancel",{type:"button"},f.locale.cancel)]):null])])},t.prototype._drawYearSelector=function(){var e=this,t=this._currentDate,i=f.DateHelper.getTwelweYears(t),n=this.config,o=n.css,a=n.timePicker,s=n.weekNumbers,c=n.width,u=n.mode,d="dhx_calendar dhx_widget"+(o?" "+o:"")+(a?" dhx_calendar--with_timepicker":"")+(s?" dhx_calendar--with_week-numbers":""),h=!0,p=this._getSelected()&&i.includes(this._getSelected().getFullYear()),v=function(t){return e._getSelected()&&t===e._getSelected().getFullYear()};return l.el("div",r({class:d,style:{width:s?parseInt(c.toString())+48+"px":c}},this._handlers),[l.el(".dhx_calendar__wrapper",[this._drawHeader(l.el("button.dhx_button.dhx_button--view_link.dhx_button--size_small.dhx_button--color_secondary.dhx_button--circle",{"aria-live":"polite",type:"button"},i[0]+"-"+i[i.length-1])),l.el(".dhx_calendar__years",i.map((function(e){return l.el("div",r({class:"dhx_calendar-year"+(v(e)?" dhx_calendar-year--selected":""),_date:e},function(e){var t={role:"button",tabindex:-1,"aria-pressed":"false"};return e&&(p?v(e)&&(t.tabindex=0,t["aria-pressed"]="true"):h&&(t.tabindex=0),h=!1),t}(e)),e)}))),"year"!==u&&"month"!==u?l.el(".dhx_calendar__actions",[l.el("button.dhx_button.dhx_button--color_primary.dhx_button--view_link.dhx_button--size_small.dhx_button--width_full.dhx_button--circle.dhx_calendar-action__cancel",{type:"button"},f.locale.cancel)]):null])])},t.prototype._drawHeader=function(e){return l.el(".dhx_calendar__navigation",[l.el("button.dhx_calendar-navigation__button.dhx_calendar-action__prev"+h.linkButtonClasses+".dhx_button--icon.dhx_button--circle",{"aria-label":"prev",type:"button"},[l.el(".dhx_button__icon.dxi.dxi-chevron-left")]),e,l.el("button.dhx_calendar-navigation__button.dhx_calendar-action__next"+h.linkButtonClasses+".dhx_button--icon.dhx_button--circle",{"aria-label":"next",type:"button"},[l.el(".dhx_button__icon.dxi.dxi-chevron-right")])])},t.prototype._drawTimepicker=function(){var e=this.config,t=e.css,i=e.weekNumbers,n=e.width;return l.el(".dhx_widget.dhx-calendar",{class:t?" "+t:"",style:{width:i?parseInt(n.toString())+48+"px":n}},[l.inject(this._timepicker.getRootView())])},t.prototype._selectDate=function(e,t){var i=t.attrs._date,n=f.DateHelper.copy(this._getSelected());switch(this._currentViewMode){case"calendar":var o=this.config.timePicker?f.DateHelper.mergeHoursAndMinutes(i,this._getSelected()||this._currentDate):i;if(!this.events.fire(p.CalendarEvents.beforeChange,[o,n,!0]))return;this.config.range&&1===this._selected.length&&this._selected[0]<o?this._selected.push(o):(this._selected=[],this._selected[0]=o),t.el.blur(),this.showDate(this._getSelected()),this.events.fire(p.CalendarEvents.change,[i,n,!0]);break;case"month":if("month"!==this.config.mode)f.DateHelper.setMonth(this._currentDate,i),this.showDate(null,"calendar"),this.events.fire(p.CalendarEvents.monthSelected,[i]);else {var r=f.DateHelper.fromYearAndMonth(this._currentDate.getFullYear()||this._getSelected().getFullYear(),i);if(!this.events.fire(p.CalendarEvents.beforeChange,[r,n,!0]))return;this._currentDate=r,this._selected[0]=r,this.events.fire(p.CalendarEvents.change,[this._getSelected(),n,!0]),this.events.fire(p.CalendarEvents.monthSelected,[i]),this.paint();}break;case"year":if("year"!==this.config.mode)f.DateHelper.setYear(this._currentDate,i),this.showDate(null,"month"),this.events.fire(p.CalendarEvents.yearSelected,[i]);else {r=f.DateHelper.fromYear(i);if(!this.events.fire(p.CalendarEvents.beforeChange,[r,n,!0]))return;this._currentDate=r,this._selected[0]=r,this.events.fire(p.CalendarEvents.change,[this._getSelected(),n,!0]),this.events.fire(p.CalendarEvents.yearSelected,[i]),this.paint();}}},t.prototype._moveBrowseFocus=function(e,t,i){if(t){var n=t.parent.body[t.idx+i];if(n){var o=n.el;o&&(e.target.tabIndex=-1,o.tabIndex=0,o.focus({preventScroll:!0}));}}},t}(u.View);t.Calendar=g;},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);}),r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=i(1),s=i(0),l=i(4),c=i(7),u=i(15),d=i(74),h=i(148),f=i(149),p=i(77),v=i(3);function g(e,t){return isNaN(e)?0:Math.min(t,Math.max(0,e))}var _=function(e){function t(t,i){void 0===i&&(i={});var n=e.call(this,t,a.extend({timeFormat:24,controls:!1,valueFormat:"string",actions:!1},i))||this;return n.events=new l.EventSystem(n),n._time={hour:0,minute:0,AM:!0},12===n.config.timeFormat&&(n._time.hour=12),n.config.controls=n.config.controls||n.config.actions,n.config.value&&n._setValue(n.config.value),n._initUI(t),n._initHandlers(),n._initEvents(),n}return o(t,e),t.prototype.getValue=function(e){12===this.config.timeFormat&&(this._time.hour=this._time.hour%12||12);var t=this._time,i=t.hour,n=t.minute,o=t.AM;if(e){var r={hour:i,minute:n};return 12===this.config.timeFormat&&(r.AM=o),r}return (i<10?"0"+i:i)+":"+(n<10?"0"+n:n)+(12===this.config.timeFormat?o?"AM":"PM":"")},t.prototype.setValue=function(e){this._setValue(e),this._hoursSlider.setValue(this._time.hour),this._minutesSlider.setValue(this._time.minute),this._inputsView.paint();},t.prototype.clear=function(){24===this.config.timeFormat?this.setValue("00:00"):this.setValue("12:00AM");},t.prototype.destructor=function(){this._minutesSlider&&this._minutesSlider.destructor(),this._hoursSlider&&this._hoursSlider.destructor(),this.events&&this.events.clear(),this.layout&&this.layout.destructor(),this.config=this.events=null,this._handlers=this._time=this._inputsView=this._minutesSlider=this._hoursSlider=null,this.unmount();},t.prototype.getRootView=function(){return this.layout.getRootView()},t.prototype._setValue=function(e){var t,i=0,n=0;if("number"==typeof e&&(e=new Date(e)),e instanceof Date)i=e.getMinutes(),n=e.getHours();else if(Array.isArray(e))n=g(e[0],23),i=g(e[1],59),e[2]&&"pm"===e[2].toLowerCase()&&(t=!0);else if("string"==typeof e){var o=e.match(/\d+/g);n=g(+o[0],23),i=g(+o[1],59),e.toLowerCase().includes("pm")&&(t=!0);}else "object"==typeof e&&e.hasOwnProperty("hour")&&e.hasOwnProperty("minute")&&(n=e.hour,i=e.minute,t=!e.AM);return t&&n<12&&(n+=12),12===this.config.timeFormat&&!f.isTimeCheck(e)&&n>=12&&(t=!0),this._time={hour:n,minute:i,AM:!t}},t.prototype._initUI=function(e){var t=this,i={gravity:!1,css:"dhx_widget dhx_timepicker "+(this.config.css?this.config.css:"")+(this.config.controls?" dhx_timepicker--with-controls":""),rows:[{id:"timepicker",css:"dhx_timepicker__inputs"},{id:"hour-slider",css:"dhx_timepicker__hour"},{id:"minute-slider",css:"dhx_timepicker__minute"}]};this.config.controls&&(i.rows.unshift({id:"close-action",css:"dhx_timepicker__close"}),i.rows.push({id:"save-action",css:"dhx_timepicker__save"}));var n=this.layout=new u.Layout(e,i),o=s.create({render:function(){return t._draw()}}),r=this._inputsView=c.toViewLike(o),a=this._minutesSlider=new d.Slider(null,{min:0,max:59,step:1,tooltip:!1,labelPosition:"top",label:h.default.minutes,value:this.config.value?this._time.minute:0}),l=this._hoursSlider=new d.Slider(null,{min:0,max:23,step:1,tooltip:!1,labelPosition:"top",label:h.default.hours,value:this.config.value?12===this._time.hour&&this._time.AM?0:this._time.hour:0});if(n.getCell("timepicker").attach(r),n.getCell("hour-slider").attach(l),n.getCell("minute-slider").attach(a),this.config.controls){n.getCell("save-action").attach((function(){return s.el("button.dhx_timepicker__button-save.dhx_button.dhx_button--view_flat.dhx_button--color_primary.dhx_button--size_small.dhx_button--circle.dhx_button--width_full",{onclick:t._outerHandlers.save,type:"button"},h.default.save)})),n.getCell("close-action").attach((function(){return s.el("button.dhx_timepicker__button-close.dhx_button.dhx_button--view_link.dhx_button--size_medium.dhx_button--view_link.dhx_button--color_secondary.dhx_button--icon.dhx_button--circle",{_ref:"close",onclick:t._outerHandlers.close,type:"button","aria-label":"close timepicker"},[s.el("span.dhx_button__icon.dxi.dxi-close")])}));}},t.prototype._initHandlers=function(){var e=this,t=function(t){var i=g(parseInt(t.value,10),59);t.value=i.toString(),e._minutesSlider.setValue(i);},i=function(t){var i=g(parseInt(t.value,10),23);t.value=i.toString(),e._hoursSlider.setValue(i);};this._handlers={onchange:{".dhx_timepicker-input--hour":function(e){return i(e.target)},".dhx_timepicker-input--minutes":function(e){return t(e.target)}},oninput:{".dhx_timepicker-input--hour":function(e){(v.isSafari()||v.isFirefox())&&i(e.target);},".dhx_timepicker-input--minutes":function(e){(v.isSafari()||v.isFirefox())&&t(e.target);}}},this._outerHandlers={close:function(){e.events.fire(p.TimepickerEvents.beforeClose,[e.getValue("timeObject"===e.config.valueFormat)])&&(e.events.fire(p.TimepickerEvents.afterClose,[e.getValue("timeObject"===e.config.valueFormat)]),e.events.fire(p.TimepickerEvents.close,[]));},save:function(){e.events.fire(p.TimepickerEvents.beforeApply,[e.getValue("timeObject"===e.config.valueFormat)])&&(e.events.fire(p.TimepickerEvents.afterApply,[e.getValue("timeObject"===e.config.valueFormat)]),e.events.fire(p.TimepickerEvents.apply,[e.getValue()]),e.events.fire(p.TimepickerEvents.save,[e._time]));}};},t.prototype._initEvents=function(){var e=this;this._hoursSlider.events.on(d.SliderEvents.change,(function(t){t<e._hoursSlider.config.min||t>e._hoursSlider.config.max||(12===e.config.timeFormat?(e._time.AM=t<12,e._time.hour=t%12||12):e._time.hour=t,e.events.fire(p.TimepickerEvents.change,[e.getValue("timeObject"===e.config.valueFormat)]),e._inputsView.paint());})),this._minutesSlider.events.on(d.SliderEvents.change,(function(t){t<e._minutesSlider.config.min||t>e._minutesSlider.config.max||(e._time.minute=t,e.events.fire(p.TimepickerEvents.change,[e.getValue("timeObject"===e.config.valueFormat)]),e._inputsView.paint());}));},t.prototype._draw=function(){return s.el(".dhx_timepicker-inputs",r({},this._handlers),[s.el("input.dhx_timepicker-input.dhx_timepicker-input--hour",{_key:"hour",_ref:"hour",value:this.getValue(!0).hour.toString().length>1?this.getValue(!0).hour:"0"+this.getValue(!0).hour,"aria-label":"hours"}),s.el("span.dhx_timepicker-delimer",":"),s.el("input.dhx_timepicker-input.dhx_timepicker-input--minutes",{_key:"minute",value:this.getValue(!0).minute.toString().length>1?this.getValue(!0).minute:"0"+this.getValue(!0).minute,"aria-label":"minutes"}),12===this.config.timeFormat?s.el(".dhx_timepicker-ampm",this._time.AM?"AM":"PM"):null])},t}(c.View);t.Timepicker=_;},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.getBlockRange=function(e,t,i){return void 0===i&&(i=!0),i?{min:e.left+window.pageXOffset,max:t.right+window.pageXOffset}:{min:e.top+window.pageYOffset,max:t.bottom+window.pageYOffset}},t.getMarginSize=function(e,t){return e&&("space"===e.type||"wide"===e.type&&t)?10:0};},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);});Object.defineProperty(t,"__esModule",{value:!0});var r=i(72),a=i(145),s=function(e){function t(t,i){return e.call(this,t,i)||this}return o(t,e),t.prototype._createCell=function(e){var i;return e.rows||e.cols||e.views?(e.parent=this._root,i=new t(this,e)):i=new a.ProCell(this,e),this._root._all[i.id]=i,e.init&&e.init(i,e),i},t}(r.Layout);t.ProLayout=s;},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);}),r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=i(1),s=i(0),l=i(34),c=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n.scrollView=new l.ScrollView((function(){return n._getFirstRootView()})),n}return o(t,e),t.prototype._getFirstRootView=function(e){return void 0===e&&(e=this),e.getParent()&&e.getParent().getRootView()?e.getParent().getRootView():this._getFirstRootView(e.getParent())},t.prototype.toVDOM=function(e){var t;if(null===this.config&&(this.config={}),!this.config.hidden){var i,n=this._calculateStyle(),o=a.isDefined(this.config.padding)?isNaN(Number(this.config.padding))?{padding:this.config.padding}:{padding:this.config.padding+"px"}:"",l=this.config.full||this.config.html?n:r(r({},n),o);if(!this.config.html)if(this._ui){var c=this._ui.getRootView();c.render&&(c=s.inject(c)),i=c?[this.scrollView.render(c)]:c||null;}else i=e?this.scrollView.render([e]):e||null;var u=this.config.resizable&&!this._isLastCell()&&this._getNextCell()&&!this.config.collapsed?s.el(".dhx_layout-resizer."+(this._isXDirection()?"dhx_layout-resizer--x":"dhx_layout-resizer--y"),r(r({},this._resizerHandlers),{_ref:"resizer_"+this._uid}),[s.el("span.dhx_layout-resizer__icon",{class:"dxi "+(this._isXDirection()?"dxi-dots-vertical":"dxi-dots-horizontal")})]):null,d={};if(this.config.on)for(var h in this.config.on)d["on"+h]=this.config.on[h];var f="",p=this.config.cols||this.config.rows;if(this.config.type&&p)switch(this.config.type){case"line":f=" dhx_layout-line";break;case"wide":f=" dhx_layout-wide";break;case"space":f=" dhx_layout-space";}var v=s.el(".dhx_layout-cell-content",{_key:this._uid+"_html",style:o},[s.el(".dhx_layout-cell-inner_html",{".innerHTML":this.config.html})]),g=s.el("div",r(r(((t={_key:this._uid,_ref:this._uid})["aria-label"]=this.config.id?"tab-content-"+this.config.id:null,t),d),{class:this._getCss(!1)+(this.config.css?" "+this.config.css:"")+(this.config.collapsed?" dhx_layout-cell--collapsed":"")+(this.config.resizable?" dhx_layout-cell--resizable":"")+(this.config.type&&!this.config.full?f:""),style:l}),this.config.full?[s.el("div",{tabindex:this.config.collapsable?"0":"-1",class:"dhx_layout-cell-header"+(this._isXDirection()?" dhx_layout-cell-header--col":" dhx_layout-cell-header--row")+(this.config.collapsable?" dhx_layout-cell-header--collapseble":"")+(this.config.collapsed?" dhx_layout-cell-header--collapsed":"")+(((this.getParent()||{}).config||{}).isAccordion?" dhx_layout-cell-header--accordion":""),style:{height:this.config.headerHeight},onclick:this._handlers.toggle,onkeydown:this._handlers.enterCollapse},[this.config.headerIcon&&s.el("span.dhx_layout-cell-header__icon",{class:this.config.headerIcon}),this.config.headerImage&&s.el(".dhx_layout-cell-header__image-wrapper",[s.el("img",{src:this.config.headerImage,class:"dhx_layout-cell-header__image"})]),this.config.header&&s.el("h3.dhx_layout-cell-header__title",this.config.header),this.config.collapsable?s.el("div.dhx_layout-cell-header__collapse-icon",{class:this._getCollapseIcon()}):s.el("div.dhx_layout-cell-header__collapse-icon",{class:"dxi dxi-empty"})]),this.config.collapsed?null:s.el("div",{style:r(r({},o),{height:"calc(100% - "+(this.config.headerHeight||37)+"px)"}),class:this._getCss(!0)+" dhx_layout-cell-content"+(this.config.type?f:"")},this.config.html?[s.el("div",{".innerHTML":this.config.html,class:"dhx_layout-cell dhx_layout-cell-inner_html"})]:i)]:!this.config.html||this.config.rows&&this.config.cols&&this.config.views?i:[this.config.collapsed?null:this.scrollView&&this.scrollView.config.enable?this.scrollView.render([v],this._uid):v]);return u?[g,u]:g}},t}(i(73).Cell);t.ProCell=c;},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);}),r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=i(1),s=i(0),l=i(4),c=i(20),u=i(7),d=i(8),h=i(76),f=i(3);function p(e,t,i){return e<t?t:e>i?i:e}var v=function(e){function t(t,i){var n=e.call(this,t,a.extend({mode:"horizontal",min:0,max:100,step:1,tooltip:!0},i))||this;n._disabled=!1,n.config.helpMessage=n.config.helpMessage||n.config.help,void 0!==n.config.thumbLabel&&(n.config.tooltip=n.config.thumbLabel),n.config.labelInline&&(n.config.labelPosition="left"),n.events=new l.EventSystem(n),n._axis="horizontal"===n.config.mode?"clientX":"clientY",n._initStartPosition(),n._keyManager=new c.KeyManager((function(){var e,t;return document.activeElement===(null===(t=null===(e=n.getRootView().refs)||void 0===e?void 0:e[n._isExtraActive?"extraRunner":"runner"])||void 0===t?void 0:t.el)})),n._initHotkeys();var o=s.create({render:function(){return n._draw()},hooks:{didMount:function(){return n._calcSliderPosition()},didRedraw:function(){return n._calcSliderPosition()}}});return n._initHandlers(),n.mount(t,o),n}return o(t,e),t.prototype.disable=function(){this._disabled=!0,this.paint();},t.prototype.enable=function(){this._disabled=!1,this.paint();},t.prototype.isDisabled=function(){return this._disabled},t.prototype.focus=function(e){this.getRootView().refs[e?"extraRunner":"runner"].el.focus();},t.prototype.blur=function(){this.getRootView().refs[this._isExtraActive?"extraRunner":"runner"].el.blur();},t.prototype.getValue=function(){var e;if(this.config.range){var t=this._getValue(this._currentPosition),i=this._getValue(this._extraCurrentPosition);e=t<i?[t,i]:[i,t];}else e=[this._getValue(this._currentPosition)];return e},t.prototype.setValue=function(e){var t=this._getValue(this._currentPosition);if(Array.isArray(e)&&e.length>1){var i=this._getValue(this._extraCurrentPosition);this._setValue(e[0],!1),this.events.fire(h.SliderEvents.change,[e[0],t,!1]),this._setValue(e[1],!0),this.events.fire(h.SliderEvents.change,[e[1],i,!0]);}else {if(e=parseFloat(e),isNaN(e))throw new Error("Wrong value type, for more info check documentation https://docs.dhtmlx.com/suite/slider__api__slider_setvalue_method.html");this._setValue(e),this.events.fire(h.SliderEvents.change,[e,t,!1]);}this.paint();},t.prototype.destructor=function(){this._keyManager&&this._keyManager.destructor(),document.body.contains(this._tooltip)&&document.body.removeChild(this._tooltip),this._tooltip=null,this.unmount();},t.prototype._calcSliderPosition=function(){var e=this.getRootView();if(e){var t=e.refs.track.el.getBoundingClientRect();this._offsets={left:t.left+window.pageXOffset,top:t.top+window.pageYOffset},this._length="horizontal"===this.config.mode?t.width:t.height;}},t.prototype._initHotkeys=function(){var e=this,t={arrowLeft:function(t){t.preventDefault(),e._move(-e.config.step,t.target.classList.contains("dhx_slider__thumb--extra"));},arrowRight:function(t){t.preventDefault(),e._move(e.config.step,t.target.classList.contains("dhx_slider__thumb--extra"));},arrowUp:function(t){t.preventDefault(),e._move(e.config.step,t.target.classList.contains("dhx_slider__thumb--extra"));},arrowDown:function(t){t.preventDefault(),e._move(-e.config.step,t.target.classList.contains("dhx_slider__thumb--extra"));}};for(var i in t)this._keyManager.addHotKey(i,t[i]);},t.prototype._move=function(e,t){this.config.inverse&&(e=-e);var i=this.config,n=i.max,o=i.min,r=t?this._getValue(this._extraCurrentPosition):this._getValue(this._currentPosition),a=r+e;this._setValue(r+e,t),(a>n||a<o)&&(a=r),this.events.fire(h.SliderEvents.change,[a,r,t]),this.paint();},t.prototype._initStartPosition=function(){var e=this.config,t=e.max,i=e.min,n=e.range,o=function(e,t,i){var n;return (n=void 0===e?[]:Array.isArray(e)?e:"string"==typeof e?e.split(",").map((function(e){return parseInt(e,10)})):[e])[0]=void 0===n[0]?t:p(n[0],t,i),n[1]=void 0===n[1]?i:p(n[1],t,i),n}(this.config.value,this.config.min,this.config.max),r=o[0],a=o[1];this._currentPosition=(r-i)/(t-i)*100,n&&(this._extraCurrentPosition=(t-a)/(t-i)*100),this._currentPosition=(r-i)/(t-i)*100,n&&(this._extraCurrentPosition=(a-i)/(t-i)*100),this._isInverse()&&(this._currentPosition=100-this._currentPosition,n&&(this._extraCurrentPosition=100-this._extraCurrentPosition));},t.prototype._getValue=function(e){this._isInverse()&&(e=100-e);var t=this.config,i=t.min,n=t.max,o=t.step;if(100===e)return n;if(0===e)return i;var r=e*(n-i)/100,a=r%o,s=a>=o/2?o:0;return +(Number(i)+Number(r)-a+s).toFixed(5)},t.prototype._setValue=function(e,t){void 0===t&&(t=!1);var i=this.config,n=i.max,o=i.min;if(e>n||e<o)return !1;var r=(e-o)/(n-o)*100,a=this._isInverse()?100-r:r;t?this._extraCurrentPosition=a:this._currentPosition=a;},t.prototype._initHandlers=function(){var e=this,t=function(t){!t.targetTouches&&t.preventDefault();var i=((t.targetTouches?t.targetTouches[0][e._axis]:t[e._axis])-e._getBegining())/e._length*100;if(e._findNewDirection){if(Math.abs(e._currentPosition-i)<1)return;i>e._currentPosition?e._possibleRange=[e._currentPosition,100]:e._possibleRange=[0,e._currentPosition],e._findNewDirection=null;}e._inSide(i)&&e._updatePosition(i,e._isExtraActive),e.paint();},i=function(n){e.events.fire(h.SliderEvents.mouseup,[n]),setTimeout((function(){e._isMouseMoving=!1,e.paint();}),4),n.targetTouches?(document.removeEventListener("touchend",i),document.removeEventListener("touchmove",t)):(document.removeEventListener("mouseup",i),document.removeEventListener("mousemove",t));},n=function(t){var i;if(!e._disabled&&3!==t.which)if(e.events.fire(h.SliderEvents.mousedown,[t]),e._isMouseMoving=!0,t.target.classList.contains("dhx_slider__thumb--extra")?(e._isExtraActive=!0,i=e._extraCurrentPosition):(e._isExtraActive=!1,i=e._currentPosition),e._findNewDirection=null,e.config.range){var n=e._currentPosition>e._extraCurrentPosition?[e._currentPosition,e._extraCurrentPosition]:[e._extraCurrentPosition,e._currentPosition],o=n[0],r=n[1];e._currentPosition===e._extraCurrentPosition?(e._findNewDirection=i,e._possibleRange=[0,100]):e._possibleRange=i<o?[0,o]:[r,100];}else e._possibleRange=[0,100];};this.config.helpMessage&&(this._helper=new d.Popup({css:"dhx_tooltip dhx_tooltip--forced dhx_tooltip--light"}),this._helper.attachHTML(this.config.helpMessage)),this._handlers={showHelper:function(t){t.preventDefault(),t.stopPropagation(),e._helper.show(t.target);},onmousedown:function(e){n(e),document.addEventListener("mousemove",t),document.addEventListener("mouseup",i);},ontouchstart:function(o){e._setTooltip(o),e._mouseIn=!1,n(o),document.addEventListener("touchmove",t),document.addEventListener("touchend",i),e.paint();},ontouchend:function(t){e._setTooltip(t),e._mouseIn=!1,e.paint();},onlabelClick:function(){e.getRootView().refs.runner.el.focus();},onclick:function(t){if(!e._disabled&&!e._isMouseMoving&&3!==t.which){var i=(t[e._axis]-e._getBegining())/e._length*100,n=e.getRootView().refs;if(e.config.range)Math.abs(e._currentPosition-i)<Math.abs(e._extraCurrentPosition-i)?(e._updatePosition(i,!1),n.runner.el.focus()):(e._updatePosition(i,!0),n.extraRunner.el.focus());else e._updatePosition(i,!1),n.runner.el.focus();e.paint();}},onmouseover:function(t){e._setTooltip(t),e._mouseIn=!0,e.paint();},onmouseout:function(t){e._setTooltip(t),e._mouseIn=!1,e.paint();},onfocus:function(t){e._setTooltip(t),e._focusIn=!0,e.events.fire(h.SliderEvents.focus,[]),e.paint();},onblur:function(t){e._setTooltip(t),e._focusIn=!1,e.events.fire(h.SliderEvents.blur,[]),e.paint();},onkeydown:function(t){e.events.fire(h.SliderEvents.keydown,[t]);}};},t.prototype._getBegining=function(){return "horizontal"===this.config.mode?this._offsets.left-window.pageXOffset:this._offsets.top-window.pageYOffset},t.prototype._inSide=function(e){var t=this._possibleRange;return e<t[0]?(this._updatePosition(t[0],this._isExtraActive),!1):!(e>t[1])||(this._updatePosition(t[1],this._isExtraActive),!1)},t.prototype._updatePosition=function(e,t){void 0===t&&(t=!1),e>100&&(e=100),e<0&&(e=0);var i=this.config,n=i.max,o=i.min,r=t?this._extraCurrentPosition:this._currentPosition,a=this._getValue(r),s=this._getValue(e);if(a!==s){var l=(s-o)/(n-o)*100,c=this._isInverse()?100-l:l;t?this._extraCurrentPosition=c:this._currentPosition=c,this.events.fire(h.SliderEvents.change,[s,a,t]);}},t.prototype._getRunnerStyle=function(e){var t;void 0===e&&(e=!1);var i="horizontal"===this.config.mode?"left":"top",n=e?this._extraCurrentPosition:this._currentPosition;return (t={})[i]=n+"%",t},t.prototype._isInverse=function(){return this.config.inverse&&"horizontal"===this.config.mode||!this.config.inverse&&"vertical"===this.config.mode},t.prototype._getRunnerCss=function(e){return void 0===e&&(e=!1),"dhx_slider__thumb"+(e?" dhx_slider__thumb--extra":"")+(this._isMouseMoving&&(e&&this._isExtraActive||!e&&!this._isExtraActive)?" dhx_slider__thumb--active":"")+(this._disabled?" dhx_slider__thumb--disabled":"")+(this._isNullable(e?this._extraCurrentPosition:this._currentPosition)&&!this.config.range?" dhx_slider__thumb--nullable":"")},t.prototype._draw=function(){var e=this.config,t=e.labelPosition,i=e.mode,n=e.hiddenLabel,o=e.tick,a=e.majorTick,l=e.css,c=e.helpMessage,u=f.getLabelStyle(r(r({},this.config),{required:!1}));return !this._tooltip||this._mouseIn&&this._focusIn&&this._isMouseMoving||document.body.contains(this._tooltip)&&document.body.removeChild(this._tooltip),s.el("div",{class:"dhx_slider dhx_slider--mode_"+i+("left"===t?" dhx_slider--label-inline":"")+(n?" dhx_slider--label_sr":"")+(o?" dhx_slider--ticks":"")+(a?" dhx_slider--major-ticks":"")+(l?" "+l:"")+(this._disabled?" dhx_slider--disabled":"")},[u?s.el("label.dhx_label.dhx_slider__label",{style:u.style,class:c?"dhx_label--with-help":"",onclick:this._handlers.onlabelClick},c?[u.label&&s.el("span.dhx_label__holder",u.label),s.el("span.dhx_label-help.dxi.dxi-help-circle-outline",{tabindex:"0",role:"button",onclick:this._handlers.showHelper})]:u.label):null,this._drawSlider()])},t.prototype._drawSlider=function(){return s.el(".dhx_widget.dhx_slider__track-holder",{"data-dhx-widget-id":this._uid},[s.el(".dhx_slider__track",{_ref:"track",onmouseover:this._handlers.onmouseover,onmouseout:this._handlers.onmouseout,onclick:this._handlers.onclick},[this._getDetector(),s.el("div",{_ref:"runner",class:this._getRunnerCss(),ontouchstart:this._handlers.ontouchstart,ontouchend:this._handlers.ontouchend,onmousedown:this._handlers.onmousedown,onfocus:this._handlers.onfocus,onblur:this._handlers.onblur,onkeydown:this._handlers.onkeydown,style:this._getRunnerStyle(),tabindex:0}),this.config.tooltip&&(this._mouseIn||this._focusIn||this._isMouseMoving)?this._drawTooltip():null,this.config.tooltip&&this.config.range&&(this._mouseIn||this._focusIn||this._isMouseMoving)?this._drawTooltip(!0):null,this.config.range?s.el("div",{_ref:"extraRunner",class:this._getRunnerCss(!0),ontouchstart:this._handlers.ontouchstart,ontouchend:this._handlers.ontouchend,onmousedown:this._handlers.onmousedown,onfocus:this._handlers.onfocus,onblur:this._handlers.onblur,onkeydown:this._handlers.onkeydown,style:this._getRunnerStyle(!0),tabindex:0}):null]),this.config.tick?this._drawTicks():null])},t.prototype._getDetector=function(){var e,t,i;if(this._disabled)return s.el(".dhx_slider__range");var n="horizontal"===this.config.mode?"left":"top",o="horizontal"===this.config.mode?"width":"height";if(this.config.range){var r=this._currentPosition>this._extraCurrentPosition?[this._currentPosition,this._extraCurrentPosition]:[this._extraCurrentPosition,this._currentPosition],a=r[0],l=r[1];return s.el(".dhx_slider__range",{style:(e={},e[n]=l+"%",e[o]=a-l+"%",e)})}return this._isInverse()?s.el(".dhx_slider__range",{style:(t={},t[n]=this._currentPosition+"%",t[o]=100-this._currentPosition+"%",t)}):s.el(".dhx_slider__range",{style:(i={},i[n]=0,i[o]=this._currentPosition+"%",i)})},t.prototype._drawTooltip=function(e){if(void 0===e&&(e=!1),"none"!==this._activeTooltip&&this.getRootView()){var t="extraTooltip"===this._activeTooltip?this._extraCurrentPosition:this._currentPosition,i="horizontal"===this.config.mode?"left":"top",n="";(e&&this._isExtraActive||!e&&!this._isExtraActive)&&(n+=" dhx_slider__thumb-label--active"),this._tooltip||(this._tooltip=document.createElement("div"));var o="tooltip"===this._activeTooltip?this.getRootView().refs.runner.el.getBoundingClientRect():this.getRootView().refs.extraRunner.el.getBoundingClientRect();this._tooltip.className="dhx_slider__thumb-label"+n,this._tooltip.style.left=o.x+("left"===i?6:-30)+window.pageXOffset+"px",this._tooltip.style.top=o.y+("left"===i?-30:6)+window.pageYOffset+"px",this._tooltip.innerText=this._getValue(t).toString(),document.body.appendChild(this._tooltip);}},t.prototype._getTicks=function(){for(var e=this.config,t=e.max,i=e.min,n=e.step,o=e.tick,r=e.majorTick,a=t-i,s=n*o/a,l=[],c=0,u=0;c<1;){var d=+(Number(i)+c*a).toFixed(5),h=u%r==0;l.push({position:(this._isInverse()?100*(1-c):100*c)+"%",isMultiple:h,label:h&&"function"==typeof this.config.tickTemplate?this.config.tickTemplate(d):null}),c+=s,u++;}return l.push({position:(this._isInverse()?0:100)+"%",isMultiple:!0,label:"function"==typeof this.config.tickTemplate?this.config.tickTemplate(t):null}),l},t.prototype._drawTicks=function(){var e="horizontal"===this.config.mode?"left":"top";return s.el(".dhx_slider__ticks-holder",this._getTicks().map((function(t){var i;return s.el("div",{class:"dhx_slider__tick"+(t.isMultiple?" dhx_slider__tick--major":""),style:(i={},i[e]=t.position,i)},void 0!==t.label?[s.el(".dhx_slider__tick-label",t.label)]:null)})))},t.prototype._isNullable=function(e){return this._isInverse()?100===e:0===e},t.prototype._setTooltip=function(e){e.target.classList.contains("dhx_slider__thumb--extra")?this._activeTooltip="extraTooltip":e.target.classList.contains("dhx_slider__thumb")?this._activeTooltip="tooltip":this._activeTooltip="none";},t}(u.View);t.Slider=v;},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);}),r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=i(1),s=i(0),l=i(4),c=i(3),u=i(7),d=i(75),h=function(e){function t(t){void 0===t&&(t={});var i=e.call(this,null,a.extend({},t))||this,n=i._popup=document.createElement("div");return n.className="dhx_widget dhx_popup"+(i.config.css?" "+i.config.css:""),n.style.position="absolute",n.setAttribute("role","dialog"),n.setAttribute("aria-modal","true"),n.setAttribute("aria-live","polite"),i.mount(n,s.create({render:function(){return i.toVDOM()}})),i._clickEvent=function(e){return i.events.fire(d.PopupEvents.click,[e])},i.events=t.events||new l.EventSystem(i),i._isActive=!1,i}return o(t,e),t.prototype.show=function(e,t,i){var n=this;void 0===t&&(t={}),this.events.fire(d.PopupEvents.beforeShow,[e])&&(e=c.toNode(e),this._isActive?this._setPopupSize(e,t):(i&&this.attach(i),this._popup.style.left="0",this._popup.style.top="0",s.awaitRedraw().then((function(){n._setPopupSize(e,t),n._popup.style.position="fixed",document.body.appendChild(n._popup),n._isActive=!0;})).then((function(){n._popup.style.position="absolute",n.events.fire(d.PopupEvents.afterShow,[e]),n._outerClickDestructor=n._detectOuterClick(e);}))));},t.prototype.hide=function(){this._hide(!1,null);},t.prototype.isVisible=function(){return this._isActive},t.prototype.attach=function(e,t){return this._html=null,"object"==typeof e?this._ui=e:"string"==typeof e?this._ui=new window.dhx[e](null,t):"function"==typeof e&&(e.prototype instanceof u.View?this._ui=new e(null,t):this._ui={getRootView:function(){return e(t)}}),this.paint(),this._ui},t.prototype.attachHTML=function(e){this._html=e,this.paint();},t.prototype.getWidget=function(){return this._ui},t.prototype.getContainer=function(){return this.getRootView().refs.content.el},t.prototype.toVDOM=function(){var e;return this._html?e=s.el(".dhx_popup__inner-html-content",{".innerHTML":this._html}):(e=this._ui?this._ui.getRootView():null)&&e.render&&(e=s.inject(e)),s.el("div",{class:"dhx_popup-content",tabindex:0,onclick:this._clickEvent,_key:this._uid,_ref:"content"},[e])},t.prototype.destructor=function(){this.hide(),this._outerClickDestructor&&this._outerClickDestructor(),this._popup=null;},t.prototype._setPopupSize=function(e,t,i){var n=this;void 0===i&&(i=3);var o=this._popup.getBoundingClientRect(),a=o.width,s=o.height;if(this._timeout&&(clearTimeout(this._timeout),this._timeout=null),!i||0!==a&&0!==s){var l=c.fitPosition(e,r(r({centering:!0,mode:"bottom"},t),{width:a,height:s})),u=l.left,d=l.top;if(this._popup.style.left=u,this._popup.style.top=d,t.indent&&0!==t.indent)switch(t.mode){case"top":this._popup.style.top=parseInt(this._popup.style.top.slice(0,-2),null)-parseInt(t.indent.toString(),null)+"px";break;case"bottom":default:this._popup.style.top=parseInt(this._popup.style.top.slice(0,-2),null)+parseInt(t.indent.toString(),null)+"px";break;case"left":this._popup.style.left=parseInt(this._popup.style.left.slice(0,-2),null)-parseInt(t.indent.toString(),null)+"px";break;case"right":this._popup.style.left=parseInt(this._popup.style.left.slice(0,-2),null)+parseInt(t.indent.toString(),null)+"px";}}else this._timeout=setTimeout((function(){n._isActive&&(n._setPopupSize(e,t,i-1),n._timeout=null);}));},t.prototype._detectOuterClick=function(e){var t=this,i=!1,n=new WeakMap,o=function(r){var a=r.target,s=document.querySelectorAll(".dhx_popup");for(i?s.forEach((function(e){return n.has(e)||n.set(e,t._popup)})):(i=Boolean(s.length))&&s.forEach((function(e){return n.set(e,!0)}));a;){if(a===e||a===t._popup||n.get(a)===t._popup)return;a=a.parentNode;}t._hide(!0,r)&&document.removeEventListener("mousedown",o);};return document.addEventListener("mousedown",o),function(){return document.removeEventListener("mousedown",o)}},t.prototype._hide=function(e,t){if(this._isActive)return !!this.events.fire(d.PopupEvents.beforeHide,[e,t])&&(document.body.removeChild(this._popup),this._isActive=!1,this._outerClickDestructor&&(this._outerClickDestructor(),this._outerClickDestructor=null),this.events.fire(d.PopupEvents.afterHide,[t]),!0)},t}(u.View);t.Popup=h;},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});t.default={hours:"Hours",minutes:"Minutes",save:"Save"};},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.isTimeCheck=function(e){return /(^12:[0-5][0-9]?AM$)/i.test(e)};},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.linkButtonClasses=".dhx_button.dhx_button--view_link.dhx_button--icon.dhx_button--size_medium.dhx_button--color_secondary";},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(1),o=i(0),r=i(11),a=function(){function e(e,t,i){this._config=i,this._cell={row:e,col:t},this._initHandlers();}return e.prototype.endEdit=function(){var e=this._checked;this._config.events.fire(r.GridEvents.beforeEditEnd,[e,this._cell.row,this._cell.col])?(this._cell.row=this._config.datacollection.getItem(this._cell.row.id),this._config.events.fire(r.GridEvents.afterEditEnd,[e,this._cell.row,this._cell.col])):this._input.checked=!e;},e.prototype.toHTML=function(){void 0===this._checked&&(this._checked=this._cell.row[this._cell.col.id]);var e=n.uid();return o.el("div.dhx_checkbox.dhx_cell-editor__checkbox",[o.el("label",{style:{display:"none"},for:e},this._checked||"false"),o.el("input.dhx_checkbox__input",{type:"checkbox",_hooks:{didInsert:this._handlers.didInsert},_key:"cell_editor","data-dhx-id":"cell_editor",checked:this._checked,id:e,style:{userSelect:"none"}}),o.el("span.dhx_checkbox__visual-input")])},e.prototype._initHandlers=function(){var e=this;this._handlers={onClick:function(){var t=!e._input.checked;e._config.events.fire(r.GridEvents.beforeEditStart,[e._cell.row,e._cell.col,"checkbox"])?(e._checked=t,e._config.events.fire(r.GridEvents.afterEditStart,[e._cell.row,e._cell.col,"checkbox"]),e.endEdit()):e._input.checked=!t;},didInsert:function(t){e._checkbox=t.el.parentNode.lastChild,e._input=t.el.parentNode.querySelector("input"),t.el.parentNode.addEventListener("click",e._handlers.onClick);}};},e}();t.CheckboxEditor=a;},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=i(0),r=i(11),a=i(40),s=i(17),l=function(){function e(e,t,i){this._config=i,this._cell={row:e,col:t},this._initHandlers();}return e.prototype.endEdit=function(e){var t,i=this;if(!e){var n=this._input.getValue();t="multiselect"===this._cell.col.editorType?n.split(",").join(", "):n;}this._config.events.fire(r.GridEvents.beforeEditEnd,[t,this._cell.row,this._cell.col])?(this._input.popup.hide(),document.removeEventListener("mousedown",this._handlers.onOuterClick),this._cell.row=this._config.datacollection.getItem(this._cell.row.id),s.focusManager.setFocusId(this._config.gridId),null==t||t.toString().split(", ").forEach((function(e){var t=i._cell.col.options.find((function(t){return "string"==typeof t?t===e:t.id.toString()===e}));e&&!t&&i._cell.col.options.push(i._input.data.getItem(e));})),this._config.events.fire(r.GridEvents.afterEditEnd,[t,this._cell.row,this._cell.col])):this._input.focus();},e.prototype.toHTML=function(){var e=this,t=this._cell.col.options.map((function(e){return "string"==typeof e?{id:""+e,value:e}:e}))||[];if(!this._input){this._input=new a.Combobox(null,n({itemHeight:37,css:"dhx_cell-editor__combobox",multiselection:"multiselect"===this._cell.col.editorType},this._cell.col.editorConfig)),this._input.data.parse(t);var i=this._cell.row[this._cell.col.id],r="multiselect"===this._cell.col.editorType?((null==i?void 0:i.toString())||"").split(", "):i;this._input.setValue(r),this._input.events.on("keydown",this._handlers.onkeydown);}return document.addEventListener("mousedown",this._handlers.onOuterClick),this._config.$editable.editor=this,o.awaitRedraw().then((function(){var t=e._input.getRootView().refs.holder.el;e._input.popup.getContainer().style.width=t.offsetWidth+"px",e._input.popup.show(t);})),s.focusManager.setFocusId(this._input._uid),o.inject(this._input.getRootView())},e.prototype._initHandlers=function(){var e=this;this._handlers={onOuterClick:function(t){if(t.target instanceof Node){var i=e._input&&e._input.getRootNode()&&e._input.getRootNode().contains(t.target),n=e._input.popup&&e._input.popup.getRootNode()&&e._input.popup.getRootNode().contains(t.target);i||n||e.endEdit();}},onkeydown:function(t){"Escape"!==t.key&&"Tab"!==t.key||e.endEdit();}};},e}();t.ComboboxEditor=l;},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.KEY_CODES={BACKSPACE:8,ENTER:13,ESC:27,DOWN_ARROW:40,UP_ARROW:38,LEFT_ARROW:37,RIGHT_ARROW:39};},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(155);t.getEditor=function(e,t){return new n.InputEditor(e,t)};},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),o=i(56),r=function(){function e(e,t){var i=this;this._list=t,this._config=t.config,this._item=e,this._list.events.on(o.ListEvents.focusChange,(function(e,t){i._mode&&t!==i._item.id&&i.endEdit();})),this._initHandlers();}return e.prototype.endEdit=function(){if(this._input){var e=this._input.value;this._list.events.fire(o.ListEvents.beforeEditEnd,[e,this._item.id])?(this._input.removeEventListener("blur",this._handlers.onBlur),this._input.removeEventListener("change",this._handlers.onChange),this._input.removeEventListener("keydown",this._handlers.onKeyDown),this._handlers={},this._mode=!1,this._list.events.fire(o.ListEvents.afterEditEnd,[e,this._item.id])):this._input.focus();}},e.prototype.toHTML=function(){this._mode=!0;var e=this._config.itemHeight;return n.el(".dhx_input__wrapper",{role:"presentation"},[n.el("div.dhx_input__container",{role:"presentation"},[n.el("input.dhx_input",{class:this._item.css?" "+this._item.css:"",style:{height:e,width:"100%",padding:"8px 12px"},_hooks:{didInsert:this._handlers.didInsert},_key:this._item.id,"data-dhx-id":this._item.id})])])},e.prototype._initHandlers=function(){var e=this;this._handlers={onBlur:function(){e.endEdit();},onChange:function(){e.endEdit();},onKeyDown:function(t){"Enter"===t.key&&e._item.value===e._input.value&&e.endEdit(),"Escape"===t.key&&(e._input.value=e._item.value,e.endEdit());},didInsert:function(t){var i=t.el;e._input=i,i.focus(),i.value=e._item.value,i.setSelectionRange(0,i.value.length),i.addEventListener("change",e._handlers.onChange),i.addEventListener("blur",e._handlers.onBlur),i.addEventListener("keydown",e._handlers.onKeyDown);}};},e}();t.InputEditor=r;},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);}),r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},a=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var s=i(0),l=i(34),c=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n.scrollView=new l.ScrollView((function(){return n.getRootView()})),n.paint(),n}return o(t,e),t.prototype.destructor=function(){e.prototype.destructor.call(this),this.scrollView=null;},t.prototype.showItem=function(e){var t=this.getRootView();if(t&&t.node&&t.node.el&&void 0!==e){var i=this.getRootNode();if(i){var n=this.config.virtual,o=this.data.getIndex(e),r=Math.floor(o/i.children.length)||0,a=i.children[o-i.children.length*r];if(n||a){var s=n?parseInt(this.config.itemHeight):a.clientHeight,l=n?o*s:a.offsetTop;l>=i.scrollTop+i.clientHeight-s?i.scrollTo(0,l-i.clientHeight+s):l<i.scrollTop&&i.scrollTo(0,l);}}}},t.prototype._renderList=function(){var e=this,t=this._getRange(),i=this.data.getRawData(t[0],t[1]).map((function(t,i){return e._renderItem(t,i)}));this.config.virtual&&(i=a([s.el(".div",{style:{height:t[2]+"px"}})],i,[s.el(".div",{style:{height:t[3]+"px"}})]));var n=this.scrollView&&this.scrollView.config.enable,o=(this.config.css?this.config.css:"")+(this.config.multiselection&&this.selection.getItem()?" dhx_no-select--pointer":"")+(n?" dhx_list--scroll-view":"");return s.el("ul.dhx_widget.dhx_list",r(r({style:{"max-height":this.config.height,position:"relative"},class:o,"data-dhx-widget-id":this._uid},this._handlers),this._getListAriaAttrs(this.config,this.data.getLength())),n?[].concat(this.scrollView.render(i)):i)},t}(i(80).List);t.ProList=c;},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){var e=this;this._sequence="",document.addEventListener("keydown",(function(t){if(e._isActive){var i=t.key;"Backspace"===i&&e._sequence.length>0&&(e._sequence=e._sequence.slice(0,e._sequence.length-1),e._change()),i.length<2&&(e._sequence+=i,e._change());}}));}return e.prototype.startNewListen=function(e){this._isActive=!0,this._sequence="",this._currentAction=e;},e.prototype.endListen=function(){this._currentAction=null,this.reset(),this._isActive=!1;},e.prototype.reset=function(){this._sequence="";},e.prototype._change=function(){this._currentAction(this._sequence),this._addClearTimeout();},e.prototype._addClearTimeout=function(){var e=this;this._clearTimeout&&clearTimeout(this._clearTimeout),this._clearTimeout=setTimeout((function(){e.reset(),e._clearTimeout=null;}),2e3);},e}();t.KeyListener=n;},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);});Object.defineProperty(t,"__esModule",{value:!0});var r=i(79),a=i(29),s=i(15),l=i(83),c=function(e){function t(t,i){return e.call(this,t,i)||this}return o(t,e),t.prototype._createLayout=function(){var e=this.list=new a.ProList(null,{template:this.config.template,htmlEnable:this.config.htmlEnable,virtual:this.config.virtual,keyNavigation:!1,multiselection:this.config.multiselection,itemHeight:this.config.itemHeight,height:this.config.listHeight,data:this.data}),t=this._layout=new s.ProLayout(this.popup.getContainer(),{css:"dhx_combobox-options dhx_combobox__options",rows:[{id:"select-unselect-all",hidden:!this.config.multiselection||!this.config.selectAllButton},{id:"list",height:"content"},{id:"not-found",hidden:!0}],on:{click:{".dhx_combobox__action-select-all":this._handlers.selectAll,".dhx_combobox-options__action-create-option":this._handlers.addOption}}});t.getCell("list").attach(e),this.config.multiselection&&this.config.selectAllButton&&t.getCell("select-unselect-all").attach(l.selectAllView);},t}(r.Combobox);t.ProCombobox=c;},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=i(0),r=i(11),a=i(1),s=i(25),l=function(){function e(e,t,i){this._config=i,this._cell={row:e,col:t},this._width=this._cell.col.$width;var n=0;this._config.firstColId===this._cell.col.id&&this._cell.row.hasOwnProperty("$level")&&(n=s.getTreeCellWidthOffset(this._cell.row)),this._width-=n-4,this._initHandlers();}return e.prototype.endEdit=function(e){var t;e||(t=this._editor.value),this._config.events.fire(r.GridEvents.beforeEditEnd,[t,this._cell.row,this._cell.col])?(this._editor.removeEventListener("blur",this._handlers.onBlur),this._editor.removeEventListener("change",this._handlers.onChange),this._editor.removeEventListener("input",this._handlers.onInput),"string"!==this._cell.col.type&&a.isNumeric(t)&&(t=parseFloat(t)),this._cell.row=this._config.datacollection.getItem(this._cell.row.id),this._config.events.fire(r.GridEvents.afterEditEnd,[t,this._cell.row,this._cell.col])):this._editor.focus();},e.prototype.toHTML=function(){var e=this._cell.row[this._cell.col.id];this._editor&&(e=this._editor.value),this._config.$editable.editor=this;var t=void 0!==this._cell.row.height||this._cell.col.htmlEnable?"dhx_cell-editor dhx_cell-editor__textarea_constant-height":"dhx_cell-editor dhx_cell-editor__textarea";return o.el("textarea",{_hooks:{didInsert:this._handlers.didInsert},_ref:"textarea",_key:"cell_editor","data-dhx-id":"cell_editor",value:e,class:t,style:{width:this._width}})},e.prototype._initHandlers=function(){var e=this;this._handlers={onBlur:function(){e.endEdit();},onChange:function(){e.endEdit();},onInput:function(t){var i;if(void 0===e._cell.row.height&&!e._cell.col.htmlEnable){var n=e._getCurrentHeight(e._editor.value,{width:e._cell.col.$width-2,maxHeight:e._config.rowHeight});e._cell.row[e._cell.col.id]=e._editor.value;var o=s.getCalculatedRowHeight(s.getMaxRowHeight(e._cell.row,e._config.columns)),a=s.getCalculatedRowHeight(s.getMaxRowHeight(((i={})[e._cell.col.id]=e._cell.row[e._cell.col.id],i),e._config.columns));if(e._minHeight=o===a?e._config.rowHeight:o,n>=e._minHeight&&n!==e._prevHeight){if(!e._config.events.fire(r.GridEvents.beforeRowResize,[e._cell.row,t,n]))return;e._config.events.fire(r.GridEvents.afterRowResize,[e._cell.row,t,n]);}e._prevHeight=n;}},didInsert:function(t){e._editor=t.el,e._editor.focus(),e._editor.setSelectionRange(0,e._editor.value.length),e._editor.addEventListener("change",e._handlers.onChange),e._editor.addEventListener("blur",e._handlers.onBlur),e._editor.addEventListener("input",e._handlers.onInput);}};},e.prototype._getCurrentHeight=function(e,t){t=n({width:100,maxHeight:40,lineHeight:20},t);var i=document.createElement("textarea");i.className="dhx_cell-editor dhx_cell-editor__textarea",i.value=e,i.style.width=t.width+"px",i.style.lineHeight=t.lineHeight+"px",i.style.maxHeight=t.maxHeight+"px",i.style.boxSizing="border-box",document.body.appendChild(i);var o=this._getElementHeight(i),r=i.value.split("\n").length,a=Math.round(o/t.lineHeight),s=o<t.maxHeight?t.maxHeight:o;return document.body.removeChild(i),1===r&&r===a?t.maxHeight:s},e.prototype._getElementHeight=function(e){return e.scrollHeight},e}();t.TextAreaEditor=l;},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n,o=i(0),r=i(40),a=i(13),s=i(11),l=i(25),c=i(1);function u(e,t,i,o,r){var a=function(){var n,a,l,c,u=(null===(n=r.target)||void 0===n?void 0:n.value)||(null===(l=null===(a=r.composedPath())||void 0===a?void 0:a[0])||void 0===l?void 0:l.value)||(null===(c=r.explicitOriginalTarget)||void 0===c?void 0:c.value);o.value[t]=u,e.fire(s.GridEvents.filterChange,[u,t,i]);};"selectFilter"!==i?(n&&clearTimeout(n),n=setTimeout(a,500)):a();}function d(e,t,i,n){if(e&&t&&i){var o=e.id,r=n?n(o,t.data):t.data.reduce((function(e,t){return void 0===t[o]||""===t[o]||isNaN(t[o])||e.push(parseFloat(t[o])),e}),[]),a=r;return "tree"===t.type&&(a=t.data.reduce((function(e,i){if(0===i.$level)if(void 0===i[o]||""===i[o]||isNaN(i[o])){var n=0;t.datacollection.eachChild(i.id,(function(e){t.datacollection.haveItems(e.id)||(n+=parseFloat(e[o]));})),e.push(n);}else e.push(parseFloat(i[o])||0);return e}),[])),i(r,a)}}t.getContent=function(){var e=this,t=function(e){var t=e.$uniqueData;return "combobox"!==e.editorType&&"select"!==e.editorType&&"multiselect"!==e.editorType||!e.options||(t=t.map((function(t){var i=e.options.find((function(e){return "string"==typeof e?t===e:t===e.id}));return i&&"string"!=typeof i?i.value:t}))),"string"!==e.type?Array.from(new Set(t.map((function(t){return l.toFormat(t,e.type,e.format)})))):t};return {inputFilter:{element:{},toHtml:function(e,t){var i=c.uid(),n=e.id.toString();return this.element[n]=o.el("div.dhx_grid-filter__label.dxi.dxi-magnify",{"aria-label":"Type to search",_ref:e.id+"_filter"},[o.el("label",{style:{display:"none"},"aria-label":"Type to search",for:i},"Type to search"),o.el("input",{type:"text",class:"dhx_input dhx_grid-filter",oninput:[u,t.events,e.id,"inputFilter",this],_key:e.id,id:i,value:this.value[e.id]||""})]),this.element[n]},match:function(e){for(var t=e.val,i=e.match,n=e.col,o=l.toFormat(t,n.type,n.format),r="",a=0;a<i.length;a++){var s=i.charCodeAt(a);r+=s>32&&s<48||63===s||s>90&&s<95||124===s?"\\"+i[a]:i[a];}return new RegExp(""+r,"i").test(o)},value:{}},selectFilter:{element:{},toHtml:function(e,i){var n=this,r=e.id.toString(),a=t(e);return this.element[r]=o.el("label.dhx_grid-filter__label.dxi.dxi-menu-down",{_ref:e.id+"_filter"},[o.el("select.dxi.dxi-menu-down",{type:"text",class:"dhx_input dhx_grid-filter dhx_grid-filter--select",onchange:[u,i.events,e.id,"selectFilter",this],_key:e.id},[o.el("option",{value:""},""),a.map((function(t){return ""!==(t=null!=t?t:"")&&o.el("option",{value:t,selected:n.value[e.id]===t.toString()},t)}))])]),this.element[r]},match:function(e){var t=e.val,i=e.match,n=e.col,o=l.toFormat(t,n.type,n.format);return !i||(o||"boolean"==typeof o)&&o.toString()==i},value:{}},comboFilter:{element:{},toHtml:function(e,i){var n,l=e.id.toString();if(!this.element[l]&&i.events){var c=t(e),u=e.header.filter((function(e){return void 0!==e.filterConfig}))[0];(n=u&&u.filterConfig?new r.Combobox(null,Object.assign({},u.filterConfig)):new r.Combobox(null,{})).data.parse(c.map((function(e){return {value:e}}))),i.events.on(a.DataEvents.load,(function(){n.data.parse(e.$uniqueData.map((function(e){return {value:e}})));})),this.element[l]=n,n.events.on("change",(function(e){if(e){var t=void 0;(Array.isArray(e)?e.find((function(e){return n.data.getItem(e)})):n.data.getItem(e))?(t=n.config.multiselection?n.list.selection.getItem().map((function(e){if(e&&n.data.getItem(e.id))return e.value})):n.list.selection.getItem().value,i.events.fire(s.GridEvents.filterChange,[t,l,"comboFilter"])):i.events.fire(s.GridEvents.filterChange,["",l,"comboFilter"]);}})),i.events.on(a.DataEvents.change,(function(i,o){if("add"===o||"update"===o||"remove"===o){var a=t(e);n.data.parse(a.map((function(e){return {value:e}}))),n.events.fire(r.ComboboxEvents.change,[n.list.selection.getItem()]);}})),i.events.on(a.DataEvents.removeAll,(function(){n.data.parse(e.$uniqueData.map((function(e){return {value:e}}))),n.events.fire(r.ComboboxEvents.change,[n.list.selection.getItem()]);})),n.popup.events.on("afterHide",(function(){(!n.list.selection.getItem()||n.config.multiselection&&!n.list.selection.getItem().length)&&(n.clear(),i.events.fire(s.GridEvents.filterChange,["",l,"comboFilter"]));}));}else n=this.element[e.id]||new r.Combobox(null,{});return o.inject(n.getRootView())},match:function(e){var t=e.val,i=e.match,n=void 0===i?"":i,o=e.multi,r=void 0!==o&&o,a=e.col,s=l.toFormat(t,a.type,a.format);if(Array.isArray(n)){for(var c=void 0,u=function(e){if(c=r?!!s.split(", ").find((function(t){return t===n[e]})):n[e]===s)return "break"},d=0;d<n.length;d++){if("break"===u(d))break}return !n||!n.length||c}return ""===n||s===n},destroy:function(){if(e.content&&e.content.comboFilter.element){var t=e.content.comboFilter.element;for(var i in t)t[i].destructor(),delete t[i];}},value:{}},sum:{calculate:function(e,t){return t.reduce((function(e,t){return e+(parseFloat(t)||0)}),0)},toHtml:function(e,t){var i=d(e,t,this.calculate);return e.format||"percent"===e.type?l.toFormat(i,e.type,e.format):i?i.toFixed(3):null}},avg:{calculate:function(e,t){return e.length?t.reduce((function(e,t){return e+t}),0)/e.length:null},toHtml:function(e,t){var i=d(e,t,this.calculate);return e.format||"percent"===e.type?l.toFormat(i,e.type,e.format):i?i.toFixed(3):null}},min:{calculate:function(e){return e.length?Math.min.apply(Math,e):null},toHtml:function(e,t){var i=d(e,t,this.calculate);return e.format||"percent"===e.type?l.toFormat(i,e.type,e.format):i?i.toFixed(3):null}},max:{calculate:function(e){return e.length?Math.max.apply(Math,e):null},toHtml:function(e,t){var i=d(e,t,this.calculate);return e.format||"percent"===e.type?l.toFormat(i,e.type,e.format):i?i.toFixed(3):null}},count:{calculate:function(e,t){return t.length},validate:function(e,t){return t.reduce((function(t,i){return void 0!==i[e]&&""!==i[e]&&(isNaN(i)?t.push(1):t.push(i)),t}),[])},toHtml:function(e,t){return d(e,t,this.calculate,this.validate)}}}};},function(e,t,i){var n=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var o=i(1),r=i(11),a=i(3);t.startResize=function(e,t,i,s){i.targetTouches&&i.preventDefault();var l=i.targetTouches?i.targetTouches[0].clientX:i.clientX,c=e.config.columns.filter((function(e){return !e.hidden})),u=0;e.config.$resizing=t;var d=function(i){var s=o.findIndex(c,(function(e){return e.id===t})),d=i.targetTouches?i.targetTouches[0].clientX:i.clientX,h=d-e.getRootNode().getBoundingClientRect().left,f=e.config.$totalHeight>e.config.height?a.getScrollbarWidth():0;if(!(e.config.leftSplit===s+1&&h>=e.config.width-f-2)){u=u||c[s].$width;var p,v=c[s].minWidth||40,g=c[s].maxWidth,_=d-l,m=n(c),y=u+_;g&&y>=g||y<=v?(y<=v&&(p=v),y>=g&&(p=g)):p=y,m[s].$width=p,m[s].$fixed=!0,e.events.fire(r.GridEvents.resize,[c[s],i]),e.paint();}},h=function(){i.targetTouches?(document.removeEventListener("touchmove",d),document.removeEventListener("touchend",h)):(document.removeEventListener("mousemove",d),document.removeEventListener("mouseup",h)),s();};i.targetTouches?(document.addEventListener("touchmove",d),document.addEventListener("touchend",h)):(document.addEventListener("mousemove",d),document.addEventListener("mouseup",h)),e.paint();};},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=i(11),r=i(3),a=i(21);function s(e,t,i,n,o,a,s){if(void 0===o&&(o=!1),void 0===a&&(a=!1),void 0===s&&(s=!1),!t.config.$editable&&t.config.selection&&!r.locateNodeByClassName(e,"dhx_grid-header-cell")){e&&e.preventDefault();var l=t.selection.getCell(),c=t.config.columns.filter((function(e){return !e.hidden}));if(t.data.filter((function(e){return !e.hidden})),l)if("vertical"===i)if(o){var u=1===n?t.data.getItem(t.data.getId(t.data.getLength()-1)):t.data.getItem(t.data.getId(0));t.selection.setCell(u.id,l.column.id,a,s),t.scrollTo(u.id.toString(),l.column.id.toString());}else {if((d=t.data.getIndex(l.row.id.toString()))+n>=0&&d+n<t.data.getLength()){u=t.data.getItem(t.data.getId(d+n));t.selection.setCell(u.id,l.column.id,a,s),t.scrollTo(u.id.toString(),l.column.id.toString());}}else if(o){u=1===n?c[c.length-1]:c[0];t.selection.setCell(l.row.id,u.id,a,s),t.scrollTo(l.row.id.toString(),u.id.toString());}else {var d;(d=c.indexOf(l.column))+n>=0&&d+n<c.length&&(t.selection.setCell(l.row.id,c[d+n].id,a,s),t.scrollTo(l.row.id.toString(),c[d+n].id.toString()));}}}t.selectionMove=s,t.getKeysHandlers=function(e){var t,i,l,c="cell"===e.config.selection||"complex"===e.config.selection||!0===e.config.selection,u={};if(e.getRootView()){var d=null===(l=null===(i=null===(t=e.getRootView())||void 0===t?void 0:t.refs)||void 0===i?void 0:i.grid_body)||void 0===l?void 0:l.el;if(!d)return;u={pageUp:function(e){e.preventDefault(),d.scrollTop-=d.clientHeight;},pageDown:function(e){e.preventDefault(),d.scrollTop+=d.clientHeight;},home:function(e){e.preventDefault(),d.scrollTop=0;},end:function(e){e.preventDefault(),d.scrollTop+=d.scrollHeight;}};}return n({enter:function(t){var i=r.locateNodeByClassName(t,"dhx_grid-header-cell");if(i){var n=i.getAttribute("data-dhx-id"),s=t.target.getAttribute("dhx_resized");if(n){var l=e.getColumn(n);l&&a.isSortable(e.config,l)&&!s&&e.events.fire(o.GridEvents.afterSort,[n]);}}if(c){var u=e.selection.getCell();u&&(!1!==u.column.editable&&e.config.editable||u.column.editable)&&(e.config.$editable?e.editEnd():"boolean"!==u.column.type?e.editCell(u.row.id,u.column.id,u.column.editorType):e.events.fire(o.GridEvents.afterEditEnd,[!u.row[u.column.id],u.row,u.column]));}else e.config.$editable&&e.editEnd();},space:function(t){var i,n=e.selection.getCell();c&&(null!==(i=null==n?void 0:n.column.editable)&&void 0!==i?i:e.config.editable)&&!e.config.$editable&&n&&"boolean"===n.column.type&&(t.preventDefault(),e.events.fire(o.GridEvents.afterEditEnd,[!n.row[n.column.id],n.row,n.column]));},escape:function(){e.config.$editable&&e.editEnd(!0);},tab:function(t){if(e.config.selection&&!r.locateNodeByClassName(t,"dhx_grid-header-cell")){e.config.$editable&&e.editEnd();var i=e.selection.getCell(),n=e.config.columns.filter((function(e){return !e.hidden}));if(i){var o=n.indexOf(i.column)+1;if(o>=0&&o<n.length)t&&t.preventDefault(),e.selection.setCell(i.row.id,n[o].id),e.scrollTo(i.row.id.toString(),n[o].id.toString());else if(o>=0){var a=e.data.getIndex(i.row.id.toString())+1;a<e.data.getLength()&&(t&&t.preventDefault(),e.selection.setCell(e.data.getId(a),n[0].id),e.scrollTo(e.data.getId(a).toString(),n[0].id.toString()));}}}},"shift+tab":function(t){if(e.config.selection&&!r.locateNodeByClassName(t,"dhx_grid-header-cell")){e.config.$editable&&e.editEnd();var i=e.selection.getCell(),n=e.config.columns.filter((function(e){return !e.hidden}));if(i){var o=n.indexOf(i.column)-1;if(o>=0&&o<n.length)t&&t.preventDefault(),e.selection.setCell(i.row.id,n[o].id),e.scrollTo(i.row.id.toString(),n[o].id.toString());else if(o<e.data.getLength()){var a=e.data.getIndex(i.row.id.toString())-1;a>=0&&(t&&t.preventDefault(),e.selection.setCell(e.data.getId(a),n[n.length-1].id),e.scrollTo(e.data.getId(a).toString(),n[n.length-1].id.toString()));}}}},arrowUp:function(t){s(t,e,"vertical",-1);},"ctrl+arrowUp":function(t){s(t,e,"vertical",-1,!0);},"shift+arrowUp":function(t){e.config.multiselection&&s(t,e,"vertical",-1,!1,!1,!0);},"ctrl+shift+arrowUp":function(t){e.config.multiselection&&s(t,e,"vertical",-1,!0,!1,!0);},arrowDown:function(t){s(t,e,"vertical",1);},"ctrl+arrowDown":function(t){s(t,e,"vertical",1,!0);},"shift+arrowDown":function(t){e.config.multiselection&&s(t,e,"vertical",1,!1,!1,!0);},"ctrl+shift+arrowDown":function(t){e.config.multiselection&&s(t,e,"vertical",1,!0,!1,!0);},arrowRight:function(t){s(t,e,"horizontal",1);},"ctrl+arrowRight":function(t){s(t,e,"horizontal",1,!0);},"shift+arrowRight":function(t){e.config.multiselection&&s(t,e,"horizontal",1,!1,!1,!0);},"ctrl+shift+arrowRight":function(t){e.config.multiselection&&s(t,e,"horizontal",1,!0,!1,!0);},arrowLeft:function(t){s(t,e,"horizontal",-1);},"ctrl+arrowLeft":function(t){s(t,e,"horizontal",-1,!0);},"shift+arrowLeft":function(t){e.config.multiselection&&s(t,e,"horizontal",-1,!1,!1,!0);},"ctrl+shift+arrowLeft":function(t){e.config.multiselection&&s(t,e,"horizontal",-1,!0,!1,!0);}},u)};},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);}),r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=i(71),s=i(11),l=i(13),c=i(3),u=i(25),d=i(33),h=i(0),f=i(34),p=function(e){function t(t,i){var n=e.call(this,t,r({autoHeight:!1},i))||this;return n.scrollView=new f.ScrollView((function(){return n.getRootView()}),{scrollHandler:function(e){return n.events.fire(s.GridEvents.scroll,[{y:e.target.scrollTop,x:e.target.scrollLeft}])}}),n}return o(t,e),t.prototype._createView=function(){var e=this;return h.create({render:function(t,i){return d.proRender(t,i,e._htmlEvents,e.selection,e._uid)}},this)},t.prototype._setEventHandlers=function(){var t=this;e.prototype._setEventHandlers.call(this),this.events.on(s.GridEvents.headerCellMouseDown,(function(e,i){var n,o=c.locateNodeByClassName(i,"dhx_header-row"),r=o&&o.getAttribute("aria-rowindex");(null===(n=e.header[Number(r)-1])||void 0===n?void 0:n.content)||(i.targetTouches?t._touch.timer=setTimeout((function(){t._dragStartColumn(i,e);}),t._touch.duration):t._dragStartColumn(i,e));})),this._events.on(s.GridSystemEvents.headerCellTouchMove,(function(e,i){t._touch.start&&i.preventDefault(),t._clearTouchTimer();})),this._events.on(s.GridSystemEvents.headerCellTouchEnd,(function(){t._touch.start=!1,t._clearTouchTimer();})),this.events.on(s.GridEvents.resize,(function(){t._parseColumns(),t._checkFilters();})),this.events.on(s.GridEvents.afterResizeEnd,(function(){t.config.autoHeight&&(t.config.data=t.data.map((function(e){var i=u.getMaxRowHeight(e,t.config.columns);return e.$height=u.getCalculatedRowHeight(i,{rowHeight:t.config.rowHeight,padding:8}),e})));})),this.events.on(s.GridEvents.afterRowResize,(function(e,i,n){var o=t.data.getItem(e.id),r=o.id,a=o.height,s=o.$height;a&&a!==s&&t.data.update(r,{height:n}),t.data.update(r,{$height:n},!0),t.config.data=t.data.map((function(e){return e})),t.paint();})),this.events.on(s.GridEvents.scroll,(function(){t._lazyLoad();})),this.events.on(l.DataEvents.dataRequest,(function(e,i){var n=t.data.dataProxy;n&&n.config&&t._prepareDataFromTo(t.data,e,i);}));},t.prototype._prepareData=function(e){var t,i=this;if(this._adjustColumns(),Array.isArray(e)||l.isTreeCollection(e))t=e;else {var n=e.getInitialData()||[];t=0!==n.length?n:e.getRawData(0,e.getLength());}return t.map((function(e){if(i.config.autoHeight&&void 0===e.height){var t=u.getMaxRowHeight(e,i.config.columns);e.$height=u.getCalculatedRowHeight(t,{rowHeight:i.config.rowHeight,padding:8})||i.config.rowHeight;}else e.$height=e.height||i.config.rowHeight;return e}))},t.prototype._prepareDataFromTo=function(e,t,i){var n=this;return e.mapRange(t,i,(function(e){var t=u.getMaxRowHeight(e,n.config.columns);return e.$height=u.getCalculatedRowHeight(t,{rowHeight:n.config.rowHeight,padding:8})||n.config.rowHeight,e}))},t.prototype._lazyLoad=function(){var e,t,i=this,n=this.data.dataProxy;if(n&&n.config){var o,r=this.data.getRawData(0,-1,null,2),a=d.getRenderConfig(this,r,{width:this.config.width,height:this.config.height}),s=n.config.limit,c=s,u=a.currentRows,h=u[0],f=u[u.length-1],p=this.data.getIndex(f.id),v=function(e){for(var t=1;t<u.length;t++)if("firstFilledRow"===e&&!u[t].$empty&&u[t-1].$empty||"firstEmptyRow"===e&&u[t].$empty&&!u[t-1].$empty)return i.data.getIndex(u[t].id)};if(h.$empty)if(f.$empty)o=this.data.getIndex(h.id);else {var g=v("firstFilledRow"),_=g-c;_<0&&(_=0);for(var m=_;m<g;m++)if(this.data.getItem(this.data.getId(m)).$empty){o=m,c=g-m;break}}else f.$empty?o=v("firstEmptyRow"):(o=null!==(e=v("firstEmptyRow"))&&void 0!==e?e:this.data.getIndex(h.id),c=(null!==(t=v("firstFilledRow"))&&void 0!==t?t:p)-o);!this.data.isDataLoaded(o,p)&&this.data.events.fire(l.DataEvents.beforeLazyLoad,[])&&(n.updateUrl(null,{from:o,limit:c}),n.config.limit=s,this.data.load(n).then((function(){i.config.autoHeight&&i._prepareDataFromTo(i.data,o,p);})));}},t.prototype._getColumnGhost=function(e){var t=this._container||c.toNode(this._uid),i=t.querySelector(".dhx_header-row"),n=i.querySelector('.dhx_grid-header-cell[data-dhx-id="'+e.id+'"]'),o=Array.from(i.childNodes).indexOf(n)+1,r=t.querySelectorAll('.dhx_grid-header-cell[data-dhx-id="'+e.id+'"]:not(.dhx_span-cell)'),a=t.querySelectorAll(".dhx_grid_data .dhx_grid-cell:nth-child("+o+")"),s=document.createElement("div");return r.forEach((function(e){return s.appendChild(e.cloneNode(!0))})),a.forEach((function(e){return s.appendChild(e.cloneNode(!0))})),s},t.prototype._dragStartColumn=function(e,t){var i=e.target,n=function(e){return e.classList.contains("dhx_grid-custom-content-cell")};n(i.parentElement)||n(i.parentElement.parentElement)||!(t.draggable||"column"===this.config.dragItem&&!1!==t.draggable||"both"===this.config.dragItem&&!1!==t.draggable)||c.locateNodeByClassName(e,"dhx_resizer_grip_wrap")||(e.targetTouches&&(this._touch.start=!0),l.dragManager.onMouseDown(e,[t.id],[this._getColumnGhost(t)]));},t}(a.Grid);t.ProGrid=p;},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this._store={};}return e.prototype.setItem=function(e,t){this._store[e]=t;},e.prototype.getItem=function(e){return this._store[e]?this._store[e]:null},e}(),o=window.dhxHelpers=window.dhxHelpers||{};o.collectionStore=o.collectionStore||new n,t.collectionStore=o.collectionStore;},function(e,t,i){(function(e){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);});Object.defineProperty(t,"__esModule",{value:!0});var r=i(32),a=i(1),s=i(53),l=function(t){function i(e,i){var n=t.call(this,e)||this;return n.config=a.extend({from:0,limit:50,delay:50,prepare:0},i),n.updateUrl(e,{from:n.config.from,limit:n.config.limit}),n}return o(i,t),i.prototype.load=function(){var t=this;return new e((function(e,i){t._timeout?(clearTimeout(t._timeout),t._timeout=setTimeout((function(){s.ajax.get(t.url,{responseType:"text"}).then(e).catch(i),t._cooling=!0;}),t.config.delay),t._cooling&&(e(null),t._cooling=!1)):(s.ajax.get(t.url,{responseType:"text"}).then(e).catch(i),t._cooling=!0,t._timeout=setTimeout((function(){})));}))},i}(r.DataProxy);t.LazyDataProxy=l;}).call(this,i(14));},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(4),o=i(41),r=i(23),a=function(){function e(e,t,i){var o=this;this.events=i||new n.EventSystem(this),this._data=t,this.config=e,this._data.events.on(r.DataEvents.removeAll,(function(){o._selected=null;})),this._data.events.on(r.DataEvents.change,(function(){if(o._selected){var e=o._data.getNearId(o._selected);e!==o._selected&&(o._selected=null,e&&o.add(e));}}));}return e.prototype.getId=function(){return this._selected},e.prototype.getItem=function(){return this._selected?this._data.getItem(this._selected):null},e.prototype.remove=function(e){return !(e=e||this._selected)||!!this.events.fire(o.SelectionEvents.beforeUnSelect,[e])&&(this._data.update(e,{$selected:!1},!0),this._selected=null,this.events.fire(o.SelectionEvents.afterUnSelect,[e]),!0)},e.prototype.add=function(e){this._selected!==e&&!this.config.disabled&&this._data.exists(e)&&(this.remove(),this._addSingle(e));},e.prototype.enable=function(){this.config.disabled=!1;},e.prototype.disable=function(){this.remove(),this.config.disabled=!0;},e.prototype._addSingle=function(e){this.events.fire(o.SelectionEvents.beforeSelect,[e])&&(this._selected=e,this._data.update(e,{$selected:!0},!0),this.events.fire(o.SelectionEvents.afterSelect,[e]));},e}();t.Selection=a;},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);}),r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=i(1),s=i(0),l=i(4),c=i(3),u=i(20),d=i(7),h=i(13),f=i(42);var p=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n._isContextMenu=!1,n._documentHaveListener=!1,n.config=a.extend({rootId:"string"==typeof t&&t||n._uid},i),n._rootItem={},Array.isArray(n.config.data)?(n.events=new l.EventSystem(n),n.data=new h.TreeCollection({rootId:n.config.rootId},n.events)):n.config.data&&n.config.data.events?(n.data=n.config.data,n.events=n.data.events,n.events.context=n):(n.events=new l.EventSystem(n),n.data=new h.TreeCollection({rootId:n.config.rootId},n.events)),n._documentClick=function(e){if(n._documentHaveListener){var t=c.locateNode(e),i=n.data.getRoot(),o=t&&t.getAttribute("data-dhx-id"),r=n.data.getParent(o),a="ontouchstart"in window||navigator.msMaxTouchPoints;document.removeEventListener("mousedown",n._documentClick),n._documentHaveListener=!1,((!a||t)&&n._isContextMenu||i!==r&&r&&n.data.getItem(o))&&r&&n.data.getItem(o)||n._close(e);}},n._currentRoot=n.data.getRoot(),n._factory=n._getFactory(),n._initHandlers(),n._keyManager=new u.KeyManager((function(e,t){return t===n._uid})),n._initEvents(),Array.isArray(n.config.data)&&n.data.parse(n.config.data),n}return o(t,e),t.prototype.paint=function(){e.prototype.paint.call(this),this._isContextMenu&&!this._vpopups&&this._init(),this._vpopups&&this._vpopups.redraw();},t.prototype.disable=function(e){var t=this;void 0!==e?this._setProp(e,"disabled",!0):this.data.forEach((function(e){var i=e.id;return t._setProp(i,"disabled",!0)}));},t.prototype.enable=function(e){var t=this;void 0!==e?this._setProp(e,"disabled",!1):this.data.forEach((function(e){var i=e.id;return t._setProp(i,"disabled",!1)}));},t.prototype.isDisabled=function(e){var t=this.data.getItem(e);if(t)return t.disabled||!1},t.prototype.show=function(e){var t=this;void 0!==e?this._setProp(e,"hidden",!1):this.data.forEach((function(e){var i=e.id;return t._setProp(i,"hidden",!1)}));},t.prototype.hide=function(e){var t=this;void 0!==e?this._setProp(e,"hidden",!0):this.data.forEach((function(e){var i=e.id;return t._setProp(i,"hidden",!0)}));},t.prototype.destructor=function(){this.events.clear(),this._keyManager&&this._keyManager.destructor(),this._vpopups&&this._vpopups.node&&this._vpopups.unmount(),this.unmount();},t.prototype.select=function(e,t){var i=this;if(void 0===t&&(t=!0),!e)throw new Error("Function argument cannot be empty, for more info check documentation https://docs.dhtmlx.com");t&&this.unselect(),this.data.update(e,{active:!0}),this.data.eachParent(e,(function(e){i.data.update(e.id,{active:!0});}));},t.prototype.unselect=function(e){var t=this;e?(this.data.update(e,{active:!1}),this.data.eachChild(e,(function(e){t.data.update(e.id,{active:!1});}))):this.data.forEach((function(e){t.data.update(e.id,{active:!1});}));},t.prototype.isSelected=function(e){if(e&&this.data.getItem(e))return !!this.data.getItem(e).active},t.prototype.getSelected=function(){var e=[];return this.data.forEach((function(t){t.active&&e.push(t.id);})),e},t.prototype._customHandlers=function(){return {}},t.prototype._close=function(e){var t=this;this._popupActive&&this.events.fire(f.NavigationBarEvents.beforeHide,[this._activeMenu,e])&&(this._activeParents&&this._activeParents.forEach((function(e){return t.data.exists(e)&&t.data.update(e,{$activeParent:!1})})),"click"===this.config.navigationType&&(this._isActive=!1),clearTimeout(this._currentTimeout),this._popupActive=!1,this._activeMenu=null,this._vpopups.node&&this._vpopups.unmount(),this._vpopups=null,this.events.fire(f.NavigationBarEvents.afterHide,[e]),this.paint());},t.prototype._init=function(){var e=this;this._vpopups=s.create({render:function(){return s.el("div",{"data-dhx-widget-id":e._uid,class:(e._isContextMenu?" dhx_context-menu":"")+" "+(e.config.css?e.config.css.split(" ").map((function(t){return e._isContextMenu?t:t+"--popup-menu"})).join(" "):""),onmousemove:e._handlers.onmousemove,onmouseleave:e._handlers.onmouseleave,onclick:e._handlers.onclick,onmousedown:e._handlers.onmousedown},e._drawPopups())}}),this._vpopups.mount(document.body);},t.prototype._initHandlers=function(){var e=this;this._isActive="click"!==this.config.navigationType,this._handlers=r({onmousemove:function(t){if(e._isActive){var i=c.locateNode(t);if(i){var n=i.getAttribute("data-dhx-id");if(e._activeMenu!==n){if(e.data.haveItems(n)){e._vpopups||e._init();var o=c.getRealPosition(i);e.data.update(n,{$position:o},!1);}e._activeItemChange(n,t);}}}},onmouseleave:function(t){if("click"!==e.config.navigationType)if(e._popupActive){var i=c.locateNode(t,"data-dhx-id","relatedTarget");if(i){var n=i.getAttribute("data-dhx-id");if(e.data.getItem(n)||(e._close(t),e._activeItemChange(null,t)),e.data.haveItems(n)){e._vpopups||e._init();var o=c.getRealPosition(i);e.data.update(n,{$position:o},!1),e._activeItemChange(n,t);}}else e._close(t),e._activeItemChange(null,t);}else e._activeItemChange(null,t);},onclick:function(t){var i=c.locateNode(t);if(i){var n=i.getAttribute("data-dhx-id");if(!e.isDisabled(n)){var o=e.data.getItem(n);if(!(null==o?void 0:o.multiClick))if(e.data.haveItems(n)){if(e._vpopups||e._init(),n===e._currentRoot)return;e._isActive||(e._isActive=!0),e._setRoot(n);var r=c.getRealPosition(i);e.data.update(n,{$position:r},!1),e._activeItemChange(n,t),e.events.fire(f.NavigationBarEvents.click,[n,t]);}else switch(null==o?void 0:o.type){case"input":case"title":break;case"menuItem":case"selectButton":e._onMenuItemClick(n,t);break;case"imageButton":case"button":case"customButton":case"customHTML":case"navItem":o.twoState&&e.data.update(o.id,{active:!o.active}),e.events.fire(f.NavigationBarEvents.click,[n,t]),e._close(t);break;default:e._close(t);}}}},onmousedown:function(t){var i=c.locateNode(t);if(i){var n=i.getAttribute("data-dhx-id"),o=e.data.getItem(n);if(null==o?void 0:o.multiClick){var r,a=365,s=function(){e.events.fire(f.NavigationBarEvents.click,[n,t]),a>50&&(a-=55),r=setTimeout(s,a);},l=function(){clearTimeout(r),document.removeEventListener("mouseup",l);};s(),document.addEventListener("mouseup",l);}}}},this._customHandlers());},t.prototype._initEvents=function(){var e=this,t=null;this.data.events.on(f.DataEvents.change,(function(){e.paint(),t&&clearTimeout(t),t=setTimeout((function(){var i={};e.data.eachChild(e.data.getRoot(),(function(e){e.group&&(e.twoState=!0,function(e,t){e[t.group]?(t.active&&(e[t.group].active=t.id),e[t.group].elements.push(t.id)):e[t.group]={active:t.active?t.id:null,elements:[t.id]};}(i,e));}),!0),e._groups=i,e._resetHotkeys(),t=null,e.paint();}),100);})),this.events.on(f.NavigationBarEvents.click,(function(t){var i=e.data.getItem(t),n=e.data.getItem(null==i?void 0:i.parent);if(n&&"selectButton"===n.type&&e.data.update(i.parent,{value:i.value,icon:i.icon}),null==i?void 0:i.group){var o=e._groups[i.group];o.active&&e.data.update(o.active,{active:!1}),o.active=i.id,e.data.update(i.id,{active:!0});}})),this.events.on(f.NavigationBarEvents.inputChange,(function(t,i){e.data.update(t,{value:i});})),this._customInitEvents();},t.prototype._getMode=function(e,t,i){return e.parent===t?"bottom":"right"},t.prototype._drawMenuItems=function(e,t){var i=this;return void 0===t&&(t=!0),this.data.map((function(e){return i._factory(e,t)}),e,!1)},t.prototype._setRoot=function(e){},t.prototype._getParents=function(e,t){var i=[],n=!1,o=this.data.getItem(e),r=o&&o.disabled;return this.data.eachParent(e,(function(e){e.id===t?(i.push(e.id),n=!0):n||i.push(e.id);}),!r),this._isContextMenu&&this._activePosition&&i.push(t),i},t.prototype._listenOuterClick=function(){this._documentHaveListener||(document.addEventListener("mousedown",this._documentClick,!0),this._documentHaveListener=!0);},t.prototype._customInitEvents=function(){},t.prototype._drawPopups=function(){var e=this,t=this._activeMenu;if(!this._isContextMenu&&!t)return null;var i=this.getRootNode(),n=i&&i.offsetParent&&i.offsetParent.offsetParent,o=null;n&&n.classList.contains("dhx_popup--window")&&n.classList.contains("dhx_popup--window_active")&&(o=2147483647);var a=this._currentRoot;if(this._isContextMenu&&!this._activePosition)return null;var l=this._getParents(t,a);return this._activeParents=l,l.forEach((function(t){return e.data.exists(t)&&e.data.update(t,{$activeParent:!0},!1)})),l.map((function(t){if(!e.data.haveItems(t))return null;var i=e.data.getItem(t)||e._rootItem;return e._popupActive=!0,s.el("ul",r({class:"dhx_widget dhx_menu"+(e.config.menuCss?" "+e.config.menuCss:""),_key:t,_hooks:{didInsert:function(n){var s=n.el.getBoundingClientRect(),l=s.width,u=s.height,d=e._isContextMenu&&e._activePosition&&t===a?e._activePosition:i.$position,h=e._getMode(i,a,d===e._activePosition),f=c.calculatePosition(d,{mode:h,auto:!0,width:l,height:u});i.$style=r(r({},f),{zIndex:e._activePosition&&e._activePosition.zIndex||o}),n.patch({style:i.$style});},didRecycle:function(n,s){if(e._isContextMenu&&e._activePosition&&t===a){var l=s.el.getBoundingClientRect(),u=l.width,d=l.height,h=c.calculatePosition(e._activePosition,{mode:e._getMode(i,a,!0),width:u,height:d});i.$style=r(r({},h),{zIndex:e._activePosition.zIndex||o}),s.patch({style:i.$style});}}},tabindex:0,style:i.$style||{position:"absolute"}},function(e){return {role:"menu","aria-labeledby":e.id,"aria-live":"polite"}}(i)),e._drawMenuItems(t))})).reverse()},t.prototype._onMenuItemClick=function(e,t){var i=this.data.getItem(e);i.disabled||(i.twoState&&this.data.update(i.id,{active:!i.active}),this.events.fire(f.NavigationBarEvents.click,[e,t]),this._close(t));},t.prototype._activeItemChange=function(e,t){var i=this;if(this._activeParents){var n=this._getParents(e,this._currentRoot);this._activeParents.forEach((function(e){i.data.exists(e)&&!n.includes(e)&&i.data.update(e,{$activeParent:!1},!1);}));}e&&!this._documentHaveListener&&this._listenOuterClick(),e&&this.data.haveItems(e)?(this._activeMenu===e&&this._popupActive||this.events.fire(f.NavigationBarEvents.openMenu,[e]),clearTimeout(this._currentTimeout),this.paint()):(clearTimeout(this._currentTimeout),this._currentTimeout=setTimeout((function(){return i.paint()}),400)),this._activeMenu=e;},t.prototype._resetHotkeys=function(){var e=this;this._keyManager.removeHotKey(null,this),this.data.map((function(t){t.hotkey&&e._keyManager.addHotKey(t.hotkey,(function(){return e._onMenuItemClick(t.id,null)}));}));},t.prototype._setProp=function(e,t,i){var n,o=this;Array.isArray(e)?e.forEach((function(e){var n;return o.data.update(e,((n={})[t]=i,n))})):this.data.update(e,((n={})[t]=i,n));},t}(d.View);t.Navbar=p;},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(169),o=i(170),r=i(171),a=i(172),s=i(173),l=i(174),c=i(175),u=i(176),d=i(177),h=i(178),f=i(35);t.createFactory=function(e){for(var t=e.defaultType,i=e.allowedTypes,p=e.widgetName,v=e.widget,g=new Set,_=0,m=i;_<m.length;_++){var y=m[_];g.add(y);}var b=v.config,w=v.events,x=v.data;return function(e,i){if(e.hidden)return null;if(!(e.type&&"button"!==e.type&&"navItem"!==e.type&&"menuItem"!==e.type||e.value||e.icon||e.html))return null;e.type=e.type||t,g&&!g.has(e.type)&&(e.type=t),"imageButton"===e.type&&"ribbon"!==p&&(e.active=!1),i&&"spacer"!==e.type&&"separator"!==e.type&&"customHTML"!==e.type&&(e.type="menuItem"),x.haveItems(e.id)&&function(e,t,i){switch(e){case"sidebar":case"context-menu":t.$openIcon="right";break;case"toolbar":t.parent===i.getRoot()?t.$openIcon="right":t.$openIcon="bottom";break;case"menu":t.parent!==this.data.getRoot()&&(t.$openIcon="right");break;case"ribbon":var n=i.getItem(t.parent);n&&"block"!==t.type&&("block"===n.type?t.$openIcon="bottom":t.$openIcon="right");}}(p,e,x),"toolbar"===p&&e.items&&e.items.forEach((function(e){e.type||(e.type="menuItem");}));var v="customHTML"!==e.type&&function(e,t,i,f){switch(e.type){case"navItem":case"selectButton":return o.navItem(e,i,f.collapsed);case"button":return n.button(e,i);case"title":return d.title(e,i);case"separator":return c.separator(e,i);case"spacer":return u.spacer(e,i);case"input":return s.input(e,t,i);case"imageButton":return a.imageButton(e,i);case"menuItem":return l.menuItem(e,i,f.asMenuItem);case"customHTMLButton":return r.customHTMLButton(e,i,f.asMenuItem);case"datePicker":return h.datePicker(e,t,i);default:throw new Error("unknown item type "+e.type)}}(e,w,p,{asMenuItem:i,collapsed:"sidebar"!==p||b.collapsed});return f.navbarComponentMixin(p,e,i,v)}};},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=i(0),r=i(35);t.button=function(e,t){var i=e.icon&&!e.value,a=i?" dhx_navbar-count--absolute":" dhx_navbar-count--button-inline";return o.el("button.dhx_button",n({class:r.getNavbarButtonCSS(e,t),"data-dhx-id":e.id,disabled:e.disabled,type:"button"},function(e){var t=e.active||e.$activeParent,i={"aria-disabled":e.disabled?"true":"false","aria-label":e.value||e.tooltip||e.id||" "+(e.count||"")};return e.items&&(i.id=e.id,i["aria-haspopup"]="menu",t&&(i["aria-expanded"]="true")),i}(e)),[e.icon?r.getIcon(e.icon,"button"):null,e.html?o.el("div.dhx_button__text",{".innerHTML":e.html}):e.value&&o.el("span.dhx_button__text",e.value),e.count>0&&r.getCount(e,a,i),e.value&&e.$openIcon?o.el("span.dhx_button__icon.dhx_button__icon--menu.dxi.dxi-menu-right",{"aria-hidden":"true"}):null,e.loading&&o.el("span.dhx_button__loading",{"aria-hidden":"true"},[o.el("span.dhx_button__loading-icon.dxi.dxi-loading")])])};},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=i(0),r=i(35);t.navItem=function(e,t,i){var a=" dhx_"+t+"-button";return o.el("button",n({class:"dhx_button"+a+(e.active||e.$activeParent?a+"--active":"")+(e.disabled?a+"--disabled":"")+(e.$openIcon?a+"--select":"")+(e.circle?a+"--circle":"")+(e.size?" "+a+"--"+e.size:"")+(!e.value&&e.icon?a+"--icon":"")+(e.css?" "+e.css:""),"data-dhx-id":e.id,disabled:e.disabled,type:"button"},function(e){var t={"aria-disabled":e.disabled?"true":"false","aria-label":e.value||" "},i=e.active||e.$activeParent;return "selectButton"===e.type||e.items?(t.id=e.id,t["aria-haspopup"]="menu",i&&(t["aria-expanded"]="true")):((e.twoState||i)&&(t["aria-pressed"]=i?"true":"false"),!e.value&&e.icon&&e.tooltip&&(t["aria-label"]=e.tooltip+" "+(e.count||""))),t}(e)),[e.icon&&o.el("span",{class:e.icon+a+"__icon","aria-hidden":"true"}),e.html&&o.el("div",{class:a.trim()+"__html",".innerHTML":e.html}),!e.html&&e.value&&o.el("span",{class:a.trim()+"__text"},e.value),e.count>0&&r.getCount(e,a+"__count",i),e.$openIcon&&o.el("span.dxi.dxi-menu-right",{class:a+"__caret","aria-hidden":"true"})])};},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=i(0);t.customHTMLButton=function(e,t,i){var r=i?" dhx_button dhx_menu-button":" dhx_button dhx_nav-menu-button";return o.el("button",n({class:"dhx_custom-button"+r+(e.$activeParent?r+"--active":""),"data-dhx-id":e.id,type:"button",".innerHTML":e.html},function(e){var t={"aria-disabled":e.disabled?"true":"false"};return (e.twoState||e.active||e.$activeParent)&&(t["aria-pressed"]=e.active||e.$activeParent?"true":"false"),t}(e)),e.html?"":e.value)};},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=i(0),r=i(35);t.imageButton=function(e,t){var i="dhx_"+t+"-button-image",a="ribbon"===t;return o.el("button.dhx_button",n({class:i+(e.size?" "+i+"--"+e.size:"")+(!e.value&&e.src?" "+i+"--icon":"")+(a&&e.$openIcon?" "+i+"--select":"")+(e.active?" "+i+"--active":""),"data-dhx-id":e.id,type:"button"},function(e){var t={"aria-disabled":e.disabled?"true":"false"};return (e.twoState||e.active)&&(t["aria-pressed"]=e.active?"true":"false"),!e.value&&e.src&&e.tooltip&&(t["aria-label"]=e.tooltip+" "+(e.count||"")),t}(e)),[a&&e.value&&e.$openIcon&&o.el("span.dxi.dxi-menu-right",{class:i+"__caret","aria-hidden":"true"}),e.html?o.el("div",{class:i+"__text",".innerHTML":e.html}):e.value&&o.el("span",{class:i+"__text"},e.value),e.src&&o.el("span",{class:i+"__image",style:{backgroundImage:"url("+e.src+")"},role:"presentation"}),e.count>0&&r.getCount(e,i+"__count",!0)])};},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),o=i(42);function r(e,t){e.fire(o.NavigationBarEvents.inputBlur,[t]);}function a(e,t){e.fire(o.NavigationBarEvents.inputFocus,[t]);}function s(e,t,i){e.fire(o.NavigationBarEvents.inputChange,[t,i.target.value]);}t.input=function(e,t,i){return n.el(".dhx_form-group.dhx_form-group--no-message-holder"+(e.hiddenLabel?".dhx_form-group--label_sr":".dhx_form-group--inline")+".dhx_"+i+"__input",{style:{width:e.width?e.width:"200px"},role:"presentation"},[e.label&&n.el("label.dhx_label",{for:e.id,style:{maxWidth:e.hiddenLabel?null:"100%"}},e.label),n.el(".dhx_input__wrapper",{role:"presentation"},[n.el("input.dhx_input",{id:e.id,placeholder:e.placeholder,class:e.icon?"dhx_input--icon-padding":"",autocomplete:e.autocomplete?"on":"off",value:e.value,disabled:e.disabled,onblur:[r,t,e.id],onfocus:[a,t,e.id],oninput:[s,t,e.id],"data-dhx-id":e.id,_hooks:{didInsert:function(i){t&&t.fire(o.NavigationBarEvents.inputCreated,[e.id,i.el]);}},_key:e.id,"aria-label":e.label||e.helpMessage||"type "+(e.placeholder?"text like "+e.placeholder:"text")}),e.icon?n.el(".dhx_input__icon",{class:e.icon,"aria-hidden":"true"}):null])])};},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=i(0),r=i(35);t.menuItem=function(e,t,i){var a=i?" dhx_menu-button":" dhx_nav-menu-button";return o.el("button",n({class:"dhx_button"+a+(e.disabled?a+"--disabled":"")+(e.active||e.$activeParent?a+"--active":""),disabled:e.disabled,"data-dhx-id":e.id,type:"button"},function(e){var t={role:"menuitem","aria-disabled":e.disabled?"true":"false"};return e.items&&(t["aria-haspopup"]="true"),t}(e)),i?[e.icon||e.value||e.html?o.el("span.dhx_menu-button__block.dhx_menu-button__block--left",[e.icon&&o.el("span.dhx_menu-button__icon",{class:e.icon}),e.html?o.el("div.dhx_menu-button__text",{".innerHTML":e.html}):e.value&&o.el("span.dhx_menu-button__text",e.value)]):null,e.count>0||e.hotkey||e.items?o.el("span.dhx_menu-button__block.dhx_menu-button__block--right",[e.count>0&&r.getCount(e," dhx_menu-button__count",!1),e.hotkey&&o.el("span.dhx_menu-button__hotkey",e.hotkey),e.items&&o.el("span.dhx_menu-button__caret.dxi.dxi-menu-right")]):null]:[e.icon&&o.el("span.dhx_menu-button__icon",{class:e.icon}),e.html?o.el("div.dhx_menu-button__text",{".innerHTML":e.html}):e.value&&o.el("span.dhx_nav-menu-button__text",e.value)])};},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.separator=function(e,t){return null};},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.spacer=function(e,t){return null};},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(0);t.title=function(e,t){return n.el("span",{class:"dhx_navbar-title dhx_navbar-title--"+t,"data-dhx-id":e.id,".innerHTML":e.html,"aria-label":e.value||""},e.html?null:e.value)};},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),o=i(39),r=i(8),a=i(42);function s(e,t){e.fire(a.NavigationBarEvents.inputBlur,[t]);}function l(e,t,i,o){n.awaitRedraw().then((function(){return i.show(o.target)})),e.fire(a.NavigationBarEvents.inputFocus,[t]);}t.datePicker=function(e,t,i){var c,u,d;return c||(d=new r.Popup,u=new o.Calendar(null,{dateFormat:e.dateFormat||"%d/%m/%y",value:e.value,css:"dhx_widget--bordered"}),d.attach(u),u.events.on("change",(function(){d.hide(),t.fire(a.NavigationBarEvents.inputChange,[e.id,u.getValue()]);})),c=!0),n.el(".dhx_form-group.dhx_form-group--no-message-holder"+(e.hiddenLabel?".dhx_form-group--label_sr":".dhx_form-group--inline")+".dhx_"+i+"__input",{style:{width:e.width?e.width:"200px"},role:"presentation"},[e.label&&n.el("label.dhx_label",{for:e.id,style:{maxWidth:e.hiddenLabel?null:"100%"}},e.label),n.el(".dhx_input__wrapper",{role:"presentation"},[n.el("input.dhx_input",{id:e.id,placeholder:e.placeholder,class:e.icon?"dhx_input--icon-padding":"",value:u.getValue(),disabled:e.disabled,onblur:[s,t,e.id],onfocus:[l,t,e.id,d],"data-dhx-id":e.id,readOnly:!0,_hooks:{didInsert:function(i){t&&t.fire(a.NavigationBarEvents.inputCreated,[e.id,i.el]);}},_key:e.id,"aria-label":e.label||e.helpMessage||"type "+(e.placeholder?"text like "+e.placeholder:"text")}),e.icon?n.el(".dhx_input__icon",{class:e.icon,"aria-hidden":"true"}):null])])};},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);}),r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=i(87),s=i(34),l=i(0),c=i(3),u=i(16),d=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n.scrollView=new s.ScrollView((function(){return n.getRootView()})),n}return o(t,e),t.prototype._draw=function(e){var t=this,i=this.data.getLength()?this.data.reduce((function(e,t){switch(t.type){case"title":return e||20;case"button":return "small"===t.size&&(!e||e<=28)?28:e||32;default:return 32}}),0)+24:null,n=[l.el("ul.dhx_navbar.dhx_navbar--horizontal",r(r({"data-dhx-widget-id":this._uid,tabindex:0},function(e){return {role:"toolbar","aria-label":e||""}}(e)),{onclick:this._handlers.onclick,onmousedown:this._handlers.onmousedown,oninput:this._handlers.input,onmouseover:this._handlers.tooltip,_hooks:{didInsert:function(e){e.el.addEventListener("keyup",(function(e){if(9===e.which){var i=c.locateNode(document.activeElement);if(i){var n=i.getAttribute("data-dhx-id"),o=t.data.getItem(n);(null==o?void 0:o.tooltip)&&u.tooltip(o.tooltip,{node:i,position:u.Position.bottom,force:!0});}}}),!0);}}}),this.data.map((function(e){return t._factory(e)}),this.data.getRoot(),!1))];return l.el("nav.dhx_widget.dhx_toolbar",{style:{height:i},class:this.config.css?this.config.css:""},this.scrollView&&this.scrollView.config.enable?[].concat(this.scrollView.render(n)):n)},t}(a.Toolbar);t.ProToolbar=d;},function(e,t,i){function n(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i]);}Object.defineProperty(t,"__esModule",{value:!0}),n(i(181)),n(i(182));},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);});Object.defineProperty(t,"__esModule",{value:!0});var r=i(3),a=i(16),s=i(22),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._isContextMenu=!0,t}return o(t,e),t.prototype.showAt=function(e,t){if(void 0===t&&(t="bottom"),e instanceof MouseEvent)this._close(e),this._changeActivePosition({left:window.pageXOffset+e.x+1,right:window.pageXOffset+e.x+1,top:window.pageYOffset+e.y,bottom:window.pageYOffset+e.y,zIndex:a.getZIndex(e.currentTarget)},t);else if(window.TouchEvent&&e instanceof TouchEvent)this._close(e),this._changeActivePosition({left:window.pageXOffset+e.touches[0].clientX,right:window.pageXOffset+e.touches[0].clientX,top:window.pageYOffset+e.touches[0].clientY,bottom:window.pageYOffset+e.touches[0].clientY,zIndex:a.getZIndex(e.currentTarget)},t);else if(e instanceof HTMLElement||"string"==typeof e){var i=r.toNode(e);this._changeActivePosition(r.getRealPosition(i),t);}},t.prototype._getFactory=function(){return s.createFactory({widget:this,defaultType:"menuItem",allowedTypes:["menuItem","spacer","separator","customHTML","customHTMLButton"],widgetName:"context-menu"})},t.prototype._close=function(t){var i=this;this.events.on(s.NavigationBarEvents.afterHide,(function(){i._activeMenu=null,i._changeActivePosition(null,null);})),e.prototype._close.call(this,t);},t.prototype._getMode=function(e,t,i){return i?this._mode:"right"},t.prototype._changeActivePosition=function(e,t){this._activePosition=e,this._mode=t,this._listenOuterClick(),this.paint();},t}(s.Navbar);t.ContextMenu=l;},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);});Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),a=i(22),s=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n.mount(t,r.create({render:function(){return n._draw()}})),n}return o(t,e),t.prototype._getFactory=function(){return a.createFactory({widget:this,defaultType:"menuItem",allowedTypes:["navItem","menuItem","spacer","separator","customHTML","customHTMLButton"],widgetName:"menu-nav"})},t.prototype._draw=function(){return r.el("ul.dhx_widget",{"data-dhx-widget-id":this._uid,onmousemove:this._handlers.onmousemove,onmouseleave:this._handlers.onmouseleave,onclick:this._handlers.onclick,onmousedown:this._handlers.onmousedown,class:"dhx_menu-nav "+(this.config.css?this.config.css:"")},this._drawMenuItems(this.data.getRoot(),!1))},t}(a.Navbar);t.Menu=s;},function(e,t,i){var n=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var o=i(2),r=i(27),a=function(){function e(e){var t;this.config=e,this._sheetName=null===(t=e.spreadsheet)||void 0===t?void 0:t.getActiveSheet().name;}return e.prototype.do=function(){var e=this.config,t=e.cell,i=e.dataStore,a=e.spreadsheet,s=e.grid;if(t){this._index||(this._index=o.getCellIndex(t,s).col-1);var l=i.getPage(this._sheetName);l.addColumn(this._index,1);var c=l.getMeta(),u=c.cols,d=c.merged,h=void 0===d?[]:d;this._prev={cols:n(u)};var f=u.slice(0,this._index),p=u.slice(this._index);l.setMeta({cols:n(f,[{width:120}],p)}),a._updateGridSizes(),r.updateSpans(1,0,this._index,l)&&(this._prev.merged=n(h),a._updateGridState());}},e.prototype.undo=function(){var e=this.config,t=e.dataStore,i=e.spreadsheet,n=t.getPage(this._sheetName);n.removeColumn(this._index,1),n.setMeta(this._prev),i._updateGridSizes(),this._prev.merged&&i._updateGridState();},e}();t.AddColumn=a;},function(e,t,i){var n=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var o=i(2),r=i(27),a=function(){function e(e){var t;this.config=e,this._sheetName=null===(t=e.spreadsheet)||void 0===t?void 0:t.getActiveSheet().name;}return e.prototype.do=function(){var e=this.config,t=e.cell,i=e.grid,a=e.dataStore,s=e.spreadsheet;if(t){this._index||(this._index=o.getCellIds(t,i).row);var l=a.getPage(this._sheetName);l.addRow(this._index,1);var c=l.getMeta(),u=c.rows,d=c.merged,h=void 0===d?[]:d;this._prev={rows:n(u)};var f=u.slice(0,this._index),p=u.slice(this._index);l.setMeta({rows:n(f,[{height:null==i?void 0:i.config.rowHeight}],p)}),s._updateGridSizes(),r.updateSpans(0,1,this._index,l)&&(this._prev.merged=n(h),s._updateGridState());}},e.prototype.undo=function(){var e=this.config,t=e.dataStore,i=e.spreadsheet,n=t.getPage(this._sheetName);n.removeRow(this._index,1),n.setMeta(this._prev),i._updateGridSizes(),this._prev.merged&&i._updateGridState();},e}();t.AddRow=a;},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(5),o=function(){function e(e){this.config=e,this._store=e.dataStore;}return e.prototype.do=function(){var e=this.config,t=e.sheets,i=e.val;if(!t.find((function(e){return e.value===i}))){this._store.addPage(i);for(var o=[],r=[],a=0;a<this.config.spreadsheet.config.colsCount;a++)o.push({width:120});for(a=0;a<this.config.spreadsheet.config.rowsCount;a++)r.push({height:this.config.spreadsheet._grid.config.rowHeight});this._store.getPage(i).setMeta({focusedCell:{cell:"A1"},selectedCells:["A1"],cols:o,rows:r});var s=this.config.spreadsheet.getActiveSheet().id,l=t.getIndex(s);this._id=t.add({value:i,id:this._id||null},l+1),this.config.spreadsheet.events.fire(n.SpreadsheetEvents.afterSheetAdd,[{name:i,id:this._id}]),this.config.spreadsheet._changeSheet(this._id),this.config.grid.paint();}},e.prototype.undo=function(){this._store.removePage(this.config.val),this.config.sheets.remove(this._id),this.config.spreadsheet._changeSheet(this.config.prev);},e}();t.AddSheet=o;},function(e,t,i){var n=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var o=i(2),r=i(27),a=i(10),s=function(){function e(e){var t;this.config=e,this._sheetName=null===(t=e.spreadsheet)||void 0===t?void 0:t.getActiveSheet().name;}return e.prototype.do=function(){var e=this.config,t=e.cell,i=e.grid,s=e.spreadsheet,l=e.dataStore;if(t){var c=o.getCellIds(t,i).col;this._index||(this._index=c);var u=l.getPage(this._sheetName),d=u.getMeta(),h=d.cols,f=d.merged;if(1===h.length)return o.showAlert(a.default.removeAlert.replace("$name",a.default.col));var p=u.getSize()[0];this._cells=u.getCellRange(0,c,p-1,c),u.removeColumn(this._index,1),this._prev={cols:n(h)};var v=h.slice(0,this._index),g=h.slice(this._index+1),_=n(v,g);u.setMeta({cols:_});var m=r.updateSpans(-1,0,this._index,u);s._updateGridSizes(),m&&(this._prev.merged=n(f),s._updateGridState());}},e.prototype.undo=function(){var e=this.config,t=e.dataStore,i=e.spreadsheet,n=t.getPage(this._sheetName);n.addColumn(this._index,1);for(var o=0;o<this._cells.length;o++)this._cells[o]&&n.setCell(o,this._index,this._cells[o]);n.setMeta(this._prev),i._updateGridSizes(),this._prev.merged&&i._updateGridState();},e}();t.DeleteColumn=s;},function(e,t,i){var n=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var o=i(2),r=i(27),a=i(10),s=function(){function e(e){var t;this.config=e,this._sheetName=null===(t=e.spreadsheet)||void 0===t?void 0:t.getActiveSheet().name;}return e.prototype.do=function(){var e=this.config,t=e.cell,i=e.dataStore,s=e.grid,l=e.spreadsheet;if(t){var c=o.getCellIds(t,s).row;this._row||(this._row=c);var u=i.getPage(this._sheetName),d=u.getSize()[1];this._cells=u.getCellRange(c,0,c,d-1),u.removeRow(this._row,1);var h=u.getMeta(),f=h.rows,p=h.merged,v=void 0===p?[]:p;if(1===f.length)return o.showAlert(a.default.removeAlert.replace("$name",a.default.row));this._prev={rows:n(f)};var g=f.slice(0,this._row),_=f.slice(this._row+1),m=n(g,_);u.setMeta({rows:m}),l._updateGridSizes(),r.updateSpans(0,-1,this._row,u)&&(this._prev.merged=n(v),l._updateGridState());}},e.prototype.undo=function(){var e=this.config,t=e.dataStore,i=e.spreadsheet,n=t.getPage(this._sheetName);n.addRow(this._row,1);for(var o=0;o<this._cells.length;o++)this._cells[o]&&n.setCell(this._row,o,this._cells[o]);n.setMeta(this._prev),i._updateGridSizes(),this._prev.merged&&i._updateGridState();},e}();t.DeleteRow=s;},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e){this.config=e,this._store=e.dataStore,this._deletedSheet=n({},e.sheets.getItem(e.prev));}return e.prototype.do=function(){var e=this.config,t=e.sheets,i=e.spreadsheet,n=e.val,o=this._store.getPage(n);this._data=o?o.serialize(!0):[],this._sheetMeta=o?o.getMeta():{},this._store.removePage(n);var r=this._index=t.getIndex(this._deletedSheet.id);n===i.getActiveSheet().name&&i._changeSheet(t.getId(1===r?r+1:r-1)),t.remove(this._deletedSheet.id),this.config.grid.paint();},e.prototype.undo=function(){var e=this.config,t=e.sheets,i=e.spreadsheet,n=e.val;this._store.addPage(n),t.add(this._deletedSheet,this._index);var o=this._store.getPage(n);o.setMeta(this._sheetMeta),o.parse(this._data),this._store.getStore().recalculate(!0,o.getContext()),i._changeSheet(this._deletedSheet.id),this.config.grid.paint();},e}();t.DeleteSheet=o;},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=i(2),r=i(5),a=i(43),s=function(){function e(e){this.config=e,this._actions=[];}return e.prototype.do=function(){var e=this,t=this.config,i=t.spreadsheet,s=t.grid,l=t.action,c=i.events;if(!this._actions.length){var u=this.config.val,d=0;if(Array.isArray(u)&&(u=u[d]),!c.fire(r.SpreadsheetEvents.beforeAction,[l,o.cleanActionConfig(this.config)]))return;i.eachCell((function(t){var i=o.getCellIds(t,s),r=i.row,l=i.col;if(!(null==s?void 0:s.isRowHidden(r+1))){var c=o.getCellIds(t,s),h=new a.actions[e.config.action](n(n({},e.config),{row:r||c.row,col:l||c.col,cell:t,val:u}));e._actions.push(h),Array.isArray(e.config.val)&&(d+1>=e.config.val.length?d=0:d+=1,u=e.config.val[d]);}}),this.config.cell);}for(var h=0,f=this._actions;h<f.length;h++){f[h].do();}c.fire(r.SpreadsheetEvents.afterAction,[l,o.cleanActionConfig(this.config)]);},e.prototype.undo=function(){var e=this.config,t=e.spreadsheet,i=e.action,n=t.events;if(n.fire(r.SpreadsheetEvents.beforeAction,[i,o.cleanActionConfig(this.config)])){for(var a=0,s=this._actions;a<s.length;a++){s[a].undo();}var l=this.config.cell.split(":")[0];t.selection.setSelectedCell(l),n.fire(r.SpreadsheetEvents.afterAction,[i,o.cleanActionConfig(this.config)]);}},e}();t.GroupAction=s;},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=i(2),r=i(43),a=function(){function e(e){this.config=e,this._actions=[];}return e.prototype.do=function(){var e=this,t=this.config,i=t.spreadsheet,a=t.grid,s=t.cell;if(!this._actions.length){var l=o.getCellIds(s,a).start.row,c=s.split(":")[0];i.eachCell((function(t){var i=o.getCellIds(t,a),s=i.row,u=i.col;if(s===l){var d=new r.actions[e.config.action](n(n({},e.config),{row:s,col:u,cell:c}));e._actions.push(d);}}),this.config.cell);}for(var u=this._actions.length-1;u>=0;u--)this._actions[u].do();},e.prototype.undo=function(){for(var e=0;e<this._actions.length;e++)this._actions[e].undo();},e}();t.GroupColAction=a;},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=i(2),r=i(43),a=function(){function e(e){this.config=e,this._actions=[];}return e.prototype.do=function(){var e=this,t=this.config,i=t.cell,a=t.grid,s=t.spreadsheet;if(!this._actions.length){var l=o.getCellIds(i,a).start.col,c=i.split(":")[0];s.eachCell((function(t){var i=o.getCellIds(t,a),s=i.row,u=i.col;if(u===l){var d=new r.actions[e.config.action](n(n({},e.config),{row:s,col:u,cell:c}));e._actions.push(d);}}),this.config.cell);}for(var u=this._actions.length-1;u>=0;u--)this._actions[u].do();},e.prototype.undo=function(){for(var e=this._actions.length-1;e>=0;e--)this._actions[e].undo();},e}();t.GroupRowAction=a;},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(2),o=i(5),r=function(){function e(e){this.config=e,this._store=e.dataStore,this._page=e.page;}return e.prototype.do=function(){var e=this.config,t=e.val,i=e.cell,r=e.grid,a=n.getCellIds(i,r),s=a.row,l=a.col;this._page.setCell(s,l,{locked:t}),t?this.config.editLine.lock():this.config.editLine.unlock(),this.config.spreadsheet.events.fire(o.SpreadsheetEvents.afterFocusSet,[i]);},e.prototype.undo=function(){var e=this.config,t=e.val,i=e.cell,r=e.grid,a=n.getCellIds(i,r),s=a.row,l=a.col;this._page.setCell(s,l,{locked:!t}),this.config.spreadsheet.events.fire(o.SpreadsheetEvents.afterFocusSet,[i]),t?this.config.editLine.unlock():this.config.editLine.lock();},e}();t.LockCell=r;},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(2),o=i(5),r=function(){function e(e){this.config=e,this._page=e.page;}return e.prototype.do=function(){var e=this.config,t=e.cell,i=e.grid,r=n.getCellIds(t,i),a=r.row,s=r.col,l=n.getCellInfo(t,this._page,i);l.locked||(this.config.prev=l.css,this._page.setCell(a,s,{css:""}),this.config.spreadsheet.events.fire(o.SpreadsheetEvents.afterStyleChange,[t,{}]),this.config.grid.paint());},e.prototype.undo=function(){var e=this.config,t=e.cell,i=e.grid,r=n.getCellIds(t,i),a=r.row,s=r.col;n.getCellInfo(t,this._page,i).locked||(this._page.setCell(a,s,{css:this.config.prev}),this.config.spreadsheet.events.fire(o.SpreadsheetEvents.afterStyleChange,[t,{}]));},e}();t.RemoveCellStyles=r;},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.config=e,this.page=e.activePage;}return e.prototype.do=function(){var e=this.config,t=e.sheets,i=e.dataStore,n=e.val,o=e.prev,r=t.getItem(o),a=this.config.spreadsheet.getActiveSheet().name;r.prevValue||t.update(r.id,{prevValue:r.value}),a===r.prevValue&&(this.config.spreadsheet._activeSheetName={name:n,id:r.id}),i.renamePage(r.prevValue,n),t.update(o,{value:n,prevValue:r.prevValue}),this.config.grid.paint(),this.config.spreadsheet.selection.setFocusedCell(this.config.spreadsheet.selection.getFocusedCell());},e.prototype.undo=function(){var e=this.config,t=e.sheets,i=e.dataStore,n=e.val,o=e.prev,r=t.getItem(o);i.renamePage(n,r.prevValue),this.config.spreadsheet.getActiveSheet().name===n&&(this.config.spreadsheet._activeSheetName={name:n,id:r.id}),t.update(o,{value:r.prevValue,prevValue:r.prevValue}),this.config.grid.paint(),this.config.spreadsheet.selection.setFocusedCell(this.config.spreadsheet.selection.getFocusedCell());},e}();t.RenameSheet=n;},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(12),o=i(2),r=i(5),a=function(){function e(e){this.config=e,this._page=e.page;}return e.prototype.do=function(){var e,t=this.config,i=t.cell,a=t.grid,s=this.config.val,l=o.getCellIds(i,a),c=l.row,u=l.col,d=n.getFormat(s);s=d&&d.mask||s;var h=o.getCellInfo(i,this._page,a);if(!h.locked&&this.config.spreadsheet.events.fire(r.SpreadsheetEvents.beforeFormatChange,[i,s])){var f=h.format;this.config.prev=null===(e=h.format)||void 0===e?void 0:e.id;var p=this.config.spreadsheet.getFormula(i);"@"!==(null==f?void 0:f.mask)&&"@"===s&&this._page.setValue(c,u,""+(p?"="+p:h.value||""),1),"@"===(null==f?void 0:f.mask)&&"@"!==s&&this._page.setValue(c,u,p?"="+p:h.value,0),this._page.setCell(c,u,{format:d||n.getFormat("common")}),this.config.spreadsheet.events.fire(r.SpreadsheetEvents.afterFormatChange,[i,s]),this.config.grid.paint();}},e.prototype.undo=function(){var e=this.config.val,t=this.config.prev;this.config.val=t,this.config.prev=e,this.do(),this.config.val=e,this.config.prev=t;},e}();t.SetCellFormat=a;},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)},o=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var r=i(27),a=i(2),s=i(5),l=function(){function e(e){this.config=e,this._page=e.page;}return e.prototype.do=function(){var e,t,i=this.config,l=i.cell,c=i.val,u=void 0===c?"":c,d=i.grid;if(l){var h=a.getCellIds(l,d),f=h.row,p=h.col,v=a.getCellInfo(l,this._page,d),g=v.locked,_=v.css,m=void 0===_?"":_,y=v.$toolbarAlign;if(!g){var b,w=y;if("string"!=typeof u){b=u.multiline;var x=a.getStylesObject(m.split("dhx_spreadsheet_link").join(" "));Array.isArray(u)&&(u=u[0]);var E=void 0;"string"!=typeof u&&(w=!!u["text-align"],u=E=this.config.replace?dhx.css.add(n({},u)):dhx.css.add(n(n({},x),a.convertStyles(u)))),u=(m.includes("dhx_spreadsheet_link")?"dhx_spreadsheet_link ":"")+E;}(null===(e=this.config.spreadsheet)||void 0===e?void 0:e.events.fire(s.SpreadsheetEvents.beforeStyleChange,[l,dhx.css.get(u)]))&&(b&&(this._page_rows=o(this._page.getMeta().rows),r.setAutoHeightToRow(l,this.config.grid,this._page,b)&&this.config.spreadsheet._updateGridState()),this.config.prev=m,this._page.setCell(f,p,{css:u,$toolbarAlign:w}),this.config.spreadsheet.events.fire(s.SpreadsheetEvents.afterStyleChange,[l,dhx.css.get(u)]),null===(t=this.config.grid)||void 0===t||t.paint());}}},e.prototype.undo=function(){var e=this.config.val,t=this.config.prev;this.config.val=t||"",this.config.prev=e||"",this.do(),this._page_rows&&(this._page.setMeta({rows:this._page_rows}),this.config.spreadsheet._updateGridState()),this.config.val=e,this.config.prev=t;},e}();t.SetCellStyle=l;},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)},o=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var r=i(27),a=i(12),s=i(2),l=i(5),c=function(){function e(e){this.config=e,this._page=e.page;}return e.prototype.do=function(){var e=this.config,t=e.cell,i=e.grid,c=s.getCellIds(t,i),u=c.row,d=c.col,h=this.config.val,f=this.config.spreadsheet;if(!f.isLocked(t)&&f.events.fire(l.SpreadsheetEvents.beforeValueChange,[t,h])){var p=f.getFormula(t);this.config.prev=p?"="+p:f.getValue(t),this._prevCell=n({},s.getCellInfo(t,this._page,i));var v=this._prevCell.format;if("string"==typeof h&&h.startsWith("=")&&"@"!==(null==v?void 0:v.mask)){for(var g=h.split("").reduce((function(e,t){return "("===t?e+1:e}),0),_=h.split("").reduce((function(e,t){return ")"===t?e+1:e}),0);_<g;)h+=")",_++;try{this._page.setValue(+u,+d,h);}catch(e){}}else this._page.setValue(+u,+d,a.getCleanValue(h,v),"text"===(null==v?void 0:v.id)?1:0);var m=s.getCellInfo(t,this._page,i),y=m.css,b=void 0===y?"":y,w=m.$toolbarAlign,x=dhx.css.get(b)||{},E=x.multiline,C={};if(E&&(this._page_rows=o(this._page.getMeta().rows),r.setAutoHeightToRow(t,this.config.grid,this._page,E)&&this.config.spreadsheet._updateGridState()),!w){var S=this._page.getValue(u,d);C={css:b=dhx.css.add(s.convertStyles(n(n({},x),{"text-align":a.isNumeric(S)&&"text"!==(null==v?void 0:v.id)?"right":"left"})))};}var I=s.doesContainUrl(h);I&&(C={css:s.isURL(h)?"dhx_spreadsheet_link "+b:b,link:{href:I}}),h||(C={css:null==b?void 0:b.split("dhx_spreadsheet_link ").join(""),link:null}),this._page.setCell(u,d,n({nextValue:void 0,edited:!1,format:v||a.getDefaultFormats().filter((function(e){return "common"===e.id}))[0]},C)),this._page.setMeta({inserted:!0}),this.config.grid.paint(),f.events.fire(l.SpreadsheetEvents.afterValueChange,[this.config.cell,h]);}},e.prototype.undo=function(){var e=this,t=this.config,i=t.cell,o=t.grid,r=s.getCellIds(i,o),a=r.row,l=r.col;this._page_rows&&(this._page.setMeta({rows:this._page_rows}),this.config.spreadsheet._updateGridState()),setTimeout((function(){e._page.setCell(a,l,n(n({},e._prevCell),{value:e._prevCell.value||""})),null==o||o.paint();}));},e}();t.SetCellValue=c;},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.config=e;}return e.prototype.do=function(){var e=this.config.spreadsheet;this._data=e.serialize(),e.parse([]);},e.prototype.undo=function(){this.config.spreadsheet.parse(this._data);},e}();t.Clear=n;},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.config=e,this._store=e.dataStore;}return e.prototype.do=function(){var e=this.config,t=e.val,i=e.spreadsheet;this._page=this._store.getPage(t),this._data=this._page?this._page.serialize(!0):[],this._page.parse([]),i._math.recalculate(),i.selection.setFocusedCell(i.selection.getSelectedCell()),i._grid.paint();},e.prototype.undo=function(){var e=this.config.spreadsheet;this._page.parse(this._data),this._store.getStore().recalculate(!0,this._page.getContext()),e.selection.setFocusedCell(e.selection.getSelectedCell()),e._math.recalculate(),e._grid.paint();},e}();t.ClearSheet=n;},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)},o=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var r=i(2),a=i(5),s=function(){function e(e){this.config=e;}return e.prototype.do=function(){var e=this,t=this.config,i=t.grid,s=t.cell,l=t.mouseEvent;if(this._colsAfterResize)i.setColumns(this._colsAfterResize);else {var c=l.clientX,u=s.split(":"),d=u[0],h=u[1],f=r.getCellIds(d,i),p=r.getCellIds(h||d,i);this._prevCols=i.config.columns.map((function(e){return n({},e)}));var v=o(i.config.columns),g=i.getRootNode();g.style.cursor="col-resize";for(var _=[],m=f.col+1;m<=p.col+1;m++){var y=v[m];y.$initWidth=i.config.columns[m].width,_.push(y);}var b=function(e){var t=e.clientX-c;_.forEach((function(e){var i=e.$initWidth+t/_.length;e.width=i<=20?20:i;})),i.setColumns(v),i.paint();},w=function(t){document.removeEventListener("mousemove",b),document.removeEventListener("mouseup",w),g.style.cursor="unset",e._colsAfterResize=v,e.config.spreadsheet.events.fire(a.SpreadsheetEvents.afterAction,[a.Actions.resizeCol,r.cleanActionConfig(e.config)]);};document.addEventListener("mousemove",b),document.addEventListener("mouseup",w),i.paint();}},e.prototype.undo=function(){this.config.grid.setColumns(this._prevCols);},e}();t.ResizeCol=s;},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)},o=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var r=i(2),a=i(5),s=function(){function e(e){this.config=e;}return e.prototype.do=function(){var e=this,t=this.config,i=t.grid,s=t.cell,l=t.mouseEvent;if(this._rowsAfterResize)this._rowsAfterResize.forEach((function(e){var t=e.id,n=e.height;i.data.update(t,{height:n,changedByUser:!0});}));else {var c=l.clientY,u=s.split(":"),d=u[0],h=u[1],f=r.getCellIds(d,i),p=r.getCellIds(h||d,i),v=o(i.data.serialize()),g=i.getRootNode();g.style.cursor="row-resize";for(var _=[],m=function(e){var t=v.find((function(t){return +t.id-1===e}));if(!t)return "continue";t.height||(t.height=i.config.rowHeight),_.push(t);},y=f.row;y<=p.row;y++)m(y);this._prevRows=_.map((function(e){return n({},e)})),this._rowsAfterResize=_.map((function(e){return n({},e)}));var b=function(t){var n=t.clientY-c;_.forEach((function(t){var o=t.height+n/_.length,r=o<=10?10:o;i.data.update(t.id,{height:r,changedByUser:!0}),e._rowsAfterResize.find((function(e){return e.id===t.id})).height=r;})),i.paint();},w=function(t){document.removeEventListener("mousemove",b),document.removeEventListener("mouseup",w),g.style.cursor="unset",e.config.spreadsheet.events.fire(a.SpreadsheetEvents.afterAction,[a.Actions.resizeRow,r.cleanActionConfig(e.config)]);};document.addEventListener("mousemove",b),document.addEventListener("mouseup",w),i.paint();}},e.prototype.undo=function(){var e=this;this._prevRows.forEach((function(t){var i=t.id,n=t.height;e.config.grid.data.update(i,{height:n,changedByUser:!0});}));},e}();t.ResizeRow=s;},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(2),o=function(){function e(e){this.config=e,this._page=e.page,this._prevState={};}return e.prototype.do=function(){var e=this.config,t=e.val,i=e.cell,o=e.grid,r=n.getCellIds(i,o),a=r.row,s=r.col,l=this._page.getCell(a,s);this._prevState[i]=(null==l?void 0:l.editor)||null,this._page.setCell(a,s,{editor:t?{type:"select",options:t}:null}),this.config.grid.paint();},e.prototype.undo=function(){var e=this.config,t=e.cell,i=e.grid,o=n.getCellIds(t,i),r=o.row,a=o.col;this._page.setCell(r,a,{editor:this._prevState[t]}),this.config.grid.paint();},e}();t.SetValidation=o;},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)},o=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var r=i(2),a=function(){function e(e){this.config=e,this._data={};}return e.prototype.do=function(){var e=this,t=this.config,i=t.dir,a=t.cell,s=t.spreadsheet,l=t.page,c=t.dataStore,u=t.grid,d=a.split(","),h=(null==l?void 0:l.getMeta()).filter,f=r.getCellIds(null==h?void 0:h.cell,u).start;d.forEach((function(t){var a=l,d=t;if(d.includes("!")){var p=d.split("!");if(d=p[1],!(a=c.getPage(p[0])))return}e._data[t]=a.serialize(!0);var v=a.getSize(),g=v[0],_=v[1],m=r.getCellIds(d,u);if(m.end){var y=m.start,b=m.end;h&&f.row===y.row&&(y.row=y.row+1);for(var w=s.config.topSplit||y.row,x=g-1<b.row?g-1:b.row,E=a.getCellRange(w,y.col,x,y.col).map((function(e,t){return n(n({},e),{$row:t})})),C=E.sort((function(e,t){var n=null==e?void 0:e.value,o=null==t?void 0:t.value;return "string"==typeof n&&(n=n.toLowerCase()),"string"==typeof o&&(o=o.toLowerCase()),!n&&"number"!=typeof n&&o?1:!o&&"number"!=typeof o&&n?-1:"string"==typeof n&&"number"==typeof o?-i:"number"==typeof n&&"string"==typeof o?i:n<o?-i:n>o?i:0})),S=w,I=0,k=[];S<x+1;){for(var M=C[I].$row+w,P=[],O=0;O<_;O++){var A=a.getCell(M,O)||{},D=a.getValue(M,O,!0);"string"==typeof D&&D.startsWith("=")&&(D=s._math.transposeMath(D,S-M,0,a.getContext())),P.push([S,O,n(n({},A),{value:D})]);}k.push.apply(k,P),S++,I++;}var F=a.serialize(!0).filter((function(e){return !k.find((function(t){return t[0]===e[0]&&t[1]===e[1]}))}));a.parse(o(F,k));}})),this.config.grid.paint();},e.prototype.undo=function(){var e=this,t=this.config,i=t.grid,n=t.page,o=t.dataStore;Object.keys(this._data).forEach((function(t){var i=n;if(t.includes("!")){var r=t.split("!");if(!(i=o.getPage(r[0])))return}i.parse(e._data[t]);})),i.paint();},e}();t.SortCells=a;},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=i(12),r=i(2),a=function(){function e(e){this.config=e,this._page=e.page;}return e.prototype.do=function(){var e,t=this.config,i=t.cell,a=t.val,s=t.grid;if(i){var l=r.getCellIds(i,s),c=l.row,u=l.col,d=this.config.spreadsheet;if(!(null==d?void 0:d.isLocked(i))){var h=r.getCellInfo(i,this._page,s),f=h.css,p=h.format;if(p||(p=o.getDefaultFormats().filter((function(e){return "common"===e.id}))[0]),this.config.prev=h,a){var v=a.text,g=a.href;v=null==v?void 0:v.trim(),this._page.setCell(c,u,{value:v||g,link:n(n({},a),{text:v}),css:"dhx_spreadsheet_link "+(f||""),format:p});}else this._page.setCell(c,u,{link:null,css:null==f?void 0:f.split("dhx_spreadsheet_link ").join(""),format:p});null===(e=this.config.grid)||void 0===e||e.paint();}}},e.prototype.undo=function(){var e=this.config,t=e.cell,i=e.grid,n=e.groupAction;if(t){var o=r.getCellIds(t,i),a=o.row,s=o.col,l=this.config.prev,c=l.value,u=void 0===c?"":c,d=l.css,h=void 0===d?"":d,f=l.link,p=void 0===f?null:f;n?this._page.setCell(a,s,{link:p}):this._page.setCell(a,s,{value:u,css:h,link:p}),null==i||i.paint();}},e}();t.InsertLink=a;},function(e,t,i){var n=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var o=i(2),r=i(1),a=i(12),s=function(){function e(e){this.config=e,this._page=e.page;}return e.prototype.do=function(){var e=this,t=this.config,i=t.cell,s=t.spreadsheet,l=t.grid,c=o.getCellIds(i,l).col,u=this._page.getSize(),d=this._page.getRange(0,c,u[0],c),h=40;d.forEach((function(t,i){if(t){var n=e._page.getCell(i,c),o=r.getStringWidth(a.getFormattedValue(""+t,n.format));o>h&&(h=o);}}));var f=this._page.getMeta().cols;this._prev=n(f),h+=20;var p=f.slice(0,c),v=f.slice(c+1);this._page.setMeta({cols:n(p,[{width:h}],v)}),s._updateGridState();},e.prototype.undo=function(){var e=this.config.spreadsheet;this._page.setMeta({cols:this._prev}),e._updateGridState();},e}();t.FitColumn=s;},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=i(2),r=i(10),a=function(){function e(e){this.config=e;}return e.prototype.do=function(){var e=this.config,t=e.cell,i=e.page,a=e.val,s=e.grid,l=e.spreadsheet;this._prev=n({},i.getMeta().filter);var c=t;if(!a)return i.setMeta({filter:null}),void(i===l._activePage&&l._filterForm.applyFilter(i));var u=o.getCellIds(c,s);if(!u.end){var d=i.getSize(),h=d[0],f=d[1];c=o.getCellNameById(s,1,1)+":"+o.getCellNameById(s,h,f),u=o.getCellIds(c,s),this.config.cell=c;}if(l._spanControl.checkBeforeAction(this.config.cell,i,r.default.filter)){for(var p=u.start,v=u.end.col-p.col;a.length<v+1;)a.push({});null==i||i.setMeta({filter:{cell:c,rules:a}}),i===l._activePage&&l._filterForm.applyFilter(i);}},e.prototype.undo=function(){var e,t,i=this.config,n=i.cell,o=i.val;this.config.val=null===(e=this._prev)||void 0===e?void 0:e.rules,this.config.cell=null===(t=this._prev)||void 0===t?void 0:t.cell,this.do(),this.config.cell=n,this.config.val=o;},e}();t.Filter=a;},function(e,t,i){var n=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var o=i(2),r=i(0),a=i(1),s=function(){function e(e){this.config=e;}return e.prototype.do=function(){var e=this,t=this.config,i=t.cell,r=t.spreadsheet,s=t.page,l=t.$autofill,c=t.grid;if(i&&o.isRangeId(i)&&!(null==i?void 0:i.includes(","))){var u=(null==s?void 0:s.getMeta()).merged,d=void 0===u?[]:u,h=o.getCellsArray(i,c),f=new Set,p=null==s?void 0:s.serialize(!0);this._prevData=n(p),h.forEach((function(e){var t=o.isCellSpaned(e,d);t&&f.add(t);}));var v=o.getCellsArray(i,c),g=v[0],_=v.slice(1),m=n(_),y=m[m.length-1],b=p.filter((function(e){var t=m.find((function(t){var i=o.getCellIndex(t,c),n=i.row,r=i.col;return e[0]===n&&e[1]===r-1}));return !t})),w=o.getCellIndex(g,c),x=o.getCellIndex(y,c);if(this._newSpan={from:{row:w.row,column:w.col-1},to:{row:x.row,column:x.col-1}},!d.find((function(t){return a.compare(t,e._newSpan)}))){this._prevSpan=d.filter((function(e){return f.has(e)}))||[];var E=n(d.filter((function(e){return !f.has(e)})),[this._newSpan]);null==s||s.setMeta({merged:E}),l||null==s||s.parse(b),r._updateGridState();}}},e.prototype.undo=function(){var e=this,t=this.config,i=t.page,o=t.spreadsheet,a=t.$autofill,s=(null==i?void 0:i.getMeta()).merged;null==i||i.setMeta({merged:n(s.filter((function(t){return t!==e._newSpan})),this._prevSpan)}),a||null==i||i.parse(this._prevData),r.awaitRedraw().then((function(){o._updateGridState();}));},e}();t.Merge=s;},function(e,t,i){var n=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var o=i(2),r=i(0),a=function(){function e(e){this.config=e;}return e.prototype.do=function(){var e=this,t=this.config,i=t.cell,n=t.spreadsheet,r=t.page,a=t.grid;if(i&&!(null==i?void 0:i.includes(","))){var s=(null==r?void 0:r.getMeta()).merged,l=o.getCellsArray(i,a);if(this._prevSpan=o.isCellSpaned(l[0],s),this._prevSpan){var c=s.filter((function(t){return t!==e._prevSpan}));null==r||r.setMeta({merged:c}),n._updateGridState();}}},e.prototype.undo=function(){var e=this.config,t=e.page,i=e.spreadsheet;if(this._prevSpan){var o=(null==t?void 0:t.getMeta()).merged;null==t||t.setMeta({merged:n(o,[this._prevSpan])}),r.awaitRedraw().then((function(){i._updateGridState();}));}},e}();t.Unmerge=a;},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(10);t.getContextMenuStruct=function(){return [{id:"lock",value:n.default.lockCell,icon:"dxi dxi-key"},{id:"clear",value:n.default.clear,icon:"dxi dxi-eraser",items:[{id:"clear-value",value:n.default.clearValue},{id:"clear-styles",value:n.default.clearStyles},{id:"clear-all",value:n.default.clearAll}]},{id:"columns",value:n.default.columns,icon:"dxi dxi-table-column",items:[{id:"add-col",value:n.default.addColumn,icon:"dxi dxi-table-column-plus-before"},{id:"remove-col",value:n.default.removeColumn,icon:"dxi dxi-table-column-remove"},{id:"fit-col",value:n.default.fitToData,hidden:!0,icon:"dxi dxi-table-column"}]},{id:"rows",value:n.default.rows,icon:"dxi dxi-table-row",items:[{id:"add-row",value:n.default.addRow,icon:"dxi dxi-table-row-plus-before"},{id:"remove-row",value:n.default.removeRow,icon:"dxi dxi-table-row-remove"}]},{id:"sort",value:n.default.sort,icon:"dxi dxi-format-line-spacing",items:[{id:"asc-sort",value:n.default.ascSort,icon:"dxi dxi-sort-variant dhx-sort-acs"},{id:"desc-sort",value:n.default.descSort,icon:"dxi dxi-sort-variant"}]},{id:"link",value:n.default.insert+" "+n.default.link.toLowerCase(),icon:"dxi dxi-link-variant"}]},t.getSheetsContextMenuStruct=function(e){return [{id:"delete",value:n.default.deleteSheet,icon:"dxi dxi-delete-forever",disabled:!e},{id:"rename",value:n.default.renameSheet,icon:"dxi dxi-pencil"}]};},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(44),o=i(10);t.getMenuStruct=function(e){return [{id:"file",open:!0,value:o.default.file,items:[{id:"import",value:o.default.importAs,icon:"dxi dxi-file-import",items:[{id:"import-xlsx",value:"Microsoft Excel(.xlsx)",icon:"dxi dxi-file-excel"}]},{id:"download",value:o.default.downloadAs,icon:"dxi dxi-file-export",items:[{id:"export-xlsx",value:"Microsoft Excel(.xlsx)",icon:"dxi dxi-file-excel"}]}]},{id:"edit",value:o.default.edit,items:[{id:"undo",value:o.default.undo,icon:"dxi dxi-undo"},{id:"redo",value:o.default.redo,icon:"dxi dxi-redo"},{type:"separator"},{id:"lock",value:o.default.lockCell,icon:"dxi dxi-key"},{type:"separator"},{id:"clear",value:o.default.clear,icon:"dxi dxi-eraser",items:[{id:"clear-value",value:o.default.clearValue},{id:"clear-styles",value:o.default.clearStyles},{id:"clear-all",value:o.default.clearAll}]}]},{id:"insert",value:o.default.insert,items:[{id:"columns",value:o.default.columns,icon:"dxi dxi-table-column",items:[{id:"add-col",value:o.default.addColumn,icon:"dxi dxi-table-column-plus-before"},{id:"remove-col",value:o.default.removeColumn,icon:"dxi dxi-table-column-remove"}]},{id:"rows",value:o.default.rows,icon:"dxi dxi-table-row",items:[{id:"add-row",value:o.default.addRow,icon:"dxi dxi-table-row-plus-before"},{id:"remove-row",value:o.default.removeRow,icon:"dxi dxi-table-row-remove"}]},{id:"link",type:"navItem",icon:"dxi dxi-link-variant",value:o.default.insert+" "+o.default.link.toLowerCase()}]},{id:"configuration",value:o.default.format,items:[{id:"font-weight-bold",value:o.default.bold,icon:"dxi dxi-format-bold"},{id:"font-style-italic",value:o.default.italic,icon:"dxi dxi-format-italic"},{id:"text-decoration-underline",value:o.default.underline,icon:"dxi dxi-format-underline"},{id:"text-decoration-line-through",value:o.default.strikethrough,icon:"dxi dxi-format-strikethrough"},{type:"separator"},{id:"halign",value:o.default.halign,items:[{id:"halign-left",value:o.default.left,twoState:!0,group:"halign",icon:"dxi dxi-format-align-left"},{id:"halign-center",value:o.default.center,twoState:!0,group:"halign",icon:"dxi dxi-format-align-center"},{id:"halign-right",value:o.default.right,twoState:!0,group:"halign",icon:"dxi dxi-format-align-right"}]},{id:"valign",value:o.default.valign,items:[{id:"valign-top",value:o.default.top,twoState:!0,group:"valign",icon:"dxi dxi-format-vertical-align-top"},{id:"valign-center",value:o.default.center,twoState:!0,group:"valign",icon:"dxi dxi-format-vertical-align-center"},{id:"valign-bottom",value:o.default.bottom,twoState:!0,group:"valign",icon:"dxi dxi-format-vertical-align-bottom"}]},{id:"multiline",value:o.default.multiline,items:[{id:"multiline-clip",group:"multiline",twoState:!0,value:o.default.clip,icon:"dxi dxi-format-text-wrapping-clip"},{id:"multiline-wrap",group:"multiline",twoState:!0,value:o.default.wrap,icon:"dxi dxi-format-text-wrapping-wrap"}]},{id:"format",type:"navItem",value:o.default.format,items:n.getFormatsDropdown(e)},{id:"merge",type:"navItem",value:o.default.merge,tooltip:o.default.merge}]},{id:"data",value:o.default.data,items:[{id:"validation",value:o.default.validation,icon:"dxi dxi-table-check"},{id:"search",value:o.default.search,icon:"dxi dxi-magnify"},{id:"filter",value:o.default.filter,icon:"dxi dxi-filter-variant"},{id:"sort",value:o.default.sort,icon:"dxi dxi-format-line-spacing",items:[{id:"asc-sort",value:o.default.ascSort,icon:"dxi dxi-sort-variant dhx-sort-acs"},{id:"desc-sort",value:o.default.descSort,icon:"dxi dxi-sort-variant"}]}]},{id:"help",value:o.default.help}]};},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)},o=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var r=i(2),a=i(44),s=i(10),l={undo:"z",redo:"y",bold:"b",italic:"i",underline:"u",link:"k","align-left":"l","align-center":"e","align-right":"r"},c={"line-through":"shift+5"},u=n(n(n({},l),c),{"line-through":"shift+x"});function d(e){return r.isMac()?"⌘+"+u[e]:l[e]?"ctrl+"+l[e]:"alt+"+c[e]}t.getHotKey=d,t.getToolbarStruct=function(e,t){var i={undo:[{id:"undo",type:"navItem",icon:"dxi dxi-undo",tooltip:s.default.undo+" ("+d("undo")+")"},{id:"redo",type:"navItem",icon:"dxi dxi-redo",tooltip:s.default.redo+" ("+d("redo")+")"}],colors:[{id:"color",css:"dhx_button-toolbar-colorPicker",type:"HTMLButton",html:a.getColorpickerTemplate("#4C4C4C","format-color-text"),tooltip:s.default.textColor},{id:"background",css:"dhx_button-toolbar-colorPicker",type:"HTMLButton",html:a.getColorpickerTemplate("#FFF","format-color-fill"),tooltip:s.default.backgroundColor}],lock:[{id:"lock",type:"navItem",icon:"dxi dxi-key",tooltip:s.default.lockCell}],file:[{id:"export",type:"navItem",icon:"dxi dxi-file-export",tooltip:s.default.export,items:[{id:"export-xlsx",value:"Microsoft Excel(.xlsx)",icon:"dxi dxi-file-excel"}]},{id:"import",type:"navItem",icon:"dxi dxi-file-import",tooltip:s.default.import,items:[{id:"import-xlsx",value:"Microsoft Excel(.xlsx)",icon:"dxi dxi-file-excel"}]}],columns:[{id:"add-col",type:"navItem",icon:"dxi dxi-table-column-plus-before",tooltip:s.default.addColumn},{id:"remove-col",type:"navItem",icon:"dxi dxi-table-column-remove",tooltip:s.default.removeColumn}],rows:[{id:"add-row",type:"navItem",icon:"dxi dxi-table-row-plus-before",tooltip:s.default.addRow},{id:"remove-row",type:"navItem",icon:"dxi dxi-table-row-remove",tooltip:s.default.removeRow}],clear:[{type:"navItem",icon:"dxi dxi-eraser",id:"clear-group",tooltip:s.default.clear,items:[{id:"clear-value",value:s.default.clearValue},{id:"clear-styles",value:s.default.clearStyles},{id:"clear-all",value:s.default.clearAll}]}],align:[{id:"halign",type:"navItem",icon:"dxi dxi-format-align-left",tooltip:s.default.halign,items:[{id:"halign-left",type:"navItem",value:s.default.left,icon:"dxi dxi-format-align-left",group:"halign",tooltip:s.default.left+" ("+d("align-left")+")"},{id:"halign-center",type:"navItem",value:s.default.center,icon:"dxi dxi-format-align-center",group:"halign",tooltip:s.default.center+" ("+d("align-center")+")"},{id:"halign-right",type:"navItem",value:s.default.right,icon:"dxi dxi-format-align-right",group:"halign",tooltip:s.default.right+" ("+d("align-right")+")"}]},{id:"valign",type:"navItem",icon:"dxi dxi-format-align-left",tooltip:s.default.valign,items:[{id:"valign-top",type:"navItem",group:"valign",value:s.default.top,icon:"dxi dxi-format-vertical-align-top"},{id:"valign-center",type:"navItem",group:"valign",value:s.default.center,icon:"dxi dxi-format-vertical-align-center"},{id:"valign-bottom",type:"navItem",group:"valign",value:s.default.bottom,icon:"dxi dxi-format-vertical-align-bottom"}]},{id:"multiline",type:"navItem",icon:"dxi dxi-format-align-left",tooltip:s.default.multiline,items:[{id:"multiline-clip",type:"navItem",group:"multiline",value:s.default.clip,icon:"dxi dxi-format-text-wrapping-clip"},{id:"multiline-wrap",type:"navItem",group:"multiline",value:s.default.wrap,icon:"dxi dxi-format-text-wrapping-wrap"}]},{id:"merge",type:"navItem",icon:"dxi dxi-table-merge-cells",tooltip:s.default.merge}],decoration:[{id:"font-weight-bold",type:"navItem",icon:"dxi dxi-format-bold",tooltip:s.default.bold+" ("+d("bold")+")"},{id:"font-style-italic",type:"navItem",icon:"dxi dxi-format-italic",tooltip:s.default.italic+" ("+d("italic")+")"},{id:"text-decoration-underline",type:"navItem",icon:"dxi dxi-format-underline",tooltip:s.default.underline+" ("+d("underline")+")"},{id:"text-decoration-line-through",type:"navItem",icon:"dxi dxi-format-strikethrough",tooltip:s.default.strikethrough+" ("+d("line-through")+")"}],helpers:[{id:"link",type:"navItem",icon:"dxi dxi-link-variant",tooltip:s.default.insert+" "+s.default.link.toLowerCase()+" ("+d("link")+")"},{id:"help",type:"navItem",icon:"dxi dxi-help-circle-outline",tooltip:s.default.help}],format:[{id:"format",type:"navItem",tooltip:s.default.format,css:"dhx_format-dropdown",items:a.getFormatsDropdown(t)}],actions:[{id:"filter",type:"navItem",tooltip:s.default.filter,icon:"dxi dxi-filter-variant"}]},n=["undo","colors","decoration","align","format","actions","helpers"],r=(e=e||n).indexOf("default");return -1!==r&&e.splice.apply(e,o([r,1],n)),(e=e.filter((function(e,t,i){return i.indexOf(e)===t}))).reduce((function(e,t,n,o){return i[t]&&(e.push.apply(e,i[t]),n!==o.length-1&&e.push({type:"separator"})),e}),[])};},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);});Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),a=i(7),s=i(5),l=i(2),c=i(31),u=i(213),d=i(1),h=function(e){function t(t,i){void 0===i&&(i={});var n=e.call(this,t,i)||this;n._store=i.math,n._activePage=i.activePage,n._grid=i.grid,n._suggest=new u.default((function(e,t,i,o){return n.setAtCursor(e,t,i,o)})),n._prevStyles=[],n._htmlEvents={oninput:function(e){n._isEdit||(e.target.value=n._value),n._value=e.target.value,n._isMath=n._value&&n._value.toString().startsWith("=")?n._parse(n._value):null,n._isMath&&n._suggest.show(n._value,e.target,n._isMath,n.config.spreadsheet._grid.config.height),n._editMode?n.setValue(n._value):n.config.events.fire(s.SpreadsheetEvents.editLineInput,[e.target.value]);},onfocus:function(e){n._editMode||n.config.events.fire(s.SpreadsheetEvents.editLineFocus,[e.target.value,e]);},onblur:function(e){n._editMode?n.focus():n.config.events.fire(s.SpreadsheetEvents.editLineBlur,[e.target.value,e]);},onclick:function(e){var t=n._input.selectionStart;t!==n._prevCursorPosition&&n._isMath&&(n._suggest.show(n._value,e.target,n._isMath),n._prevCursorPosition=t);},onselectionchange:function(){var e=n.getRootView(),t=e&&e.refs&&e.refs.input_wrapper,i="0px";if(n._isEdit&&n._value&&n._input){var o=n._input.selectionStart,r=d.getStringWidth((""+n._value).substr(0,o))+12,a=n.getRootNode().offsetWidth;t&&a<r&&(i=a-r+"px");}t&&(t.el.style.left=i,n.paint());}},document.addEventListener("selectionchange",n._htmlEvents.onselectionchange),n.config.events.on(s.SpreadsheetEvents.cellInput,(function(e,t){n._setValue(t);})),n.config.events.on(s.SpreadsheetEvents.afterSheetChange,(function(){n._activePage=n.config.spreadsheet._activePage;var e=n.config.spreadsheet._editMode,t=n._input&&n._input.selectionStart;e?(n._editMode=e,n._removeStyles(),n._setValue(n._value),n.focus(),n.setCursor(t),e.pageName===n.config.spreadsheet.getActiveSheet().name&&(n._editMode=null)):n._editMode=null;})),n.config.events.on(s.SpreadsheetEvents.afterEditStart,(function(){n._isEdit=!0;})),n.config.events.on(s.SpreadsheetEvents.afterEditEnd,(function(){n._isEdit=!1;}));return n.mount(t,r.create({render:function(){return n._render()}})),n}return o(t,e),t.prototype._parse=function(e,t){return void 0===t&&(t=this._activePage.getContext()),this._store.parse(e,t)},t.prototype.navigate=function(e){return "enter"===e&&this._isMath&&(this._presedEnter=!0),this._editMode&&this._presedEnter?(this.setCellMath(),!1):this._suggest.navigate(e)},t.prototype.setAtCursor=function(e,t,i,n){if(this._input){var o=this._value.substr(0,t)+e+this._value.substr(i);this._editMode?this.setValue(o):this.config.events.fire(s.SpreadsheetEvents.editLineInput,[o]),this._prevCursorPosition=t+n,this._input.setSelectionRange(t+n,t+n);}},t.prototype.focus=function(){this._input&&this._input.focus();},t.prototype.blur=function(){this._input&&this._input.blur();},t.prototype.lock=function(){this._locked=!0,this.paint();},t.prototype.unlock=function(){this._locked=!1,this.paint();},t.prototype.setValueAtRedactor=function(e){var t=this._input&&this._input.selectionStart;this.setAtCursor(e,t,t,e.length);},t.prototype.setValue=function(e){this.unlock(),this._setValue(e);},t.prototype._setValue=function(e){this._value=e,this._isMath=this._value&&this._value.toString().startsWith("=")?this._parse(this._value):null,this._colored=this._parseColors(this._value),this._input&&(this._input.value=this._value),this._presedEnter=!1,this._htmlEvents.onselectionchange(),this.paint();},t.prototype.setCellMath=function(){if(this._editMode){this._removeStyles();var e=l.getCellIds(this._editMode.cell,this._grid),t=e.row,i=e.col,n=this._editMode.page;this._editMode=null,n.setCell(t,i,{nextValue:this._value}),this.config.spreadsheet._changeSheet(n.getMeta().toolbarId),this.blur(),this._presedEnter=!1;}},t.prototype.getValue=function(){return this._value},t.prototype.clean=function(){var e=this;setTimeout((function(){e._setValue("");}),1);},t.prototype.destructor=function(){this._suggest.destructor();},t.prototype.getInput=function(){return this._input},t.prototype.setCursor=function(e){this._input&&this._input.setSelectionRange(e,e);},t.prototype.isCellExpected=function(e,t,i,n){if(!this._presedEnter){if(this._isMath&&this._isEdit){var o=this._value,r=e.lastIndexOf(","),a=e.lastIndexOf(":"),l=r>a?r:a,u=e.includes(",")||e.includes(":"),d=i?i.selectionStart:this._input?this._input.selectionStart:this._value.length,h=this._isMath.code;if(l>-1&&e.includes(n)){var f=this._parse(this._isMath.source.substring(0,d)).code.reverse();e=(12===f[2]?f[5]:f[2])!==c.T_OPERATOR?e.substring(l):e.substring(l+1);}for(var p=0;p<h.length;p+=3){var v=h[p+1]+h[p+2]==d,g=h[p]===c.T_SPACE?h[p-3]:h[p];if(v&&(g==c.T_OPERATOR&&")"!==o[h[p+1]]||u)){if(t){var _=this.config.spreadsheet.getActiveSheet().name;this._editMode&&this._editMode.pageName!==_&&(e=u?(e.includes(",")?",":":")+"'"+_+"'!"+e.substring(1):"'"+_+"'!"+e);var m=o.substring(0,d),y=m+e+o.substring(d);return this._editMode?(this.setValue(y),this.setCursor(m.length+e.length)):this.config.events.fire(s.SpreadsheetEvents.editLineInput,[y]),m.length+e.length}return d}}}return 0}this._presedEnter=!1;},t.prototype._render=function(){var e=this;return r.el(".dhx_edit_line",{},[r.el(".input__wrapper",[r.el(".input_value",{_ref:"input_wrapper"},this._colored),r.el("input.dhx_edit_line_input",{_hooks:{didInsert:function(t){e._input=t.el;},didUnmount:function(){document.removeEventListener("selectionchange",e._htmlEvents.onselectionchange);}},oninput:this._htmlEvents.oninput,onfocus:this._htmlEvents.onfocus,onblur:this._htmlEvents.onblur,onclick:this._htmlEvents.onclick,value:this._value||"",_ref:"input",disabled:this._locked}),r.el(".input-animation")])])},t.prototype._parseColors=function(e){this._removeStyles();var t=1,i=[],n=function(e,t){return i.push(r.el("span"+(t?"."+t:""),{".innerText":e}))};if(e&&"="===e[0]){for(var o=this._parse(e).code,a=0,s=function(i){var r=e.substr(a,o[i+1]-a),s=e.substr(o[i+1],o[i+2]);switch(o[i]){case c.T_SPACE:for(var u=0;u<o[i+2];u++)n("&nbsp;"),a++;break;case c.T_ARG:case c.T_RANGE:var d=l._prevStyles.find((function(e){return e&&e.cell===s}));t=9===t?1:t,o[i+1]>a&&n(r),a=o[i+1]+o[i+2],n(s,"text_range_"+(d?d.styleNum:t)),d||o[i-3]===c.T_ERROR||(l._setStyles(s,t),l._prevStyles.push({cell:s,styleNum:t}),++t);break;case c.T_DATA:case c.T_ERROR:break;case c.T_PAGE:o[i+3]!==c.T_ARG&&o[i+3]!==c.T_RANGE&&o[i+3]!==c.T_ERROR&&(o[i+1]!==a&&n(r),a=o[i+1]+o[i+2],n(s));break;default:o[i+1]>a&&n(r),a=o[i+1]+o[i+2],n(s);}},l=this,u=0;u<o.length;u+=3)s(u);a!==e.length&&n(e.substr(a,e.length-a));}else n(e);return i},t.prototype._setStyles=function(e,t){var i=this;e.includes("$")&&(e=e=e.split("$").join("")),e.includes("!")||(e="'"+(this._editMode?this._editMode.pageName:this.config.spreadsheet.getActiveSheet().name)+"'!"+e);var n=this.config.grid,o=this._parse(e).code;if(c.fromId(o[7])[2]===this._activePage.getID())if(e.includes("!")&&(e=e.substr(e.indexOf("!")+1)),-1!==e.indexOf(":"))this.config.spreadsheet.eachCell((function(e){var o=l.getCellIds(e,i._grid),r=o.row,a=o.col;n.addCellCss(""+(r+1),""+(a+1),"range_"+t);}),e);else {var r=l.getCellIds(e,this._grid),a=r.row,s=r.col;n.addCellCss(""+(a+1),""+(s+1),"range_"+t);}},t.prototype._removeStyles=function(){for(var e=this,t=function(t){if(!t)return {value:void 0};var n=i.config.grid,o=t.cell;if(o.includes("$")&&(o=o.split("$").join("")),o.includes("!")&&(o=o.substr(o.indexOf("!")+1)),o.includes(":"))i.config.spreadsheet.eachCell((function(i){var o=l.getCellIds(i,e._grid),r=o.row,a=o.col;n.removeCellCss(""+(r+1),""+(a+1),"range_"+t.styleNum);}),o);else {var r=l.getCellIds(o,i._grid),a=r.row,s=r.col;n.removeCellCss(""+(a+1),""+(s+1),"range_"+t.styleNum);}},i=this,n=0,o=this._prevStyles;n<o.length;n++){var r=t(o[n]);if("object"==typeof r)return r.value}this._prevStyles=[];},t}(a.View);t.EditLine=h;},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(8),o=i(29),r=i(31),a=function(){function e(e){this._suggestCallback=e;}return e.prototype.isVisible=function(){return this._popup&&this._popup.isVisible()},e.prototype.hide=function(){this.isVisible()&&this._popup.hide();},e.prototype.destructor=function(){this._popup&&this._popup.destructor();},e.prototype.navigate=function(e){if(!this.isVisible())return !1;var t=this._list,i=t.data.getLength();if(!i)return !1;if("arrowUp"===e||"arrowDown"===e){var n="arrowDown"===e?1:-1,o=t.data.getIndex(t.getFocus());return void 0===o&&(o=-1===n?i:-1),this._list.setFocus(t.data.getId((o+n+i)%i)),!0}var r=t.getFocusItem();if(!r){var a=this._list.data.getId(0);r=this._list.data.getItem(a);}return this._insertSuggest(r.value),!0},e.prototype.show=function(e,t,i,n,o){for(var a=o||t.selectionStart,s=i.code,l=this._getPopup(n),c=function(i){if(s[i]==r.T_NAME&&a==s[i+1]+s[i+2]){var n=e.substr(s[i+1],s[i+2]).toUpperCase();return u._list.data.filter((function(e){return e.value.startsWith(n)})),u._list.data.getLength()?(u._cursorStart=a,u._startTrim=s[i+1],l.show(t,{centering:!1})):l.hide(),{value:void 0}}},u=this,d=0;d<s.length;d+=3){var h=c(d);if("object"==typeof h)return h.value}l.hide();},e.prototype._insertSuggest=function(e){this._suggestCallback(e+"(",this._startTrim,this._cursorStart,e.length+1),this._popup.hide();},e.prototype._getPopup=function(e){var t=this;if(!this._popup){var i=Object.keys(r.methods).map((function(e){return {value:e}}));this._popup=new n.Popup({css:"dhx_suggest_list"}),this._list=new o.List(null),this._list.data.parse(i),this._list.events.on("Click",(function(e){var i=t._list.selection.getItem();t._insertSuggest(i.value),t._list.selection.remove(i.id);})),this._popup.attach(this._list);}var a=this._popup.getRootNode();return !a.style.maxHeight&&e&&(a.style.maxHeight=e+"px"),this._popup},e}();t.default=a;},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(5),o=i(2),r=i(57),a=i(10),s=i(1),l=function(){function e(e,t,i,n,o){this._spreadsheet=e,this._grid=t,this._activePage=n,this._math=o.getStore(),this._dataStore=o,this._callAction=i.bind(e),this._buffer={value:"",math:[],meta:[],styles:{},cell:"",cells:"",operation:"",inserted:!1,formats:[],html:"",spans:[]},this._setHandlers();}return e.prototype.store=function(e){var t=this,i=this._spreadsheet.selection.getFocusedCell(),n=o.getCellInfo(i,this._activePage,this._grid),r=this._spreadsheet.selection.getSelectedCell();if(this._prevCopyPage&&this._prevCopyPage.setMeta({inserted:!0}),!n.edited){var a=o.isRangeId(r),l=[r];if(a&&r.includes(",")){var c=(l=r.split(","))[l.length-1];if(r.includes(":"))if(c.includes(":")){for(var u=void 0,d=void 0,h=void 0,f=void 0,p=void 0,v=0;v<l.length;v++){var g=l[v];if(g.includes(":")&&!u&&(u=g,f={start:o.getCellIds(u.split(":")[0],this._grid),end:o.getCellIds(u.split(":")[1],this._grid)}),v){if(!g.includes(":")&&!d.includes(":"))if(f.start.row===f.end.row||f.start.col===f.end.col){var _=f.start.row===f.end.row?"row":"col",m=o.getCellIds(g,this._grid)[_];f.start[_]===m[_]&&h.push(g);}else r=c,v=l.length,h=[r];if(g.includes(":")&&g!==u){var y=o.getCellIds(g.split(":")[0],this._grid),b=o.getCellIds(g.split(":")[1],this._grid),w=y.row===f.start.row||y.row===f.end.row||y.col===f.start.col||y.col===f.end.col,x=b.row===f.start.row||b.row===f.end.row||b.col===f.start.col||b.col===f.end.col,E=w&&x,C=y.row===f.start.row?"col":"row";p||(p=C),E&&p===C?h.push(g):(r=c,v=l.length,h=[r]);}}else h=[g];d=g;}(l=h).length>1&&(r=l.join());}else l=[r=c];else l=[r=c];}if(!o.isRangeId(r)||r.includes(":")){var S,I=[];if(o.isRangeId(l[0])){var k=o.getCellIds(l[0].split(":")[0],this._grid).row,M=o.getCellIds(l[0].split(":")[1],this._grid).row,P=l[1]&&o.getCellIds(l[1].split(":")[0],this._grid).row;S=P&&(P===k||P===M);}var O=0,A=function(e){var i,n=0;O=S?0:O;var r=l[e];D._spreadsheet.eachCell((function(e,r){if(s.isDefined(r)||(r=" "),n){var a=o.getCellIds(i,t._grid),l=o.getCellIds(e,t._grid);a.row===l.row||O++,I[O]?I[O]+="\t"+r:I.push(""+r);}else I[O]?I[O]+="\t"+r:I.push(""+r);i=e,n++;}),r),O++;},D=this;for(v=0;v<l.length;v++)A(v);this._buffer.value=I.join("\n"),this._buffer.styles=this._spreadsheet.getStyle(r,!1);var F=this._activePage.getMeta().merged,V=[];if(o.isRangeId(r)){var R=[],T=o.getCellsArray(r,this._grid);this._spreadsheet.eachCell((function(e){R.push(t._spreadsheet._getMath(e));var i=o.isCellSpaned(e,F);if(i&&!V.includes(i)){var n=i.from,r=i.to,a=o.getCellNameByIndex(n.row,n.column+1,t._grid),s=o.getCellNameByIndex(r.row,r.column+1,t._grid);T.includes(a)&&T.includes(s)&&a===e&&V.push(i);}else V.push(null);}),r),this._buffer.math=R;}else {var L=this._spreadsheet._getMath(r);this._buffer.math=[L];var H=o.isCellSpaned(r,F);H&&!V.includes(H)&&V.push(H);}this._buffer.spans=V,this._buffer.cells=r,this._buffer.meta=[],this._spreadsheet.eachCell((function(e){var i=o.getCellIds(e,t._grid),n=i.row,r=i.col;t._buffer.meta.push(t._activePage.getCell(n,r)||{});}),r),this._buffer.formats=this._spreadsheet.getFormat(r),this._buffer.cell=i,this._buffer.operation=e,this._activePage.setMeta({inserted:!1}),this._prevCopyPage=this._activePage,this._grid.paint();}else this._buffer.cell=null;}},e.prototype.paste=function(){var e=this;if(this._buffer.cell){this._activePage.setMeta({inserted:!0});var t=this._buffer.cell,i=this._buffer.formats,s=t,l=!1;if(o.isRangeId(this._buffer.cells)){l=!0;var c=o.getRangeIndexes(this._buffer.cells,this._grid),u=o.getCellIndex(t,this._grid),d={row:c.end.row-c.start.row,col:c.end.col-c.start.col},h=o.getCellNameByIndex(u.row+d.row,u.col+d.col,this._grid);if(o.isRangeId(t))o.getCellsArray(this._buffer.cells,this._grid).length>o.getCellsArray(t,this._grid).length&&(s=t.split(":")[0]+":"+h);else s+=":"+h;}var f=o.isRangeId(s),p=Array.isArray(this._buffer.styles)?this._buffer.styles.map((function(e){return dhx.css.add(e)})):dhx.css.add(this._buffer.styles),v=[];"cut"===this._buffer.operation&&(v.push({cell:this._buffer.cells,action:n.Actions.setCellFormat,groupAction:f?n.Actions.groupAction:null,val:"",page:this._activePage,dataStore:this._dataStore},{cell:this._buffer.cells,action:n.Actions.setCellValue,val:"",page:this._activePage,groupAction:l?n.Actions.groupAction:null,dataStore:this._dataStore},{cell:this._buffer.cells,action:n.Actions.setCellStyle,val:"",page:this._activePage,groupAction:l?n.Actions.groupAction:null,dataStore:this._dataStore},{cell:this._buffer.cells,action:n.Actions.setValidation,val:null,page:this._activePage,groupAction:l?n.Actions.groupAction:null,dataStore:this._dataStore},{cell:this._buffer.cells,action:n.Actions.insertLink,val:null,page:this._activePage,groupAction:l?n.Actions.groupAction:null,dataStore:this._dataStore}),this._buffer.spans.forEach((function(t){if(t){var i=t.from,r=o.getCellNameByIndex(i.row,i.column+1,e._grid);v.push({action:n.Actions.unmerge,groupAction:n.Actions.groupAction,dataStore:e._dataStore,cell:r,page:e._activePage});}})),this._buffer.operation="copy");var g,_,m=l?[].concat(this._buffer.value):this._buffer.value,y=this._buffer.math,b=this._buffer.meta.map((function(e){var t;return (null===(t=e.editor)||void 0===t?void 0:t.options)||null})),w=this._buffer.meta.map((function(e){return e.link||null})),x=m.length;if(l){var E=o.getRangeIndexes(this._buffer.cells,this._grid);g=E.start,_=E.end.col-E.start.col+1;}else g=o.getCellIndex(this._buffer.cells,this._grid),_=1;var C=0,S=this._activePage.getMeta().merged;this._spreadsheet.eachCell((function(t){var i=C%x,n=m[i],r=y[i];if(r){var a=i%_,s=(i-a)/_,l=o.getCellIndex(t,e._grid);n="="+e._math.transposeMath(r.source,l.row-g.row-s,l.col-g.col-a);}m[C]=n,C++;}),s),m=m.map((function(e,t){return o.doesContainUrl(e)?(w[t]={href:e},""):e})),v.push({cell:s,action:n.Actions.setCellFormat,groupAction:f?n.Actions.groupAction:null,val:i,page:this._activePage,dataStore:this._dataStore},{cell:s,action:n.Actions.setCellStyle,val:p,page:this._activePage,groupAction:f?n.Actions.groupAction:null,dataStore:this._dataStore},{cell:s,action:n.Actions.setCellValue,val:m,page:this._activePage,groupAction:n.Actions.groupAction,dataStore:this._dataStore},{cell:s,action:n.Actions.setValidation,val:b,page:this._activePage,groupAction:n.Actions.groupAction,dataStore:this._dataStore},{cell:s,action:n.Actions.insertLink,val:w,page:this._activePage,groupAction:n.Actions.groupAction,dataStore:this._dataStore});var I=!1,k=this._spreadsheet._grid,M=0,P=o.getCellsArray(this._buffer.cell,k),O=this._spreadsheet.config,A=O.leftSplit,D=O.topSplit;if(this._spreadsheet.eachCell((function(t){var i,s=e._buffer.spans[M];if(s){var l=r.getCellsDiff(P[M],t,k),c=l.x,u=l.y,d=o.getCellNameByIndex(s.from.row+u,s.from.column+c+1,k)+":"+o.getCellNameByIndex(s.to.row+u,s.to.column+c+1,k);if(!o.checkSpanByNames(d,A,D,k))return o.showAlert(a.default.spanPasteError),void(I=!0);if(o.isCellSpaned(t,S)||!(null===(i=e._spreadsheet._spanControl)||void 0===i?void 0:i.checkBeforeMerge(d)))return;v.push({action:n.Actions.merge,groupAction:n.Actions.merge,dataStore:e._dataStore,cell:d,page:e._activePage,$autofill:!0});}M=M===P.length-1?0:++M;}),s),!I){this._spreadsheet.eachCell((function(t){var i=o.getCellIds(t,k),n=i.row,r=i.col;e._activePage.setCell(+n,+r,{$toolbarAlign:!0});}),s),this._callAction(v);var F=o.getCellIds(s,k).end,V=k.data.getLength(),R=k.config.columns.length;(V<(null==F?void 0:F.row)+1||R<=(null==F?void 0:F.col)+1)&&this._spreadsheet._updateGridSizes(),this._spreadsheet.selection.setSelectedCell(s);}}},e.prototype.getStruct=function(){return this._buffer},e.prototype._setHandlers=function(){var e=this;this._spreadsheet.events.on(n.SpreadsheetEvents.afterSheetChange,(function(){e._activePage=e._spreadsheet._activePage;}));},e}();t.BufferManager=l;},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);});Object.defineProperty(t,"__esModule",{value:!0});var r=i(13),a=i(2),s=function(e){function t(t){var i=e.call(this)||this;return i._grid=t,i}return o(t,e),t.prototype.toJsonArray=function(t){var i=this,n=e.prototype.toJsonArray.call(this,t).reduce((function(e,t,n){for(var o in t)e.push({value:t[o],cell:a.getCellNameByIndex(n,parseFloat(o),i._grid)});return e}),[]);return n},t}(r.CsvDriver);t.CustomCsvDriver=s;},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(17),o=i(3);function r(e){for(var t=e.toLowerCase().match(/\w+/g),i=0,n="",o=0;o<t.length;o++){var r=t[o];"ctrl"===r?i+=4:"shift"===r?i+=2:"alt"===r?i+=1:n=r;}return i+n}var a={Up:"arrowUp",Down:"arrowDown",Right:"arrowRight",Left:"arrowLeft",Esc:"escape",Spacebar:"space"},s=function(){function e(e){var t=this;this._keysStorage={},this._initHandler=function(e){var i;if(e.which>=48&&e.which<=57||e.which>=65&&e.which<=90)i=String.fromCharCode(e.which);else {var r=32===e.which?e.code:e.key;i=o.isIE()&&a[r]||r;}var s=t._keysStorage[(e.ctrlKey||e.metaKey?4:0)+(e.shiftKey?2:0)+(e.altKey?1:0)+(i&&i.toLowerCase())];if(s)for(var l=0;l<s.length;l++){if(t._beforeCall&&!1===t._beforeCall(e,n.focusManager.getFocusId()))return;s[l].handler(e);}},e&&(this._beforeCall=e),document.addEventListener("keydown",this._initHandler);}return e.prototype.destructor=function(){document.removeEventListener("keydown",this._initHandler),this.removeHotKey();},e.prototype.addHotKey=function(e,t){var i=r(e);this._keysStorage[i]||(this._keysStorage[i]=[]),this._keysStorage[i].push({handler:t});},e.prototype.removeHotKey=function(e,t){var i=this;if(e)if(e&&t){var n=r(e),o=function(e){return e.toString().replace(/\n/g,"").replace(/\s/g,"")};this._keysStorage[n].forEach((function(e,r){o(e.handler)===o(t)&&(delete i._keysStorage[n][r],i._keysStorage[n]=i._keysStorage[n].filter((function(e){return e})));}));}else {var a=r(e);delete this._keysStorage[a];}else this._keysStorage={};},e}();t.KeyManager=s;},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)},o=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var r=i(1),a=i(0),s=i(37),l=i(2),c=i(57),u=i(5),d=i(33),h=function(){function e(e,t,i,n){this._spreadsheet=e,this._grid=t,this._bufferManager=i,this._events=e.events,this._activePage=n,e.config.readonly||this._setHandlers();}return e.prototype.setSelectedCell=function(e){var t=this;if(e&&this._events.fire(u.SpreadsheetEvents.beforeSelectionSet,[e])){this._removeHeadersCss();var i=this._activePage.getMeta().merged,n=e.split(","),o=n.map((function(e){var n=e;if(!(null==i?void 0:i.length)||t._pressedArea&&"cell"!==t._pressedArea)return n;if(l.isRangeId(e)){var o=l.getRangeArray(e,t._grid),r=new Set;if(o.forEach((function(e){var t=l.isCellSpaned(e,i);t&&r.add(t);})),r.size){var a=l.getCellIds(o[0],t._grid),s=l.getCellIds(o[o.length-1],t._grid),c=a.row,u=a.col,d=s.row,h=s.col;Array.from(r).forEach((function(e){var t=e.from,i=e.to;t.row<c&&(c=t.row),t.column<u&&(u=t.column),i.row>d&&(d=i.row),i.column>h&&(h=i.column);})),n=l.getCellNameByIndex(c,u+1,t._grid)+":"+l.getCellNameByIndex(d,h+1,t._grid);}}else {var f=l.isCellSpaned(e,i);f&&(n=l.getCellNameByIndex(f.from.row,f.from.column+1,t._grid));}return n}));this._activePage.setMeta({selectedCells:o});var r=n[n.length-1];l.isRangeId(r)&&(r=r.split(":")[0]),this.setFocusedCell(r),this._setHeadersCss(),this._mousePressed?this._grid.paint():this._events.fire(u.SpreadsheetEvents.afterSelectionSet,[this.getSelectedCell()]);}},e.prototype.getSelectedCell=function(){var e=this._activePage.getMeta().selectedCells;if(e&&e.length)return e.join(",")},e.prototype.getFocusedCell=function(){var e=this._activePage.getMeta().focusedCell;if(e&&e.cell)return e.cell},e.prototype.setFocusedCell=function(e){if(e&&(e=e.toUpperCase(),this._events.fire(u.SpreadsheetEvents.beforeFocusSet,[e]))){var t=l.getCellIds(e,this._grid),i=t.row,n=t.col;this._activePage.setMeta({focusedCell:{row:i,col:n,cell:e,edit:!1}}),this._events.fire(u.SpreadsheetEvents.afterFocusSet,[e]);}},e.prototype.removeSelectedCell=function(e){var t=this,i=this.getSelectedCell();if(i){if(e){var n=i.split(","),o=e.split(","),r=[];o.forEach((function(e){l.isRangeId(e)?l.getCellsArray(e,t._grid).forEach((function(e){r.push(e);})):r.push(e);}));var a=[];if(n.forEach((function(e){if(l.isRangeId(e)){var i=l.getCellsArray(e,t._grid);r.forEach((function(e){var t=i.indexOf(e);t>-1&&(i[t]=null);}));var n=null;i.forEach((function(e,t){n?(e||(a.push(n+":"+i[t-1]),n=null),e&&t===i.length-1&&a.push(n+":"+i[t])):n=e;}));}else r.includes(e)||a.push(e);})),a.length)return void this.setSelectedCell(a.join(","));this._activePage.setMeta({selectedCells:null});}else this._activePage.setMeta({selectedCells:null});this._grid.paint();}},e.prototype._isInRange=function(e,t){if(!t||!e||!t.includes(":"))return !1;var i=l.getCellIndex(e,this._grid),n=i.row,o=i.col,r=l.getRangeIndexes(t,this._grid),a=r.start,s=r.end,c=function(e,t,i){return (e-t)*(e-i)<=0};return !(!a||!s)&&(c(n,a.row,s.row)&&c(o,a.col,s.col))},e.prototype._setSearchCell=function(e){if(this._searchedCells[e]){this._searchCell=this._searchedCells[e];var t=l.getCellIndex(this._searchCell,this._grid,!0),i=t.row,n=t.col;this._grid.scrollTo(i+1,n);}},e.prototype._setSearchedArray=function(e){this._searchedCells=e;},e.prototype._removeSearchCell=function(){this._searchCell=null,this._searchedCells=[],this._grid.paint();},e.prototype._removeHeadersCss=function(){var e=this;if(this.getSelectedCell()){this._prevHeaderCss.forEach((function(t){var i=l.getCellIndex(t,e._grid),n=e._grid.data.getId(i.row);void 0!==n&&e._grid.removeRowCss(n,"dhx_selected_row");var o=e._grid.config.columns[i.col];void 0!==o&&(o.header[0].css=o.header[0].css.replace(" dhx_selected_header",""));}));var t=this._activePage.getMeta().focusedCell;this._grid.data.exists(t.row)&&this._grid.removeRowCss(t.row,"dhx_selected_row");}this._filteredCells&&(this._spreadsheet.eachCell((function(t){var i=l.getCellIndex(t,e._grid),n=e._grid.data.getId(i.row);void 0!==n&&e._grid.removeRowCss(n,"dhx_filtered_row");var o=e._grid.config.columns[i.col];void 0!==o&&(o.header[0].css=o.header[0].css.replace(" dhx_filtered_header",""));}),this._filteredCells),this._filteredCells="");},e.prototype._setHeadersCss=function(){var e=this,t=this.getSelectedCell(),i=this._activePage.getMeta(),n=i.merged,o=i.filter;if(this._prevHeaderCss=[],t){var r=[];this._spreadsheet.eachCell((function(t){var i=l.getCellIndex(t,e._grid),o=e._grid.data.getId(i.row);void 0!==o&&e._grid.addRowCss(o,"dhx_selected_row");var a=l.isCellSpaned(t,n),s=t;if(a&&!r.includes(a)&&"header"!==e._pressedArea&&"index"!==e._pressedArea){var c=a.from,u=a.to;s=l.getCellNameByIndex(c.row,c.column+1,e._grid)+":"+l.getCellNameByIndex(u.row,u.column+1,e._grid),r.push(a);}l.isRangeId(s)?e._spreadsheet.eachCell((function(t){return e._setCss(t)}),s):e._setCss(s);}));}o&&(this._spreadsheet.eachCell((function(t){var i=l.getCellIndex(t,e._grid),n=e._grid.data.getId(i.row);void 0!==n&&e._grid.addRowCss(n,"dhx_filtered_row");var o=e._grid.config.columns[i.col];void 0===o||o.header[0].css.includes("dhx_filtered_header")||(o.header[0].css+=" dhx_filtered_header");}),o.cell),this._filteredCells=o.cell);},e.prototype._setCss=function(e){this._prevHeaderCss.push(e);var t=l.getCellIndex(e,this._grid),i=this._grid.data.getId(t.row);void 0!==i&&this._grid.addRowCss(i,"dhx_selected_row");var n=this._grid.config.columns[t.col];void 0===n||n.header[0].css.includes("dhx_selected_header")||(n.header[0].css+=" dhx_selected_header");},e.prototype._selectRow=function(e){var t=this._grid.config.columns[1],i=this._grid.config.columns[this._grid.config.columns.length-1];this.setSelectedCell(l.getCellNameById(this._grid,e.id,t.id)+":"+l.getCellNameById(this._grid,e.id,i.id));},e.prototype._selectColumn=function(e){var t=this._grid.data.getId(0),i=this._grid.data.getId(this._grid.data.getLength()-1),n=this._grid.data.getItem(t),o=this._grid.data.getItem(i);this.setSelectedCell(l.getCellNameById(this._grid,n.id,e.id)+":"+l.getCellNameById(this._grid,o.id,e.id));},e.prototype._setGroupSelectionHandlers=function(){var e=this;this._spreadsheet.config.readonly||(this._grid.events.on(s.GridEvents.cellMouseOver,(function(t,i){if(!l.getCellInfo(e.getFocusedCell(),e._activePage,e._grid).edited){var n=e._activePage.getMeta(),r=n.focusedCell;if(e._mousePressed){if("index"!==e._pressedArea&&"$index"===i.id)return;if("header"===e._pressedArea&&"$index"!==i.id){var a=e._grid.data.getId(e._grid.data.getLength()-1),s=e._grid.data.getItem(a);return void e.setSelectedCell(r.cell+":"+l.getCellNameById(e._grid,s.id,i.id))}var u=e._grid.config.columns[e._grid.config.columns.length-1],d=l.getCellNameById(e._grid,t.id,"index"===e._pressedArea?u.id:i.id),h=r.cell,f=o(n.selectedCells);if("fillHandle"===e._pressedArea){d=c.getLastCopyingCell(e._cellsToCopy,d,e._grid);var p=e._isInRange(d,e._cellsToCopy);(l.isRangeId(e._cellsToCopy)&&d===h||p)&&(d=e._cellsToCopy.split(":")[1]);}var v=h===d?h:h+":"+d;f[f.length-1]=v;var g=e.getFocusedCell();e.setSelectedCell(f.join(",")),e.setFocusedCell(g);}}})),this._grid.events.on(s.GridEvents.headerCellMouseOver,(function(t){if("cell"!==e._pressedArea&&e._mousePressed&&"header"===e._pressedArea&&"$index"!==t.id){var i=e._grid.data.getId(e._grid.data.getLength()-1),n=e._grid.data.getItem(i),o=e._activePage.getMeta().focusedCell;e.setSelectedCell(o.cell+":"+l.getCellNameById(e._grid,n.id,t.id.toString()));}})));},e.prototype._setHandlers=function(){var e,t,i=this;a.awaitRedraw().then((function(){e=i._grid.getRootView().node.el.getBoundingClientRect();}));var c=function(n){t&&clearTimeout(t);var o=i._grid.getScrollState();n.clientX>e.width+e.left-50&&i._grid.scroll(o.x+50,o.y),n.clientX<e.left+50&&i._grid.scroll(o.x-50,o.y),n.clientY>e.height+e.top-50&&i._grid.scroll(o.x,o.y+50),n.clientY<e.top+50&&i._grid.scroll(o.x,o.y-50),t=setTimeout((function(){c(n);}),100);};document.addEventListener("mouseup",(function(){if(i._mousePressed){i._mousePressed=!1;var e=i.getSelectedCell();"fillHandle"===i._pressedArea&&(e!==i._cellsToCopy&&i._events.fire(u.SpreadsheetEvents.groupFill,[i._cellsToCopy,e]),i._cellsToCopy=""),i._pressedArea=null,document.removeEventListener("mousemove",c),t&&clearTimeout(t),e&&i._events.fire(u.SpreadsheetEvents.afterSelectionSet,[i.getSelectedCell()]),i._grid.paint();}})),this._grid.events.on(s.GridEvents.cellMouseDown,(function(t,n,o){var r;i._mousePressed=!0,e=i._grid.getRootView().node.el.getBoundingClientRect(),setTimeout((function(){i._mousePressed&&document.addEventListener("mousemove",c);}),100);var a=i._activePage.getMeta().selectedCells;if("$index"!==n.id){i._pressedArea="cell";var s=l.getCellNameById(i._grid,t.id,n.id),d=l.getCellInfo(s,i._activePage,i._grid);if(!(3===o.which&&i._isInRange(s,a[a.length-1])||d.edited)){var h=i.getFocusedCell();if(!o.shiftKey||o.ctrlKey||o.metaKey)if(o.shiftKey&&(o.ctrlKey||o.metaKey)){a.length&&a[a.length-1]===h&&a.pop();var f=i.getSelectedCell();i.setSelectedCell((f?f+",":"")+h+":"+s);}else if(!o.ctrlKey&&!o.metaKey||o.shiftKey)i.setSelectedCell(s);else {if(!(f=i.getSelectedCell()))return;if(f&&!l.getCellsArray(f,i._grid).includes(s))return i.setSelectedCell(f+","+s);for(var p=f.split(","),v=0;v<p.length;v++){var g=p[v];l.isRangeId(g)||g!==s||i.setSelectedCell(p.filter((function(e){return e!==s})).join(","));}}else i.setSelectedCell(h+":"+l.getCellNameById(i._grid,t.id,n.id));}}else {var _=o.target.getAttribute("data-dhx-id");if(o.shiftKey){var m=i.getSelectedCell(),y=[];l.isRangeId(m)&&(y=m.split(":"));var b=l.getCellIds(y[0]||m,i._grid),w=i._grid.config.columns,x=l.getCellNameById(i._grid,t.id,w[w.length-1].id),E=l.getCellNameById(i._grid,b.row+1,1);return void i.setSelectedCell(E+":"+x)}if(_){document.removeEventListener("mousemove",c),i._mousePressed=!1;var C=null===(r=i.getSelectedCell())||void 0===r?void 0:r.split(":"),S=C&&l.getCellIds(C[0],i._grid),I=C&&l.getCellIds(C[1],i._grid);if(!C||0!==S.col||I.col+2!==i._grid.config.columns.length||+_!==S.row&&+_!==I.row){var k=l.getCellNameById(i._grid,+_+1,1);i._resizedRows=[k,k];}else i._resizedRows=C;i._spreadsheet._callAction({cell:i._resizedRows.join(":"),action:u.Actions.resizeRow,groupAction:u.Actions.resizeRow,mouseEvent:o});}else i._pressedArea="index",i._selectRow(t),i._mousePressed=!0;}})),this._grid.events.on(s.GridEvents.headerCellMouseDown,(function(e,t){var n,o=t.target.getAttribute("data-dhx-id");if(t.shiftKey){var r=i.getSelectedCell(),a=[];l.isRangeId(r)&&(a=r.split(":"));var s=l.getCellIds(a[0]||r,i._grid),c=l.getCellNameById(i._grid,i._grid.data.getId(0),s.col+1),d=l.getCellNameById(i._grid,i._grid.data.getLength(),e.id);i.setSelectedCell(c+":"+d);}else {var h=t.target.className.includes("dhx_header_icon");if(h)return i._pressedArea="header",void i._selectColumn(e);if(!o||h)i._pressedArea="header",i._selectColumn(e),i._mousePressed=!0;else {if("$index"===o){var f=l.getCellNameByIndex(0,1,i._grid),p=l.getCellNameByIndex(i._grid.data.getLength()-1,i._grid.config.columns.length-1,i._grid);return void i.setSelectedCell(f+":"+p)}var v=(r=null===(n=i.getSelectedCell())||void 0===n?void 0:n.split(":"))&&l.getCellIds(r[0],i._grid),g=r&&l.getCellIds(r[1],i._grid);if(!r||0!==v.row||g.row+1!==i._grid.data.getLength()||+o!==v.col+1&&+o!==g.col+1){s=l.getCellNameByIndex(0,+o,i._grid);i._resizedColumns=[s,s];}else i._resizedColumns=r;i._spreadsheet._callAction({cell:i._resizedColumns.join(":"),action:u.Actions.resizeCol,groupAction:u.Actions.resizeCol,mouseEvent:t});}}})),this._setGroupSelectionHandlers(),this._grid.events.on(s.GridEvents.cellDblClick,(function(e,t,n){n.ctrlKey||n.metaKey?i._grid.events.fire(s.GridEvents.cellClick,[e,t,n]):"$index"!==t.id&&i._spreadsheet.startEdit(l.getCellNameById(i._grid,e.id,t.id));})),this._grid.events.on(s.GridEvents.headerCellDblClick,(function(e,t){var n=t.target.getAttribute("data-dhx-id");if("$index"!==n&&n){var o=l.getCellNameByIndex(0,+e.id,i._grid);i._spreadsheet.fitColumn(o);}})),this._spreadsheet.events.on(u.SpreadsheetEvents.afterSheetChange,(function(){i._removeHeadersCss(),i._activePage=i._spreadsheet._activePage;var e=i._activePage.getMeta();i.setSelectedCell(e.selectedCells?e.selectedCells.join(","):null),i.setFocusedCell(e.focusedCell?e.focusedCell.cell:null);})),this._events.on(u.SpreadsheetEvents.afterAction,(function(e){e===u.Actions.resizeRow&&(i._resizedRows=null,i._grid.paint()),e===u.Actions.resizeCol&&(i._resizedColumns=null,i._grid.paint());})),this._events.on(u.SpreadsheetEvents.gridRedraw,(function(e){var t,s=i._activePage.getMeta(),u=s.selectedCells,h=s.focusedCell,f=s.merged,p=void 0===f?[]:f,v=s.filter,g=s.inserted,_=null==h?void 0:h.cell;if(u&&(_||(null===(t=i._searchedCells)||void 0===t?void 0:t.length))){var m,y=function(e){var t=i._grid.data.getItem(i._grid.data.getId(e.row));return t?{x:i._grid.config.columns.slice(0,e.col).reduce((function(e,t){return e+t.$width}),0),y:e.row?i._grid.data.mapRange(0,e.row-1,(function(e){return e})).reduce((function(e,t){return e+(t.height||t.$height)}),0)-1:0,width:(i._grid.config.columns[e.col]?i._grid.config.columns[e.col].$width:0)+1,height:(t.height||t.$height)+1}:{x:0,y:0,width:0,height:0}},b=function(e){var t=y(e.start),i=y(e.end);return {x:t.x,y:t.y,width:i.x-t.x+(i.width||0),height:i.y-t.y+i.height}},w=i._spreadsheet.config,x=w.leftSplit,E=void 0===x?0:x,C=w.topSplit,S=void 0===C?0:C,I=i._grid.getScrollState(),k=y({row:S,col:E}),M=function(e){void 0===e&&(e="A1");var t=l.getCellIds(e,i._grid),n=(t.col,t.row,l.isCellFixed(e,E,S,i._grid)),o=n.isLeftFixed,r=n.isTopFixed,a=l.isCellSpaned(e,p);if(a){var s=a.from,c=s.row,u=s.column;e=l.getCellNameByIndex(c,u+1,i._grid);}var h=y(l.getCellIndex(e,i._grid)),f=h.x,v=h.y,g=h.width,_=void 0===g?0:g,m=h.height,w=k.x+I.x+(k.width||0),x=k.y+I.y,C=o?_:null,M=r?m:null,P=Math.abs(f-w<0&&!o?f-w:0),O=Math.abs(v-x<0&&!r?v-x:0),A=o?f+I.x:f,D=r?v+I.y:v;if(a){var F=a,V=F.to,R=F.from,T=y({row:V.row,col:+V.column+1}),L=R.row!==V.row?T.y-D+T.height-m:0;_+=R.column!==V.column?T.x-A+T.width-_:0,m+=L;var H=b({start:{row:R.row,col:R.column+1},end:{row:V.row,col:V.column+1}});o&&(C=H.width),r&&(M=H.height);}var N=_-P,j=m-O;return {width:C&&C>N?C:N,height:M&&M>j?M:j,top:D+O,left:A+P,borderLeft:!o&&_>N+d.BORDERS?"none":null,borderRight:!o&&N<=0?"none":null,borderTop:!r&&m>j?"none":null,borderBottom:!r&&j<=0?"none":null,position:"absolute",pointerEvents:"none",zIndex:12,minWidth:C,minHeight:M}},P=function(e){var t=l.getRangeIndexes(e,i._grid),n=b(t),o=n.x,r=n.y,a=n.width,s=n.height,c=t.start,u=t.end,d=c.col<=E,h=c.row<S;if(d||h){var f=k.x+I.x+k.width,p=k.y+I.y,v=b({start:{row:c.row,col:c.col},end:{row:S&&u.row>=S?S-1:u.row,col:E&&u.col>E?E:u.col}}),g=d?v.width:null,_=h?v.height:null,m=d?o+I.x:o,y=h?r+I.y:r,w=Math.abs(o-f<0&&!d?o-f:0),x=Math.abs(r-p<0&&!h?r-p:0),C=a-w,M=s-x;return d&&(C-=I.x),h&&(M-=I.y),{top:y+x,left:m+w,width:C,minWidth:g,height:M,borderLeft:!d&&a>C?"none":null,borderRight:!d&&C<=0?"none":null,borderTop:!h&&s>M?"none":null,borderBottom:!h&&M<=0?"none":null,minHeight:_,zIndex:12}}return {top:r,left:o,width:a,height:s,zIndex:10}},O=u.map((function(e){return l.isRangeId(e)?a.el(".dhx_group_selection",{style:P(e)}):1!==u.length?a.el(".dhx_group_selection",{style:M(e)}):void 0})),A=u[u.length-1],D=a.el(".dhx_selected_cell",{style:M(_||A)});i._searchCell&&(m=i._searchedCells.map((function(e){return a.el(".dhx_search_group"+(e===i._searchCell?".dhx_search_cell":""),{style:M(e)})})));var F,V,R,T=[],L=i._bufferManager.getStruct();if(L.cell&&void 0!==g&&!g)T=(L.cells.includes(",")?L.cells.split(","):[L.cells]).map((function(e){var t=l.isRangeId(e)?P(e):M(e),i=t.width,o=t.left,r=t.height,s=t.top;return a.el(".dhx_copy_selection",{style:n(n({},t),{width:i+2,left:o-1,height:r+2,top:s-1})})}));if(i._resizedColumns){var H=l.getCellIds(i._resizedColumns[1],i._grid),N=r.findIndex(i._grid.config.columns,(function(e){return e.id==H.col+1})),j=y({row:0,col:N}),$=i._grid.config.$totalHeight;F=a.el(".resize_line",{style:{top:j.y,left:j.x+j.width-1.5,height:$}});}if(i._resizedRows){var z=l.getCellIndex(i._resizedRows[1],i._grid);j=y({row:z.row,col:0});F=a.el(".resize_line",{style:{top:j.y+j.height-2,left:0,width:i._grid.config.$totalWidth,height:"2px"}});}if(l.isRangeId(A)){var B=l.getRangeArray(A,i._grid);A=B[B.length-1];}if(v){var W=l.getCellsArray(v.cell,i._grid).reverse(),U=W.find((function(e){return !i._grid.isRowHidden(l.getCellIds(e,i._grid).row+1)}));V=a.el(".dhx_filtered_cells",{style:P(W[W.length-1]+":"+U)});}if(!l.getCellInfo(i.getFocusedCell(),i._activePage,i._grid).edited){var G=M(l.isRangeId(i.getSelectedCell())?A:_),q=G.top,Y=G.left,X=G.width,K=G.height,J=G.minWidth;q+=(G.minHeight||K)-6,Y+=(J||X)-6;var Z=l.isCellFixed(A,E,S,i._grid),Q=Z.isLeftFixed,ee=Z.isTopFixed;R=a.el(".dhx_selection_grip",{"data-dhx-id":"selection_grip",style:{position:"absolute",left:Y,top:q,zIndex:!ee&&!Q||ee&&X<=0||Q&&K<=0?10:12},onmousedown:function(){i._mousePressed=!0,document.addEventListener("mousemove",c),i._pressedArea="fillHandle";var e=i.getSelectedCell().split(","),t=e[e.length-1];i.setSelectedCell(t);var n=l.getCellsArray(t,i._grid),o=l.isCellSpaned(n[n.length-1],p);if(i._cellsToCopy=t,o){var r=o.to,a=l.getCellNameByIndex(r.row,r.column+1,i._grid);i._cellsToCopy=n[0]+":"+a;}}});}e.refs.selection.patch(a.el(".dhx_grid_selection",o(T,[D],O,[m,F,V,R])));}}));},e}();t.Selection=h;},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=i(0),r=i(39),a=i(8),s=i(26),l=i(12),c=i(5),u=i(18),d=function(){function e(e,t,i){var n=this;this._dateFormat=t,this._calendar=new r.Calendar(null,{dateFormat:t}),this._popup=new a.Popup({css:"dhx_editor-popup"}),this._popup.attach(this._calendar),this._events=i,this._endEdit=e,this._popup.events.on(a.PopupEvents.afterShow,(function(){n._calendar.getRootNode().querySelector(".dhx_calendar__days").addEventListener("click",n.endEdit.bind(n),{once:!0});})),this._initHandlers();}return e.prototype.endEdit=function(){var e=this;this.edit&&(o.awaitRedraw().then((function(){e._events.fire(c.SpreadsheetEvents.cellInput,[e._config.oninput[1],e._calendar.getValue()]),e._endEdit(),e._popup.hide();})),this.edit=!1);},e.prototype.setValue=function(e){var t;if(l.isNumeric(e))t=s.excelDateToJSDate(e);else {if(!u.stringToDate(e,this._dateFormat,!0))return;t=u.stringToDate(e,this._dateFormat);}this._calendar.setValue(t);},e.prototype.hidePopup=function(){this._popup.isVisible()&&this._popup.hide();},e.prototype.toHTML=function(e){var t=this;return this._config=e,this.setValue(e.value),this.edit=!0,document.addEventListener("mousedown",this._handlers.onOuterClick),o.el("input.dhx_cell_input",n(n({},e),{onkeydown:function(e){"Enter"===e.code&&t._popup.hide();},oninput:this._handlers.oninput,_hooks:n(n({},e._hooks),{didInsert:this._handlers.didInsert})}))},e.prototype._showPopup=function(){this._input.value.startsWith("=")||this._popup.show(this._input,{centering:!0,mode:"bottom"});},e.prototype._initHandlers=function(){var e=this;this._handlers={onFocus:function(){o.awaitRedraw().then((function(){e._showPopup();}));},onOuterClick:function(t){if(t.target instanceof Node){var i=e._input&&e._input.contains(t.target),n=e._popup&&e._popup.getRootNode()&&e._popup.getRootNode().contains(t.target);i||n||e._popup.hide();}},oninput:function(t){t.target.value||e._showPopup(),t.target.value.startsWith("=")&&e._popup.isVisible()&&e._popup.hide();var i=e._config.oninput;(0, i[0])(i[1],t);},didInsert:function(t){var i=t.el;e._input=i,e._input.addEventListener("focus",e._handlers.onFocus),e._config._hooks.didInsert(t);}};},e}();t.DateEditor=d;},function(e,t,i){(function(e){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)},o=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var r=i(1),a=i(12),s=i(2),l=function(){function t(e,t){this._spreadsheet=e,this._grid=t;}return t.prototype.xlsx=function(){var e=this;if(!s.isWasmSupported())throw new Error("WebAssembly is not supported by your browser");var t=[{id:""}],i=this._spreadsheet.serialize(),l=a.getDefaultFormats(),c=[];i.sheets.forEach((function(i){for(var a=e._spreadsheet._dataStore.getPage(i.name),u=a.getSize(),d=a.getMeta().merged,h=[],f=[],p=0;p<u[1];p++)h.push(null);for(p=0;p<u[0];p++)f.push(o(h));i.data.forEach((function(i){var o=null,a=s.getCellIds(i.cell,e._grid),c=a.row,u=a.col,d=l.find((function(e){return e.id===i.format})),h=d?d.mask:"",p=i.css||"",v=h+p;if(-1===(o=r.findIndex(t,(function(e){return e.id===v})))){var g={"text-align":"align","font-size":"fontSize","font-weight":"fontWeight","font-style":"fontStyle","text-decoration":"textDecoration","vertical-align":"verticalAlign"},_=dhx.css.get(p)||{},m=Object.keys(_).reduce((function(e,t){return e[g[t]||t]=_[t],e}),{});t.push(n(n({format:h},m),{id:v})),o=t.length-1;}var y={v:r.isDefined(i.value)?""+i.value:"",s:o};f[c][u]=y;})),c.push({name:i.name,cells:f,cols:i.cols,rows:i.rows,merged:d});}));var u={data:c,styles:t},d=this._spreadsheet.config.exportModulePath;this._getXlsxWorker(d).then((function(e){return e.postMessage({type:"convert",data:u})}));},t.prototype.json=function(){return r.downloadFile(JSON.stringify(this._spreadsheet.serialize()),"data.json","text/json")},t.prototype._getXlsxWorker=function(t){if(!this._xlsxWorker){var i=window.URL.createObjectURL(new Blob(["importScripts('"+t+"');"],{type:"text/javascript"}));this._xlsxWorker=new e((function(e){var t=new Worker(i);t.addEventListener("message",(function(i){if("init"===i.data.type)e(t);else if("ready"===i.data.type){var n=document.createElement("a");n.href=URL.createObjectURL(i.data.blob),n.download="data.xlsx",document.body.appendChild(n),n.click(),document.body.removeChild(n);}}));}));}return this._xlsxWorker},t}();t.Exporter=l;}).call(this,i(14));},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(2),o=function(){function e(){}return e.prototype.toJsonArray=function(e,t){var i=[],o=[],r={};return e.styles.forEach((function(e,t){var i=["background","color","textAlign","verticalAlign","textDecoration","fontWeight","fontStyle"].reduce((function(t,i){return e[i]&&(t[i]=e[i]),t}),{});o.push(e.format),r["imported_class"+t]=i;})),e.data.forEach((function(e){var r=[];e.cells.forEach((function(e,i){e.forEach((function(e,a){if(e){var s={cell:n.getCellNameByIndex(i,a+1,t),value:e.v,css:["imported_class"+e.s],format:o[e.s]};r.push(s);}}));})),i.push({name:e.name,data:r,cols:e.cols,rows:e.rows,merged:e.merged});})),{sheets:i,styles:r}},e}();t.XlsxDriver=o;},function(e,t,i){(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=i(2),o=function(){function t(e){this._spreadsheet=e;}return t.prototype.load=function(t,i){var n=this;return void 0===t&&(t="xlsx"),new e((function(e){n._getFile(t,i).then((function(i){if("json"===t)return e(i);i instanceof ArrayBuffer&&(i=new Uint8Array(i));var o=n._spreadsheet.config.importModulePath;n._getXlsxWorker(o).then((function(t){t.postMessage({type:"convert",data:i,formulas:!0}),t.onmessage=function(t){"ready"===t.data.type&&e(t.data);};}));}));}))},t.prototype._getXlsxWorker=function(t){if(!this._xlsxWorker){var i=window.URL.createObjectURL(new Blob(["importScripts('"+t+"');"],{type:"text/javascript"}));this._xlsxWorker=new e((function(e){var t=new Worker(i);t.addEventListener("message",(function(i){"init"===i.data.type&&e(t);}));}));}return this._xlsxWorker},t.prototype._getFile=function(t,i){return void 0===t&&(t="xlsx"),new e((function(e){if(i)return n.fetchFile(i,"GET","arraybuffer").then((function(t){e(t);}));var o=document.createElement("input");o.type="file",o.accept="."+t,o.click(),o.addEventListener("change",(function(i){var n=new FileReader;n.onload=function(){var i=n.result;e("json"===t?i:new Uint8Array(i));},"json"===t?n.readAsText(i.target.files[0]):n.readAsArrayBuffer(i.target.files[0]);}));}))},t}();t.FileProxy=o;}).call(this,i(14));},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(31);t.Store=n.Store,t.initMathStore=function(e){var t=new n.DataStore({strict:!1});return e.forEach((function(e){return t.addPage(e.value)})),t};},function(e,t,i){(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.detectDrag=function(t){return new e((function(e){var i=function(){document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",i),e(!1);},n=setTimeout((function(){i();}),1e3),o=function(r){(Math.abs(r.pageX-t.pageX)>4||Math.abs(r.pageY-t.pageY)>4)&&(document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",i),clearTimeout(n),e({x:t.pageX,y:t.pageY}));};document.addEventListener("mousemove",o),document.addEventListener("mouseup",i);}))};}).call(this,i(14));},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.default={popups:{},lastActive:null,freeCount:0,add:function(e,t){this.lastActive&&this.popups[this.lastActive].classList.remove("dhx_popup--window_active"),this.lastActive=e,t.classList.add("dhx_popup--window_active"),this.popups[e]=t;},setActive:function(e){if(e!==this.lastActive){var t=this.popups[e];t&&(this.lastActive&&this.popups[this.lastActive].classList.remove("dhx_popup--window_active"),this.lastActive=e,t.classList.add("dhx_popup--window_active"));}},openFreeWindow:function(e){0===this.freeCount&&e.classList.add("dhx_window--no-scroll"),this.freeCount++;},closeFreeWindow:function(e){this.freeCount--,0===this.freeCount&&e.classList.remove("dhx_window--no-scroll");}};},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);});Object.defineProperty(t,"__esModule",{value:!0});var r=i(88),a=i(30),s=i(15),l=i(22),c=i(45),u=function(e){function t(t){return e.call(this,t)||this}return o(t,e),t.prototype._startResize=function(e){var t,i,n=this,o=100|this.config.minWidth,r=100|this.config.minHeight,a=this._popup.offsetLeft,s=this._popup.offsetTop,l=this._popup.offsetWidth,u=this._popup.offsetHeight,d=this.getRootView().refs;switch(!0){case e.bottom&&e.left:i="dhx_window-body-pointer--bottom_left",t=d.bottomLeft;break;case e.bottom&&e.right:i="dhx_window-body-pointer--bottom_right",t=d.bottomLeft;break;case e.top&&e.left:i="dhx_window-body-pointer--top_left",t=d.bottomLeft;break;case e.top&&e.right:i="dhx_window-body-pointer--top-right",t=d.right;break;case e.top:i="dhx_window-body-pointer--top",t=d.bottomLeft;break;case e.bottom:i="dhx_window-body-pointer--bottom",t=d.bottomLeft;break;case e.left:i="dhx_window-body-pointer--left",t=d.bottomLeft;break;case e.right:i="dhx_window-body-pointer--right",t=d.right;}t.el.classList.add("dhx_window-resizer--active"),this.config.node.classList.add("dhx_window--stop_selection"),this.config.node.classList.add(i);var h=function(t){var i=n._getContainerParams(),d=i.containerInnerWidth,h=i.containerInnerHeight,f=i.containerXOffset,p=i.containerYOffset,v={width:n._notInNode()?t.pageX-a:t.pageX-n.config.node.offsetLeft-a,height:n._notInNode()?t.pageY-s:t.pageY-n.config.node.offsetTop-s,left:n._notInNode()?t.pageX:t.pageX-n.config.node.offsetLeft,top:n._notInNode()?t.pageY:t.pageY-n.config.node.offsetTop};e.right&&(v.width<o?v.width=o:v.width>f+d-a&&(v.width=f+d-a),n._popup.style.width=v.width+"px"),e.bottom&&(v.height<r?v.height=r:v.height>p+h-s&&(v.height=p+h-s),n._popup.style.height=v.height+"px"),e.left&&(a+l-v.left<o&&(v.left=a+l-o),v.width=a+l-v.left,n.config.left=v.left,n._popup.style.left=v.left+"px",n._popup.style.width=v.width+"px"),e.top&&(v.top<p?v.top=p:s+u-v.top<r&&(v.top=s+u-r),v.height=s+u-v.top,n.config.top=v.top,n._popup.style.top=v.top+"px",n._popup.style.height=v.height+"px"),n.config.width=n._popup.offsetWidth,n.config.height=n._popup.offsetHeight,n.events.fire(c.WindowEvents.resize,[v,{left:a,top:s,height:u,width:l},e]),n.scrollView&&n.scrollView.update();},f=function(){document.removeEventListener("mouseup",f),document.removeEventListener("mousemove",h),n.config.node.classList.remove("dhx_window--stop_selection"),n.config.node.classList.remove(i),t.el.classList.remove("dhx_window-resizer--active");};document.addEventListener("mouseup",f),document.addEventListener("mousemove",h);},t.prototype._initUI=function(){var e=this,t=[],i=(this.config.header||this.config.title||this.config.closable||this.config.movable)&&!1!==this.config.header;i&&t.push({id:"header",height:"content",css:"dhx_window-header "+(this.config.movable?"dhx_window-header--movable":""),on:{mousedown:this.config.movable&&this._handlers.move,dblclick:this._handlers.headerDblClick}}),t.push({id:"content",css:i?"dhx_window-content":"dhx_window-content-without-header"}),this.config.footer&&t.push({id:"footer",height:"content",css:"dhx_window-footer"}),this.config.resizable&&t.push({id:"resizers",height:"content",css:"resizers"});var n=this._layout=new s.ProLayout(this._popup,{css:"dhx_window"+(this.config.modal?" dhx_window--modal":""),rows:t,on:{mousedown:this._handlers.setActive},id:this._uid}),o=this._layout.getCell("content");if(o&&o.scrollView&&(this.scrollView=o.scrollView),i){var r=this.header=new a.Toolbar;this.config.title&&(this.header.data.add({type:"title",value:this.config.title,id:"title",css:"title_max"}),this._popup.setAttribute("aria-label",this.config.title)),this.config.closable&&(this.header.data.add({type:"spacer"}),this.header.data.add({id:"close",type:"button",view:"link",size:"medium",color:"secondary",circle:!0,icon:"dxi dxi-close"}),r.events.on(l.NavigationBarEvents.click,(function(t,i){"close"===t&&e._hide(i);}))),n.getCell("header").attach(r);}if(this.config.footer){var c=this.footer=new a.Toolbar;n.getCell("footer").attach(c);}this.config.resizable&&n.getCell("resizers").attach((function(){return e._drawResizers()}));},t}(r.Window);t.ProWindow=u;},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=i(5),r=i(2),a=i(44),s=i(17),l=i(31),c=i(1),u=i(12);function d(e){if(e.ctrlKey||e.altKey||e.metaKey||e.shiftKey&&32===e.keyCode)return !1;var t=e.which||e.keyCode;return t>=65&&t<=90||t>=48&&t<=57||t>=96&&t<=105||!!{32:" ",106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"}[t]||!1}function h(e){var t,i=e.selection.getSelectedCell(),n=e._activePage.getMeta().merged;if(i.includes(",")){var o=i.split(",");i=o[o.length-1];}var a=(t=r.isRangeId(i)?r.getRangeMatrix(i,e._grid):[[i]]).reduce((function(t,i){var o=i.reduce((function(t,i){var o=l.str2pos(i),a=o[0],s=o[1],u=n.find((function(e){var t=e.from;return t.row===a&&t.column===s})),d=1,h=1;if(u&&(d+=u.to.row-u.from.row,h+=u.to.column-u.from.column),r.isCellSpaned(i,n)&&!u)return t;var f=e.getValue(i),p=c.isDefined(f)?f:" ",v=e.getStyle(i,!1)||{},g=Object.keys(v).reduce((function(e,t){return ""+e+t+":"+v[t]+";"}),"");return t+' <td style="'+g+'" rowSpan="'+d+'" colSpan="'+h+'">\n\t\t\t'+p+"</td>"}),"");return t+'<tr style="box-sizing: inherit;">'+o+"</tr>"}),"");return '\n\t\x3c!--StartFragment--\x3e\n\t\t<table id="customers">\n\t\t<col span="'+t[0].length+'">\n\t\t\t<tbody style="box-sizing: inherit;">\n\t\t\t\t'+a+"\n\t\t\t</tbody>\n\t\t</table>\n\t\x3c!--EndFragment--\x3e"}function f(e,t){return "row"===t?{min:0,max:e.data.getLength()-1}:{min:1,max:e.config.columns.length-1}}function p(e,t,i,o,a,s){var l=e.selection.getFocusedCell();if(!r.getCellInfo(l,o,t).edited){var c=r.getCellIndex(l,t),u=f(t,s),d=a?c[s]+a:i;d>=u.min&&d<=u.max&&(c[s]=d);var h=r.getCellNameByIndex(c.row,c.col,t),p=o.getMeta().merged;if(null==p?void 0:p.length){var v=r.isCellSpaned(h,p);if(v){var g=r.isCellSpaned(l,p),_="col"===s?"column":"row",m={from:n({},v.from),to:n({},v.to)};if(m.from.column+=1,m.to.column+=1,v===g){var y=a>0?m.to[_]+1:m.from[_]-1;y>=u.min&&y<=u.max&&(c[s]=y),h=r.getCellNameByIndex(c.row,c.col,t);}else {var b="row"===_?m.from.row:c.row,w="column"===_?m.from.column:c.col;h=r.getCellNameByIndex(b,w,t);}}}e.selection.setSelectedCell(h);var x=r.getCellIds(h,t);t.scrollTo(""+(x.row+1),""+(x.col+1));}}function v(e,t,i,o,a){var s=e.selection.getFocusedCell();if(!r.getCellInfo(s,a,t).edited){var l,c,u=r.getCellIndex(s,t),d=e.selection.getSelectedCell().split(",")[0];if(d.includes(":")){var h=r.getRangeIndexes(d,t);h.end[o]>u[o]?(l=n({},h.end),c=h.start):(l=n({},h.start),c=h.end);}else l=n({},u),c=u;var p=f(t,o);if(l[o]+i>=p.min&&l[o]+i<=p.max){l[o]+=i;var v=r.getCellNameByIndex(l.row,l.col,t);if(v===(c=r.getCellNameByIndex(c.row,c.col,t)))return void e.selection.setSelectedCell(v);e.selection.setSelectedCell(v+":"+c),e.selection.setFocusedCell(s);}}}t.isPrintableKey=d,t.getHtmlData=h,t.getKeysHandlers=function(e,t,i,f){var g,_;e.events.on(o.SpreadsheetEvents.afterEditStart,(function(e){g=e;})),e.events.on(o.SpreadsheetEvents.afterEditEnd,(function(){g=null;})),e.events.on(o.SpreadsheetEvents.afterSheetChange,(function(){return _=e._activePage})),document.addEventListener("keydown",(function(i){if(d(i)&&(s.focusManager.getFocusId()===e._uid||s.focusManager.getFocusId()===t._uid)){var n=e.selection.getFocusedCell();n&&n!==g&&(i.preventDefault(),e.startEdit(n,i.key));}}));var m=function(n,o){var a,s=i.getStruct(),d=e.selection.getSelectedCell(),h=r.getCellIndex(d,t),f=r.getCellNameByIndex(h.row+n.rowsCount-1,h.col+n.colsCount-1,t),p=r.isRangeId(d)?d:d+":"+f,v=l.str2pos(d),g=v[0],_=v[1],m=null===(a=n.spans)||void 0===a?void 0:a.map((function(e){if(!e)return null;var t=e.from,i=e.to;return {from:{row:t.row+g,column:t.column+_},to:{row:i.row+g,column:i.column+_}}}));if(n.styles?s.styles=n.styles:s.styles=e.getStyle(p,!1),c.isDefined(o)&&(!o.includes(s.html)||!s.html)&&(s.cells="",n.formats.length)){for(var y=e.config.formats,b=[],w=function(t){var i=null==y?void 0:y.find((function(e){return e.mask===t}));i||(i=u.addNewFormat(t,e.toolbar.data,y)),b.push(null==i?void 0:i.id);},x=0,E=n.formats;x<E.length;x++){w(E[x]);}s.formats=b;}var C=s.value;s.value=n.values.map((function(e){return c.isNumeric(e)?+e:e})),s.cell=p,s.spans=m||[],i.paste(),s.value=C;},y={};function b(i){i.preventDefault();var n=e.selection.getSelectedCell(),o=a.getToggledValue(_,n,"text-decoration","line-through",t);e.setStyle(e.selection.getSelectedCell(),{"text-decoration":o});}function w(t,i){i.preventDefault(),e.setStyle(e.selection.getSelectedCell(),{"text-align":t});}function x(t,i){i.preventDefault();var n=e._sheets,o=e.getActiveSheet().id,r=n.getIndex(o),a=n.getLength()-1,s=r+t,l="add-sheet"===n.getId(0)?1:0;s<l&&(s=a),s>a&&(s=l),e.setActiveSheet(n.getId(s));}function E(i,n){n.preventDefault();var o=e.selection.getFocusedCell(),a=r.getCellIds(o,t),s=a.row,l=a.col,c=r.getCellNameById(t,i?t.data.getLength():s+1,i?l+1:t.config.columns.length-1),u=r.getCellNameById(t,i?1:s+1,i?l+1:1);e.selection.setSelectedCell(u+":"+c),e.selection.setFocusedCell(o);}return window.clipboardData?y={"ctrl+c":function(){if(!g&&(i.store("copy"),window.clipboardData)){var t=h(e);window.clipboardData.setData("text/html",t),window.clipboardData.setData("text/plain",i.getStruct().value),window.preventDefault(),i.getStruct().html=t;}},"ctrl+x":function(){g||(i.store("cut"),window.clipboardData&&(window.clipboardData.setData("text/html",h(e)),window.clipboardData.setData("text/plain",i.getStruct().value),window.preventDefault(),i.getStruct().html=window.clipboardData.getData("text/html")));},"ctrl+v":function(){if(!g&&window.clipboardData){var e=r.parseFromText(window.clipboardData.getData("text")),t=window.clipboardData.getData("text/html");t&&t.includes("<table")&&(e=r.parseHtmlTable(t)),m(e,t||"");}}}:(document.addEventListener("cut",(function(n){g||s.focusManager.getFocusId()!==e._uid&&s.focusManager.getFocusId()!==t._uid||(i.store("cut"),n.clipboardData.setData("text/html",h(e)),n.clipboardData.setData("text/plain",i.getStruct().value),n.preventDefault(),i.getStruct().html=n.clipboardData.getData("text/html"));})),document.addEventListener("copy",(function(n){if(!g&&(s.focusManager.getFocusId()===e._uid||s.focusManager.getFocusId()===t._uid)){i.store("copy");var o=h(e);n.clipboardData.setData("text/html",o),n.clipboardData.setData("text/plain",i.getStruct().value),n.preventDefault(),i.getStruct().html=o;}})),document.addEventListener("paste",(function(i){if(!g&&(s.focusManager.getFocusId()===e._uid||s.focusManager.getFocusId()===t._uid)){i.preventDefault();var n=i.clipboardData.getData("text/html"),o=r.parseFromText(i.clipboardData.getData("text"));n&&n.includes("<table")&&(o=r.parseHtmlTable(n)),m(o,n||"");}}))),n(n({},y),{escape:function(){var n=e.selection.getSelectedCell(),o=r.getCellInfo(n,_,t);i.getStruct().inserted=!0,o.edited&&(e.endEdit(!0),t.paint());},delete:function(){if(!g){var i=e.selection.getSelectedCell();i&&e.setValue(i,""),t.paint();}},enter:function(){var i=e.selection.getSelectedCell(),n=e.selection.getFocusedCell(),o=e._editMode;if(!f.navigate("enter"))if(g||o&&o.cell){var a=r.getCellIndex(g||o.cell,t);a.row=a.row+1===t.data.getLength()?a.row:a.row+1,e.selection.setSelectedCell(r.getCellNameByIndex(a.row,a.col,t)),g="",r.isRangeId(i)&&!o&&(e.selection.setSelectedCell(i),e.selection.setFocusedCell(r.getNextRangeCell(i,n,t,"col")));}else {if(r.isRangeId(i))return e.endEdit(),e.selection.setSelectedCell(i),void e.selection.setFocusedCell(r.getNextRangeCell(i,n,t,"col"));e.startEdit(i);}},f2:function(){e.startEdit(e.selection.getSelectedCell());},pageUp:function(e){e.preventDefault();var i=t.getRootView().refs.grid_body;i.el.scrollTop-=i.el.clientHeight;},pageDown:function(e){e.preventDefault();var i=t.getRootView().refs.grid_body;i.el.scrollTop+=i.el.clientHeight-t.config.rowHeight;},"ctrl+a":function(i){if(!g){i.preventDefault();var n=r.getCellNameByIndex(0,1,t),o=r.getCellNameByIndex(t.data.getLength()-1,t.config.columns.length-1,t);e.selection.setSelectedCell(n+":"+o);}},"shift+arrowLeft":function(){v(e,t,-1,"col",_);},"shift+arrowRight":function(){v(e,t,1,"col",_);},"shift+arrowDown":function(){v(e,t,1,"row",_);},"shift+arrowUp":function(){v(e,t,-1,"row",_);},"ctrl+enter":function(){e.endEdit();},"shift+enter":function(){var i=e.selection.getSelectedCell();if(r.isRangeId(i)){var n=e.selection.getFocusedCell();return e.endEdit(),e.selection.setSelectedCell(i),void e.selection.setFocusedCell(r.getPrevRangeCell(i,n,t,"col"))}p(e,t,null,_,-1,"row");},tab:function(i){i.preventDefault();var n=e.selection.getSelectedCell();if(r.isRangeId(n)){var o=e.selection.getFocusedCell();return e.endEdit(),e.selection.setSelectedCell(n),void e.selection.setFocusedCell(r.getNextRangeCell(n,o,t))}p(e,t,null,_,1,"col");},"shift+tab":function(i){i.preventDefault();var n=e.selection.getSelectedCell();if(r.isRangeId(n)){var o=e.selection.getFocusedCell();return e.endEdit(),e.selection.setSelectedCell(n),void e.selection.setFocusedCell(r.getPrevRangeCell(n,o,t))}p(e,t,null,_,-1,"col");},arrowLeft:function(i){g||(i.preventDefault(),p(e,t,null,_,-1,"col"));},arrowRight:function(i){g||(i.preventDefault(),p(e,t,null,_,1,"col"));},arrowDown:function(i){i.preventDefault(),f.navigate("arrowDown")||g||p(e,t,null,_,1,"row");},arrowUp:function(i){i.preventDefault(),f.navigate("arrowUp")||g||p(e,t,null,_,-1,"row");},"ctrl+arrowLeft":function(){p(e,t,1,_,null,"col");},"ctrl+arrowRight":function(){p(e,t,t.config.columns.length-1,_,null,"col");},"ctrl+arrowDown":function(){p(e,t,t.data.getLength()-1,_,null,"row");},"ctrl+arrowUp":function(){p(e,t,0,_,null,"row");},home:function(i){g||(i.preventDefault(),p(e,t,1,_,null,"col"));},end:function(i){g||(i.preventDefault(),p(e,t,t.config.columns.length-1,_,null,"col"));},"ctrl+home":function(){p(e,t,0,_,null,"row"),p(e,t,1,_,null,"col");},"ctrl+end":function(){p(e,t,t.data.getLength()-1,_,null,"row"),p(e,t,t.config.columns.length-1,_,null,"col");},"ctrl+z":function(i){var n=e.selection.getFocusedCell(),o=r.getCellInfo(n,_,t);n&&o.edited||i.preventDefault(),e.undo();},"ctrl+y":function(t){t.preventDefault(),e.redo();},"ctrl+shift+z":function(){e.redo();},"ctrl+b":function(){var i=e.selection.getSelectedCell(),n=a.getToggledValue(_,i,"font-weight","bold",t);e.setStyle(e.selection.getSelectedCell(),{"font-weight":n});},"ctrl+i":function(){var i=e.selection.getSelectedCell(),n=a.getToggledValue(_,i,"font-style","italic",t);e.setStyle(e.selection.getSelectedCell(),{"font-style":n});},"ctrl+u":function(i){i.preventDefault();var n=e.selection.getSelectedCell(),o=a.getToggledValue(_,n,"text-decoration","underline",t);e.setStyle(e.selection.getSelectedCell(),{"text-decoration":o});},"ctrl+f":function(t){t.preventDefault(),e.search("",!0);},"alt+shift+5":function(e){r.isMac()||b(e);},"ctrl+shift+x":function(e){r.isMac()&&b(e);},"ctrl+shift+e":function(e){w("center",e);},"ctrl+shift+l":function(e){w("left",e);},"ctrl+shift+r":function(e){w("right",e);},"shift + F11":function(t){t.preventDefault(),e.addSheet();},"alt + arrowUp":function(e){x(1,e);},"alt + arrowDown":function(e){x(-1,e);},"ctrl + space":function(e){E(!0,e);},"shift + space":function(e){E(!1,e);},"ctrl+k":function(t){t.preventDefault();var i=e.selection.getFocusedCell();e._showLinkPopup(i);},backspace:function(){g||e.setValue(e.selection.getSelectedCell(),"");}})};},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=i(0),r=i(8),a=i(5),s=i(29),l=i(17),c=i(12),u=function(){function e(e,t){this._list=new s.List(null,{keyNavigation:!0,css:"dhx_editor-list"}),this._data=this._list.data,this._popup=new r.Popup({css:"dhx_editor-popup"}),this._popup.attach(this._list),this._events=t,this._endEdit=e,this._initHandlers();}return e.prototype.endEdit=function(){var e=this;this.edit&&(o.awaitRedraw().then((function(){var t;e._events.fire(a.SpreadsheetEvents.cellInput,[e._config.oninput[1],(null===(t=e._list.selection.getItem())||void 0===t?void 0:t.value)||e._input.value]),e._endEdit(),e._popup.hide();})),this.edit=!1);},e.prototype.setValue=function(e){var t=e.filter((function(e){return e||c.isNumeric(e)})).map((function(e){return (null==e?void 0:e.toString().trim())||""})),i=new Set(t);this._data.parse(Array.from(i).map((function(e){return {value:e}})));},e.prototype.toHTML=function(e){var t=this;return this._config=e,this.edit=!0,document.addEventListener("mousedown",this._handlers.onOuterClick),[o.el("input.dhx_cell_input",n(n({},e),{onkeydown:function(e){"Enter"===e.code&&t._popup.hide(),"ArrowDown"!==e.code&&"ArrowUp"!==e.code||l.focusManager.setFocusId(t._list._uid);},oninput:this._handlers.oninput,_hooks:n(n({},e._hooks),{didInsert:this._handlers.didInsert,didRemove:function(){return document.removeEventListener("mousedown",t._handlers.onOuterClick)}})})),o.el(".dxi.dxi-menu-up.dhx_spreadsheet_cell_icon",{onclick:function(){return t.endEdit()}})]},e.prototype._filter=function(e){this._list.data.filter((function(t){return e?t.value.includes(e):t}));},e.prototype._showPopup=function(){var e,t=this;this._popup.show(this._input,{centering:!0,mode:"bottom"}),this._list.selection.add((null===(e=this._list.data.find((function(e){return e.value===t._input.value})))||void 0===e?void 0:e.id)||"");},e.prototype._initHandlers=function(){var e=this;this._handlers={onFocus:function(){o.awaitRedraw().then((function(){e._showPopup();}));},onOuterClick:function(t){if(t.target instanceof Node){var i=e._input&&e._input.contains(t.target),n=e._popup&&e._popup.getRootNode()&&e._popup.getRootNode().contains(t.target);i||n||e._popup.hide();}},oninput:function(t){var i=t.target.value;i||e._showPopup(),i.startsWith("=")&&e._popup.isVisible()&&e._popup.hide(),e._filter(i);var n=e._config.oninput;(0, n[0])(n[1],t);},didInsert:function(t){var i=t.el;e._input=i,e._input.addEventListener("focus",e._handlers.onFocus),e._config._hooks.didInsert(t);}},this._list.events.on(s.ListEvents.click,(function(){e.endEdit();})),this._events.on(a.SpreadsheetEvents.afterEditEnd,(function(){e._popup.hide();})),this._popup.events.on(r.PopupEvents.afterShow,(function(){var t=e._list.getFocus();e._list.data.getItem(t)||e._list.setFocus(e._list.data.getId(0));}));},e}();t.SelectEditor=u;},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=i(0),r=i(54),a=i(8),s=i(5),l=i(12),c=i(26),u=function(){function e(e,t,i){var n=t.toLocaleLowerCase().includes("%a")?12:24;this._timepicker=new r.Timepicker(null,{timeFormat:n}),this._popup=new a.Popup({css:"dhx_editor_popup"}),this._popup.attach(this._timepicker),this._events=i,this._initHandlers();}return e.prototype.endEdit=function(){},e.prototype.setValue=function(e){this._isFromSet=!0,this._initialDate&&l.isNumeric(e)&&(this._initialDate=c.excelDateToJSDate(e));var t=l.isNumeric(e)?c.excelDateToJSDate(e):c.timeStringToJS(e);t!==e&&this._timepicker.setValue(t);},e.prototype.hidePopup=function(){this._popup.isVisible()&&this._popup.hide();},e.prototype.toHTML=function(e){var t=this;return this._config=e,this.setValue(e.value),this._initialDate=e.initValue,document.addEventListener("mousedown",this._handlers.onOuterClick),o.el("input.dhx_cell_input",n(n({},e),{onkeydown:function(e){"Enter"===e.code&&t._popup.hide();},oninput:this._handlers.oninput,_hooks:n(n({},e._hooks),{didInsert:this._handlers.didInsert,didRemove:this._handlers.didRemove})}))},e.prototype._showPopup=function(){this._input.value.startsWith("=")||this._popup.show(this._input,{centering:!0,mode:"bottom"});},e.prototype._initHandlers=function(){var e=this;this._handlers={onFocus:function(){o.awaitRedraw().then((function(){e._showPopup();}));},onOuterClick:function(t){if(t.target instanceof Node){var i=e._input&&e._input.contains(t.target),n=e._popup&&e._popup.getRootNode()&&e._popup.getRootNode().contains(t.target);i||n||e._popup.hide();}},oninput:function(t){var i=t.target.value;i||e._showPopup(),i.startsWith("=")&&e._popup.isVisible()&&e._popup.hide();var n=e._config.oninput,o=n[0],r=n[1];e.setValue(i),o(r,t);},didInsert:function(t){var i=t.el;e._input=i,e._input.addEventListener("focus",e._handlers.onFocus),e._config._hooks.didInsert(t),e._initTimePickerEvents();},didRemove:function(){document.removeEventListener("mousedown",e._handlers.onOuterClick);}};},e.prototype._initTimePickerEvents=function(){var e=this;this._timepicker.events.on(r.TimepickerEvents.change,(function(t){e._isFromSet?o.awaitRedraw().then((function(){e._isFromSet=!1;})):e._events.fire(s.SpreadsheetEvents.cellInput,[e._config.oninput[1],l.getFormattedValue(c.getExcelDateFromJs(c.timeStringToJS(t)),e._config.format)]);}));},e}();t.TimeEditor=u;},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=i(58),r=i(5),a=i(46),s=i(10),l=i(8),c=i(2),u=i(107),d=function(){function e(e,t,i){this._set=t,this._grid=i,this._modal=new a.Window({title:s.default.validation,movable:!0,closable:!0,css:"dhx-spreadsheet-form-validation",height:250,width:600}),this._form=new o.Form(null,{rows:[{name:"cell",type:"input",label:"Cell range:",labelPosition:"left",labelWidth:70,width:270,placeholder:"Enter cell range"},{cols:[{name:"criteria",type:"combo",label:"Criteria:",labelPosition:"left",labelWidth:70,width:270,readonly:!0,multiselection:!1,data:[{value:"List of items",id:"items"},{value:"List from a range",id:"range"}]},{labelWidth:3,width:260,labelPosition:"left",name:"target",type:"input",validation:this.formValidation.bind(this),errorMessage:"Invalid cell range",placeholder:"Enter cell range"}]},{align:"end",cols:[{type:"button",text:s.default.cancel,id:"cancel",view:"link"},{type:"button",text:s.default.removeValidation,id:"remove",view:"link"},{type:"button",text:s.default.save,id:"save"}]}]}),this._modal.attach(this._form),this._events=e,this._initHandlers();}return e.prototype.hide=function(){this._modal.isVisible()&&this._modal.hide(),this._events.fire(r.SpreadsheetEvents.afterPopupHide);},e.prototype.formValidation=function(e){if(!e)return !0;if("range"===this._form.getItem("criteria").getValue()){var t=c.getCellIds(e,this._grid),i=t.row,n=t.start;return i||n}return !0},e.prototype.show=function(e,t){this._modal.isVisible()||this._modal.show();var i=n({},t);if(t.editor){var o=t.editor.options;i.target="string"==typeof o?o:o.join(","),i.criteria="string"==typeof o?"range":"items";}this._form.setValue(n({cell:e,criteria:"items",target:""},i));},e.prototype._save=function(e){var t=this._form.getValue(),i=t.target,n=t.cell,o=t.criteria;if(i=u.sanitize(i),this._form.validate()){if(!e||i){var r="range"===o;r&&!c.getCellIds(i,this._grid).start&&(i+=":"+i),this.hide();var a=r?i:i.split(",").map((function(e){return e.trim()}));this._set(n,e?a:null);}}else this._form.blur("target");},e.prototype._initHandlers=function(){var e=this;this._form.events.on(o.FormEvents.focus,(function(t){e._focus=t;})),this._modal.events.on(l.PopupEvents.afterShow,(function(){e._form.setFocus("target");})),this._form.events.on(o.FormEvents.click,(function(t){switch(t){case"save":e._save(!0);break;case"remove":e._save(!1);break;default:e.hide();}})),this._form.getItem("criteria").events.on(o.FormEvents.change,(function(t){var i="Enter "+("range"===t?"cell range":" items separated by a comma");e._form.getItem("target").setProperties({placeholder:i}),e._form.setFocus("target");})),this._events.on(r.SpreadsheetEvents.afterSelectionSet,(function(t){"cell"===e._focus&&(e._form.setValue({cell:t}),e._form.setFocus("cell")),"target"===e._focus&&"range"===e._form.getItem("criteria").getValue()&&(e._form.setValue({target:t}),e._form.setFocus("target"));}));},e}();t.ValidationForm=d;},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);}),r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},a=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var s,l=i(1),c=i(0),u=i(4),d=i(7),h=i(9),f=i(6);!function(e){e.change="change",e.focus="focus",e.blur="blur",e.keydown="keydown";}(s=t.RadioButtonEvents||(t.RadioButtonEvents={}));var p=function(e){function t(t,i){void 0===i&&(i={});var n=e.call(this,t,r({text:"",width:"content",height:"content"},i))||this;n._propsItem=["text"],n._props=a(h.baseProps,n._propsItem),n._handlers={onchange:function(e){n.config.checked=e.target.checked,n.events.fire(s.change,[e.target.checked]);},onfocus:function(){return n.events.fire(s.focus,[n.getValue()||"",n.config.id])},onblur:function(){var e;return null===(e=n.events)||void 0===e?void 0:e.fire(s.blur,[n.getValue()||"",n.config.id])},onkeydown:function(e){n.events.fire(s.keydown,[e,n.config.id]);}},n.events=new u.EventSystem;return n.mount(t,c.create({render:function(){return n._draw()}})),n}return o(t,e),t.prototype.destructor=function(){this.events&&this.events.clear(),this.config=this.events=this._handlers=this._uid=this._props=this._propsItem=null,this.unmount();},t.prototype.setProperties=function(e){if(e&&!l.isEmptyObj(e)){for(var t in e)this._props.includes(t)&&(this.config[t]=e[t]);this.paint();}},t.prototype.getProperties=function(){for(var e={},t=0,i=this._props;t<i.length;t++){var n=i[t];e[n]=this.config[n];}return e},t.prototype.getValue=function(){if(this.config.checked)return this.config.value},t.prototype.setValue=function(e){this.config.checked=e,this.paint();},t.prototype.focus=function(){var e=this;c.awaitRedraw().then((function(){e.getRootView().refs.input.el.focus();}));},t.prototype.blur=function(){var e=this;c.awaitRedraw().then((function(){e.getRootView().refs.input.el.blur();}));},t.prototype.disable=function(){this.config.$disabled=!0,this.paint();},t.prototype.enable=function(){this.config.$disabled=!1,this.paint();},t.prototype.isDisabled=function(){return this.config.$disabled},t.prototype.clear=function(){this.config.checked=!1,this.paint();},t.prototype.validate=function(){var e=!1;return this.config.checked&&(e=!0),this.config.$validationStatus=e?f.ValidationStatus.success:f.ValidationStatus.error,this.paint(),e},t.prototype.clearValidate=function(){this.config.$validationStatus=f.ValidationStatus.pre,this.paint();},t.prototype._draw=function(){var e=this.config,t=e.id,i=e.value,n=e.checked,o=e.$disabled,r=e.$name,a=e.$required,s=e.text;return c.el("label.dhx_radiobutton.dhx_form-group",{class:h.getFormItemCss(this.config,!!a)},[c.el("input.dhx_radiobutton__input",{type:"radio",id:t,value:i||"",name:r||"",disabled:o,checked:n,onchange:this._handlers.onchange,onfocus:this._handlers.onfocus,onblur:this._handlers.onblur,onkeydown:this._handlers.onkeydown,required:a,_ref:"input"}),c.el("span.dhx_radiobutton__visual-input"),c.el("span.dhx_text",[s])])},t}(d.View);t.RadioButton=p;},function(e,t,i){function n(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i]);}Object.defineProperty(t,"__esModule",{value:!0}),n(i(100)),n(i(232)),n(i(36));},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);}),r=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var a=i(1),s=i(4),l=i(7),c=i(13),u=i(15),d=i(30),h=i(22),f=i(48),p=i(36),v=i(100),g=i(233),_=i(101),m=i(234),y=i(235),b=i(236),w=i(29),x=i(0),E=function(e){function t(t,i){void 0===i&&(i={});var n=e.call(this,null,a.extend({mode:p.VaultMode.list,modeControls:!0,toolbar:!0,updateFromResponse:!0,scaleFactor:4,customScroll:!0,uploader:{},progressBar:{},disablePreview:!1,editable:!0},i))||this;return n.config.toolbar||(n.config.uploader.autosend=!0),i.data?(n.data=i.data,n.events=i.data.events,n.events.context=n):(n.events=new s.EventSystem(n),n.data=new c.DataCollection({},n.events)),n.data.config.init=function(e){var t,i,o,r;return e.status=e.status||p.FileStatus.uploaded,e.file?(e.size=e.file.size,e.name=e.file.name,e.value=null===(t=e.file.name)||void 0===t?void 0:t.split(".").slice(0,-1).join("."),e.extension=null===(i=e.file.name)||void 0===i?void 0:i.split(".").pop(),e.preview=!n.config.disablePreview):(e.size=e.size||0,e.name=e.name||"",e.value=(null===(o=e.name)||void 0===o?void 0:o.split(".").slice(0,-1).join("."))||"",e.extension=null===(r=e.name)||void 0===r?void 0:r.split(".").pop(),e.preview=!n.config.disablePreview),e.file&&_.isImage(e)&&n._readStack.add(e,n.uploader.config.autosend||n.config.disablePreview),e},n._readStack=new y.ReadStackPreview(n.data),n.uploader=new v.Uploader(n.config.uploader,n.data,n.events),n._progressBar=new m.ProgressBar(n.events,n.config.progressBar),n.events.on(p.UploaderEvents.uploadProgress,(function(e,t,i){return n._progressBar.setState(e,{current:t,total:i})})),n._initUI(t),n._initEvents(),n}return o(t,e),t.prototype.destructor=function(){this.toolbar.destructor(),this._readStack.stop(),this.uploader.unlinkDropArea(),this.uploader.abort(),this.unmount();},t.prototype.getRootView=function(){return this._layout.getRootView()},t.prototype.paint=function(){var e=this._canDrop||!this.data.getLength();this._activeView=e?this._emptyField:this.config.mode===p.VaultMode.grid||this.toolbar&&this.toolbar.getState().mode===p.VaultMode.grid?this.grid:this.list,this._layout.getCell("vault").attach(this._activeView);},t.prototype._initUI=function(e){var t=this._layout=new u.Layout(e,{css:"dhx_vault",rows:[{id:"toolbar",css:"dhx_vault--toolbar",height:"content"},{id:"vault",css:"dhx_vault--container"}],on:this._getDragEvents()});this._initToolbar(),t.getCell("toolbar").attach(this.toolbar),this._initEmpty(),this._initList(),this._initGrid(e),this.config.toolbar||t.getCell("toolbar").hide(),this.paint();},t.prototype._initList=function(){var e=this,t="ontouchstart"in document.documentElement;this.list=new w.List(null,{data:this.data,dragMode:"both",multiselection:!!t||"ctrlClick",template:g.listTemplate,eventHandlers:g.getContainersEvents(this.data),keyNavigation:!0,editable:this.config.editable,itemHeight:49,hotkeys:{delete:function(){var t,i=null===(t=e.list.selection.getItem())||void 0===t?void 0:t.map((function(e){return e.id}));i.length&&e.data.remove(i);}}}),this.list.events.on("afterEditEnd",(function(t,i){var n=e.list.data.getItem(i);e.list.data.update(i,{name:t+"."+n.extension});}));},t.prototype._initGrid=function(e){var t=this,i="ontouchstart"in document.documentElement;this.grid=new b.DataView(null,{gap:8,itemsInRow:4,dragMode:"both",multiselection:!!i||"ctrlClick",data:this.data,template:g.gridTemplate,eventHandlers:g.getContainersEvents(this.data),keyNavigation:!0,editable:this.config.editable,hotkeys:{delete:function(){var e,i=null===(e=t.list.selection.getItem())||void 0===e?void 0:e.map((function(e){return e.id}));i.length&&t.data.remove(i);}}}),this.grid.selection=this.list.selection,e&&("string"==typeof e&&(e=document.getElementById(e)),this.grid.config.itemsInRow=Math.floor(e.offsetWidth/100));},t.prototype._initToolbar=function(){this.toolbar=new d.Toolbar(null,{css:"vault-toolbar"}),this.toolbar.data.parse([{id:"add",tooltip:f.default.add,type:"navItem",css:"dhx_toolbar-button--circle dhx_toolbar-button--icon",icon:"dxi dxi-plus"},{id:"mode-separator",type:"separator"},{id:"list",tooltip:f.default.list,type:"navItem",css:"dhx_toolbar-button--circle dhx_toolbar-button--icon",icon:"dxi dxi-view-sequential",active:this.config.mode===p.VaultMode.list,group:"mode"},{id:"grid",tooltip:f.default.grid,type:"navItem",css:"dhx_toolbar-button--circle dhx_toolbar-button--icon",icon:"dxi dxi-view-grid",active:this.config.mode===p.VaultMode.grid,group:"mode"},{id:"upload-separator",type:"separator"},{id:"upload",tooltip:f.default.upload,type:"navItem",css:"dhx_toolbar-button--circle dhx_toolbar-button--icon",icon:"dxi dxi-vault"},{id:"spacer",type:"spacer"},{id:"remove-all",tooltip:f.default.clearAll,type:"navItem",css:"dhx_toolbar-button--circle dhx_toolbar-button--icon",icon:"dxi dxi-delete-forever"}]),this.config.modeControls||this.toolbar.hide(["mode-separator","list","grid","upload-separator"]),this._hideAdditionalButtons();},t.prototype._initEmpty=function(){var e=this;return this._emptyField=l.toViewLike(x.create({render:function(){return x.el(".dhx-dropable-area.drop-files-here",[x.el(".dhx-big-icon-block",[x.el(".dxi.dxi-vault")]),!e._canDrop&&x.el(".drop-area-bold-text",f.default.dragAndDrop),!e._canDrop&&x.el(".drop-area-bold-text",f.default.filesOrFoldersHere),!e._canDrop&&x.el(".drop-area-light-text",f.default.or),!e._canDrop&&x.el("button.dhx_button.dhx_button--view_flat.dhx_btn--small.dhx_button--color_primary.dhx_button--size_small",{onclick:function(){return e.uploader.selectFile()}},f.default.browse)])}}))},t.prototype._changeUI=function(e){this.config.mode=e,this._activeView=e===p.VaultMode.grid?this.grid:this.list,this.data.getLength()&&this.paint();},t.prototype._initEvents=function(){var e=this;this.data.events.on(c.DataEvents.change,(function(){e.data.getLength()?e._showAdditionalButtons():e._hideAdditionalButtons(),e.config.downloadURL&&e.data.forEach((function(t){t.downloadURL||(t.downloadURL=e.config.downloadURL);})),e.paint();})),this.events.on(p.UploaderEvents.uploadBegin,(function(){e.config.toolbar&&e._layout.getCell("toolbar").attach(e._progressBar);})),this.events.on(p.UploaderEvents.uploadComplete,(function(){e.config.toolbar&&e._layout.getCell("toolbar").attach(e.toolbar);})),this.toolbar.events.on(h.NavigationBarEvents.click,(function(t){switch(t){case"add":e.uploader.selectFile();break;case"remove-all":if(e.data.getLength()){var i=e._activeView.selection.getItem();i&&i.length>0?i.forEach((function(t){_.removeItem(e.data,t.id);})):e.data.removeAll();}break;case"list":case"grid":e._changeUI(t);break;case"upload":e.uploader.send();}})),this.events.on(p.ProgressBarEvents.cancel,(function(){e.uploader.abort(),e.paint();}));},t.prototype._getDragEvents=function(){var e=this,t={left:null,top:null,width:null,height:null};return {dragleave:function(i){e._canDrop&&(i.pageX>t.left+t.width-1||i.pageX<t.left||i.pageY>t.top+t.height-1||i.pageY<t.top)&&(e._canDrop=!1,e.config.toolbar&&e._layout.getCell("toolbar").show(),e._layout.config.css="dhx_vault",e.paint());},dragenter:function(i){if(i.preventDefault(),!e.uploader.isActive&&!e._canDrop){for(var n=0,o=i.dataTransfer.types;n<o.length;n++){var r=o[n];if("Files"!==r&&"application/x-moz-file"!==r)return void(e._canDrop=!1)}e._canDrop=!0;var a=e.getRootView().node.el.getBoundingClientRect();t.left=a.left+window.pageXOffset,t.top=a.top+window.pageYOffset,t.width=a.width,t.height=a.height,e._canDrop=!0,e.config.toolbar&&e._layout.getCell("toolbar").hide(),e._layout.config.css="dhx_vault dhx-dragin "+(e._canDrop?" drop-here":""),e.paint();}},dragover:function(e){e.preventDefault();},drop:function(t){if(t.preventDefault(),e._canDrop){var i=t.dataTransfer;e.uploader.parseFiles(i),e._canDrop=!1,e.config.toolbar&&e._layout.getCell("toolbar").show(),e._layout.config.css="dhx_vault",e.paint();}}}},t.prototype._hideAdditionalButtons=function(){var e=this,t=["upload",this.config.modeControls?"upload-separator":""];r(["mode-separator","list","grid"],t,["remove-all"]).forEach((function(t){e.toolbar.data.getItem(t)&&!e.toolbar.data.getItem(t).hidden&&e.toolbar.hide(t);}));},t.prototype._showAdditionalButtons=function(){var e=this,t=this.config.modeControls?["mode-separator","list","grid"]:[],i=this.uploader.config.autosend?[]:["upload",this.config.modeControls?"upload-separator":""],n=r(t,i,["remove-all"]);this.toolbar.data.update("remove-all",{tooltip:this._activeView.selection&&this._activeView.selection.getItem()?f.default.clearAllSelected:f.default.clearAll}),n.forEach((function(t){e.toolbar.data.getItem(t)&&e.toolbar.data.getItem(t).hidden&&e.toolbar.show(t);}));},t}(l.View);t.Vault=E;},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(3),o=i(16),r=i(101),a=i(36),s=i(48);t.gridTemplate=function(e){var t=e.status===a.FileStatus.inprogress,i=e.status===a.FileStatus.failed,n=e.status!==a.FileStatus.uploaded,o="dhx_dataview-item--file__";switch(e.status){case a.FileStatus.inprogress:o+="progress";break;case a.FileStatus.queue:o+="queue";break;case a.FileStatus.failed:o+="failed";break;default:o="";}var l="",c="";e.link&&(c=(l=(e.downloadURL||"")+e.link).split("/").pop().split("?")[0]);var u="";return /image/.exec(r.getFileClassName(e))&&e.preview&&(e.image&&e.image.src?u="style=\"background:url('"+e.image.src+"') center center no-repeat;background-size:cover\"":e.link&&(u="style=\"background:url('"+l+"') center center no-repeat;background-size:cover\"")),'<div class="dhx_dataview-item--file '+o+'">\n\t\t<div class="dhx_dataview-item--file-type '+r.getFileClassName(e)+'" '+u+"></div>\n\t\t"+(t?'<div class="dhx_dataview-item--progress-block">\n\t\t\t\t\t<div class="dhx_dataview-item--progress-value">'+(100*e.progress).toFixed(1)+'%</div>\n\t\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" class="dhx_vault-item--progress-circle" viewBox="0 0 60 60">\n\t\t\t\t\t\t<circle cx="30" cy="30" r="28" stroke-width="4" class="dhx_vault-item--progress-bar-background"></circle>\n\t\t\t\t\t\t<circle cx="30" cy="30" r="28" stroke-width="4" stroke-dasharray="175.9 175.9" stroke-dashoffset="'+175.9*(1-e.progress)+'" class="active-circle dhx_vault-item--progress-bar-active"></circle>\n\t\t\t\t\t</svg>\n\t\t\t\t</div>':'<div class="dhx_dataview-item--default-block">\n\t\t\t\t\t'+(i?'<div class="dhx_dataview-item--error-mark dxi dxi-alert-circle"></div>':n?'<div class="dhx_dataview-item--error-mark dxi dxi-vault"></div>':'<div class="dhx_dataview-item--success-mark dxi dxi-checkbox-marked-circle"></div>')+'\n\t\t\t\t</div>\n\t\t\t\t<div class="dhx_dataview-item--hover-block">\n\t\t\t\t\t<div class="dhx_dataview-item--control-block '+(i||n||!e.link?"dhx_dataview-item--control-block__withoutLink":"")+'">\n\t\t\t\t\t\t'+(i||n||!e.link?'<div class="dhx_dataview-item--remove-btn dxi dxi-delete-forever"></div>':'<a href="'+l+'" class="dhx_dataview-item--download-btn dxi dxi-download" download="'+c+'"></a>\n\t\t\t\t\t\t\t\t\t<div class="dhx_dataview-item--remove-btn dxi dxi-delete-forever"></div>')+"\n\t\t\t\t\t</div>\n\t\t\t\t\t"+(i?'<div class="dhx_dataview-item--error-text">'+s.default.error+"</div>":'<div class="dhx_dataview-item--file-size">'+r.getBasis(e.size)+"</div>")+"\n\t\t\t\t</div>")+'\n\t\t</div>\n\t<div class="dhx_dataview-item--file-name">'+r.truncateWord(e.name)+"</div>"},t.listTemplate=function(e){var t=e.status===a.FileStatus.failed,i=e.status===a.FileStatus.inprogress,n=e.status!==a.FileStatus.uploaded&&!t,o="",l="";return e.link&&(l=(o=(e.downloadURL||"")+e.link).split("/").pop().split("?")[0]),'<div class="dhx_list-item--icon '+(n?"dhx_list-item--queue":"")+'">\n\t\t\t<div class="dhx_list-item--file-type '+r.getFileClassName(e)+'"></div>\n\t\t</div>\n\t\t<div class="dhx_list-item--content">\n\t\t'+(i?'<div class="dhx_list-item--name">'+e.value+"."+e.extension+'\n\t\t\t\t\t<p class="dhx_item--progress-value">'+(100*e.progress).toFixed(1)+"%</p>\n\t\t\t\t</div>":'<div class="dhx_list-item--name">'+e.value+"."+e.extension+"</div>\n\t\t\t\t\t"+(t?'<div class="dhx_list-item--error-info">'+s.default.error+"</div>":"")+'\n\t\t\t\t\t<div class="dhx_list-item--size '+(t?"error":"")+'">'+r.getBasis(e.size)+"</div>\t\n\t\t\t\t</div>")+"\n\t\t</div>\n\t\t"+(i?'<div class="dhx_item--download-progress" style="width:'+(100*e.progress).toFixed(1)+'%"></div>':'<div class="dhx_item--info">\n\t\t\t\t\t'+(t?'<div class="dhx_item--error-mark dxi dxi-alert-circle"></div><div class="dhx_item--btn-remove dxi dxi-delete-forever"></div>':(n?'<div class="dhx_item--error-mark dxi dxi-vault"></div>':'<div class="dhx_item--success-mark dxi dxi-checkbox-marked-circle"></div>')+'\n\t\t\t\t\t\t\t<div class="dhx_item--hover-block">\n\t\t\t\t\t\t\t\t'+(t||n||!e.link?"":'<a href="'+o+'" class="dhx_item--download-btn dxi dxi-download" download="'+l+'"></a>')+'\n\t\t\t\t\t\t\t\t<div class="dhx_item--btn-remove dxi dxi-delete-forever"></div>\n\t\t\t\t\t\t\t</div>')+"\n\t\t\t\t</div>")},t.getContainersEvents=function(e){var t=function(t){var i=n.locate(t);if(i){var r=e.getItem(i);o.tooltip(r.name,{node:t.target,position:o.Position.bottom});}};return {onclick:{"dxi-delete-forever":function(t){var i=n.locate(t);i&&r.removeItem(e,i);}},onmouseover:{"dxi-download":function(e){o.tooltip(s.default.download,{node:e.target,position:o.Position.bottom});},"dxi-delete-forever":function(e){o.tooltip(s.default.clear,{node:e.target,position:o.Position.bottom});},"dhx_list-item--name":t,"dhx_dataview-item--file-name":t}}};},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);});Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),a=i(7),s=i(48),l=i(36),c=function(e){function t(t,i){var n=e.call(this,null,i)||this;n.events=t,n._progress=0;return n.mount(null,r.create({render:function(){return n._draw()}})),n._abortUpload=function(){n.events.fire(l.ProgressBarEvents.cancel);},n}return o(t,e),t.prototype.setState=function(e,t){this._progress=e,this.config.template?this._progressText=this.config.template(e,t):this._progressText=this._progress.toFixed(1)+"%",this.paint();},t.prototype._draw=function(){return r.el(".progress-bar",{_key:this._uid},[r.el(".progress-indicator",{style:{width:this._progress+"%"}}),r.el(".progress-text",{".innerHTML":this._progressText}),r.el("button",{class:"dhx_button dhx_button--color_primary dhx_button--size_small dhx_button--view_flat action-abort-all",onclick:this._abortUpload},s.default.cancel)])},t}(a.View);t.ProgressBar=c;},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this._readerStack=[],this._isActive=!1,this._data=e;}return e.prototype.add=function(e,t){void 0===t&&(t=!1),this._readerStack.push(e),t||this.read();},e.prototype.read=function(){var e=this;if(this._readerStack.length&&!this._isActive){var t=this._readerStack.shift();this._isActive=!0;var i=new FileReader;i.readAsDataURL(t.file),i.onload=function(i){var n=new Image;n.src=i.target.result,n.onload=function(){e._data.exists(t.id)&&e._data.update(t.id,{image:n}),e._isActive=!1,e.read();};},i.onerror=function(){e._isActive=!1,e.read();};}},e.prototype.stop=function(){this._readerStack=[];},e}();t.ReadStackPreview=n;},function(e,t,i){function n(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i]);}Object.defineProperty(t,"__esModule",{value:!0}),n(i(102)),n(i(239)),n(i(103));},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(238);t.getEditor=function(e,t){return new n.InputEditor(e,t)};},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),o=i(103),r=function(){function e(e,t){var i=this;this._dataView=t,this._config=t.config,this._item=e,this._dataView.events.on(o.DataViewEvents.focusChange,(function(e,t){i._mode&&t!==i._item.id&&i.endEdit();})),this._initHandlers();}return e.prototype.endEdit=function(){if(this._input){var e=this._input.value;this._dataView.events.fire(o.DataViewEvents.beforeEditEnd,[e,this._item.id])?(this._input.removeEventListener("blur",this._handlers.onBlur),this._input.removeEventListener("change",this._handlers.onChange),this._input.removeEventListener("keydown",this._handlers.onKeyDown),this._handlers={},this._mode=!1,this._dataView.events.fire(o.DataViewEvents.afterEditEnd,[e,this._item.id])):this._input.focus();}},e.prototype.toHTML=function(e){this._mode=!0;var t=this._config,i=t.itemsInRow,o=t.gap,r=function(e){return parseFloat(e)};return n.el(".dhx_input__wrapper",{style:{width:"calc("+100/i+"% - "+r(o)+" * "+(i-1)/i+"px)",maxWidth:"calc("+100/i+"% - "+r(o)+" * "+(i-1)/i+"px)",marginRight:e?"":o},role:"presentation"},[n.el("div.dhx_input__container",{style:{height:"100%"},role:"presentation"},[n.el("input.dhx_input",{class:(this._item.css?" "+this._item.css:"")+(e?" dhx_dataview-item--last-item-in-row":""),style:{padding:"8px, 12px",width:"100%",height:"100%"},_hooks:{didInsert:this._handlers.didInsert},_key:this._item.id,"data-dhx-id":this._item.id})])])},e.prototype._initHandlers=function(){var e=this;this._handlers={onBlur:function(){e.endEdit();},onChange:function(){e.endEdit();},onKeyDown:function(t){"Enter"===t.key&&e._item.value===e._input.value&&e.endEdit(),"Escape"===t.key&&(e._input.value=e._item.value,e.endEdit());},didInsert:function(t){var i=t.el;e._input=i,i.focus(),i.value=e._item.value,i.setSelectionRange(0,i.value.length),i.addEventListener("change",e._handlers.onChange),i.addEventListener("blur",e._handlers.onBlur),i.addEventListener("keydown",e._handlers.onKeyDown);}};},e}();t.InputEditor=r;},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);}),r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=i(34),s=i(102),l=i(0),c=function(e){function t(t,i){void 0===i&&(i={});var n=e.call(this,t,i)||this;return n.scrollView=new a.ScrollView((function(){return n.getRootView()})),n.paint(),n}return o(t,e),t.prototype.destructor=function(){e.prototype.destructor.call(this),this.scrollView=null;},t.prototype.showItem=function(e){var t=this.getRootView();if(t&&t.node&&t.node.el&&void 0!==e){var i=this.getRootNode().getElementsByClassName("scroll-view")[0];if(i){var n=this.config.virtual,o=this.data.getIndex(e),r=Math.floor(o/this.config.itemsInRow),a=Math.floor(r/i.children.length)||0,s=i.children[r-i.children.length*a];if(n||s){var l=s.children[o%this.config.itemsInRow],c=parseInt(this.config.gap.toString().replace("px",""),null);l.offsetTop>=i.clientHeight+i.scrollTop-l.clientHeight?i.scrollTop=l.offsetTop-i.clientHeight+l.clientHeight+c:l.offsetTop<i.scrollTop-c&&(i.scrollTop=l.offsetTop-c);}}}},t.prototype._renderList=function(){var e=this,t=this.data.getRawData(0,-1),i=this.config,n=i.itemsInRow,o=i.css,a=i.gap,s=0,c=t.reduce((function(t,i,o){return 0===s&&t.push([]),t[t.length-1].push(e._renderItem(i,o)),s=(s+1)%n,t}),[]),u=c.map((function(e,t){return l.el(".dhx_dataview-row",{style:{margin:a},"aria-label":"Row "+(t+1)},e)})),d=this.scrollView&&this.scrollView.config.enable,h=(o||"")+" dhx_widget dhx_dataview"+(this.config.multiselection&&this.selection.getItem()?" dhx_no-select--pointer":"")+(d?" dhx_dataview--scroll-view":"");return l.el("",r(r(r({},this._handlers),{"data-dhx-widget-id":this._uid,class:h,style:{height:this.config.height}}),this.getDataViewAriaAttrs(this.config,this.data.getLength(),c.length,n)),d?[this.scrollView.render(u)]:u)},t}(s.DataView);t.ProDataView=c;},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.default={simpleVaultText:"Drag & drop files or folders here or",simpleVaultLabel:"browse files"};},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);}),r=this&&this.__rest||function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(i[n[o]]=e[n[o]]);}return i},a=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var s=i(89),l=i(6),c=i(15),u=i(1),d=i(91),h=i(90),f=i(59),p=i(92),v=i(47),g=i(93),_=i(94),m=i(99),y=i(98),b=i(95),w=i(96),x=i(104),E=i(105),C=i(242),S=i(106),I=i(243),k=function(e){function t(t,i){return e.call(this,t,i)||this}return o(t,e),t.prototype._addLayoutItem=function(e){var t=this,i=e.id=e.id||u.uid(),n=e.name=e.name||i.toString();e.type=e.type&&e.type.toLowerCase();var o=e.width,s=e.height,c=e.css,k=e.padding,M=r(e,["css","padding"]),P=c?c+" dhx_form-element":"dhx_form-element",O=!("spacer"===e.type||void 0===e.type);switch(O&&!o&&(o="content"),O&&!s&&(s="content"),M.type){case"button":M.full&&(P+=" dhx_button--full-gravity");var A=this._attachments[n]=new d.Button(null,e);A.events.on(l.ItemEvent.beforeChangeProperties,(function(e){return t.events.fire(l.FormEvents.beforeChangeProperties,[n,e])})),A.events.on(l.ItemEvent.afterChangeProperties,(function(e){t._changeProps(n,e),t.events.fire(l.FormEvents.afterChangeProperties,[n,e]),t.layout.paint();})),A.events.on(l.ItemEvent.click,(function(e){e.preventDefault(),t.events.fire(l.FormEvents.click,[n,e]),t.events.fire(l.FormEvents.buttonClick,[n,e]),A.config.submit&&t.validate()&&A.config.url&&t.send(A.config.url);})),A.events.on(l.ItemEvent.beforeHide,(function(e,i){if(!i)return t.events.fire(l.FormEvents.beforeHide,[n,e])})),A.events.on(l.ItemEvent.beforeShow,(function(e){return t.events.fire(l.FormEvents.beforeShow,[n,e])})),A.events.on(l.ItemEvent.afterHide,(function(e,i){t.layout.getCell(n).hide(),!i&&t.events.fire(l.FormEvents.afterHide,[n,e]);})),A.events.on(l.ItemEvent.afterShow,(function(e){t.layout.getCell(n).show(),t.events.fire(l.FormEvents.afterShow,[n,e]);})),A.events.on(l.ItemEvent.focus,(function(e){t.events.fire(l.FormEvents.focus,[n,e]);})),A.events.on(l.ItemEvent.blur,(function(e){t.events.fire(l.FormEvents.blur,[n,e]);})),A.events.on(l.ItemEvent.keydown,(function(e){t.events.fire(l.FormEvents.keydown,[e,n]);}));break;case"datepicker":var D=this._attachments[n]=new h.DatePicker(null,e);this._state[n]=D.getValue("Date"===M.valueFormat),D.events.on(l.ItemEvent.beforeChangeProperties,(function(e){return t.events.fire(l.FormEvents.beforeChangeProperties,[n,e])})),D.events.on(l.ItemEvent.afterChangeProperties,(function(e){t._changeProps(n,e),t._state[n]=D.getValue("Date"===M.valueFormat),t.events.fire(l.FormEvents.afterChangeProperties,[n,e]),t.layout.paint();})),D.events.on(l.ItemEvent.change,(function(e){t._state[n]=e,t.events.fire(l.FormEvents.change,[n,e]);})),D.events.on(l.ItemEvent.beforeHide,(function(e,i){if(!i)return t.events.fire(l.FormEvents.beforeHide,[n,e])})),D.events.on(l.ItemEvent.beforeShow,(function(e){return t.events.fire(l.FormEvents.beforeShow,[n,e])})),D.events.on(l.ItemEvent.afterHide,(function(e,i){t.layout.getCell(n).hide(),!i&&t.events.fire(l.FormEvents.afterHide,[n,e]);})),D.events.on(l.ItemEvent.afterShow,(function(e){t.layout.getCell(n).show(),t.events.fire(l.FormEvents.afterShow,[n,e]);})),D.events.on(l.ItemEvent.beforeValidate,(function(e){return t.events.fire(l.FormEvents.beforeValidate,[n,e])})),D.events.on(l.ItemEvent.afterValidate,(function(e,i){t.events.fire(l.FormEvents.afterValidate,[n,e,i]);})),D.events.on(l.ItemEvent.focus,(function(e){t.events.fire(l.FormEvents.focus,[n,e]);})),D.events.on(l.ItemEvent.blur,(function(e){t.events.fire(l.FormEvents.blur,[n,e]);})),D.events.on(l.ItemEvent.keydown,(function(e){t.events.fire(l.FormEvents.keydown,[e,n]);}));break;case"checkbox":var F=this._attachments[n]=new f.Checkbox(null,e);this._state[n]=F.getValue(),F.events.on(l.ItemEvent.beforeChangeProperties,(function(e){return t.events.fire(l.FormEvents.beforeChangeProperties,[n,e])})),F.events.on(l.ItemEvent.afterChangeProperties,(function(e){t._changeProps(n,e),t._state[n]=F.getValue(),t.events.fire(l.FormEvents.afterChangeProperties,[n,e]),t.layout.paint();})),F.events.on(l.ItemEvent.change,(function(e){t._state[n]=e,t.events.fire(l.FormEvents.change,[n,e]);})),F.events.on(l.ItemEvent.beforeHide,(function(e,i){if(!i)return t.events.fire(l.FormEvents.beforeHide,[n,e])})),F.events.on(l.ItemEvent.beforeShow,(function(e){return t.events.fire(l.FormEvents.beforeShow,[n,e])})),F.events.on(l.ItemEvent.afterHide,(function(e,i){t.layout.getCell(n).hide(),!i&&t.events.fire(l.FormEvents.afterHide,[n,e]);})),F.events.on(l.ItemEvent.afterShow,(function(e){t.layout.getCell(n).show(),t.events.fire(l.FormEvents.afterShow,[n,e]);})),F.events.on(l.ItemEvent.beforeValidate,(function(e){return t.events.fire(l.FormEvents.beforeValidate,[n,e])})),F.events.on(l.ItemEvent.afterValidate,(function(e,i){t.events.fire(l.FormEvents.afterValidate,[n,e,i]);})),F.events.on(l.ItemEvent.focus,(function(e){t.events.fire(l.FormEvents.focus,[n,e]);})),F.events.on(l.ItemEvent.blur,(function(e){t.events.fire(l.FormEvents.blur,[n,e]);})),F.events.on(l.ItemEvent.keydown,(function(e){t.events.fire(l.FormEvents.keydown,[e,n]);}));break;case"checkboxgroup":var V=this._attachments[n]=new p.CheckboxGroup(null,e);this._state[n]=V.getValue(),V.events.on(l.ItemEvent.beforeChangeProperties,(function(e){return t.events.fire(l.FormEvents.beforeChangeProperties,[n,e])})),V.events.on(l.ItemEvent.afterChangeProperties,(function(e){t._changeProps(n,e),t._state[n]=V.getValue(),t.events.fire(l.FormEvents.afterChangeProperties,[n,e]),t.layout.paint();})),V.events.on(l.ItemEvent.change,(function(e){t._state[n]=e,t.events.fire(l.FormEvents.change,[n,e]);})),V.events.on(l.ItemEvent.beforeHide,(function(e,i){if(!i)return t.events.fire(l.FormEvents.beforeHide,[n,e])})),V.events.on(l.ItemEvent.beforeShow,(function(e){return t.events.fire(l.FormEvents.beforeShow,[n,e])})),V.events.on(l.ItemEvent.afterHide,(function(e,i){t.layout.getCell(n).hide(),!i&&t.events.fire(l.FormEvents.afterHide,[n,e]);})),V.events.on(l.ItemEvent.afterShow,(function(e){t.layout.getCell(n).show(),t.events.fire(l.FormEvents.afterShow,[n,e]);})),V.events.on(l.ItemEvent.beforeValidate,(function(e){return t.events.fire(l.FormEvents.beforeValidate,[n,e])})),V.events.on(l.ItemEvent.afterValidate,(function(e,i){t.events.fire(l.FormEvents.afterValidate,[n,e,i]);})),V.events.on(l.ItemEvent.focus,(function(e,i){t.events.fire(l.FormEvents.focus,[n,e,i]);})),V.events.on(l.ItemEvent.blur,(function(e,i){t.events.fire(l.FormEvents.blur,[n,e,i]);})),V.events.on(l.ItemEvent.keydown,(function(e,i){t.events.fire(l.FormEvents.keydown,[e,n,i]);}));break;case"combo":var R=this._attachments[n]=new I.ProCombo(null,e);this._state[n]=R.getValue(),R.events.on(l.ItemEvent.beforeChangeProperties,(function(e){return t.events.fire(l.FormEvents.beforeChangeProperties,[n,e])})),R.events.on(l.ItemEvent.afterChangeProperties,(function(e){t._changeProps(n,e),t._state[n]=R.getValue(),t.events.fire(l.FormEvents.afterChangeProperties,[n,e]),t.layout.paint();})),R.events.on(l.ItemEvent.change,(function(e){t._state[n]=e,t.events.fire(l.FormEvents.change,[n,e]);})),R.events.on(l.ItemEvent.beforeHide,(function(e,i){if(!i)return t.events.fire(l.FormEvents.beforeHide,[n,e])})),R.events.on(l.ItemEvent.beforeShow,(function(e){return t.events.fire(l.FormEvents.beforeShow,[n,e])})),R.events.on(l.ItemEvent.afterHide,(function(e,i){t.layout.getCell(n).hide(),!i&&t.events.fire(l.FormEvents.afterHide,[n,e]);})),R.events.on(l.ItemEvent.afterShow,(function(e){t.layout.getCell(n).show(),t.events.fire(l.FormEvents.afterShow,[n,e]);})),R.events.on(l.ItemEvent.beforeValidate,(function(e){return t.events.fire(l.FormEvents.beforeValidate,[n,e])})),R.events.on(l.ItemEvent.afterValidate,(function(e,i){t.events.fire(l.FormEvents.afterValidate,[n,e,i]);})),R.events.on(l.ItemEvent.focus,(function(e){t.events.fire(l.FormEvents.focus,[n,e]);})),R.events.on(l.ItemEvent.blur,(function(e){t.events.fire(l.FormEvents.blur,[n,e]);})),R.events.on(l.ItemEvent.keydown,(function(e,i){t.events.fire(l.FormEvents.keydown,[e,n,i]);}));break;case"input":var T=this._attachments[n]=new v.Input(null,e);this._state[n]=T.getValue(),T.events.on(l.ItemEvent.beforeChangeProperties,(function(e){return t.events.fire(l.FormEvents.beforeChangeProperties,[n,e])})),T.events.on(l.ItemEvent.afterChangeProperties,(function(e){t._changeProps(n,e),t._state[n]=T.getValue(),t.events.fire(l.FormEvents.afterChangeProperties,[n,e]),t.layout.paint();})),T.events.on(l.ItemEvent.change,(function(e){t._state[n]=e,t.events.fire(l.FormEvents.change,[n,e]);})),T.events.on(l.ItemEvent.beforeHide,(function(e,i){if(!i)return t.events.fire(l.FormEvents.beforeHide,[n,e])})),T.events.on(l.ItemEvent.beforeShow,(function(e){return t.events.fire(l.FormEvents.beforeShow,[n,e])})),T.events.on(l.ItemEvent.afterHide,(function(e,i){t.layout.getCell(n).hide(),!i&&t.events.fire(l.FormEvents.afterHide,[n,e]);})),T.events.on(l.ItemEvent.afterShow,(function(e){t.layout.getCell(n).show(),t.events.fire(l.FormEvents.afterShow,[n,e]);})),T.events.on(l.ItemEvent.beforeValidate,(function(e){return t.events.fire(l.FormEvents.beforeValidate,[n,e])})),T.events.on(l.ItemEvent.afterValidate,(function(e,i){t.events.fire(l.FormEvents.afterValidate,[n,e,i]);})),T.events.on(l.ItemEvent.focus,(function(e){t.events.fire(l.FormEvents.focus,[n,e]);})),T.events.on(l.ItemEvent.blur,(function(e){t.events.fire(l.FormEvents.blur,[n,e]);})),T.events.on(l.ItemEvent.keydown,(function(e){t.events.fire(l.FormEvents.keydown,[e,n]);}));break;case"radiogroup":var L=this._attachments[n]=new g.RadioGroup(null,e);this._state[n]=L.getValue(),L.events.on(l.ItemEvent.beforeChangeProperties,(function(e){return t.events.fire(l.FormEvents.beforeChangeProperties,[n,e])})),L.events.on(l.ItemEvent.afterChangeProperties,(function(e){t._changeProps(n,e),t._state[n]=L.getValue(),t.events.fire(l.FormEvents.afterChangeProperties,[n,e]),t.layout.paint();})),L.events.on(l.ItemEvent.change,(function(e){t._state[n]=e,t.events.fire(l.FormEvents.change,[n,e]);})),L.events.on(l.ItemEvent.beforeHide,(function(e,i){if(!i)return t.events.fire(l.FormEvents.beforeHide,[n,e])})),L.events.on(l.ItemEvent.beforeShow,(function(e){return t.events.fire(l.FormEvents.beforeShow,[n,e])})),L.events.on(l.ItemEvent.afterHide,(function(e,i){t.layout.getCell(n).hide(),!i&&t.events.fire(l.FormEvents.afterHide,[n,e]);})),L.events.on(l.ItemEvent.afterShow,(function(e){t.layout.getCell(n).show(),t.events.fire(l.FormEvents.afterShow,[n,e]);})),L.events.on(l.ItemEvent.beforeValidate,(function(e){return t.events.fire(l.FormEvents.beforeValidate,[n,e])})),L.events.on(l.ItemEvent.afterValidate,(function(e,i){t.events.fire(l.FormEvents.afterValidate,[n,e,i]);})),L.events.on(l.ItemEvent.focus,(function(e,i){t.events.fire(l.FormEvents.focus,[n,e,i]);})),L.events.on(l.ItemEvent.blur,(function(e,i){t.events.fire(l.FormEvents.blur,[n,e,i]);})),L.events.on(l.ItemEvent.keydown,(function(e,i){t.events.fire(l.FormEvents.keydown,[e,n,i]);}));break;case"select":var H=this._attachments[n]=new _.Select(null,e);this._state[n]=H.getValue(),H.events.on(l.ItemEvent.beforeChangeProperties,(function(e){return t.events.fire(l.FormEvents.beforeChangeProperties,[n,e])})),H.events.on(l.ItemEvent.afterChangeProperties,(function(e){t._changeProps(n,e),t._state[n]=H.getValue(),t.events.fire(l.FormEvents.afterChangeProperties,[n,e]),t.layout.paint();})),H.events.on(l.ItemEvent.changeOptions,(function(e){t.layout.getCell(n).config.options=a(e);})),H.events.on(l.ItemEvent.change,(function(e){t._state[n]=e,t.events.fire(l.FormEvents.change,[n,e]);})),H.events.on(l.ItemEvent.beforeHide,(function(e,i){if(!i)return t.events.fire(l.FormEvents.beforeHide,[n,e])})),H.events.on(l.ItemEvent.beforeShow,(function(e){return t.events.fire(l.FormEvents.beforeShow,[n,e])})),H.events.on(l.ItemEvent.afterHide,(function(e,i){t.layout.getCell(n).hide(),!i&&t.events.fire(l.FormEvents.afterHide,[n,e]);})),H.events.on(l.ItemEvent.afterShow,(function(e){t.layout.getCell(n).show(),t.events.fire(l.FormEvents.afterShow,[n,e]);})),H.events.on(l.ItemEvent.beforeValidate,(function(e){return t.events.fire(l.FormEvents.beforeValidate,[n,e])})),H.events.on(l.ItemEvent.afterValidate,(function(e,i){t.events.fire(l.FormEvents.afterValidate,[n,e,i]);})),H.events.on(l.ItemEvent.focus,(function(e){t.events.fire(l.FormEvents.focus,[n,e]);})),H.events.on(l.ItemEvent.blur,(function(e){t.events.fire(l.FormEvents.blur,[n,e]);})),H.events.on(l.ItemEvent.keydown,(function(e){t.events.fire(l.FormEvents.keydown,[e,n]);}));break;case"simplevault":M.$vaultHeight=s;var N=this._attachments[n]=new m.SimpleVault(null,e);this._state[n]=N.getValue(),N.events.on(l.ItemEvent.beforeChangeProperties,(function(e){return t.events.fire(l.FormEvents.beforeChangeProperties,[n,e])})),N.events.on(l.ItemEvent.afterChangeProperties,(function(e){t._changeProps(n,e),t._state[n]=N.getValue(),t.events.fire(l.FormEvents.afterChangeProperties,[n,e]),t.layout.paint();})),N.events.on(l.ItemEvent.change,(function(e){t._state[n]=e,t.events.fire(l.FormEvents.change,[n,e]);})),N.events.on(l.ItemEvent.beforeHide,(function(e,i){if(!i)return t.events.fire(l.FormEvents.beforeHide,[n,e])})),N.events.on(l.ItemEvent.beforeShow,(function(e){return t.events.fire(l.FormEvents.beforeShow,[n,e])})),N.events.on(l.ItemEvent.afterHide,(function(e,i){t.layout.getCell(n).hide(),!i&&t.events.fire(l.FormEvents.afterHide,[n,e]);})),N.events.on(l.ItemEvent.afterShow,(function(e){t.layout.getCell(n).show(),t.events.fire(l.FormEvents.afterShow,[n,e]);})),N.events.on(l.ItemEvent.beforeValidate,(function(e){return t.events.fire(l.FormEvents.beforeValidate,[n,e])})),N.events.on(l.ItemEvent.afterValidate,(function(e,i){t.events.fire(l.FormEvents.afterValidate,[n,e,i]);}));break;case"slider":var j=this._attachments[n]=new y.SliderForm(null,e);this._state[n]=j.getValue(),j.events.on(l.ItemEvent.change,(function(e){t._state[n]=e,t.events.fire(l.FormEvents.change,[n,e]);})),j.events.on(l.ItemEvent.beforeHide,(function(e,i){if(!i)return t.events.fire(l.FormEvents.beforeHide,[n,e])})),j.events.on(l.ItemEvent.beforeShow,(function(e){return t.events.fire(l.FormEvents.beforeShow,[n,e])})),j.events.on(l.ItemEvent.afterHide,(function(e,i){t.layout.getCell(n).hide(),!i&&t.events.fire(l.FormEvents.afterHide,[n,e]);})),j.events.on(l.ItemEvent.afterShow,(function(e){t.layout.getCell(n).show(),t.events.fire(l.FormEvents.afterShow,[n,e]);})),j.events.on(l.ItemEvent.focus,(function(e){t.events.fire(l.FormEvents.focus,[n,e]);})),j.events.on(l.ItemEvent.blur,(function(e){t.events.fire(l.FormEvents.blur,[n,e]);})),j.events.on(l.ItemEvent.keydown,(function(e){t.events.fire(l.FormEvents.keydown,[e,n]);}));break;case"textarea":var $=this._attachments[n]=new b.Textarea(null,e);this._state[n]=$.getValue(),$.events.on(l.ItemEvent.beforeChangeProperties,(function(e){return t.events.fire(l.FormEvents.beforeChangeProperties,[n,e])})),$.events.on(l.ItemEvent.afterChangeProperties,(function(e){t._changeProps(n,e),t._state[n]=$.getValue(),t.events.fire(l.FormEvents.afterChangeProperties,[n,e]),t.layout.paint();})),$.events.on(l.ItemEvent.change,(function(e){t._state[n]=e,t.events.fire(l.FormEvents.change,[n,e]);})),$.events.on(l.ItemEvent.beforeHide,(function(e,i){if(!i)return t.events.fire(l.FormEvents.beforeHide,[n,e])})),$.events.on(l.ItemEvent.beforeShow,(function(e){return t.events.fire(l.FormEvents.beforeShow,[n,e])})),$.events.on(l.ItemEvent.afterHide,(function(e,i){t.layout.getCell(n).hide(),!i&&t.events.fire(l.FormEvents.afterHide,[n,e]);})),$.events.on(l.ItemEvent.afterShow,(function(e){t.layout.getCell(n).show(),t.events.fire(l.FormEvents.afterShow,[n,e]);})),$.events.on(l.ItemEvent.beforeValidate,(function(e){return t.events.fire(l.FormEvents.beforeValidate,[n,e])})),$.events.on(l.ItemEvent.afterValidate,(function(e,i){t.events.fire(l.FormEvents.afterValidate,[n,e,i]);})),$.events.on(l.ItemEvent.focus,(function(e){t.events.fire(l.FormEvents.focus,[n,e]);})),$.events.on(l.ItemEvent.blur,(function(e){t.events.fire(l.FormEvents.blur,[n,e]);})),$.events.on(l.ItemEvent.keydown,(function(e){t.events.fire(l.FormEvents.keydown,[e,n]);}));break;case"text":"content"===o&&(P+=" dhx_form-element--fit-content");var z=this._attachments[n]=new w.Text(null,e);this._state[n]=z.getValue(),z.events.on(l.ItemEvent.beforeChangeProperties,(function(e){return t.events.fire(l.FormEvents.beforeChangeProperties,[n,e])})),z.events.on(l.ItemEvent.afterChangeProperties,(function(e){t._changeProps(n,e),t._state[n]=z.getValue(),t.events.fire(l.FormEvents.afterChangeProperties,[n,e]),t.layout.paint();})),z.events.on(l.ItemEvent.change,(function(e){t._state[n]=e,t.events.fire(l.FormEvents.change,[n,e]);})),z.events.on(l.ItemEvent.beforeHide,(function(e,i){if(!i)return t.events.fire(l.FormEvents.beforeHide,[n,e])})),z.events.on(l.ItemEvent.beforeShow,(function(e){return t.events.fire(l.FormEvents.beforeShow,[n,e])})),z.events.on(l.ItemEvent.afterHide,(function(e,i){t.layout.getCell(n).hide(),!i&&t.events.fire(l.FormEvents.afterHide,[n,e]);})),z.events.on(l.ItemEvent.afterShow,(function(e){t.layout.getCell(n).show(),t.events.fire(l.FormEvents.afterShow,[n,e]);})),z.events.on(l.ItemEvent.beforeValidate,(function(e){return t.events.fire(l.FormEvents.beforeValidate,[n,e])})),z.events.on(l.ItemEvent.afterValidate,(function(e,i){t.events.fire(l.FormEvents.afterValidate,[n,e,i]);}));break;case"timepicker":var B=this._attachments[n]=new x.TimePicker(null,e);this._state[n]=M.value&&B.getValue("timeObject"===M.valueFormat)||"",B.events.on(l.ItemEvent.beforeChangeProperties,(function(e){return t.events.fire(l.FormEvents.beforeChangeProperties,[n,e])})),B.events.on(l.ItemEvent.afterChangeProperties,(function(e){t._changeProps(n,e),t._state[n]=B.getValue("timeObject"===M.valueFormat),t.events.fire(l.FormEvents.afterChangeProperties,[n,e]),t.layout.paint();})),B.events.on(l.ItemEvent.change,(function(e){t._state[n]=e,t.events.fire(l.FormEvents.change,[n,e]);})),B.events.on(l.ItemEvent.beforeHide,(function(e,i){if(!i)return t.events.fire(l.FormEvents.beforeHide,[n,e])})),B.events.on(l.ItemEvent.beforeShow,(function(e){return t.events.fire(l.FormEvents.beforeShow,[n,e])})),B.events.on(l.ItemEvent.afterHide,(function(e,i){t.layout.getCell(n).hide(),!i&&t.events.fire(l.FormEvents.afterHide,[n,e]);})),B.events.on(l.ItemEvent.afterShow,(function(e){t.layout.getCell(n).show(),t.events.fire(l.FormEvents.afterShow,[n,e]);})),B.events.on(l.ItemEvent.beforeValidate,(function(e){return t.events.fire(l.FormEvents.beforeValidate,[n,e])})),B.events.on(l.ItemEvent.afterValidate,(function(e,i){t.events.fire(l.FormEvents.afterValidate,[n,e,i]);})),B.events.on(l.ItemEvent.focus,(function(e){t.events.fire(l.FormEvents.focus,[n,e]);})),B.events.on(l.ItemEvent.blur,(function(e){t.events.fire(l.FormEvents.blur,[n,e]);})),B.events.on(l.ItemEvent.keydown,(function(e){t.events.fire(l.FormEvents.keydown,[e,n]);}));break;case"colorpicker":var W=this._attachments[n]=new E.ColorPicker(null,e);this._state[n]=W.getValue(),W.events.on(l.ItemEvent.beforeChangeProperties,(function(e){return t.events.fire(l.FormEvents.beforeChangeProperties,[n,e])})),W.events.on(l.ItemEvent.afterChangeProperties,(function(e){t._changeProps(n,e),t._state[n]=W.getValue(),t.events.fire(l.FormEvents.afterChangeProperties,[n,e]),t.layout.paint();})),W.events.on(l.ItemEvent.change,(function(e){t._state[n]=e,t.events.fire(l.FormEvents.change,[n,e]);})),W.events.on(l.ItemEvent.beforeHide,(function(e,i){if(!i)return t.events.fire(l.FormEvents.beforeHide,[n,e])})),W.events.on(l.ItemEvent.beforeShow,(function(e){return t.events.fire(l.FormEvents.beforeShow,[n,e])})),W.events.on(l.ItemEvent.afterHide,(function(e,i){t.layout.getCell(n).hide(),!i&&t.events.fire(l.FormEvents.afterHide,[n,e]);})),W.events.on(l.ItemEvent.afterShow,(function(e){t.layout.getCell(n).show(),t.events.fire(l.FormEvents.afterShow,[n,e]);})),W.events.on(l.ItemEvent.beforeValidate,(function(e){return t.events.fire(l.FormEvents.beforeValidate,[n,e])})),W.events.on(l.ItemEvent.afterValidate,(function(e,i){t.events.fire(l.FormEvents.afterValidate,[n,e,i]);})),W.events.on(l.ItemEvent.focus,(function(e){t.events.fire(l.FormEvents.focus,[n,e]);})),W.events.on(l.ItemEvent.blur,(function(e){t.events.fire(l.FormEvents.blur,[n,e]);})),W.events.on(l.ItemEvent.keydown,(function(e){t.events.fire(l.FormEvents.keydown,[e,n]);}));break;case"container":var U=this._attachments[n]=new C.Container(null,e);U.events.on(l.ItemEvent.beforeChangeProperties,(function(e){return t.events.fire(l.FormEvents.beforeChangeProperties,[n,e])})),U.events.on(l.ItemEvent.afterChangeProperties,(function(e){t._changeProps(n,e),t.events.fire(l.FormEvents.afterChangeProperties,[n,e]),t.layout.paint();})),U.events.on(l.ItemEvent.beforeHide,(function(e,i){if(!i)return t.events.fire(l.FormEvents.beforeHide,[n,e])})),U.events.on(l.ItemEvent.beforeShow,(function(e){return t.events.fire(l.FormEvents.beforeShow,[n,e])})),U.events.on(l.ItemEvent.afterHide,(function(e,i){t.layout.getCell(n).hide(),!i&&t.events.fire(l.FormEvents.afterHide,[n,e]);})),U.events.on(l.ItemEvent.afterShow,(function(e){t.layout.getCell(n).show(),t.events.fire(l.FormEvents.afterShow,[n,e]);}));break;default:var G=this._attachments[n]=new S.Spacer(null,e);G.events.on(l.ItemEvent.beforeChangeProperties,(function(e){return t.events.fire(l.FormEvents.beforeChangeProperties,[n,e])})),G.events.on(l.ItemEvent.afterChangeProperties,(function(e){t._changeProps(n,e),t.events.fire(l.FormEvents.afterChangeProperties,[n,e]),t.layout.paint();})),G.events.on(l.ItemEvent.beforeHide,(function(e,i){if(!i)return t.events.fire(l.FormEvents.beforeHide,[n,e])})),G.events.on(l.ItemEvent.beforeShow,(function(e){return t.events.fire(l.FormEvents.beforeShow,[n,e])})),G.events.on(l.ItemEvent.afterHide,(function(e,i){t.layout.getCell(n).hide(),!i&&t.events.fire(l.FormEvents.afterHide,[n,e]);})),G.events.on(l.ItemEvent.afterShow,(function(e){t.layout.getCell(n).show(),t.events.fire(l.FormEvents.afterShow,[n,e]);}));}var q={id:n,width:o,height:s,padding:k,css:P};return "gravity"in e&&(q.gravity=e.gravity),q},t.prototype._initUI=function(e){var t=this._attachments={},i={padding:"8px"};this.config.css+=" dhx_form",this._createLayoutConfig(this.config,i);var n=this.layout=new c.ProLayout(e,i);for(var o in t)n.getCell(o).attach(t[o]);},t}(s.Form);t.ProForm=k;},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);}),r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=i(0),s=i(7),l=i(6),c=i(4),u=i(1),d=i(15),h=i(9),f=function(e){function t(t,i){var n=e.call(this,t,r({disabled:!1,hidden:!1,width:"content",height:"content"},i))||this;if(n.events=new c.EventSystem,u.isEmptyObj(i))throw new Error("Check the configuration is correct");n.container&&n.container.destructor();var o={};for(var s in i)"id"!==s&&"type"!==s&&"name"!==s&&"width"!==s&&"height"!==s&&(n.config[s]=i[s],"validation"!==s&&(o[s]=i[s]));n.container=new d.Layout(null,{rows:[o]}),o.html&&n.container.attachHTML(o.html),n.config.hidden&&a.awaitRedraw().then((function(){n.hide(!0);})),n.paint();return n.mount(t,a.create({render:function(){return n._draw()}})),n}return o(t,e),t.prototype.attach=function(e){this.container.attach(e);},t.prototype.attachHTML=function(e){this.container.attachHTML(e);},t.prototype.show=function(){this.config.hidden&&this.events.fire(l.ItemEvent.beforeShow,[void 0])&&(this.config.hidden=!1,this.events.fire(l.ItemEvent.afterShow,[void 0]));},t.prototype.hide=function(e){this.config.hidden&&!e||!this.events.fire(l.ItemEvent.beforeHide,[void 0,e])||(this.config.hidden=!0,this.events.fire(l.ItemEvent.afterHide,[void 0,e]));},t.prototype.isVisible=function(){return !this.config.hidden},t.prototype.disable=function(){this.config.disabled=!0,this.paint();},t.prototype.enable=function(){this.config.disabled=!1,this.paint();},t.prototype.isDisabled=function(){return this.config.disabled},t.prototype.setProperties=function(e){if(e&&!u.isEmptyObj(e)&&this.events.fire(l.ItemEvent.beforeChangeProperties,[this.getProperties()])){for(var t in e)h.baseProps.includes(t)&&(this.config[t]=e[t]);this.events.fire(l.ItemEvent.afterChangeProperties,[this.getProperties()]),this.paint();}},t.prototype.getProperties=function(){for(var e={},t=0,i=h.baseProps;t<i.length;t++){var n=i[t];e[n]=this.config[n];}return e},t.prototype._getRootView=function(){return this.container.getRootView()},t.prototype._draw=function(){var e=this.config,t=e.name,i=e.id,n=e.disabled?" dhx_form-group--disabled":"";return a.el(".dhx_form-group.dhx_form-group--container",{class:n,"data-dhx-id":t||i},[a.inject(this._getRootView())])},t}(s.View);t.Container=f;},function(e,t,i){var n,o=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);},n(e,t)},function(e,t){function i(){this.constructor=e;}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i);});Object.defineProperty(t,"__esModule",{value:!0});var r=i(97),a=i(1),s=i(40),l=i(0),c=function(e){function t(t,i){return e.call(this,t,i)||this}return o(t,e),t.prototype._initView=function(e){var t=this;if(a.isEmptyObj(e))throw new Error("Check the configuration is correct");this.combobox&&this.combobox.destructor(),this.config={type:e.type,id:e.id,name:e.name,disabled:!1,hidden:!1,value:"",readOnly:!1,template:void 0,filter:void 0,multiselection:!1,selectAllButton:!1,itemsCount:void 0,itemHeight:32,virtual:!1,listHeight:224,required:!1,validation:void 0,placeholder:"",label:"",labelWidth:"",labelPosition:"top",hiddenLabel:!1,helpMessage:"",preMessage:"",successMessage:"",errorMessage:"",width:"content",height:"content",padding:void 0};var i={};for(var n in e)"id"!==n&&"type"!==n&&"name"!==n&&(this.config[n]=e[n],"validation"!==n&&(i[n]=e[n]));this.combobox=new s.ProCombobox(null,i),this.config.hidden&&l.awaitRedraw().then((function(){t.hide(!0);})),this.paint();},t}(r.Combo);t.ProCombo=c;},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=i(46),r=i(30),a=i(5),s=i(22),l=i(1),c=i(2),u=i(0),d=i(45),h=i(12),f=function(){function e(e){this._events=e.events,this._spreadsheet=e,this._grid=e._grid,this._selection=e.selection,this._modal=new o.Window({css:"dhx-spreadsheet-form-search-modal",height:56,left:window.innerWidth-385,viewportOverflow:!0,top:0,width:405}),this._toolbar=new r.Toolbar(null,{data:[{type:"input",value:"",placeholder:"Search",icon:"dxi dxi-magnify",id:"search",css:"search-input",width:200},{type:"title",value:"",id:"results"},{icon:"dxi dxi-chevron-up",id:"prev"},{icon:"dxi dxi-chevron-down",id:"next"},{type:"separator"},{icon:"dxi dxi-close",id:"close"}],css:"dhx-spreadsheet-form-search-form"}),this._modal.attach(this._toolbar),this._initHandlers();}return e.prototype.hide=function(){this._modal.isVisible()&&(this._modal.hide(),this._selection._removeSearchCell());},e.prototype.research=function(e){e!==this._page&&(this._page=e),this._data=this._page.serialize().map((function(e){var t=e[0],i=e[1],o=e[2],r=o.value,a=o.format;return [t,i,n(n({},o),{value:h.getFormattedValue(r,a)})]})),this.search(this._searchText);},e.prototype.show=function(e){this.research(e),this._modal.show(),this._toolbar.setState({search:""}),this._toolbar.disable(["next","prev"]);},e.prototype.isVisible=function(){return this._modal.isVisible()},e.prototype.search=function(e,t){var i=this;t&&this._page!==t&&this.research(t),this._toolbar.getState().search!==e&&(this._searchText=e,this._toolbar.setState({search:e})),this._filtered=[],e&&(this._filtered=this._data.filter((function(t){var n=t[0],o=(t[1],t[2].value);return !i._grid.isRowHidden(n+1)&&(!e||l.isDefined(o)&&(""+o).toLowerCase().includes(e.toLowerCase()))})));var n=this._filtered.map((function(e){return c.getCellNameById(i._spreadsheet._grid,e[0]+1,e[1]+1)}));return this._modal.isVisible()?(n.length?this._selection._setSearchedArray(n):this._selection._removeSearchCell(),this._stepIndex=0,this.next(),e?this._toolbar.enable(["next","prev"]):(this._toolbar.disable(["next","prev"]),this._selection._removeSearchCell()),n):n},e.prototype.next=function(){var e=this._filtered.length;this._toolbar.data.update("results",{value:(e?this._stepIndex+1:0)+"/"+e}),this._updateWindowPos(),e&&(this._stepIndex++,this._stepIndex>=e&&(this._stepIndex=0),this._selection._setSearchCell(this._stepIndex));},e.prototype.prev=function(){var e=this._filtered.length;this._toolbar.data.update("results",{value:(e?this._stepIndex+1:0)+"/"+e}),this._updateWindowPos(),e&&(this._stepIndex--,this._stepIndex<0&&(this._stepIndex=e-1),this._toolbar.data.update("results",{value:this._stepIndex+1+"/"+e}),this._selection._setSearchCell(this._stepIndex));},e.prototype.destructor=function(){document.removeEventListener("keydown",this._keyHandler);},e.prototype._updateWindowPos=function(){var e=this;u.awaitRedraw().then((function(){var t=e._modal.getSize();e._modal.setPosition(window.innerWidth-t.width-1,0);}));},e.prototype._keyHandler=function(e){if("Escape"===e.code&&(e.preventDefault(),this.hide()),"KeyG"===e.code){var t=e.ctrlKey||e.metaKey;t&&!e.shiftKey&&(e.preventDefault(),this.next()),t&&e.shiftKey&&(e.preventDefault(),this.prev());}},e.prototype._initHandlers=function(){var e=this;this._toolbar.events.on(s.NavigationBarEvents.click,(function(t){switch(t){case"prev":e.prev();break;case"close":e.hide();break;case"next":e.next();}})),this._toolbar.events.on(s.NavigationBarEvents.inputChange,(function(t,i){e._searchText=i,e.search(i);})),this._modal.events.on(d.WindowEvents.afterShow,(function(){u.awaitRedraw().then((function(){var t=e._toolbar.getRootNode().querySelector("input");null==t||t.focus(),null==t||t.setAttribute("autocomplete","off"),e._toolbar.select("search");}));})),document.addEventListener("keydown",this._keyHandler.bind(this)),this._events.on(a.SpreadsheetEvents.afterSheetChange,(function(){e.isVisible()&&e.research(e._spreadsheet._activePage);})),this._events.on(a.SpreadsheetEvents.afterAction,(function(){e.isVisible()&&e.research(e._spreadsheet._activePage);}));},e}();t.SearchForm=f;},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(58),o=i(46),r=i(10),a=i(8),s=i(5),l=i(30),c=i(2),u=i(22),d=i(16),h=i(0),f=i(107),p=function(){function e(e,t,i){this._set=t,this._events=i,this._grid=e,this._modal=new o.Window({title:r.default.insert+" "+r.default.link.toLowerCase(),movable:!0,closable:!0,css:"dhx-spreadsheet-form-link",height:300,width:300}),this._form=new n.Form("",{padding:15,rows:[{name:"text",type:"input",label:r.default.text,labelPosition:"top",width:270,placeholder:r.default.text},{name:"href",type:"input",label:r.default.link,labelPosition:"top",width:270,placeholder:r.default.link},{align:"end",css:"dhx-button-wrapper",cols:[{type:"button",text:r.default.cancel,id:"cancel",view:"link"},{type:"button",text:r.default.save,id:"save"}]}]}),this._popup=new a.Popup({css:"dhx-spreadsheet-form-link dhx_editor-popup"}),this._toolbar=new l.Toolbar(void 0,{css:"dhx_link-toolbar",data:[{type:"customHTML",html:"",css:"dhx_spreadsheet_link href-link",id:"link"},{icon:"dxi dxi-file-outline",tooltip:r.default.copy.toLowerCase(),circle:!0,id:"copy"},{icon:"dxi dxi-pencil",tooltip:r.default.edit.toLowerCase(),circle:!0,id:"edit"},{icon:"dxi dxi-link-variant-off",tooltip:(r.default.remove+" "+r.default.link).toLowerCase(),circle:!0,id:"unlink"}]}),this._modal.attach(this._form),this._popup.attach(this._toolbar),this._initHandlers();}return e.prototype.hide=function(){this._modal.isVisible()&&this._modal.hide(),this._form.setValue({text:"",href:""}),this._debounds=!1,this._events.fire(s.SpreadsheetEvents.afterPopupHide);},e.prototype.isVisible=function(){return this._modal.isVisible()},e.prototype.destructor=function(){this._form.destructor(),this._modal.destructor(),this._popup.destructor(),this._toolbar.destructor();},e.prototype.show=function(e,t){var i=this;this._modal.isVisible()||this._modal.show(),this._cell=e;var n=t.value,o=t.link||{},r=o.href,a=o.text,s=!r&&c.isURL(n)?n:r;this._form.setValue({text:a||n,href:s}),this.toogleSaveButton((null==s?void 0:s.toString())||""),h.awaitRedraw().then((function(){i.hideInfo();}));},e.prototype.showInfo=function(e,t){if(!this._popup.isVisible()){this._cell=e,this._cellMeta=t;var i=t.link,n=t.value,o=t.locked,r=void 0!==o&&o,a=null==i?void 0:i.href;if(!a)a=(""+n).split(" ").find((function(e){return c.isURL(e)}));this.toogleLocked(r),a&&(this._toolbarLink=a,this._toolbar.data.update("link",{html:'<a href="'+a+'" target="blank">'+a+"</a>"}),this._popup.show(c.getCellNode(e,this._grid,!0)));}},e.prototype.hideInfo=function(){this._popup.isVisible()&&(this._popup.hide(),this._toolbarLink=null,this._cellMeta=null,this._events.fire(s.SpreadsheetEvents.afterPopupHide));},e.prototype._keyHandler=function(e){var t=this;"Escape"===e.code&&(e.preventDefault(),this.hide()),"Enter"===e.code&&(e.preventDefault(),this._form.blur("href"),this._form.blur("text"),this._debounds||(this._debounds=setTimeout((function(){t._save(),t._debounds=!1;}),200)));},e.prototype._save=function(){var e=this._form.getValue(),t=e.text,i=e.href;(i=f.sanitize(i)).startsWith("http")||(i="http://"+i,this._form.setValue({href:i})),this._form.validate()?(this._set(this._cell,i?{text:t,href:i}:void 0),this.hide()):this._form.setFocus("href");},e.prototype.toogleSaveButton=function(e){var t=this._form.getItem("save");e?t.enable():t.disable();},e.prototype.toogleLocked=function(e){e?this._toolbar.disable(["edit","unlink"]):this._toolbar.enable(["edit","unlink"]);},e.prototype._initHandlers=function(){var e=this;this._modal.events.on(a.PopupEvents.afterShow,(function(){e._form.setFocus("href");})),this._form.events.on(n.FormEvents.click,(function(t){if("save"===t)e._save();else e.hide();})),this._form.events.on("keydown",function(e){this._keyHandler(e);}.bind(this)),this._form.getItem("href").events.on("input",(function(t){e.toogleSaveButton(t);})),this._toolbar.events.on(u.NavigationBarEvents.click,(function(t){switch(t){case"copy":window.clipboardData?window.clipboardData.setData("text/plain",e._toolbarLink):navigator.clipboard.writeText(e._toolbarLink),d.message({text:r.default.linkCopied,css:"dhx_message--success",expire:2e3});break;case"edit":e.show(e._cell,e._cellMeta);break;case"unlink":e._set(e._cell);}e.hideInfo();}));},e}();t.LinkForm=p;},function(e,t,i){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)},o=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<i;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)n[o]=r[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var r=i(58),a=i(5),s=i(10),l=i(8),c=i(2),u=i(3),d=i(26),h=i(1),f=i(12),p=i(0),v=function(){function e(e,t){this._grid=e,this._set=t,this._popup=new l.Popup({css:"dhx_editor-popup dhx_filter-popup"});}return e.prototype.hide=function(){var e=this;this._popup.isVisible()&&(this._popup.hide(),p.awaitRedraw().then((function(){return e._form.destructor()})));},e.prototype.show=function(e,t,i,r){var a=this,s=u.locateNode(t,"data-dhx-col-id");this._initForm();var l=i.cell,f=i.rules,p=c.getCellIds(l,this._grid),v=p.start,g=p.end,_=c.getCellIds(e,this._grid),m=_.row,y=_.col;this._filter=n(n({},i),{rules:o(i.rules)}),this._ruleIndex=y-v.col;var b=f[this._ruleIndex],w=m+1,x=r.getCellRange(w,y,g.row,y).map((function(e,t){e=e||{};var i=h.isDefined(e.value)?c.getCellNameByIndex(w+t,y+1,a._grid):"empty";return n(n({},e),{id:i})})),E={};this._hidden=[],this._data=[];var C=[],S=b.condition,I=b.exclude;x.forEach((function(e,t){var i=t+w,o=a._grid.isRowHidden(i+1),r=e||{id:"empty"},s=r.value,l=r.id,c=r.format,u=h.isDefined(I)&&(null==I?void 0:I.find((function(e){return (null==c?void 0:c.id)&&(e="object"==typeof e?d.getExcelDateFromJs(e):d.getExcelDateFromString(e,c)),e===s})));if(o&&!u||C.includes(s))s&&a._hidden.push(e);else {var f=!u;C.push(s),E[l]=f,a._data.push(n(n({},e),{checked:f}));}})),this._setCheckboxes();var k=this._controls,M=k.input,P=k.condition,O=k.checkboxes,A=k.search;if(O.setValue(E),this._checkboxesState=O.getValue(),M.hide(),M.setValue(""),A.setValue(""),null==S?void 0:S.factor){var D=S.factor,F=S.value;this._updateStateByCondition(D,F);}else P.setValue("1"),M.hide();this._popup.show(s),this._initValue=this._form.getValue();},e.prototype.apply=function(){var e,t=this,i=this._form.getValue(),n=i.condition,o=i.value,r=i.max,s=[];Object.values(this._checkboxesState).findIndex((function(e){return !e}))>-1&&Object.keys(this._checkboxesState).forEach((function(e){if(!t._checkboxesState[e]){var i=t._data.find((function(t){return t.id==e})).value;s.push(h.isDefined(i)?i:null);}}));var l=o;if(1!==n){switch(n){case a.FilterConditions.tdc:o||(l=null);break;case a.FilterConditions.d:case a.FilterConditions.da:case a.FilterConditions.db:var c=this._controls.datepicker.getValue(!0);c&&(l=d.getExcelDateFromJs(c));break;case a.FilterConditions.ib:case a.FilterConditions.inb:"number"==typeof o&&"number"==typeof r&&(l=[Math.min(o,r),Math.max(o,r)]);break;case a.FilterConditions.e:case a.FilterConditions.ne:l=!0;break;default:l=o;}h.isDefined(l)&&(e={factor:n,value:l});}h.compare(this._initValue,i)||(this._filter.rules[this._ruleIndex]={condition:e,exclude:s},this._set(this._filter.cell,this._filter.rules)),this.hide();},e.prototype._initForm=function(){this._form=new r.Form(null,{css:"dhx_spreadsheet_filter-popup",rows:[{name:"condition",type:"combo",label:s.default.condition+":",labelPosition:"top",readonly:!0,height:70,data:o([{value:s.default.none,id:1}],Object.keys(a.FilterConditions).map((function(e){return {value:s.default[e],id:e}})))},{name:"value",type:"input",placeholder:s.default.value,height:32},{name:"date",type:"datepicker",placeholder:s.default.date,height:32},{type:"text",name:"and",value:s.default.and,height:32},{name:"max",type:"input",inputType:"number",height:32,placeholder:s.default.value},{type:"spacer",height:10},{type:"text",css:"dhx-filter-label",height:32,value:s.default.values+":"},{type:"button",name:"unselect",view:"flat",full:!0,css:"filter-unselect",text:s.default.unselectAll},{type:"button",name:"select",view:"flat",full:!0,hidden:!0,text:s.default.selectAll},{type:"spacer",height:5},{type:"input",name:"search",height:50,icon:"dxi dxi-magnify",autocomplite:!0},{css:"dhx-filter-checkbox-group",rows:[{name:"checkboxes",type:"checkboxGroup",options:{rows:[]}}]},{type:"spacer",height:15},{css:"buttons-wrapper",cols:[{name:"cancel",type:"button",view:"link",text:s.default.cancel},{name:"apply",type:"button",view:"flat",text:s.default.apply}]}]});var e=this._form.getItem("select"),t=this._form.getItem("unselect"),i=this._form.getItem("checkboxes"),n=this._form.getItem("condition"),l=this._form.getItem("value"),c=this._form.getItem("search"),u=this._form.getItem("date");this._controls={unselect:t,select:e,checkboxes:i,condition:n,input:l,search:c,datepicker:u},this._checkboxesState={},this._popup.attach(this._form),this._initHandlers();},e.prototype._updateStateByCondition=function(e,t){var i=this._controls,n=i.input,o=i.condition,r=i.datepicker;o.setValue(e);var s=this._form.getItem("max"),l=this._form.getItem("and");switch(s.hide(),l.hide(),r.hide(),n.setValue(t),e){case a.FilterConditions.d:case a.FilterConditions.da:case a.FilterConditions.db:r.show(),r.setValue(h.isNumeric(t)?d.excelDateToJSDate(t):""),n.hide();break;case a.FilterConditions.e:case a.FilterConditions.ne:n.hide();break;case a.FilterConditions.tc:case a.FilterConditions.tdc:case a.FilterConditions.ts:case a.FilterConditions.te:case a.FilterConditions.tex:n.setProperties({inputType:"text"}),n.setValue(t),n.show();break;case a.FilterConditions.ib:case a.FilterConditions.inb:l.show(),s.setValue(null==t?void 0:t[1]),s.show();case a.FilterConditions.gt:case a.FilterConditions.geq:case a.FilterConditions.lt:case a.FilterConditions.leq:case a.FilterConditions.eq:case a.FilterConditions.neq:n.setProperties({inputType:"number"}),n.setValue(t instanceof Array?t[0]:t),n.show();break;default:n.hide();}},e.prototype.applyFilter=function(e){var t=this,i=e.getMeta().filter;if(this._grid.data.getInitialData().forEach((function(e){var i=e.id;t._grid.isRowHidden(i)&&t._showRow(i);})),!i)return this._grid.paint(),void this._updateGridData();for(var o=i.cell,r=i.rules,s=c.getCellIds(o,this._grid),l=s.start,u=s.end,p=0,v=u.col,g=u.row,_=l.row+1,m=function(i){var o=r[p],s=o.exclude,l=o.condition;p++;var c=e.getCellRange(_,i,g,i).map((function(e,t){var i=t+_+1;return n(n({},e),{rowId:i})}));if(s&&(c=c.filter((function(e,i){var o=n(n({},e),{value:h.isDefined(null==e?void 0:e.value)?e.value:null}),r=o.format,a=s.find((function(e){return "date"===(null==r?void 0:r.id)&&(e="object"==typeof e?d.getExcelDateFromJs(e):d.getExcelDateFromString(e,r)),o.value===e})),l=i+_+1;return a&&!t._grid.isRowHidden(l)&&t._hideRow(l),!a}))),l){var u=l.factor,v=l.value;c.forEach((function(e){var i,n=e||{},o=n.value,r=n.format,s=n.rowId,l=f.getFormattedValue(o,r);switch(u){case a.FilterConditions.d:case a.FilterConditions.da:case a.FilterConditions.db:v="object"==typeof v?d.getExcelDateFromJs(v):d.getExcelDateFromString(v,r),l=o;}switch(u){case a.FilterConditions.e:i=h.isDefined(o);break;case a.FilterConditions.ne:i=!h.isDefined(o);break;case a.FilterConditions.tc:i=v&&!o||o&&!(""+l).toLowerCase().includes(v.toLowerCase());break;case a.FilterConditions.tdc:i=o&&(""+l).toLowerCase().includes(v.toLowerCase());break;case a.FilterConditions.ts:i=o&&!(""+l).toLowerCase().startsWith(v.toLowerCase());break;case a.FilterConditions.te:i=o&&!(""+l).toLowerCase().endsWith(v.toLowerCase());break;case a.FilterConditions.tex:i=h.isNumeric(l)||""+l!==v;break;case a.FilterConditions.d:i=!h.isDefined(o)||!h.isNumeric(o)||Math.trunc(o)!==Math.trunc(v);break;case a.FilterConditions.db:i=!h.isDefined(o)||!h.isNumeric(o)||Math.trunc(o)>=Math.trunc(v);break;case a.FilterConditions.da:i=!h.isDefined(o)||!h.isNumeric(o)||Math.trunc(o)<=Math.trunc(v);break;case a.FilterConditions.gt:i=!h.isDefined(o)||!h.isNumeric(o)||o<=v;break;case a.FilterConditions.lt:i=!h.isDefined(o)||!h.isNumeric(o)||o>=v;break;case a.FilterConditions.geq:i=!h.isDefined(o)||!h.isNumeric(o)||o<v;break;case a.FilterConditions.leq:i=!h.isDefined(o)||!h.isNumeric(o)||o>v;break;case a.FilterConditions.eq:i=!h.isDefined(o)||!h.isNumeric(o)||o!==v;break;case a.FilterConditions.neq:i=!h.isDefined(o)||!h.isNumeric(o)||o===v;break;case a.FilterConditions.ib:i=!h.isDefined(o)||!h.isNumeric(o)||o<v[0]||o>v[1];break;case a.FilterConditions.inb:i=!h.isDefined(o)||!h.isNumeric(o)||o>=v[0]&&o<=v[1];}i&&!t._grid.isRowHidden(s)&&t._hideRow(s);}));}},y=l.col;y<=v;y++)m(y);this._updateGridData(),this._grid.paint();},e.prototype._showRow=function(e){this._grid.data.update(e,{hidden:!1},!0);},e.prototype._hideRow=function(e){this._grid.data.update(e,{hidden:!0},!0);},e.prototype._updateGridData=function(){this._grid.data.filter((function(e){return !e.hidden}));},e.prototype._updateButton=function(e){var t=this._controls,i=t.select,n=t.unselect;p.awaitRedraw().then((function(){e?(n.show(),i.hide()):(n.hide(),i.show());}));},e.prototype._setCheckboxes=function(e){void 0===e&&(e="");var t=this._data.filter((function(t){var i=t.value,n=t.format;return !e||(""+f.getFormattedValue(i,n)).toLocaleLowerCase().includes(e.toLocaleLowerCase())})).map((function(e){var t=e.value,i=e.checked,n=e.id,o=e.format,r=f.getFormattedValue(t,o);return {type:"checkbox",text:null!=r?r:"("+s.default.empty+")",id:n,checked:i}}));this._form.getItem("checkboxes").setProperties({options:{rows:o(t)}});},e.prototype._selectAll=function(e){var t=this,i=this._controls.checkboxes;Object.keys(this._checkboxesState).forEach((function(i){return t._checkboxesState[i]=e})),i.setValue(this._checkboxesState),this._updateButton(e);},e.prototype._initHandlers=function(){var e=this,t=this._controls,i=t.condition,o=t.search,a=t.checkboxes,s=t.datepicker,c=i.getWidget();this._form.events.on(r.FormEvents.change,(function(t,i){switch(t){case"condition":e._updateStateByCondition(i);break;case"checkboxes":e._checkboxesState=n(n({},e._checkboxesState),i);var o=Object.values(e._checkboxesState).findIndex((function(e){return !e}));e._updateButton(o<0);}})),o.events.on("input",(function(t){e._setCheckboxes(""+t),a.setValue(e._checkboxesState);})),this._form.events.on(r.FormEvents.click,(function(t){switch(t){case"unselect":case"select":e._selectAll("select"===t);break;case"apply":e.apply();break;case"cancel":e.hide();}}));var u=c.popup.getContainer(),d=s._popup.getContainer();this._popup.events.on(l.PopupEvents.beforeHide,(function(e,t){if(e){var i=(null==t?void 0:t.target).closest(".dhx_popup-content");if(e&&(i===u||i===d))return !1}}));},e}();t.FilterForm=v;},function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0});var n=i(5),o=i(2),r=i(10),a=function(){function e(e,t,i,n){this._callAction=e,this._config=t,this._grid=i,this._isLocked=n;}return e.prototype.doAction=function(e,t){if(this.checkBeforeMerge(e,t)){var i=n.Actions[t?"unmerge":"merge"];this._callAction({action:i,groupAction:i,cell:e});}},e.prototype.checkBeforeMerge=function(e,t){var i=this;if(!o.isRangeId(e)&&!t)return !1;var n=this._config,a=n.topSplit,s=n.leftSplit;return !a&&!s||o.checkSpanByNames(e,s,a,this._grid)?!o.getCellsArray(e,this._grid).find((function(e){return i._isLocked(e)}))||(o.showAlert(r.default[t?"spanUnmergeLockedError":"spanMergeLockedError"]),!1):(o.showAlert(r.default.spanMergeAlert),!1)},e.prototype.checkBeforeAction=function(e,t,i){var n,a=t.getMeta().merged;if(o.getCellsArray(e,this._grid).forEach((function(e){var t=o.isCellSpaned(e,a);t&&(n=t);}),e),n){var s=r.default.mergeAlertMessage.split("$action");return o.showAlert(s[0]+" "+i.toLowerCase()+" "+(s[1]||"")),!1}return !0},e}();t.Merge=a;}])})),window.dhx_legacy){if(window.dhx)for(var key in dhx)dhx_legacy[key]=dhx[key];window.dhx=dhx_legacy,delete window.dhx_legacy;} 
    } (spreadsheet_min));

    var spreadsheet_minExports = spreadsheet_min.exports;

    /* src/Spreadsheet.svelte generated by Svelte v3.59.2 */
    const file = "src/Spreadsheet.svelte";

    function create_fragment$1(ctx) {
    	let div;

    	const block = {
    		c: function create() {
    			div = element("div");
    			set_style(div, "width", "100%");
    			set_style(div, "height", "100%");
    			add_location(div, file, 18, 0, 423);
    		},
    		l: function claim(nodes) {
    			throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option");
    		},
    		m: function mount(target, anchor) {
    			insert_dev(target, div, anchor);
    			/*div_binding*/ ctx[3](div);
    		},
    		p: noop,
    		i: noop,
    		o: noop,
    		d: function destroy(detaching) {
    			if (detaching) detach_dev(div);
    			/*div_binding*/ ctx[3](null);
    		}
    	};

    	dispatch_dev("SvelteRegisterBlock", {
    		block,
    		id: create_fragment$1.name,
    		type: "component",
    		source: "",
    		ctx
    	});

    	return block;
    }

    function instance$1($$self, $$props, $$invalidate) {
    	let { $$slots: slots = {}, $$scope } = $$props;
    	validate_slots('Spreadsheet', slots, []);
    	let { data } = $$props;
    	let spreadsheet;
    	let container;

    	onMount(() => {
    		$$invalidate(2, spreadsheet = new spreadsheet_minExports.Spreadsheet(container, {}));

    		spreadsheet.events.on("ActionName", () => {
    			
    		});
    	});

    	$$self.$$.on_mount.push(function () {
    		if (data === undefined && !('data' in $$props || $$self.$$.bound[$$self.$$.props['data']])) {
    			console.warn("<Spreadsheet> was created without expected prop 'data'");
    		}
    	});

    	const writable_props = ['data'];

    	Object.keys($$props).forEach(key => {
    		if (!~writable_props.indexOf(key) && key.slice(0, 2) !== '$$' && key !== 'slot') console.warn(`<Spreadsheet> was created with unknown prop '${key}'`);
    	});

    	function div_binding($$value) {
    		binding_callbacks[$$value ? 'unshift' : 'push'](() => {
    			container = $$value;
    			$$invalidate(0, container);
    		});
    	}

    	$$self.$$set = $$props => {
    		if ('data' in $$props) $$invalidate(1, data = $$props.data);
    	};

    	$$self.$capture_state = () => ({
    		onMount,
    		Spreadsheet: spreadsheet_minExports.Spreadsheet,
    		data,
    		spreadsheet,
    		container
    	});

    	$$self.$inject_state = $$props => {
    		if ('data' in $$props) $$invalidate(1, data = $$props.data);
    		if ('spreadsheet' in $$props) $$invalidate(2, spreadsheet = $$props.spreadsheet);
    		if ('container' in $$props) $$invalidate(0, container = $$props.container);
    	};

    	if ($$props && "$$inject" in $$props) {
    		$$self.$inject_state($$props.$$inject);
    	}

    	$$self.$$.update = () => {
    		if ($$self.$$.dirty & /*spreadsheet, data*/ 6) {
    			spreadsheet?.parse(data);
    		}
    	};

    	return [container, data, spreadsheet, div_binding];
    }

    class Spreadsheet_1 extends SvelteComponentDev {
    	constructor(options) {
    		super(options);
    		init(this, options, instance$1, create_fragment$1, safe_not_equal, { data: 1 });

    		dispatch_dev("SvelteRegisterComponent", {
    			component: this,
    			tagName: "Spreadsheet_1",
    			options,
    			id: create_fragment$1.name
    		});
    	}

    	get data() {
    		throw new Error("<Spreadsheet>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'");
    	}

    	set data(value) {
    		throw new Error("<Spreadsheet>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'");
    	}
    }

    function getData() {
      return {
        sheets: [
          {
            name: "Boolean",
            data: [
              {
                cell: "A1",
                css: "header",
                format: "common",
                value: "Formula name",
              },
              {
                cell: "B1",
                css: "header",
                format: "common",
                value: "Formula example",
              },
              {
                cell: "C1",
                css: "header",
                format: "common",
                value: "Data for formula",
              },
              {
                cell: "A2",
                css: "header",
                format: "common",
                value: "Boolean",
              },
              {
                cell: "A3",
                css: "highlighting",
                format: "common",
                value: "Equal to",
              },
              {
                cell: "B3",
                format: "common",
                value: "=C3=D3",
              },
              {
                cell: "C3",
                format: "number",
                value: 5,
              },
              {
                cell: "D3",
                format: "number",
                value: 5,
              },
              {
                cell: "A4",
                css: "highlighting",
                format: "common",
                value: "Greater than",
              },
              {
                cell: "B4",
                format: "common",
                value: "=C4>D4",
              },
              {
                cell: "C4",
                format: "number",
                value: 7,
              },
              {
                cell: "D4",
                format: "number",
                value: 5,
              },
              {
                cell: "A5",
                css: "highlighting",
                format: "common",
                value: "Greater than or equal to",
              },
              {
                cell: "B5",
                format: "common",
                value: "=C5>=D5",
              },
              {
                cell: "C5",
                format: "number",
                value: 7,
              },
              {
                cell: "D5",
                format: "number",
                value: 5,
              },
              {
                cell: "A6",
                css: "highlighting",
                format: "common",
                value: "Less than",
              },
              {
                cell: "B6",
                format: "common",
                value: "=C6<D6",
              },
              {
                cell: "C6",
                format: "number",
                value: 5,
              },
              {
                cell: "D6",
                format: "number",
                value: 7,
              },
              {
                cell: "A7",
                css: "highlighting",
                format: "common",
                value: "Less than or equal to",
              },
              {
                cell: "B7",
                format: "common",
                value: "=C7<=D7",
              },
              {
                cell: "C7",
                format: "number",
                value: 5,
              },
              {
                cell: "D7",
                format: "number",
                value: 7,
              },
              {
                cell: "A8",
                css: "highlighting",
                format: "common",
                value: "Not equal to",
              },
              {
                cell: "B8",
                format: "common",
                value: "=C8<>D8",
              },
              {
                cell: "C8",
                format: "number",
                value: 5,
              },
              {
                cell: "D8",
                format: "number",
                value: 5,
              },
            ],
            cols: [
              {
                width: 180,
              },
            ],
            rows: [],
          },
          {
            name: "Date",
            data: [
              {
                cell: "A1",
                css: "header",
                format: "common",
                value: "Formula name",
              },
              {
                cell: "B1",
                css: "header",
                format: "common",
                value: "Formula example",
              },
              {
                cell: "C1",
                css: "header",
                format: "common",
                value: "Data for formula",
              },
              {
                cell: "A2",
                css: "header",
                format: "common",
                value: "Date",
              },
              {
                cell: "A3",
                css: "highlighting",
                format: "common",
                value: "DATE",
              },
              {
                cell: "B3",
                format: "date",
                value: "=DATE(C3;D3;E3)",
              },
              {
                cell: "C3",
                format: "common",
                value: 2021,
              },
              {
                cell: "D3",
                format: "number",
                value: 11,
              },
              {
                cell: "E3",
                format: "number",
                value: 1,
              },
              {
                cell: "A4",
                css: "highlighting",
                format: "common",
                value: "DATEDIF",
              },
              {
                cell: "B4",
                format: "common",
                value: "=DATEDIF(C4;D4;E4)",
              },
              {
                cell: "C4",
                format: "date",
                value: 44136.125,
              },
              {
                cell: "D4",
                format: "date",
                value: 44501,
              },
              {
                cell: "E4",
                format: "common",
                value: "M",
              },
              {
                cell: "A5",
                css: "highlighting",
                format: "common",
                value: "DATEVALUE",
              },
              {
                cell: "B5",
                format: "date",
                value: "=DATEVALUE(C5)",
              },
              {
                cell: "C5",
                format: "common",
                value: "3/10/1975",
              },
              {
                cell: "A6",
                css: "highlighting",
                format: "common",
                value: "DAY",
              },
              {
                cell: "B6",
                format: "common",
                value: "=DAY(C6)",
              },
              {
                cell: "C6",
                format: "date",
                value: 44501,
              },
              {
                cell: "A7",
                css: "highlighting",
                format: "common",
                value: "DAYS",
              },
              {
                cell: "B7",
                format: "common",
                value: "=DAYS(C7;D7)",
              },
              {
                cell: "C7",
                format: "date",
                value: 44501,
              },
              {
                cell: "D7",
                format: "date",
                value: 44136.125,
              },
              {
                cell: "A8",
                css: "highlighting",
                format: "common",
                value: "DAYS360",
              },
              {
                cell: "B8",
                format: "common",
                value: "=DAYS360(C8;D8)",
              },
              {
                cell: "C8",
                format: "date",
                value: 44136.125,
              },
              {
                cell: "D8",
                format: "date",
                value: 44501,
              },
              {
                cell: "A9",
                css: "highlighting",
                format: "common",
                value: "EDATE",
              },
              {
                cell: "B9",
                format: "date",
                value: "=EDATE(C9;D9)",
              },
              {
                cell: "C9",
                format: "date",
                value: 44136.125,
              },
              {
                cell: "D9",
                format: "number",
                value: 24,
              },
              {
                cell: "A10",
                css: "highlighting",
                format: "common",
                value: "EOMONTH",
              },
              {
                cell: "B10",
                format: "date",
                value: "=EOMONTH(C10;D10)",
              },
              {
                cell: "C10",
                format: "date",
                value: 44136.125,
              },
              {
                cell: "D10",
                format: "number",
                value: 1,
              },
              {
                cell: "A11",
                css: "highlighting",
                format: "common",
                value: "ISOWEEKNUM",
              },
              {
                cell: "B11",
                format: "common",
                value: "=ISOWEEKNUM(C11)",
              },
              {
                cell: "C11",
                format: "date",
                value: 44136.125,
              },
              {
                cell: "A12",
                css: "highlighting",
                format: "common",
                value: "MONTH",
              },
              {
                cell: "B12",
                format: "common",
                value: "=MONTH(C12)",
              },
              {
                cell: "C12",
                format: "date",
                value: 44501,
              },
              {
                cell: "A13",
                css: "highlighting",
                format: "common",
                value: "NETWORKDAYS",
              },
              {
                cell: "B13",
                format: "common",
                value: "=NETWORKDAYS(C13;D13)",
              },
              {
                cell: "C13",
                format: "date",
                value: 44136.125,
              },
              {
                cell: "D13",
                format: "date",
                value: 44501,
              },
              {
                cell: "A14",
                css: "highlighting",
                format: "common",
                value: "NETWORKDAYS.INTL",
              },
              {
                cell: "B14",
                format: "common",
                value: "=NETWORKDAYS.INTL(C14;D14;E14)",
              },
              {
                cell: "C14",
                format: "date",
                value: 44136.125,
              },
              {
                cell: "D14",
                format: "date",
                value: 44501,
              },
              {
                cell: "E14",
                format: "number",
                value: 1,
              },
              {
                cell: "A15",
                css: "highlighting",
                format: "common",
                value: "NOW",
              },
              {
                cell: "B15",
                format: "date",
                value: "=NOW()",
              },
              {
                cell: "A16",
                css: "highlighting",
                format: "common",
                value: "TIMEVALUE",
              },
              {
                cell: "B16",
                format: "common",
                value: "=TIMEVALUE(C16)",
              },
              {
                cell: "C16",
                format: "text",
                value: "14:15:30",
              },
              {
                cell: "A17",
                css: "highlighting",
                format: "common",
                value: "WEEKDAY",
              },
              {
                cell: "B17",
                format: "common",
                value: "=WEEKDAY(C17)",
              },
              {
                cell: "C17",
                format: "date",
                value: 44501,
              },
              {
                cell: "A18",
                css: "highlighting",
                format: "common",
                value: "WEEKNUM",
              },
              {
                cell: "B18",
                format: "common",
                value: "=WEEKNUM(C18)",
              },
              {
                cell: "C18",
                format: "date",
                value: 44501,
              },
              {
                cell: "A19",
                css: "highlighting",
                format: "common",
                value: "WORKDAY",
              },
              {
                cell: "B19",
                format: "date",
                value: "=WORKDAY(C19,D19)",
              },
              {
                cell: "C19",
                format: "date",
                value: 44501,
              },
              {
                cell: "D19",
                format: "number",
                value: 5,
              },
              {
                cell: "A20",
                css: "highlighting",
                format: "common",
                value: "WORKDAY.INTL",
              },
              {
                cell: "B20",
                format: "date",
                value: "=WORKDAY.INTL(C20;D20;E20)",
              },
              {
                cell: "C20",
                format: "date",
                value: 44136.125,
              },
              {
                cell: "D20",
                format: "number",
                value: 2,
              },
              {
                cell: "E20",
                format: "number",
                value: 2,
              },
              {
                cell: "A21",
                css: "highlighting",
                format: "common",
                value: "YEAR",
              },
              {
                cell: "B21",
                format: "common",
                value: "=YEAR(C21)",
              },
              {
                cell: "C21",
                format: "date",
                value: 44501,
              },
              {
                cell: "A22",
                css: "highlighting",
                format: "common",
                value: "YEARFRAC",
              },
              {
                cell: "B22",
                format: "common",
                value: "=YEARFRAC(C22;D22;E22)",
              },
              {
                cell: "C22",
                format: "date",
                value: 44136.125,
              },
              {
                cell: "D22",
                format: "date",
                value: 44501,
              },
              {
                cell: "E22",
                format: "number",
                value: 0,
              },
            ],
            cols: [
              {
                width: 180,
              },
            ],
            rows: [],
          },
          {
            name: "Financial",
            data: [
              {
                cell: "A1",
                css: "header",
                format: "common",
                value: "Formula name",
              },
              {
                cell: "B1",
                css: "header",
                format: "common",
                value: "Formula example",
              },
              {
                cell: "C1",
                css: "header",
                format: "common",
                value: "Data for formula",
              },
              {
                cell: "A2",
                css: "header",
                format: "common",
                value: "Financial",
              },
              {
                cell: "A3",
                css: "highlighting",
                format: "common",
                value: "ACCRINT",
              },
              {
                cell: "B3",
                format: "common",
                value: "=ACCRINT(C3;D3;E3;F3;G3;H3)",
              },
              {
                cell: "C3",
                format: "number",
                value: 39508,
              },
              {
                cell: "D3",
                format: "number",
                value: 39691,
              },
              {
                cell: "E3",
                format: "number",
                value: 39569,
              },
              {
                cell: "F3",
                format: "number",
                value: 0.1,
              },
              {
                cell: "G3",
                format: "number",
                value: 1000,
              },
              {
                cell: "H3",
                format: "number",
                value: 1,
              },
              {
                cell: "A4",
                css: "highlighting",
                format: "common",
                value: "BINOM.DIST",
              },
              {
                cell: "B4",
                format: "common",
                value: "=BINOM.DIST(C4,D4,E4,F4)",
              },
              {
                cell: "C4",
                format: "number",
                value: 30,
              },
              {
                cell: "D4",
                format: "number",
                value: 65,
              },
              {
                cell: "E4",
                format: "percent",
                value: 0.35,
              },
              {
                cell: "F4",
                format: "number",
                value: "TRUE",
              },
              {
                cell: "A5",
                css: "highlighting",
                format: "common",
                value: "BINOM.DIST.RANGE",
              },
              {
                cell: "B5",
                format: "common",
                value: "=BINOM.DIST.RANGE(C5,D5,E5)",
              },
              {
                cell: "C5",
                format: "number",
                value: 60,
              },
              {
                cell: "D5",
                format: "number",
                value: 0.75,
              },
              {
                cell: "E5",
                format: "number",
                value: 48,
              },
              {
                cell: "A6",
                css: "highlighting",
                format: "common",
                value: "BINOM.INV",
              },
              {
                cell: "B6",
                format: "common",
                value: "=BINOM.INV(C6,D6,E6)",
              },
              {
                cell: "C6",
                format: "number",
                value: 100,
              },
              {
                cell: "D6",
                format: "number",
                value: 0.5,
              },
              {
                cell: "E6",
                format: "percent",
                value: 0.2,
              },
              {
                cell: "A7",
                css: "highlighting",
                format: "common",
                value: "BITLSHIFT",
              },
              {
                cell: "B7",
                format: "common",
                value: "=BITLSHIFT(C7,D7)",
              },
              {
                cell: "C7",
                format: "common",
                value: 4,
              },
              {
                cell: "D7",
                format: "common",
                value: 2,
              },
              {
                cell: "A8",
                css: "highlighting",
                format: "common",
                value: "BITOR",
              },
              {
                cell: "B8",
                format: "common",
                value: "=BITOR(C8, D8)",
              },
              {
                cell: "C8",
                format: "common",
                value: 23,
              },
              {
                cell: "D8",
                format: "common",
                value: 10,
              },
              {
                cell: "A9",
                css: "highlighting",
                format: "common",
                value: "BITRSHIFT",
              },
              {
                cell: "B9",
                format: "common",
                value: "=BITRSHIFT(C9,D9)",
              },
              {
                cell: "C9",
                format: "common",
                value: 16,
              },
              {
                cell: "D9",
                format: "common",
                value: 2,
              },
              {
                cell: "A10",
                css: "highlighting",
                format: "common",
                value: "BITXOR",
              },
              {
                cell: "B10",
                format: "common",
                value: "=BITXOR(C10,D10)",
              },
              {
                cell: "C10",
                format: "common",
                value: 5,
              },
              {
                cell: "D10",
                format: "common",
                value: 3,
              },
              {
                cell: "A11",
                css: "highlighting",
                format: "common",
                value: "COMPLEX",
              },
              {
                cell: "B11",
                format: "common",
                value: "=COMPLEX(C11,D11)",
              },
              {
                cell: "C11",
                format: "common",
                value: 5,
              },
              {
                cell: "D11",
                format: "common",
                value: 2,
              },
              {
                cell: "A12",
                css: "highlighting",
                format: "common",
                value: "CORREL",
              },
              {
                cell: "B12",
                format: "common",
                value: "=CORREL(C12:G12,I12:M12)",
              },
              {
                cell: "C12",
                format: "common",
                value: 3,
              },
              {
                cell: "D12",
                format: "common",
                value: 2,
              },
              {
                cell: "E12",
                format: "common",
                value: 4,
              },
              {
                cell: "F12",
                format: "common",
                value: 5,
              },
              {
                cell: "G12",
                format: "common",
                value: 6,
              },
              {
                cell: "I12",
                format: "common",
                value: 9,
              },
              {
                cell: "J12",
                format: "common",
                value: 7,
              },
              {
                cell: "K12",
                format: "common",
                value: 12,
              },
              {
                cell: "L12",
                format: "common",
                value: 15,
              },
              {
                cell: "M12",
                format: "common",
                value: 17,
              },
              {
                cell: "A13",
                css: "highlighting",
                format: "common",
                value: "COVAR",
              },
              {
                cell: "B13",
                format: "common",
                value: "=COVAR(C13:G13,I13:M13)",
              },
              {
                cell: "C13",
                format: "common",
                value: 3,
              },
              {
                cell: "D13",
                format: "common",
                value: 2,
              },
              {
                cell: "E13",
                format: "common",
                value: 4,
              },
              {
                cell: "F13",
                format: "common",
                value: 5,
              },
              {
                cell: "G13",
                format: "common",
                value: 6,
              },
              {
                cell: "H13",
                format: "common",
              },
              {
                cell: "I13",
                format: "common",
                value: 9,
              },
              {
                cell: "J13",
                format: "common",
                value: 7,
              },
              {
                cell: "K13",
                format: "common",
                value: 12,
              },
              {
                cell: "L13",
                format: "common",
                value: 15,
              },
              {
                cell: "M13",
                format: "common",
                value: 17,
              },
              {
                cell: "A14",
                css: "highlighting",
                format: "common",
                value: "COVARIANCE.P",
              },
              {
                cell: "B14",
                format: "common",
                value: "=COVARIANCE.P(C14:G14,I14:M14)",
              },
              {
                cell: "C14",
                format: "common",
                value: 3,
              },
              {
                cell: "D14",
                format: "common",
                value: 2,
              },
              {
                cell: "E14",
                format: "common",
                value: 4,
              },
              {
                cell: "F14",
                format: "common",
                value: 5,
              },
              {
                cell: "G14",
                format: "common",
                value: 6,
              },
              {
                cell: "H14",
                format: "common",
              },
              {
                cell: "I14",
                format: "common",
                value: 9,
              },
              {
                cell: "J14",
                format: "common",
                value: 7,
              },
              {
                cell: "K14",
                format: "common",
                value: 12,
              },
              {
                cell: "L14",
                format: "common",
                value: 15,
              },
              {
                cell: "M14",
                format: "common",
                value: 17,
              },
              {
                cell: "A15",
                css: "highlighting",
                format: "common",
                value: "COVARIANCE.S",
              },
              {
                cell: "B15",
                format: "common",
                value: "=COVARIANCE.S(C15:G15,I15:M15)",
              },
              {
                cell: "C15",
                format: "common",
                value: 3,
              },
              {
                cell: "D15",
                format: "common",
                value: 2,
              },
              {
                cell: "E15",
                format: "common",
                value: 4,
              },
              {
                cell: "F15",
                format: "common",
                value: 5,
              },
              {
                cell: "G15",
                format: "common",
                value: 6,
              },
              {
                cell: "H15",
                format: "common",
              },
              {
                cell: "I15",
                format: "common",
                value: 9,
              },
              {
                cell: "J15",
                format: "common",
                value: 7,
              },
              {
                cell: "K15",
                format: "common",
                value: 12,
              },
              {
                cell: "L15",
                format: "common",
                value: 15,
              },
              {
                cell: "M15",
                format: "common",
                value: 17,
              },
              {
                cell: "A16",
                css: "highlighting",
                format: "common",
                value: "DB",
              },
              {
                cell: "B16",
                format: "common",
                value: "=DB(C16;D16;E16;F16;G16)",
              },
              {
                cell: "C16",
                format: "number",
                value: 10000,
              },
              {
                cell: "D16",
                format: "number",
                value: 5000,
              },
              {
                cell: "E16",
                format: "number",
                value: 5,
              },
              {
                cell: "F16",
                format: "number",
                value: 1,
              },
              {
                cell: "G16",
                format: "number",
                value: 12,
              },
              {
                cell: "A17",
                css: "highlighting",
                format: "common",
                value: "DDB",
              },
              {
                cell: "B17",
                format: "common",
                value: "=DDB(C17;D17;E17;F17;G17)",
              },
              {
                cell: "C17",
                format: "number",
                value: 3500,
              },
              {
                cell: "D17",
                format: "number",
                value: 500,
              },
              {
                cell: "E17",
                format: "number",
                value: 5,
              },
              {
                cell: "F17",
                format: "number",
                value: 1,
              },
              {
                cell: "G17",
                format: "number",
                value: 2,
              },
              {
                cell: "A18",
                css: "highlighting",
                format: "common",
                value: "DEC2BIN",
              },
              {
                cell: "B18",
                format: "common",
                value: "=DEC2BIN(C18)",
              },
              {
                cell: "C18",
                format: "common",
                value: 9,
              },
              {
                cell: "A19",
                css: "highlighting",
                format: "common",
                value: "DEC2HEX",
              },
              {
                cell: "B19",
                format: "number",
                value: "=DEC2HEX(C19)",
              },
              {
                cell: "C19",
                format: "common",
                value: -54,
              },
              {
                cell: "A20",
                css: "highlighting",
                format: "common",
                value: "DEC2OCT",
              },
              {
                cell: "B20",
                format: "common",
                value: "=DEC2OCT(C20,D20)",
              },
              {
                cell: "C20",
                format: "common",
                value: 58,
              },
              {
                cell: "D20",
                format: "common",
                value: 3,
              },
              {
                cell: "A21",
                css: "highlighting",
                format: "common",
                value: "DELTA",
              },
              {
                cell: "B21",
                format: "common",
                value: "=DELTA(C21,D21)",
              },
              {
                cell: "C21",
                format: "common",
                value: 4,
              },
              {
                cell: "D21",
                format: "common",
                value: 5,
              },
              {
                cell: "A22",
                css: "highlighting",
                format: "common",
                value: "DEVSQ",
              },
              {
                cell: "B22",
                format: "common",
                value: "=DEVSQ(C22:H22)",
              },
              {
                cell: "C22",
                format: "common",
                value: 50,
              },
              {
                cell: "D22",
                format: "common",
                value: 47,
              },
              {
                cell: "E22",
                format: "common",
                value: 52,
              },
              {
                cell: "F22",
                format: "common",
                value: 46,
              },
              {
                cell: "G22",
                format: "common",
                value: 45,
              },
              {
                cell: "H22",
                format: "common",
                value: 48,
              },
              {
                cell: "A23",
                css: "highlighting",
                format: "common",
                value: "DOLLARDE",
              },
              {
                cell: "B23",
                format: "common",
                value: "=DOLLARDE(C23;D23)",
              },
              {
                cell: "C23",
                format: "number",
                value: 1.1,
              },
              {
                cell: "D23",
                format: "number",
                value: 32,
              },
              {
                cell: "A24",
                css: "highlighting",
                format: "common",
                value: "DOLLARFR",
              },
              {
                cell: "B24",
                format: "common",
                value: "=DOLLARFR(C24;D24)",
              },
              {
                cell: "C24",
                format: "number",
                value: 1.125,
              },
              {
                cell: "D24",
                format: "number",
                value: 16,
              },
              {
                cell: "A25",
                css: "highlighting",
                format: "common",
                value: "EFFECT",
              },
              {
                cell: "B25",
                format: "common",
                value: "=EFFECT(C25;D25)",
              },
              {
                cell: "C25",
                format: "percent",
                value: 0.06,
              },
              {
                cell: "D25",
                format: "number",
                value: 2,
              },
              {
                cell: "A26",
                css: "highlighting",
                format: "common",
                value: "ERF",
              },
              {
                cell: "B26",
                format: "common",
                value: "=ERF(C26)",
              },
              {
                cell: "C26",
                format: "common",
                value: 1,
              },
              {
                cell: "A27",
                css: "highlighting",
                format: "common",
                value: "ERFC",
              },
              {
                cell: "B27",
                format: "common",
                value: "=ERFC(C26)",
              },
              {
                cell: "A28",
                css: "highlighting",
                format: "common",
                value: "EXP",
              },
              {
                cell: "B28",
                format: "common",
                value: "=EXP(C26)",
              },
              {
                cell: "A29",
                css: "highlighting",
                format: "common",
                value: "FISHER",
              },
              {
                cell: "B29",
                format: "common",
                value: "=FISHER(C29)",
              },
              {
                cell: "C29",
                format: "common",
                value: 0.75,
              },
              {
                cell: "A30",
                css: "highlighting",
                format: "common",
                value: "FISHERINV",
              },
              {
                cell: "B30",
                format: "common",
                value: "=FISHERINV(C30)",
              },
              {
                cell: "C30",
                format: "common",
                value: 0.97,
              },
              {
                cell: "A31",
                css: "highlighting",
                format: "common",
                value: "FV",
              },
              {
                cell: "B31",
                format: "common",
                value: "=FV(C31/12;D31;E31;F31;G31)",
              },
              {
                cell: "C31",
                format: "number",
                value: 0.06,
              },
              {
                cell: "D31",
                format: "number",
                value: 10,
              },
              {
                cell: "E31",
                format: "number",
                value: -200,
              },
              {
                cell: "F31",
                format: "number",
                value: -500,
              },
              {
                cell: "G31",
                format: "number",
                value: 1,
              },
              {
                cell: "A32",
                css: "highlighting",
                format: "common",
                value: "FVSCHEDULE",
              },
              {
                cell: "B32",
                format: "common",
                value: "=FVSCHEDULE(C32;D32:E32)",
              },
              {
                cell: "C32",
                format: "number",
                value: 100,
              },
              {
                cell: "D32",
                format: "percent",
                value: 0.02,
              },
              {
                cell: "E32",
                format: "percent",
                value: 0.02,
              },
              {
                cell: "A33",
                css: "highlighting",
                format: "common",
                value: "GAMMA",
              },
              {
                cell: "B33",
                format: "common",
                value: "=GAMMA(C33)",
              },
              {
                cell: "C33",
                format: "common",
                value: 2.5,
              },
              {
                cell: "A34",
                css: "highlighting",
                format: "common",
                value: "GEOMEAN",
              },
              {
                cell: "B34",
                format: "common",
                value: "=GEOMEAN(C34:G34)",
              },
              {
                cell: "C34",
                format: "number",
                value: 1,
              },
              {
                cell: "D34",
                format: "number",
                value: 2,
              },
              {
                cell: "E34",
                format: "number",
                value: 3,
              },
              {
                cell: "F34",
                format: "number",
                value: 4,
              },
              {
                cell: "G34",
                format: "number",
                value: 5,
              },
              {
                cell: "A35",
                css: "highlighting",
                format: "common",
                value: "GESTEP",
              },
              {
                cell: "B35",
                format: "common",
                value: "=GESTEP(C35,D35)",
              },
              {
                cell: "C35",
                format: "common",
                value: 5,
              },
              {
                cell: "D35",
                format: "common",
                value: 4,
              },
              {
                cell: "A36",
                css: "highlighting",
                format: "common",
                value: "HARMEAN",
              },
              {
                cell: "B36",
                format: "common",
                value: "=HARMEAN(C36:G36)",
              },
              {
                cell: "C36",
                format: "number",
                value: 1,
              },
              {
                cell: "D36",
                format: "number",
                value: 2,
              },
              {
                cell: "E36",
                format: "number",
                value: 3,
              },
              {
                cell: "F36",
                format: "number",
                value: 4,
              },
              {
                cell: "G36",
                format: "number",
                value: 5,
              },
              {
                cell: "A37",
                css: "highlighting",
                format: "common",
                value: "HEX2BIN",
              },
              {
                cell: "B37",
                format: "common",
                value: "=HEX2BIN(C37)",
              },
              {
                cell: "C37",
                format: "common",
                value: "FF",
              },
              {
                cell: "A38",
                css: "highlighting",
                format: "common",
                value: "HEX2DEC",
              },
              {
                cell: "B38",
                format: "common",
                value: "=HEX2DEC(C38)",
              },
              {
                cell: "C38",
                format: "common",
                value: 10,
              },
              {
                cell: "A39",
                css: "highlighting",
                format: "common",
                value: "HEX2OCT",
              },
              {
                cell: "B39",
                format: "common",
                value: "=HEX2OCT(C39)",
              },
              {
                cell: "C39",
                format: "common",
                value: "3B4E",
              },
              {
                cell: "A40",
                css: "highlighting",
                format: "common",
                value: "IMABS",
              },
              {
                cell: "B40",
                format: "common",
                value: "=IMABS(C40)",
              },
              {
                cell: "C40",
                format: "common",
                value: "5+12i",
              },
              {
                cell: "A41",
                css: "highlighting",
                format: "common",
                value: "IMAGINARY",
              },
              {
                cell: "B41",
                format: "common",
                value: "=IMAGINARY(C41)",
              },
              {
                cell: "C41",
                format: "common",
                value: "-i",
              },
              {
                cell: "A42",
                css: "highlighting",
                format: "common",
                value: "IMCONJUGATE",
              },
              {
                cell: "B42",
                format: "common",
                value: "=IMCONJUGATE(C42)",
              },
              {
                cell: "C42",
                format: "common",
                value: "3+4i",
              },
              {
                cell: "A43",
                css: "highlighting",
                format: "common",
                value: "IMCOS",
              },
              {
                cell: "B43",
                format: "common",
                value: "=IMCOS(C43)",
              },
              {
                cell: "C43",
                format: "common",
                value: "1+i",
              },
              {
                cell: "A44",
                css: "highlighting",
                format: "common",
                value: "IMCOSH",
              },
              {
                cell: "B44",
                format: "common",
                value: "=IMCOSH(C44)",
              },
              {
                cell: "C44",
                format: "common",
                value: "4+3i",
              },
              {
                cell: "A45",
                css: "highlighting",
                format: "common",
                value: "IMCOT",
              },
              {
                cell: "B45",
                format: "common",
                value: "=IMCOT(C45)",
              },
              {
                cell: "C45",
                format: "common",
                value: "4+3i",
              },
              {
                cell: "A46",
                css: "highlighting",
                format: "common",
                value: "IMCSC",
              },
              {
                cell: "B46",
                format: "common",
                value: "=IMCSC(C46)",
              },
              {
                cell: "C46",
                format: "common",
                value: "4+3i",
              },
              {
                cell: "A47",
                css: "highlighting",
                format: "common",
                value: "IMCSCH",
              },
              {
                cell: "B47",
                format: "common",
                value: "=IMCSCH(C47)",
              },
              {
                cell: "C47",
                format: "common",
                value: "4+3i",
              },
              {
                cell: "A48",
                css: "highlighting",
                format: "common",
                value: "IMDIV",
              },
              {
                cell: "B48",
                format: "common",
                value: "=IMDIV(C48,D48)",
              },
              {
                cell: "C48",
                format: "common",
                value: "-238+240i",
              },
              {
                cell: "D48",
                format: "common",
                value: "10+24i",
              },
              {
                cell: "A49",
                css: "highlighting",
                format: "common",
                value: "IMEXP",
              },
              {
                cell: "B49",
                format: "common",
                value: "=IMEXP(C49)",
              },
              {
                cell: "C49",
                format: "common",
                value: "1+i",
              },
              {
                cell: "A50",
                css: "highlighting",
                format: "common",
                value: "IMLN",
              },
              {
                cell: "B50",
                format: "common",
                value: "=IMLN(C50)",
              },
              {
                cell: "C50",
                format: "common",
                value: "3+4i",
              },
              {
                cell: "A51",
                css: "highlighting",
                format: "common",
                value: "IMPOWER",
              },
              {
                cell: "B51",
                format: "common",
                value: "=IMPOWER(C51,D51)",
              },
              {
                cell: "C51",
                format: "common",
                value: "2+3i",
              },
              {
                cell: "D51",
                format: "common",
                value: 3,
              },
              {
                cell: "A52",
                css: "highlighting",
                format: "common",
                value: "IMPRODUCT",
              },
              {
                cell: "B52",
                format: "common",
                value: "=IMPRODUCT(C52,D52)",
              },
              {
                cell: "C52",
                format: "common",
                value: "3+4i",
              },
              {
                cell: "D52",
                format: "common",
                value: "5-3i",
              },
              {
                cell: "A53",
                css: "highlighting",
                format: "common",
                value: "IMREAL",
              },
              {
                cell: "B53",
                format: "common",
                value: "=IMREAL(C53)",
              },
              {
                cell: "C53",
                format: "common",
                value: "-i",
              },
              {
                cell: "A54",
                css: "highlighting",
                format: "common",
                value: "IMSEC",
              },
              {
                cell: "B54",
                format: "common",
                value: "=IMSEC(C54)",
              },
              {
                cell: "C54",
                format: "common",
                value: "4+3i",
              },
              {
                cell: "A55",
                css: "highlighting",
                format: "common",
                value: "IMSECH",
              },
              {
                cell: "B55",
                format: "common",
                value: "=IMSECH(C55)",
              },
              {
                cell: "C55",
                format: "common",
                value: "4+3i",
              },
              {
                cell: "A56",
                css: "highlighting",
                format: "common",
                value: "IMSIN",
              },
              {
                cell: "B56",
                format: "common",
                value: "=IMSIN(C56)",
              },
              {
                cell: "C56",
                format: "common",
                value: "4+3i",
              },
              {
                cell: "A57",
                css: "highlighting",
                format: "common",
                value: "IMSINH",
              },
              {
                cell: "B57",
                format: "common",
                value: "=IMSINH(C57)",
              },
              {
                cell: "C57",
                format: "common",
                value: "4+3i",
              },
              {
                cell: "A58",
                css: "highlighting",
                format: "common",
                value: "IMSQRT",
              },
              {
                cell: "B58",
                format: "common",
                value: "=IMSQRT(C58)",
              },
              {
                cell: "C58",
                format: "common",
                value: "1+i",
              },
              {
                cell: "A59",
                css: "highlighting",
                format: "common",
                value: "IMSUB",
              },
              {
                cell: "B59",
                format: "common",
                value: "=IMSUB(C59,D59)",
              },
              {
                cell: "C59",
                format: "common",
                value: "13+4i",
              },
              {
                cell: "D59",
                format: "common",
                value: "5+3i",
              },
              {
                cell: "A60",
                css: "highlighting",
                format: "common",
                value: "IMSUM",
              },
              {
                cell: "B60",
                format: "common",
                value: "=IMSUM(C60,D60,E60)",
              },
              {
                cell: "C60",
                format: "common",
                value: "3+4i",
              },
              {
                cell: "D60",
                format: "common",
                value: "5-3i",
              },
              {
                cell: "E60",
                format: "common",
                value: "1-3i",
              },
              {
                cell: "A61",
                css: "highlighting",
                format: "common",
                value: "IMTAN",
              },
              {
                cell: "B61",
                format: "common",
                value: "=IMTAN(C61)",
              },
              {
                cell: "C61",
                format: "common",
                value: "3i",
              },
              {
                cell: "A62",
                css: "highlighting",
                format: "common",
                value: "IPMT",
              },
              {
                cell: "B62",
                format: "common",
                value: "=IPMT(C62/12;D62;E62*12;-F62)",
              },
              {
                cell: "C62",
                format: "percent",
                value: 0.03,
              },
              {
                cell: "D62",
                format: "number",
                value: 24,
              },
              {
                cell: "E62",
                format: "number",
                value: 5,
              },
              {
                cell: "F62",
                format: "number",
                value: 10000,
              },
              {
                cell: "A63",
                css: "highlighting",
                format: "common",
                value: "IRR",
              },
              {
                cell: "B63",
                format: "common",
                value: "=IRR(C63:E63)",
              },
              {
                cell: "C63",
                format: "number",
                value: -2000,
              },
              {
                cell: "D63",
                format: "number",
                value: 3000,
              },
              {
                cell: "E63",
                format: "number",
                value: 4000,
              },
              {
                cell: "A64",
                css: "highlighting",
                format: "common",
                value: "ISPMT",
              },
              {
                cell: "B64",
                format: "common",
                value: "=ISPMT(C64;D64;E64;-F64)",
              },
              {
                cell: "C64",
                format: "percent",
                value: 0.1,
              },
              {
                cell: "D64",
                format: "number",
                value: 0,
              },
              {
                cell: "E64",
                format: "number",
                value: 4,
              },
              {
                cell: "F64",
                format: "number",
                value: 4000,
              },
              {
                cell: "A65",
                css: "highlighting",
                format: "common",
                value: "LARGE",
              },
              {
                cell: "B65",
                format: "common",
                value: "=LARGE(C65:G65,2)",
              },
              {
                cell: "C65",
                format: "number",
                value: 1,
              },
              {
                cell: "D65",
                format: "number",
                value: 2,
              },
              {
                cell: "E65",
                format: "number",
                value: 3,
              },
              {
                cell: "F65",
                format: "number",
                value: 4,
              },
              {
                cell: "G65",
                format: "number",
                value: 5,
              },
              {
                cell: "A66",
                css: "highlighting",
                format: "common",
                value: "MEDIAN",
              },
              {
                cell: "B66",
                format: "common",
                value: "=MEDIAN(C66:G66,3)",
              },
              {
                cell: "C66",
                format: "number",
                value: 1,
              },
              {
                cell: "D66",
                format: "number",
                value: 2,
              },
              {
                cell: "E66",
                format: "number",
                value: 3,
              },
              {
                cell: "F66",
                format: "number",
                value: 4,
              },
              {
                cell: "G66",
                format: "number",
                value: 5,
              },
              {
                cell: "A67",
                css: "highlighting",
                format: "common",
                value: "NOMINAL",
              },
              {
                cell: "B67",
                format: "common",
                value: "=NOMINAL(C67;D67)",
              },
              {
                cell: "C67",
                format: "percent",
                value: 0.0609,
              },
              {
                cell: "D67",
                format: "number",
                value: 2,
              },
              {
                cell: "A68",
                css: "highlighting",
                format: "common",
                value: "NPER",
              },
              {
                cell: "B68",
                format: "common",
                value: "=NPER(C68/12;D68;-E68)",
              },
              {
                cell: "C68",
                format: "percent",
                value: 0.045,
              },
              {
                cell: "D68",
                format: "number",
                value: 93.22,
              },
              {
                cell: "E68",
                format: "number",
                value: 5000,
              },
              {
                cell: "A69",
                css: "highlighting",
                format: "common",
                value: "NPV",
              },
              {
                cell: "B69",
                format: "common",
                value: "=NPV(C69;D69;E69)",
              },
              {
                cell: "C69",
                format: "percent",
                value: 0.1,
              },
              {
                cell: "D69",
                format: "number",
                value: 100,
              },
              {
                cell: "E69",
                format: "number",
                value: 200,
              },
              {
                cell: "A70",
                css: "highlighting",
                format: "common",
                value: "OCT2BIN",
              },
              {
                cell: "B70",
                format: "common",
                value: "=OCT2BIN(C70)",
              },
              {
                cell: "C70",
                format: "number",
                value: 10,
              },
              {
                cell: "A71",
                css: "highlighting",
                format: "common",
                value: "OCT2DEC",
              },
              {
                cell: "B71",
                format: "common",
                value: "=OCT2DEC(C71)",
              },
              {
                cell: "C71",
                format: "number",
                value: 10,
              },
              {
                cell: "A72",
                css: "highlighting",
                format: "common",
                value: "OCT2HEX",
              },
              {
                cell: "B72",
                format: "common",
                value: "=OCT2HEX(C72)",
              },
              {
                cell: "C72",
                format: "common",
                value: 252,
              },
              {
                cell: "A73",
                css: "highlighting",
                format: "common",
                value: "PDURATION",
              },
              {
                cell: "B73",
                format: "common",
                value: "=PDURATION(C73;D73;E73)",
              },
              {
                cell: "C73",
                format: "percent",
                value: 0.045,
              },
              {
                cell: "D73",
                format: "number",
                value: 93.22,
              },
              {
                cell: "E73",
                format: "number",
                value: 5000,
              },
              {
                cell: "A74",
                css: "highlighting",
                format: "common",
                value: "PERCENTILE",
              },
              {
                cell: "B74",
                format: "common",
                value: "=PERCENTILE(C74:F74,0.3)",
              },
              {
                cell: "C74",
                format: "number",
                value: 1,
              },
              {
                cell: "D74",
                format: "number",
                value: 2,
              },
              {
                cell: "E74",
                format: "number",
                value: 3,
              },
              {
                cell: "F74",
                format: "number",
                value: 4,
              },
              {
                cell: "A75",
                css: "highlighting",
                format: "common",
                value: "PERCENTILE.EXC",
              },
              {
                cell: "B75",
                format: "common",
                value: "=PERCENTILE.EXC(C75:K75,0.25)",
              },
              {
                cell: "C75",
                format: "number",
                value: 1,
              },
              {
                cell: "D75",
                format: "number",
                value: 2,
              },
              {
                cell: "E75",
                format: "number",
                value: 3,
              },
              {
                cell: "F75",
                format: "number",
                value: 4,
              },
              {
                cell: "G75",
                format: "number",
                value: 5,
              },
              {
                cell: "H75",
                format: "number",
                value: 6,
              },
              {
                cell: "I75",
                format: "number",
                value: 7,
              },
              {
                cell: "J75",
                format: "number",
                value: 8,
              },
              {
                cell: "K75",
                format: "number",
                value: 9,
              },
              {
                cell: "A76",
                css: "highlighting",
                format: "common",
                value: "PERCENTILE.INC",
              },
              {
                cell: "B76",
                format: "common",
                value: "=PERCENTILE.INC(C76:F76,0.3)",
              },
              {
                cell: "C76",
                format: "number",
                value: 1,
              },
              {
                cell: "D76",
                format: "number",
                value: 2,
              },
              {
                cell: "E76",
                format: "number",
                value: 3,
              },
              {
                cell: "F76",
                format: "number",
                value: 4,
              },
              {
                cell: "G76",
                format: "number",
              },
              {
                cell: "H76",
                format: "number",
              },
              {
                cell: "I76",
                format: "number",
              },
              {
                cell: "J76",
                format: "number",
              },
              {
                cell: "K76",
                format: "number",
              },
              {
                cell: "A77",
                css: "highlighting",
                format: "common",
                value: "PERMUT",
              },
              {
                cell: "B77",
                format: "common",
                value: "=PERMUT(C77,D77)",
              },
              {
                cell: "C77",
                format: "common",
                value: 3,
              },
              {
                cell: "D77",
                format: "common",
                value: 2,
              },
              {
                cell: "A78",
                css: "highlighting",
                format: "common",
                value: "PMT",
              },
              {
                cell: "B78",
                format: "common",
                value: "=PMT(C78/12;D78*12;-E78)",
              },
              {
                cell: "C78",
                format: "percent",
                value: 0.03,
              },
              {
                cell: "D78",
                format: "number",
                value: 5,
              },
              {
                cell: "E78",
                format: "number",
                value: 10000,
              },
              {
                cell: "A79",
                css: "highlighting",
                format: "common",
                value: "PPMT",
              },
              {
                cell: "B79",
                format: "common",
                value: "=PPMT(C79/12;D79;E79*12;-F79;G79;)",
              },
              {
                cell: "C79",
                format: "percent",
                value: 0.03,
              },
              {
                cell: "D79",
                format: "number",
                value: 24,
              },
              {
                cell: "E79",
                format: "number",
                value: 5,
              },
              {
                cell: "F79",
                format: "number",
                value: 10000,
              },
              {
                cell: "G79",
                format: "number",
                value: 0,
              },
              {
                cell: "A80",
                css: "highlighting",
                format: "common",
                value: "PV",
              },
              {
                cell: "B80",
                format: "common",
                value: "=PV(C80/12;12*D80;-E80;F80;)",
              },
              {
                cell: "C80",
                format: "percent",
                value: 0.08,
              },
              {
                cell: "D80",
                format: "number",
                value: 20,
              },
              {
                cell: "E80",
                format: "number",
                value: 500,
              },
              {
                cell: "F80",
                format: "number",
                value: 0,
              },
              {
                cell: "A81",
                css: "highlighting",
                format: "common",
                value: "QUARTILE",
              },
              {
                cell: "B81",
                format: "common",
                value: "=QUARTILE(C81:J81,1)",
              },
              {
                cell: "C81",
                format: "common",
                value: 1,
              },
              {
                cell: "D81",
                format: "common",
                value: 2,
              },
              {
                cell: "E81",
                format: "common",
                value: 4,
              },
              {
                cell: "F81",
                format: "common",
                value: 7,
              },
              {
                cell: "G81",
                format: "common",
                value: 8,
              },
              {
                cell: "H81",
                format: "common",
                value: 9,
              },
              {
                cell: "I81",
                format: "common",
                value: 10,
              },
              {
                cell: "J81",
                format: "common",
                value: 12,
              },
              {
                cell: "A82",
                css: "highlighting",
                format: "common",
                value: "QUARTILE.EXC",
              },
              {
                cell: "B82",
                format: "common",
                value: "=QUARTILE.EXC(C82:M82,1)",
              },
              {
                cell: "C82",
                format: "common",
                value: 6,
              },
              {
                cell: "D82",
                format: "common",
                value: 7,
              },
              {
                cell: "E82",
                format: "common",
                value: 15,
              },
              {
                cell: "F82",
                format: "common",
                value: 36,
              },
              {
                cell: "G82",
                format: "common",
                value: 39,
              },
              {
                cell: "H82",
                format: "common",
                value: 40,
              },
              {
                cell: "I82",
                format: "common",
                value: 41,
              },
              {
                cell: "J82",
                format: "common",
                value: 42,
              },
              {
                cell: "K82",
                format: "common",
                value: 43,
              },
              {
                cell: "L82",
                format: "common",
                value: 47,
              },
              {
                cell: "M82",
                format: "common",
                value: 49,
              },
              {
                cell: "A83",
                css: "highlighting",
                format: "common",
                value: "QUARTILE.INC",
              },
              {
                cell: "B83",
                format: "common",
                value: "=QUARTILE.INC(C83:J83,1)",
              },
              {
                cell: "C83",
                format: "common",
                value: 6,
              },
              {
                cell: "D83",
                format: "common",
                value: 7,
              },
              {
                cell: "E83",
                format: "common",
                value: 15,
              },
              {
                cell: "F83",
                format: "common",
                value: 36,
              },
              {
                cell: "G83",
                format: "common",
                value: 39,
              },
              {
                cell: "H83",
                format: "common",
                value: 40,
              },
              {
                cell: "I83",
                format: "common",
                value: 41,
              },
              {
                cell: "J83",
                format: "common",
                value: 42,
              },
              {
                cell: "K83",
                format: "common",
              },
              {
                cell: "L83",
                format: "common",
              },
              {
                cell: "M83",
                format: "common",
              },
              {
                cell: "A84",
                css: "highlighting",
                format: "common",
                value: "SIGN",
              },
              {
                cell: "B84",
                format: "common",
                value: "=SIGN(C84)",
              },
              {
                cell: "C84",
                format: "common",
                value: 10,
              },
              {
                cell: "A85",
                css: "highlighting",
                format: "common",
                value: "SMALL",
              },
              {
                cell: "B85",
                format: "common",
                value: "=SMALL(C85:G85,F85)",
              },
              {
                cell: "C85",
                format: "number",
                value: 1,
              },
              {
                cell: "D85",
                format: "number",
                value: 2,
              },
              {
                cell: "E85",
                format: "number",
                value: 3,
              },
              {
                cell: "F85",
                format: "number",
                value: 4,
              },
              {
                cell: "G85",
                format: "number",
                value: 5,
              },
              {
                cell: "A86",
                css: "highlighting",
                format: "common",
                value: "STEYX",
              },
              {
                cell: "B86",
                format: "common",
                value: "=STEYX(H86:L86,C86:G86)",
              },
              {
                cell: "C86",
                format: "common",
                value: 6,
              },
              {
                cell: "D86",
                format: "common",
                value: 7,
              },
              {
                cell: "E86",
                format: "common",
                value: 8,
              },
              {
                cell: "F86",
                format: "common",
                value: 9,
              },
              {
                cell: "G86",
                format: "common",
                value: 10,
              },
              {
                cell: "H86",
                format: "number",
                value: 1,
              },
              {
                cell: "I86",
                format: "number",
                value: 2,
              },
              {
                cell: "J86",
                format: "number",
                value: 3,
              },
              {
                cell: "K86",
                format: "number",
                value: 4,
              },
              {
                cell: "L86",
                format: "number",
                value: 5,
              },
              {
                cell: "A87",
                css: "highlighting",
                format: "common",
                value: "SYD",
              },
              {
                cell: "B87",
                format: "common",
                value: "=SYD(C87,D87,E87,F87)",
              },
              {
                cell: "C87",
                format: "common",
                value: 30000,
              },
              {
                cell: "D87",
                format: "common",
                value: 7500,
              },
              {
                cell: "E87",
                format: "common",
                value: 10,
              },
              {
                cell: "F87",
                format: "common",
                value: 1,
              },
              {
                cell: "A88",
                css: "highlighting",
                format: "common",
                value: "TBILLPRICE",
              },
              {
                cell: "B88",
                format: "common",
                value: "=TBILLPRICE(C88,D88,E88)",
              },
              {
                cell: "C88",
                format: "date",
                value: 39538.125,
              },
              {
                cell: "D88",
                format: "date",
                value: 39600.125,
              },
              {
                cell: "E88",
                format: "common",
                value: 0.09,
              },
              {
                cell: "A89",
                css: "highlighting",
                format: "common",
                value: "TBILLYIELD",
              },
              {
                cell: "B89",
                format: "common",
                value: "=TBILLYIELD(C89,D89,98.45)",
              },
              {
                cell: "C89",
                format: "date",
                value: 39538.125,
              },
              {
                cell: "D89",
                format: "date",
                value: 39600.125,
              },
              {
                cell: "A90",
                css: "highlighting",
                format: "common",
                value: "WEIBULL",
              },
              {
                cell: "B90",
                format: "common",
                value: "=WEIBULL(C90,D90,E90,F90)",
              },
              {
                cell: "C90",
                format: "common",
                value: 105,
              },
              {
                cell: "D90",
                format: "common",
                value: 20,
              },
              {
                cell: "E90",
                format: "common",
                value: 100,
              },
              {
                cell: "F90",
                format: "common",
                value: 1,
              },
              {
                cell: "A91",
                css: "highlighting",
                format: "common",
                value: "WEIBULL.DIST",
              },
              {
                cell: "B91",
                format: "common",
                value: "=WEIBULL.DIST(C91,D91,E91,F91)",
              },
              {
                cell: "C91",
                format: "common",
                value: 105,
              },
              {
                cell: "D91",
                format: "common",
                value: 20,
              },
              {
                cell: "E91",
                format: "common",
                value: 100,
              },
              {
                cell: "F91",
                format: "common",
                value: 1,
              },
            ],
            cols: [
              {
                width: 180,
              },
            ],
            rows: [],
          },
          {
            name: "Information",
            data: [
              {
                cell: "A1",
                css: "header",
                format: "common",
                value: "Formula name",
              },
              {
                cell: "B1",
                css: "header",
                format: "common",
                value: "Formula example",
              },
              {
                cell: "C1",
                css: "header",
                format: "common",
                value: "Data for formula",
              },
              {
                cell: "A2",
                css: "header",
                format: "common",
                value: "Information",
              },
              {
                cell: "A3",
                css: "highlighting",
                format: "common",
                value: "ISBINARY",
              },
              {
                cell: "B3",
                format: "common",
                value: "=ISBINARY(C3)",
              },
              {
                cell: "C3",
                format: "number",
                value: 0,
              },
              {
                cell: "A4",
                css: "highlighting",
                format: "common",
                value: "ISBLANK",
              },
              {
                cell: "B4",
                format: "common",
                value: "=ISBLANK(C4)",
              },
              {
                cell: "A5",
                css: "highlighting",
                format: "common",
                value: "ISEVEN",
              },
              {
                cell: "B5",
                format: "common",
                value: "=ISEVEN(C5)",
              },
              {
                cell: "C5",
                format: "number",
                value: 2,
              },
              {
                cell: "A6",
                css: "highlighting",
                format: "common",
                value: "ISNONTEXT",
              },
              {
                cell: "B6",
                format: "common",
                value: "=ISNONTEXT(C6)",
              },
              {
                cell: "C6",
                format: "number",
                value: 1,
              },
              {
                cell: "A7",
                css: "highlighting",
                format: "common",
                value: "ISNUMBER",
              },
              {
                cell: "B7",
                format: "common",
                value: "=ISNUMBER(C7)",
              },
              {
                cell: "C7",
                format: "number",
                value: 1,
              },
              {
                cell: "A8",
                css: "highlighting",
                format: "common",
                value: "ISODD",
              },
              {
                cell: "B8",
                format: "common",
                value: "=ISODD(C8)",
              },
              {
                cell: "C8",
                format: "number",
                value: 3,
              },
              {
                cell: "A9",
                css: "highlighting",
                format: "common",
                value: "ISTEXT",
              },
              {
                cell: "B9",
                format: "common",
                value: "=ISTEXT(C9)",
              },
              {
                cell: "C9",
                format: "common",
                value: "text",
              },
              {
                cell: "A10",
                css: "highlighting",
                format: "common",
                value: "N",
              },
              {
                cell: "B10",
                format: "common",
                value: "=N(C10)",
              },
              {
                cell: "C10",
                format: "common",
                value: "TRUE",
              },
            ],
            cols: [
              {
                width: 180,
              },
            ],
            rows: [],
          },
          {
            name: "Lookup",
            data: [
              {
                cell: "A1",
                css: "header",
                format: "common",
                value: "Formula name",
              },
              {
                cell: "B1",
                css: "header",
                format: "common",
                value: "Formula example",
              },
              {
                cell: "C1",
                css: "header",
                format: "common",
                value: "Data for formula",
              },
              {
                cell: "A2",
                css: "header",
                format: "common",
                value: "Lookup",
              },
              {
                cell: "A3",
                css: "highlighting",
                format: "common",
                value: "HLOOKUP",
              },
              {
                cell: "B3",
                format: "common",
                value: "=HLOOKUP(3,C3:C4,2)",
              },
              {
                cell: "C3",
                format: "common",
                value: 1,
              },
              {
                cell: "A4",
                css: "highlighting",
                format: "common",
                value: "INDEX",
              },
              {
                cell: "B4",
                format: "common",
                value: "=INDEX(C4:E4,C4,D4)",
              },
              {
                cell: "C4",
                format: "common",
                value: 1,
              },
              {
                cell: "D4",
                format: "common",
                value: 2,
              },
              {
                cell: "E4",
                format: "common",
                value: 3,
              },
              {
                cell: "A5",
                css: "highlighting",
                format: "common",
                value: "LOOKUP",
              },
              {
                cell: "B5",
                format: "common",
                value: "=LOOKUP(C5,{11,22,33})",
              },
              {
                cell: "C5",
                format: "common",
                value: 22,
              },
              {
                cell: "A6",
                css: "highlighting",
                format: "common",
                value: "MATCH",
              },
              {
                cell: "B6",
                format: "common",
                value: "=MATCH(C6,{11,22,33})",
              },
              {
                cell: "C6",
                format: "common",
                value: 22,
              },
              {
                cell: "A7",
                css: "highlighting",
                format: "common",
                value: "VLOOKUP",
              },
              {
                cell: "B7",
                format: "common",
                value: "=VLOOKUP(1,C7:E7,E7)",
              },
              {
                cell: "C7",
                format: "common",
                value: 1,
              },
              {
                cell: "D7",
                format: "common",
                value: 2,
              },
              {
                cell: "E7",
                format: "common",
                value: 3,
              },
              {
                cell: "A8",
                css: "highlighting",
                format: "common",
                value: "XLOOKUP",
              },
              {
                cell: "B8",
                format: "common",
                value: "=LOOKUP(C8,{11,22,33})",
              },
              {
                cell: "C8",
                format: "common",
                value: 22,
              },
              {
                cell: "A9",
                css: "highlighting",
                format: "common",
                value: "XMATCH",
              },
              {
                cell: "B9",
                format: "common",
                value: "=XMATCH(C9,{11,33})",
              },
              {
                cell: "C9",
                format: "common",
                value: 11,
              },
            ],
            cols: [
              {
                width: 180,
              },
            ],
            rows: [],
          },
          {
            name: "Math",
            data: [
              {
                cell: "A1",
                css: "header",
                format: "common",
                value: "Formula name",
              },
              {
                cell: "B1",
                css: "header",
                format: "common",
                value: "Formula example",
              },
              {
                cell: "C1",
                css: "header",
                format: "common",
                value: "Data for formula",
              },
              {
                cell: "A2",
                css: "header",
                format: "common",
                value: "Math",
              },
              {
                cell: "A3",
                css: "highlighting",
                format: "common",
                value: "ABS",
              },
              {
                cell: "B3",
                format: "common",
                value: "=ABS(C3)",
              },
              {
                cell: "C3",
                format: "number",
                value: -5,
              },
              {
                cell: "A4",
                css: "highlighting",
                format: "common",
                value: "ACOS",
              },
              {
                cell: "B4",
                format: "common",
                value: "=ACOS(C4)",
              },
              {
                cell: "C4",
                format: "number",
                value: 0.5,
              },
              {
                cell: "A5",
                css: "highlighting",
                format: "common",
                value: "ACOSH",
              },
              {
                cell: "B5",
                format: "common",
                value: "=ACOSH(C5)",
              },
              {
                cell: "C5",
                format: "number",
                value: 3,
              },
              {
                cell: "A6",
                css: "highlighting",
                format: "common",
                value: "ACOT",
              },
              {
                cell: "B6",
                format: "common",
                value: "=ACOT(C6)",
              },
              {
                cell: "C6",
                format: "number",
                value: 2,
              },
              {
                cell: "A7",
                css: "highlighting",
                format: "common",
                value: "ACOTH",
              },
              {
                cell: "B7",
                format: "common",
                value: "=ACOTH(C7)",
              },
              {
                cell: "C7",
                format: "number",
                value: 6,
              },
              {
                cell: "A8",
                css: "highlighting",
                format: "common",
                value: "ADD",
              },
              {
                cell: "B8",
                format: "common",
                value: "=ADD(C8;D8)",
              },
              {
                cell: "C8",
                format: "number",
                value: 1,
              },
              {
                cell: "D8",
                format: "number",
                value: 100,
              },
              {
                cell: "A9",
                css: "highlighting",
                format: "common",
                value: "ARABIC",
              },
              {
                cell: "B9",
                format: "common",
                value: "=ARABIC(C9)",
              },
              {
                cell: "C9",
                format: "common",
                value: "LVII",
              },
              {
                cell: "A10",
                css: "highlighting",
                format: "common",
                value: "ASIN",
              },
              {
                cell: "B10",
                format: "common",
                value: "=ASIN(C10)",
              },
              {
                cell: "C10",
                format: "number",
                value: -0.5,
              },
              {
                cell: "A11",
                css: "highlighting",
                format: "common",
                value: "ASINH",
              },
              {
                cell: "B11",
                format: "common",
                value: "=ASINH(C11)",
              },
              {
                cell: "C11",
                format: "number",
                value: 10,
              },
              {
                cell: "A12",
                css: "highlighting",
                format: "common",
                value: "ATAN",
              },
              {
                cell: "B12",
                format: "common",
                value: "=ATAN(C12)",
              },
              {
                cell: "C12",
                format: "number",
                value: 1,
              },
              {
                cell: "A13",
                css: "highlighting",
                format: "common",
                value: "ATAN2",
              },
              {
                cell: "B13",
                format: "common",
                value: "=ATAN2(C13;D13)",
              },
              {
                cell: "C13",
                format: "number",
                value: 1,
              },
              {
                cell: "D13",
                format: "number",
                value: 1,
              },
              {
                cell: "A14",
                css: "highlighting",
                format: "common",
                value: "ATANH",
              },
              {
                cell: "B14",
                format: "common",
                value: "=ATANH(C14)",
              },
              {
                cell: "C14",
                format: "number",
                value: 0.76,
              },
              {
                cell: "A15",
                css: "highlighting",
                format: "common",
                value: "AVEDEV",
              },
              {
                cell: "B15",
                format: "common",
                value: "=AVEDEV(C15:H15)",
              },
              {
                cell: "C15",
                format: "number",
                value: 50,
              },
              {
                cell: "D15",
                format: "number",
                value: 47,
              },
              {
                cell: "E15",
                format: "number",
                value: 52,
              },
              {
                cell: "F15",
                format: "number",
                value: 46,
              },
              {
                cell: "G15",
                format: "number",
                value: 45,
              },
              {
                cell: "H15",
                format: "number",
                value: 48,
              },
              {
                cell: "A16",
                css: "highlighting",
                format: "common",
                value: "AVERAGE",
              },
              {
                cell: "B16",
                format: "common",
                value: "=AVERAGE(C16;D16)",
              },
              {
                cell: "C16",
                format: "number",
                value: 5,
              },
              {
                cell: "D16",
                format: "number",
                value: 15,
              },
              {
                cell: "A17",
                css: "highlighting",
                format: "common",
                value: "AVERAGEA",
              },
              {
                cell: "B17",
                format: "common",
                value: "=AVERAGEA(C17:F17)",
              },
              {
                cell: "C17",
                format: "number",
                value: 2,
              },
              {
                cell: "D17",
                format: "number",
                value: 4,
              },
              {
                cell: "E17",
                format: "number",
                value: 6,
              },
              {
                cell: "F17",
                format: "number",
                value: 8,
              },
              {
                cell: "A18",
                css: "highlighting",
                format: "common",
                value: "BASE",
              },
              {
                cell: "B18",
                format: "common",
                value: "=BASE(C18;D18)",
              },
              {
                cell: "C18",
                format: "number",
                value: 7,
              },
              {
                cell: "D18",
                format: "number",
                value: 2,
              },
              {
                cell: "A19",
                css: "highlighting",
                format: "common",
                value: "BITAND",
              },
              {
                cell: "B19",
                format: "common",
                value: "=BITAND(C19,D19)",
              },
              {
                cell: "C19",
                format: "common",
                value: 1,
              },
              {
                cell: "D19",
                format: "common",
                value: 5,
              },
              {
                cell: "A20",
                css: "highlighting",
                format: "common",
                value: "CEILING",
              },
              {
                cell: "B20",
                format: "common",
                value: "=CEILING(C20;D20)",
              },
              {
                cell: "C20",
                format: "number",
                value: 2.5,
              },
              {
                cell: "D20",
                format: "number",
                value: 1,
              },
              {
                cell: "A21",
                css: "highlighting",
                format: "common",
                value: "COMBIN",
              },
              {
                cell: "B21",
                format: "common",
                value: "=COMBIN(C21;D21)",
              },
              {
                cell: "C21",
                format: "number",
                value: 8,
              },
              {
                cell: "D21",
                format: "number",
                value: 2,
              },
              {
                cell: "A22",
                css: "highlighting",
                format: "common",
                value: "COMBINA",
              },
              {
                cell: "B22",
                format: "common",
                value: "=COMBINA(C22;D22)",
              },
              {
                cell: "C22",
                format: "number",
                value: 4,
              },
              {
                cell: "D22",
                format: "number",
                value: 3,
              },
              {
                cell: "A23",
                css: "highlighting",
                format: "common",
                value: "COS",
              },
              {
                cell: "B23",
                format: "common",
                value: "=COS(C23)",
              },
              {
                cell: "C23",
                format: "number",
                value: 1.021,
              },
              {
                cell: "A24",
                css: "highlighting",
                format: "common",
                value: "COSH",
              },
              {
                cell: "B24",
                format: "common",
                value: "=COSH(C24)",
              },
              {
                cell: "C24",
                format: "number",
                value: 4,
              },
              {
                cell: "A25",
                css: "highlighting",
                format: "common",
                value: "COT",
              },
              {
                cell: "B25",
                format: "common",
                value: "=COT(C25)",
              },
              {
                cell: "C25",
                format: "number",
                value: 30,
              },
              {
                cell: "A26",
                css: "highlighting",
                format: "common",
                value: "COTH",
              },
              {
                cell: "B26",
                format: "common",
                value: "=COTH(C26)",
              },
              {
                cell: "C26",
                format: "number",
                value: 2,
              },
              {
                cell: "A27",
                css: "highlighting",
                format: "common",
                value: "COUNT",
              },
              {
                cell: "B27",
                format: "common",
                value: "=COUNT(C27;D27)",
              },
              {
                cell: "C27",
                format: "number",
                value: 5,
              },
              {
                cell: "D27",
                format: "common",
                value: "some text",
              },
              {
                cell: "A28",
                css: "highlighting",
                format: "common",
                value: "COUNTA",
              },
              {
                cell: "B28",
                format: "common",
                value: "=COUNTA(C28;D28)",
              },
              {
                cell: "C28",
                format: "number",
                value: 5,
              },
              {
                cell: "D28",
                format: "common",
                value: "some text",
              },
              {
                cell: "A29",
                css: "highlighting",
                format: "common",
                value: "COUNTBLANK",
              },
              {
                cell: "B29",
                format: "common",
                value: "=COUNTBLANK(C29:D29)",
              },
              {
                cell: "C29",
                format: "number",
                value: 0,
              },
              {
                cell: "A30",
                css: "highlighting",
                format: "common",
                value: "CSC",
              },
              {
                cell: "B30",
                format: "common",
                value: "=CSC(C30)",
              },
              {
                cell: "C30",
                format: "number",
                value: 15,
              },
              {
                cell: "A31",
                css: "highlighting",
                format: "common",
                value: "CSCH",
              },
              {
                cell: "B31",
                format: "common",
                value: "=CSCH(C31)",
              },
              {
                cell: "C31",
                format: "number",
                value: 1.5,
              },
              {
                cell: "A32",
                css: "highlighting",
                format: "common",
                value: "DECIMAL",
              },
              {
                cell: "B32",
                format: "common",
                value: "=DECIMAL(C32;D32)",
              },
              {
                cell: "C32",
                format: "number",
                value: 111,
              },
              {
                cell: "D32",
                format: "number",
                value: 2,
              },
              {
                cell: "A33",
                css: "highlighting",
                format: "common",
                value: "DEGREES",
              },
              {
                cell: "B33",
                format: "common",
                value: "=DEGREES(C33)",
              },
              {
                cell: "C33",
                format: "number",
                value: 5,
              },
              {
                cell: "A34",
                css: "highlighting",
                format: "common",
                value: "DIVIDE",
              },
              {
                cell: "B34",
                format: "common",
                value: "=DIVIDE(C34;D34)",
              },
              {
                cell: "C34",
                format: "number",
                value: 4,
              },
              {
                cell: "D34",
                format: "number",
                value: 2,
              },
              {
                cell: "A35",
                css: "highlighting",
                format: "common",
                value: "EQ",
              },
              {
                cell: "B35",
                format: "common",
                value: '=IF(C35=D35,"Yes","No")',
              },
              {
                cell: "C35",
                format: "number",
                value: 3,
              },
              {
                cell: "D35",
                format: "number",
                value: 3,
              },
              {
                cell: "A36",
                css: "highlighting",
                format: "common",
                value: "EVEN",
              },
              {
                cell: "B36",
                format: "common",
                value: "=EVEN(C36)",
              },
              {
                cell: "C36",
                format: "number",
                value: 5.7,
              },
              {
                cell: "A37",
                css: "highlighting",
                format: "common",
                value: "FACT",
              },
              {
                cell: "B37",
                format: "common",
                value: "=FACT(C37)",
              },
              {
                cell: "C37",
                format: "number",
                value: 5,
              },
              {
                cell: "A38",
                css: "highlighting",
                format: "common",
                value: "FACTDOUBLE",
              },
              {
                cell: "B38",
                format: "common",
                value: "=FACTDOUBLE(C38)",
              },
              {
                cell: "C38",
                format: "number",
                value: 6,
              },
              {
                cell: "A39",
                css: "highlighting",
                format: "common",
                value: "FLOOR",
              },
              {
                cell: "B39",
                format: "common",
                value: "=FLOOR(C39;D39)",
              },
              {
                cell: "C39",
                format: "number",
                value: 3.7,
              },
              {
                cell: "D39",
                format: "number",
                value: 2,
              },
              {
                cell: "A40",
                css: "highlighting",
                format: "common",
                value: "GCD",
              },
              {
                cell: "B40",
                format: "common",
                value: "=GCD(C40;D40)",
              },
              {
                cell: "C40",
                format: "number",
                value: 60,
              },
              {
                cell: "D40",
                format: "number",
                value: 36,
              },
              {
                cell: "A41",
                css: "highlighting",
                format: "common",
                value: "GT",
              },
              {
                cell: "B41",
                format: "common",
                value: '=IF(C41>D41,"Yes","No")',
              },
              {
                cell: "C41",
                format: "number",
                value: 2,
              },
              {
                cell: "D41",
                format: "number",
                value: 3,
              },
              {
                cell: "A42",
                css: "highlighting",
                format: "common",
                value: "GTE",
              },
              {
                cell: "B42",
                format: "common",
                value: '=IF(C42>=D42,"Yes","No")',
              },
              {
                cell: "C42",
                format: "number",
                value: 3,
              },
              {
                cell: "D42",
                format: "number",
                value: 3,
              },
              {
                cell: "A43",
                css: "highlighting",
                format: "common",
                value: "INT",
              },
              {
                cell: "B43",
                format: "common",
                value: "=INT(C43)",
              },
              {
                cell: "C43",
                format: "number",
                value: 5.7,
              },
              {
                cell: "A44",
                css: "highlighting",
                format: "common",
                value: "LN",
              },
              {
                cell: "B44",
                format: "common",
                value: "=LN(C44)",
              },
              {
                cell: "C44",
                format: "number",
                value: 86,
              },
              {
                cell: "A45",
                css: "highlighting",
                format: "common",
                value: "LOG",
              },
              {
                cell: "B45",
                format: "common",
                value: "=LOG(C45)",
              },
              {
                cell: "C45",
                format: "number",
                value: 10,
              },
              {
                cell: "A46",
                css: "highlighting",
                format: "common",
                value: "LOG10",
              },
              {
                cell: "B46",
                format: "common",
                value: "=LOG10(C46)",
              },
              {
                cell: "C46",
                format: "number",
                value: 10,
              },
              {
                cell: "A47",
                css: "highlighting",
                format: "common",
                value: "LT",
              },
              {
                cell: "B47",
                format: "common",
                value: '=IF(C47<D47,"Yes","No")',
              },
              {
                cell: "C47",
                format: "number",
                value: 2,
              },
              {
                cell: "D47",
                format: "number",
                value: 3,
              },
              {
                cell: "A48",
                css: "highlighting",
                format: "common",
                value: "LTE",
              },
              {
                cell: "B48",
                format: "common",
                value: '=IF(C48<=D48,"Yes","No")',
              },
              {
                cell: "C48",
                format: "number",
                value: 3,
              },
              {
                cell: "D48",
                format: "number",
                value: 3,
              },
              {
                cell: "A49",
                css: "highlighting",
                format: "common",
                value: "MAX",
              },
              {
                cell: "B49",
                format: "common",
                value: "=MAX(C49;D49)",
              },
              {
                cell: "C49",
                format: "number",
                value: 5,
              },
              {
                cell: "D49",
                format: "number",
                value: 15,
              },
              {
                cell: "A50",
                css: "highlighting",
                format: "common",
                value: "MIN",
              },
              {
                cell: "B50",
                format: "common",
                value: "=MIN(C50;D50)",
              },
              {
                cell: "C50",
                format: "number",
                value: 5,
              },
              {
                cell: "D50",
                format: "number",
                value: 2,
              },
              {
                cell: "A51",
                css: "highlighting",
                format: "common",
                value: "MINUS",
              },
              {
                cell: "B51",
                format: "common",
                value: "=MINUS(C51;D51)",
              },
              {
                cell: "C51",
                format: "number",
                value: 1,
              },
              {
                cell: "D51",
                format: "number",
                value: 100,
              },
              {
                cell: "A52",
                css: "highlighting",
                format: "common",
                value: "MOD",
              },
              {
                cell: "B52",
                format: "common",
                value: "=MOD(C52;D52)",
              },
              {
                cell: "C52",
                format: "number",
                value: 3,
              },
              {
                cell: "D52",
                format: "number",
                value: 2,
              },
              {
                cell: "A53",
                css: "highlighting",
                format: "common",
                value: "MROUND",
              },
              {
                cell: "B53",
                format: "common",
                value: "=MROUND(C53;D53)",
              },
              {
                cell: "C53",
                format: "number",
                value: 10,
              },
              {
                cell: "D53",
                format: "number",
                value: 3,
              },
              {
                cell: "A54",
                css: "highlighting",
                format: "common",
                value: "MULTINOMIAL",
              },
              {
                cell: "B54",
                format: "common",
                value: "=MULTINOMIAL(C54;D54)",
              },
              {
                cell: "C54",
                format: "number",
                value: 2,
              },
              {
                cell: "D54",
                format: "number",
                value: 3,
              },
              {
                cell: "A55",
                css: "highlighting",
                format: "common",
                value: "MULTIPLY",
              },
              {
                cell: "B55",
                format: "common",
                value: "=MULTIPLY(C55;D55)",
              },
              {
                cell: "C55",
                format: "number",
                value: 2,
              },
              {
                cell: "D55",
                format: "number",
                value: 2,
              },
              {
                cell: "A56",
                css: "highlighting",
                format: "common",
                value: "NE",
              },
              {
                cell: "B56",
                format: "common",
                value: "=NE(C56,D56)",
              },
              {
                cell: "C56",
                format: "number",
                value: 3,
              },
              {
                cell: "D56",
                format: "number",
                value: 3,
              },
              {
                cell: "A57",
                css: "highlighting",
                format: "common",
                value: "ODD",
              },
              {
                cell: "B57",
                format: "common",
                value: "=ODD(C57)",
              },
              {
                cell: "C57",
                format: "number",
                value: 5,
              },
              {
                cell: "A58",
                css: "highlighting",
                format: "common",
                value: "PI",
              },
              {
                cell: "B58",
                format: "common",
                value: "=PI()",
              },
              {
                cell: "A59",
                css: "highlighting",
                format: "common",
                value: "POW",
              },
              {
                cell: "B59",
                format: "common",
                value: "=POW(C59;D59)",
              },
              {
                cell: "C59",
                format: "number",
                value: 5,
              },
              {
                cell: "D59",
                format: "number",
                value: 2,
              },
              {
                cell: "A60",
                css: "highlighting",
                format: "common",
                value: "POWER",
              },
              {
                cell: "B60",
                format: "common",
                value: "=POWER(C60;D60)",
              },
              {
                cell: "C60",
                format: "number",
                value: 5,
              },
              {
                cell: "D60",
                format: "number",
                value: 2,
              },
              {
                cell: "A61",
                css: "highlighting",
                format: "common",
                value: "PRODUCT",
              },
              {
                cell: "B61",
                format: "common",
                value: "=PRODUCT(C61;D61)",
              },
              {
                cell: "C61",
                format: "number",
                value: 5,
              },
              {
                cell: "D61",
                format: "number",
                value: 2,
              },
              {
                cell: "A62",
                css: "highlighting",
                format: "common",
                value: "QUOTIENT",
              },
              {
                cell: "B62",
                format: "common",
                value: "=QUOTIENT(C62;D62)",
              },
              {
                cell: "C62",
                format: "number",
                value: 5,
              },
              {
                cell: "D62",
                format: "number",
                value: 2,
              },
              {
                cell: "A63",
                css: "highlighting",
                format: "common",
                value: "RADIANS",
              },
              {
                cell: "B63",
                format: "common",
                value: "=RADIANS(C63)",
              },
              {
                cell: "C63",
                format: "number",
                value: 270,
              },
              {
                cell: "A64",
                css: "highlighting",
                format: "common",
                value: "RAND",
              },
              {
                cell: "B64",
                format: "common",
                value: "=RAND()",
              },
              {
                cell: "A65",
                css: "highlighting",
                format: "common",
                value: "RANDBETWEEN",
              },
              {
                cell: "B65",
                format: "common",
                value: "=RANDBETWEEN(C65;D65)",
              },
              {
                cell: "C65",
                format: "number",
                value: 1,
              },
              {
                cell: "D65",
                format: "number",
                value: 100,
              },
              {
                cell: "A66",
                css: "highlighting",
                format: "common",
                value: "ROMAN",
              },
              {
                cell: "B66",
                format: "common",
                value: "=ROMAN(C66)",
              },
              {
                cell: "C66",
                format: "number",
                value: 10,
              },
              {
                cell: "A67",
                css: "highlighting",
                format: "common",
                value: "ROUND",
              },
              {
                cell: "B67",
                format: "common",
                value: "=ROUND(C67;D67)",
              },
              {
                cell: "C67",
                format: "number",
                value: 5.73758,
              },
              {
                cell: "D67",
                format: "number",
                value: 2,
              },
              {
                cell: "A68",
                css: "highlighting",
                format: "common",
                value: "ROUNDDOWN",
              },
              {
                cell: "B68",
                format: "common",
                value: "=ROUNDDOWN(C68;D68)",
              },
              {
                cell: "C68",
                format: "number",
                value: 5.73758,
              },
              {
                cell: "D68",
                format: "number",
                value: 2,
              },
              {
                cell: "A69",
                css: "highlighting",
                format: "common",
                value: "ROUNDUP",
              },
              {
                cell: "B69",
                format: "common",
                value: "=ROUNDUP(C69;D69)",
              },
              {
                cell: "C69",
                format: "number",
                value: 5.78658,
              },
              {
                cell: "D69",
                format: "number",
                value: 2,
              },
              {
                cell: "A70",
                css: "highlighting",
                format: "common",
                value: "SEC",
              },
              {
                cell: "B70",
                format: "common",
                value: "=SEC(C70)",
              },
              {
                cell: "C70",
                format: "number",
                value: 45,
              },
              {
                cell: "A71",
                css: "highlighting",
                format: "common",
                value: "SECH",
              },
              {
                cell: "B71",
                format: "common",
                value: "=SECH(C71)",
              },
              {
                cell: "C71",
                format: "number",
                value: 45,
              },
              {
                cell: "A72",
                css: "highlighting",
                format: "common",
                value: "SIN",
              },
              {
                cell: "B72",
                format: "common",
                value: "=SIN(C72)",
              },
              {
                cell: "C72",
                format: "number",
                value: 30,
              },
              {
                cell: "A73",
                css: "highlighting",
                format: "common",
                value: "SINH",
              },
              {
                cell: "B73",
                format: "common",
                value: "=SINH(C73)",
              },
              {
                cell: "C73",
                format: "number",
                value: 1,
              },
              {
                cell: "A74",
                css: "highlighting",
                format: "common",
                value: "SQRT",
              },
              {
                cell: "B74",
                format: "common",
                value: "=SQRT(C74)",
              },
              {
                cell: "C74",
                format: "number",
                value: 5,
              },
              {
                cell: "A75",
                css: "highlighting",
                format: "common",
                value: "SQRTPI",
              },
              {
                cell: "B75",
                format: "common",
                value: "=SQRTPI(C75)",
              },
              {
                cell: "C75",
                format: "number",
                value: 1,
              },
              {
                cell: "A76",
                css: "highlighting",
                format: "common",
                value: "STDEV",
              },
              {
                cell: "B76",
                format: "common",
                value: "=STDEV(C76;D76)",
              },
              {
                cell: "C76",
                format: "number",
                value: 5,
              },
              {
                cell: "D76",
                format: "number",
                value: 2,
              },
              {
                cell: "A77",
                css: "highlighting",
                format: "percent",
                value: "STDEV.S",
              },
              {
                cell: "B77",
                format: "common",
                value: "=STDEV.S(C77:I77)",
              },
              {
                cell: "C77",
                format: "number",
                value: 102,
              },
              {
                cell: "D77",
                format: "number",
                value: 99,
              },
              {
                cell: "E77",
                format: "number",
                value: 97,
              },
              {
                cell: "F77",
                format: "number",
                value: 100,
              },
              {
                cell: "G77",
                format: "number",
                value: 98,
              },
              {
                cell: "H77",
                format: "number",
                value: 105,
              },
              {
                cell: "I77",
                format: "number",
                value: 102,
              },
              {
                cell: "A78",
                css: "highlighting",
                format: "common",
                value: "STDEVA",
              },
              {
                cell: "B78",
                format: "common",
                value: "=STDEVA(C78;D78)",
              },
              {
                cell: "C78",
                format: "number",
                value: 5,
              },
              {
                cell: "D78",
                format: "number",
                value: 2,
              },
              {
                cell: "A79",
                css: "highlighting",
                format: "common",
                value: "STDEVP",
              },
              {
                cell: "B79",
                format: "common",
                value: "=STDEVP(C79;D79)",
              },
              {
                cell: "C79",
                format: "number",
                value: 5,
              },
              {
                cell: "D79",
                format: "number",
                value: 2,
              },
              {
                cell: "A80",
                css: "highlighting",
                format: "common",
                value: "STDEVPA",
              },
              {
                cell: "B80",
                format: "common",
                value: "=STDEVPA(C80;D80)",
              },
              {
                cell: "C80",
                format: "number",
                value: 5,
              },
              {
                cell: "D80",
                format: "number",
                value: 2,
              },
              {
                cell: "A81",
                css: "highlighting",
                format: "common",
                value: "SUBTOTAL",
              },
              {
                cell: "B81",
                format: "common",
                value: "=SUBTOTAL(C81;D81:F81)",
              },
              {
                cell: "C81",
                format: "common",
                value: 9,
              },
              {
                cell: "D81",
                format: "number",
                value: 115,
              },
              {
                cell: "E81",
                format: "number",
                value: 10,
              },
              {
                cell: "F81",
                format: "number",
                value: 90,
              },
              {
                cell: "A82",
                css: "highlighting",
                format: "common",
                value: "SUM",
              },
              {
                cell: "B82",
                format: "common",
                value: "=SUM(C82;D82)",
              },
              {
                cell: "C82",
                format: "number",
                value: 5,
              },
              {
                cell: "D82",
                format: "number",
                value: 2,
              },
              {
                cell: "A83",
                css: "highlighting",
                format: "common",
                value: "SUMPRODUCT",
              },
              {
                cell: "B83",
                format: "common",
                value: "=SUMPRODUCT(C83:E83;F83:H83)",
              },
              {
                cell: "C83",
                format: "number",
                value: 5,
              },
              {
                cell: "D83",
                format: "number",
                value: 5,
              },
              {
                cell: "E83",
                format: "number",
                value: 5,
              },
              {
                cell: "F83",
                format: "number",
                value: 2,
              },
              {
                cell: "G83",
                format: "number",
                value: 2,
              },
              {
                cell: "H83",
                format: "number",
                value: 2,
              },
              {
                cell: "A84",
                css: "highlighting",
                format: "common",
                value: "SUMSQ",
              },
              {
                cell: "B84",
                format: "common",
                value: "=SUMSQ(C84;D84)",
              },
              {
                cell: "C84",
                format: "number",
                value: 5,
              },
              {
                cell: "D84",
                format: "number",
                value: 2,
              },
              {
                cell: "A85",
                css: "highlighting",
                format: "common",
                value: "SUMX2MY2",
              },
              {
                cell: "B85",
                format: "common",
                value: "=SUMX2MY2(C85:F85;G85:J85)",
              },
              {
                cell: "C85",
                format: "number",
                value: 5,
              },
              {
                cell: "D85",
                format: "number",
                value: 5,
              },
              {
                cell: "E85",
                format: "number",
                value: 5,
              },
              {
                cell: "F85",
                format: "number",
                value: 5,
              },
              {
                cell: "G85",
                format: "number",
                value: 2,
              },
              {
                cell: "H85",
                format: "number",
                value: 2,
              },
              {
                cell: "I85",
                format: "number",
                value: 2,
              },
              {
                cell: "J85",
                format: "number",
                value: 2,
              },
              {
                cell: "A86",
                css: "highlighting",
                format: "common",
                value: "SUMX2PY2",
              },
              {
                cell: "B86",
                format: "common",
                value: "=SUMX2PY2(C86:G86,H86:L86)",
              },
              {
                cell: "C86",
                format: "number",
                value: 5,
              },
              {
                cell: "D86",
                format: "number",
                value: 5,
              },
              {
                cell: "E86",
                format: "number",
                value: 5,
              },
              {
                cell: "F86",
                format: "number",
                value: 5,
              },
              {
                cell: "G86",
                format: "number",
                value: 5,
              },
              {
                cell: "H86",
                format: "number",
                value: 2,
              },
              {
                cell: "I86",
                format: "number",
                value: 2,
              },
              {
                cell: "J86",
                format: "number",
                value: 2,
              },
              {
                cell: "K86",
                format: "number",
                value: 2,
              },
              {
                cell: "L86",
                format: "number",
                value: 2,
              },
              {
                cell: "A87",
                css: "highlighting",
                format: "common",
                value: "SUMXMY2",
              },
              {
                cell: "B87",
                format: "common",
                value: "=SUMXMY2(C87:G87,H87:L87)",
              },
              {
                cell: "C87",
                format: "number",
                value: 5,
              },
              {
                cell: "D87",
                format: "number",
                value: 5,
              },
              {
                cell: "E87",
                format: "number",
                value: 5,
              },
              {
                cell: "F87",
                format: "number",
                value: 5,
              },
              {
                cell: "G87",
                format: "number",
                value: 5,
              },
              {
                cell: "H87",
                format: "number",
                value: 2,
              },
              {
                cell: "I87",
                format: "number",
                value: 2,
              },
              {
                cell: "J87",
                format: "number",
                value: 2,
              },
              {
                cell: "K87",
                format: "number",
                value: 2,
              },
              {
                cell: "L87",
                format: "number",
                value: 2,
              },
              {
                cell: "A88",
                css: "highlighting",
                format: "common",
                value: "TAN",
              },
              {
                cell: "B88",
                format: "common",
                value: "=TAN(C88)",
              },
              {
                cell: "C88",
                format: "number",
                value: 0.785,
              },
              {
                cell: "A89",
                css: "highlighting",
                format: "common",
                value: "TANH",
              },
              {
                cell: "B89",
                format: "common",
                value: "=TANH(C89)",
              },
              {
                cell: "C89",
                format: "number",
                value: 0.5,
              },
              {
                cell: "A90",
                css: "highlighting",
                format: "common",
                value: "TRUNC",
              },
              {
                cell: "B90",
                format: "common",
                value: "=TRUNC(C90)",
              },
              {
                cell: "C90",
                format: "number",
                value: 5.64,
              },
              {
                cell: "A91",
                css: "highlighting",
                format: "common",
                value: "VAR",
              },
              {
                cell: "B91",
                format: "common",
                value: "=VAR(C91:F91)",
              },
              {
                cell: "C91",
                format: "number",
                value: 5,
              },
              {
                cell: "D91",
                format: "number",
                value: 2,
              },
              {
                cell: "E91",
                format: "number",
                value: 5,
              },
              {
                cell: "F91",
                format: "number",
                value: 2,
              },
              {
                cell: "A92",
                css: "highlighting",
                format: "common",
                value: "VAR.S",
              },
              {
                cell: "B92",
                format: "common",
                value: "=VAR.S(C92:G92)",
              },
              {
                cell: "C92",
                format: "number",
                value: 50,
              },
              {
                cell: "D92",
                format: "number",
                value: 47,
              },
              {
                cell: "E92",
                format: "number",
                value: 52,
              },
              {
                cell: "F92",
                format: "number",
                value: 46,
              },
              {
                cell: "G92",
                format: "number",
                value: 45,
              },
              {
                cell: "A93",
                css: "highlighting",
                format: "common",
                value: "VARA",
              },
              {
                cell: "B93",
                format: "common",
                value: "=VARA(C93:F93)",
              },
              {
                cell: "C93",
                format: "number",
                value: 5,
              },
              {
                cell: "D93",
                format: "number",
                value: 2,
              },
              {
                cell: "E93",
                format: "number",
                value: 5,
              },
              {
                cell: "F93",
                format: "number",
                value: 2,
              },
              {
                cell: "A94",
                css: "highlighting",
                format: "common",
                value: "VARP",
              },
              {
                cell: "B94",
                format: "common",
                value: "=VARP(C94:F94)",
              },
              {
                cell: "C94",
                format: "number",
                value: 5,
              },
              {
                cell: "D94",
                format: "number",
                value: 2,
              },
              {
                cell: "E94",
                format: "number",
                value: 5,
              },
              {
                cell: "F94",
                format: "number",
                value: 2,
              },
              {
                cell: "A95",
                css: "highlighting",
                format: "common",
                value: "VARPA",
              },
              {
                cell: "B95",
                format: "common",
                value: "=VARPA(C95;D95)",
              },
              {
                cell: "C95",
                format: "number",
                value: 5,
              },
              {
                cell: "D95",
                format: "number",
                value: 2,
              },
            ],
            cols: [
              {
                width: 180,
              },
            ],
            rows: [],
          },
          {
            name: "Regex",
            data: [
              {
                cell: "A1",
                css: "header",
                format: "common",
                value: "Formula name",
              },
              {
                cell: "B1",
                css: "header",
                format: "common",
                value: "Formula example",
              },
              {
                cell: "C1",
                css: "header",
                format: "common",
                value: "Data for formula",
              },
              {
                cell: "A2",
                css: "header",
                format: "common",
                value: "Regex",
              },
              {
                cell: "A3",
                css: "highlighting",
                format: "common",
                value: "REGEXEXTRACT",
              },
              {
                cell: "B3",
                format: "common",
                value: "=REGEXEXTRACT(C3;D3)",
              },
              {
                cell: "C3",
                format: "text",
                value: "DHTMLX Spreadsheet",
              },
              {
                cell: "D3",
                format: "text",
                value: "DHTMLX",
              },
              {
                cell: "A4",
                css: "highlighting",
                format: "common",
                value: "REGEXMATCH",
              },
              {
                cell: "B4",
                format: "common",
                value: "=REGEXMATCH(C4;D4)",
              },
              {
                cell: "C4",
                format: "text",
                value: "You are happy",
              },
              {
                cell: "D4",
                format: "text",
                value: "happy",
              },
              {
                cell: "A5",
                css: "highlighting",
                format: "common",
                value: "REGEXREPLACE",
              },
              {
                cell: "B5",
                format: "common",
                value: '=REGEXREPLACE(C5, "[0-9]+", "777")',
              },
              {
                cell: "C5",
                format: "common",
                value: "Google Doc 101",
              },
            ],
            cols: [
              {
                width: 180,
              },
            ],
            rows: [],
          },
          {
            name: "String",
            data: [
              {
                cell: "A1",
                css: "header",
                format: "common",
                value: "Formula name",
              },
              {
                cell: "B1",
                css: "header",
                format: "common",
                value: "Formula example",
              },
              {
                cell: "C1",
                css: "header",
                format: "common",
                value: "Data for formula",
              },
              {
                cell: "A2",
                css: "header",
                format: "common",
                value: "String",
              },
              {
                cell: "A3",
                css: "highlighting",
                format: "common",
                value: "ARRAYTOTEXT",
              },
              {
                cell: "B3",
                format: "common",
                value: "=ARRAYTOTEXT(C3:E3)",
              },
              {
                cell: "C3",
                format: "common",
                value: "RED",
              },
              {
                cell: "D3",
                format: "common",
                value: "BLUE",
              },
              {
                cell: "E3",
                format: "common",
                value: "GREEN",
              },
              {
                cell: "A4",
                css: "highlighting",
                format: "common",
                value: "CHAR",
              },
              {
                cell: "B4",
                format: "common",
                value: "=CHAR(C4)",
              },
              {
                cell: "C4",
                format: "number",
                value: 67,
              },
              {
                cell: "A5",
                css: "highlighting",
                format: "common",
                value: "CLEAN",
              },
              {
                cell: "B5",
                format: "common",
                value: "=CLEAN(C5)",
              },
              {
                cell: "C5",
                format: "common",
                value: "some",
              },
              {
                cell: "A6",
                css: "highlighting",
                format: "common",
                value: "CODE",
              },
              {
                cell: "B6",
                format: "common",
                value: "=CODE(C6)",
              },
              {
                cell: "C6",
                format: "common",
                value: "a",
              },
              {
                cell: "A7",
                css: "highlighting",
                format: "common",
                value: "CONCATENATE",
              },
              {
                cell: "B7",
                format: "common",
                value: '=CONCATENATE(C7;" ";D7)',
              },
              {
                cell: "C7",
                format: "common",
                value: "some",
              },
              {
                cell: "D7",
                format: "common",
                value: "text",
              },
              {
                cell: "A8",
                css: "highlighting",
                format: "common",
                value: "DOLLAR",
              },
              {
                cell: "B8",
                format: "common",
                value: "=DOLLAR(C8;D8)",
              },
              {
                cell: "C8",
                format: "number",
                value: 120.1,
              },
              {
                cell: "D8",
                format: "number",
                value: 0,
              },
              {
                cell: "A9",
                css: "highlighting",
                format: "common",
                value: "EXACT",
              },
              {
                cell: "B9",
                format: "common",
                value: "=EXACT(C9;D9)",
              },
              {
                cell: "C9",
                format: "common",
                value: "text",
              },
              {
                cell: "D9",
                format: "common",
                value: "text",
              },
              {
                cell: "A10",
                css: "highlighting",
                format: "common",
                value: "FIND",
              },
              {
                cell: "B10",
                format: "common",
                value: "=FIND(C10;D10)",
              },
              {
                cell: "C10",
                format: "common",
                value: "t",
              },
              {
                cell: "D10",
                format: "common",
                value: "text",
              },
              {
                cell: "A11",
                css: "highlighting",
                format: "common",
                value: "FIXED",
              },
              {
                cell: "B11",
                format: "common",
                value: "=FIXED(C11;D11)",
              },
              {
                cell: "C11",
                format: "number",
                value: 1234.567,
              },
              {
                cell: "D11",
                format: "number",
                value: 1,
              },
              {
                cell: "A12",
                css: "highlighting",
                format: "common",
                value: "JOIN",
              },
              {
                cell: "B12",
                format: "common",
                value: '=JOIN("_",C12,D12)',
              },
              {
                cell: "C12",
                format: "common",
                value: "DHTMLX",
              },
              {
                cell: "D12",
                format: "common",
                value: "Docs",
              },
              {
                cell: "A13",
                css: "highlighting",
                format: "common",
                value: "LEFT",
              },
              {
                cell: "B13",
                format: "common",
                value: "=LEFT(C13; 2)",
              },
              {
                cell: "C13",
                format: "common",
                value: "some",
              },
              {
                cell: "A14",
                css: "highlighting",
                format: "common",
                value: "LEN",
              },
              {
                cell: "B14",
                format: "common",
                value: "=LEN(C14)",
              },
              {
                cell: "C14",
                format: "common",
                value: "some",
              },
              {
                cell: "A15",
                css: "highlighting",
                format: "common",
                value: "LOWER",
              },
              {
                cell: "B15",
                format: "common",
                value: "=LOWER(C15)",
              },
              {
                cell: "C15",
                format: "common",
                value: "SOME",
              },
              {
                cell: "A16",
                css: "highlighting",
                format: "common",
                value: "MID",
              },
              {
                cell: "B16",
                format: "common",
                value: "=MID(C16; 2; 2)",
              },
              {
                cell: "C16",
                format: "common",
                value: "some",
              },
              {
                cell: "A17",
                css: "highlighting",
                format: "common",
                value: "NUMBERVALUE",
              },
              {
                cell: "B17",
                format: "common",
                value: "=NUMBERVALUE(C17,E17,D17)",
              },
              {
                cell: "C17",
                format: "common",
                value: '="3/521,48"',
              },
              {
                cell: "D17",
                format: "common",
                value: "/",
              },
              {
                cell: "E17",
                format: "common",
                value: ",",
              },
              {
                cell: "A18",
                css: "highlighting",
                format: "common",
                value: "PROPER",
              },
              {
                cell: "B18",
                format: "common",
                value: "=PROPER(C18)",
              },
              {
                cell: "C18",
                format: "common",
                value: "some",
              },
              {
                cell: "A19",
                css: "highlighting",
                format: "common",
                value: "REPLACE",
              },
              {
                cell: "B19",
                format: "common",
                value: '=REPLACE(C19,6,5,"*")',
              },
              {
                cell: "C19",
                format: "number",
                value: "abcdefghijk",
              },
              {
                cell: "A20",
                css: "highlighting",
                format: "common",
                value: "REPT",
              },
              {
                cell: "B20",
                format: "common",
                value: "=REPT(C20;D20)",
              },
              {
                cell: "C20",
                format: "common",
                value: "s",
              },
              {
                cell: "D20",
                format: "number",
                value: 3,
              },
              {
                cell: "A21",
                css: "highlighting",
                format: "common",
                value: "RIGHT",
              },
              {
                cell: "B21",
                format: "common",
                value: "=RIGHT(C21; 2)",
              },
              {
                cell: "C21",
                format: "common",
                value: "some",
              },
              {
                cell: "A22",
                css: "highlighting",
                format: "common",
                value: "SEARCH",
              },
              {
                cell: "B22",
                format: "common",
                value: "=SEARCH(C22;D22)",
              },
              {
                cell: "C22",
                format: "common",
                value: "m",
              },
              {
                cell: "D22",
                format: "common",
                value: "some",
              },
              {
                cell: "A23",
                css: "highlighting",
                format: "common",
                value: "SUBSTITUTE",
              },
              {
                cell: "B23",
                format: "common",
                value: "=SUBSTITUTE(C23;D23;E23)",
              },
              {
                cell: "C23",
                format: "common",
                value: "text",
              },
              {
                cell: "D23",
                format: "common",
                value: "t",
              },
              {
                cell: "E23",
                format: "common",
                value: "s",
              },
              {
                cell: "A24",
                css: "highlighting",
                format: "common",
                value: "T",
              },
              {
                cell: "B24",
                format: "common",
                value: "=T(C24)",
              },
              {
                cell: "C24",
                format: "common",
                value: "Start",
              },
              {
                cell: "A25",
                css: "highlighting",
                format: "common",
                value: "TRIM",
              },
              {
                cell: "B25",
                format: "common",
                value: "=TRIM(C25)",
              },
              {
                cell: "C25",
                format: "common",
                value: "some",
              },
              {
                cell: "A26",
                css: "highlighting",
                format: "common",
                value: "UPPER",
              },
              {
                cell: "B26",
                format: "common",
                value: "=UPPER(C26)",
              },
              {
                cell: "C26",
                format: "common",
                value: "some",
              },
            ],
            cols: [
              {
                width: 180,
              },
            ],
            rows: [],
          },
          {
            name: "Other",
            data: [
              {
                cell: "A1",
                css: "header",
                format: "common",
                value: "Formula name",
              },
              {
                cell: "B1",
                css: "header",
                format: "common",
                value: "Formula example",
              },
              {
                cell: "C1",
                css: "header",
                format: "common",
                value: "Data for formula",
              },
              {
                cell: "A2",
                css: "header",
                format: "common",
                value: "Other",
              },
              {
                cell: "A3",
                css: "highlighting",
                format: "common",
                value: "AND",
              },
              {
                cell: "B3",
                format: "common",
                value: "=AND(C3>D3;C3<E3)",
              },
              {
                cell: "C3",
                format: "number",
                value: 70,
              },
              {
                cell: "D3",
                format: "number",
                value: 60,
              },
              {
                cell: "E3",
                format: "number",
                value: 100,
              },
              {
                cell: "A4",
                css: "highlighting",
                format: "common",
                value: "CHOOSE",
              },
              {
                cell: "B4",
                format: "common",
                value: "=CHOOSE(C4;D4;E4;F4)",
              },
              {
                cell: "C4",
                format: "number",
                value: 2,
              },
              {
                cell: "D4",
                format: "number",
                value: 60,
              },
              {
                cell: "E4",
                format: "common",
                value: "some",
              },
              {
                cell: "F4",
                format: "number",
                value: 2,
              },
              {
                cell: "A5",
                css: "highlighting",
                format: "common",
                value: "FALSE",
              },
              {
                cell: "B5",
                format: "common",
                value: "=IF(C5>D5),FALSE()",
              },
              {
                cell: "C5",
                format: "number",
                value: 5,
              },
              {
                cell: "D5",
                format: "number",
                value: 7,
              },
              {
                cell: "A6",
                css: "highlighting",
                format: "common",
                value: "IF",
              },
              {
                cell: "B6",
                format: "common",
                value: '=IF(C6>D6;"Pass","Fail")',
              },
              {
                cell: "C6",
                format: "number",
                value: 70,
              },
              {
                cell: "D6",
                format: "number",
                value: 60,
              },
              {
                cell: "A7",
                css: "highlighting",
                format: "common",
                value: "NOT",
              },
              {
                cell: "B7",
                format: "common",
                value: "=NOT(C7=D7)",
              },
              {
                cell: "C7",
                format: "common",
                value: "text",
              },
              {
                cell: "D7",
                format: "common",
                value: "some",
              },
              {
                cell: "A8",
                css: "highlighting",
                format: "common",
                value: "OR",
              },
              {
                cell: "B8",
                format: "common",
                value: "=OR(C8>D8;C8=D8)",
              },
              {
                cell: "C8",
                format: "number",
                value: 5,
              },
              {
                cell: "D8",
                format: "number",
                value: 2,
              },
              {
                cell: "A9",
                css: "highlighting",
                format: "common",
                value: "TRUE",
              },
              {
                cell: "B9",
                format: "common",
                value: "=IF(C9>D9),TRUE()",
              },
              {
                cell: "C9",
                format: "number",
                value: 7,
              },
              {
                cell: "D9",
                format: "number",
                value: 5,
              },
            ],
            cols: [
              {
                width: 180,
              },
            ],
            rows: [],
          },
        ],
        styles: {
          header: {
            "font-weight": "bold",
            "white-space": "nowrap",
          },
          highlighting: {
            color: "#0b72a5",
            "white-space": "nowrap",
          },
        },
        formats: [
          {
            name: "Common",
            id: "common",
            mask: "",
            example: "1500.31",
          },
          {
            name: "Number",
            id: "number",
            mask: "#,##0.00",
            example: "1500.31",
          },
          {
            name: "Percent",
            id: "percent",
            mask: "#,##0.00%",
            example: "15.0031",
          },
          {
            name: "Currency",
            id: "currency",
            mask: "$#,##0.00",
            example: "1500.31",
          },
          {
            name: "Date",
            id: "date",
            mask: "mm-dd-yy",
            example: "44490",
            dateFormat: "%d/%m/%Y",
          },
          {
            name: "Time",
            id: "time",
            mask: "h:mm:ss am/pm",
            example: "0.5625",
            timeFormat: 12,
          },
          {
            name: "Text",
            id: "text",
            mask: "@",
            example: "some text",
          },
        ],
      };
    }

    /* src/App.svelte generated by Svelte v3.59.2 */

    function create_fragment(ctx) {
    	let spreadsheet;
    	let current;

    	spreadsheet = new Spreadsheet_1({
    			props: { data: getData() },
    			$$inline: true
    		});

    	const block = {
    		c: function create() {
    			create_component(spreadsheet.$$.fragment);
    		},
    		l: function claim(nodes) {
    			throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option");
    		},
    		m: function mount(target, anchor) {
    			mount_component(spreadsheet, target, anchor);
    			current = true;
    		},
    		p: noop,
    		i: function intro(local) {
    			if (current) return;
    			transition_in(spreadsheet.$$.fragment, local);
    			current = true;
    		},
    		o: function outro(local) {
    			transition_out(spreadsheet.$$.fragment, local);
    			current = false;
    		},
    		d: function destroy(detaching) {
    			destroy_component(spreadsheet, detaching);
    		}
    	};

    	dispatch_dev("SvelteRegisterBlock", {
    		block,
    		id: create_fragment.name,
    		type: "component",
    		source: "",
    		ctx
    	});

    	return block;
    }

    function instance($$self, $$props, $$invalidate) {
    	let { $$slots: slots = {}, $$scope } = $$props;
    	validate_slots('App', slots, []);
    	const writable_props = [];

    	Object.keys($$props).forEach(key => {
    		if (!~writable_props.indexOf(key) && key.slice(0, 2) !== '$$' && key !== 'slot') console.warn(`<App> was created with unknown prop '${key}'`);
    	});

    	$$self.$capture_state = () => ({ Spreadsheet: Spreadsheet_1, getData });
    	return [];
    }

    class App extends SvelteComponentDev {
    	constructor(options) {
    		super(options);
    		init(this, options, instance, create_fragment, safe_not_equal, {});

    		dispatch_dev("SvelteRegisterComponent", {
    			component: this,
    			tagName: "App",
    			options,
    			id: create_fragment.name
    		});
    	}
    }

    const app = new App({
      target: document.body,
    });

    return app;

})();
//# sourceMappingURL=bundle.js.map
